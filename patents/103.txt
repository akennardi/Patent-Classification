                                                ABSTRACT
   FORMAT PRESERVATION BASED MASKING SYSTEM AND METHOD
  A computer implement format preservation based masking system and method is provided. The
  system obtains a first set of letters and a private key, and encrypts the first set of letters to obtain
  an encrypted letters list using the first set and private key. The encrypted letters list comprises a
5 set of encrypted letters.    A dynamic map is generated based on the encrypted letters, which
  includes one or more keys, each key being specific to a letter in the first set letters. A position of
  each of maskable letters in a second set of letters is calculated using the dynamic map, and
  performs masking of the maskable letters based on the position of each of the maskable letters to
  obtain masked data using the dynamic map.
0 [To be published with FIG. 2]

 OBTAINING AN INPUT SET OF LETTERS AND A PRIVATE      202
                  KEY FROM A USER
     ENCRYPTING A SET OF LETTERS TO OBTAIN AN
ENCRYPTED LETTERS LIST USING THE SET OF LETTERS -     204
 AND THE PRIVATE KEY, THE ENCRYPTED LETTERS LIST
      COMPRISES A SET OF ENCRYPTED LETTERS
  GENERATING A DYNAMIC MAP BASED ON THE SET OF
ENCRYPTED LETTERS, THE DYNAMIC MAP COMPRISES A
  SET OF KEYS, EACH KEY IS SPECIFIC TO A LETTER IN    206
                THE SET OF LETTERS
    CALCULATING A POSITION OF EACH OF MASKABLE
   LETTERS IN THE INPUT SET OF LETTERS USING THE   -- 208
                    DYNAMIC MAP
   PERFORMING MASKING OF THE MASKABLE LETTERS
  BASED ON THE POSITION OF EACH OF THE MASKABLE
LETTERS TO OBTAIN MASKED DATA USING THE DYNAMIC       210
                        MAP
                       FIG. 2

      FORMAT PRESERVATION BASED MASKING SYSTEM AND METHOD
               CROSS-REFERENCE TO RELATED APPLICATIONS AND PRIORITY
            [0001] This   patent   application    claims  priority  to   India  Patent    Application
 5 4244/MUM/2015, filed on November 7, 2015, the entirety of which is hereby incorporated by
   reference.
                                          TECHNICAL FIELD
            [0002] The embodiments herein generally relate to information privacy systems, and,
   more particularly, to a format preservation based masking system and method.
 0
                                             BACKGROUND
            [0003] Several organizations unwittingly share production data for testing purposes in
   non-production environment. This increases the risk of data breach. Masking sensitive data is a
   heuristic approach that organizations adopt in order to comply with data privacy mandates.
 5 Current data masking tools have been used by organizations to share data in non-production
   environment in order to maintain high data utility and non-disclosure of customer sensitive data.
   These tools offer a variety of masking techniques that are capable of masking sensitive data to
   meet several data privacy expectations.       However, these tools mask data by using a static
   predefined lookup for replacing the original data. Using such techniques (or tools), it is easy to
20 reproduce (or decipher) the original data and hence it is less secure leading to compromise in
   utility and privacy.   Further, existing solutions require data to be specified within a specific
   range.
            [0004] Additionally, existing solutions work on physical look ups of original and masked
   data mapping, which requires a computing system to consume more disk space, and more time in
25 terms of creating, updating and processing of the data in a presentable and secured format. It is
                                                      1

   therefore a challenge in maintaining consistency of data sharing at an enterprise level without
   disrupting the format of the data.
                                                SUMMARY
 5          [0005] The following presents a simplified summary of some embodiments of the
   disclosure in order to provide a basic understanding of the embodiments. This summary is not an
   extensive overview of the embodiments. It is not intended to identify key/critical elements of the
   embodiments or to delineate the scope of the embodiments. Its sole purpose is to present some
   embodiments in a simplified form as a prelude to the more detailed description that is presented
 0 below.
            [0006] In view of the foregoing, an embodiment herein provides a format preservation
   based masking system.       A format preserving based masking system, comprising a memory
   storing instructions; a hardware processor coupled to the memory, wherein the hardware
   processor is configured by the instructions to: obtain an input set of letters and a private key from
 5 a user, encrypt a set of letters to obtain an encrypted letters list using the set of letters and the
   private key, wherein the encrypted letters list includes a set of encrypted letters, generate a
   dynamic map based on the encrypted letters list , wherein the dynamic map includes a set of
   keys, each key is specific to a letter in the set of letters, calculate a position of each of maskable
   letters in the input set of letters that are to be masked using the dynamic map, and perform
20 masking of the maskable letters based on the position of each of the maskable letters to obtain
   masked data using the dynamic map.
            [0007] The set of letters and the input set of letters comprises at least one of a character, a
   numeric, and a symbol.       The set of letters and the input set of letters are selected from one or
   more languages. When the input set of letters comprises one or more numerals, the hardware
25 processor is further configured by the instructions to: generate a Most Significant Bit (MSB) map
   for the one or more numerals, calculate a position of each of maskable letters in the input set of
                                                      2

   letters using the dynamic map and the MSB map, and perform masking of the maskable letters
   based on the position of each of the maskable letters to obtain masked data using the dynamic
   map and MSB map.
            [0008] The hardware processor is further configured by the instructions to: determine an
 5 order of letters in the encrypted letters list, sort the encrypted letters list from the order of letters
   to obtain a sorted encrypted letters list, generate a dynamic map based on the sorted encrypted
   letters list, wherein the dynamic map comprises a set of keys and values, each key specific to at
   least one letter in the set of letters, and, each value comprises one or more rearranged letters to be
   masked from the set of letters, calculate a position of each of maskable letters in the input set of
 0 letters that are to be masked using the dynamic map, and perform masking of the maskable letters
   based on the position of each of the maskable letters to obtain masked data using the dynamic
   map. The dynamic map further comprises an index indicative of masked replace letter for each
   letter in the set of letters.
            [0009] When the one or more numerals is indicative of a specified range, the maskable
 5 letters comprising the one or more numerals are masked within the specified range.
            [0010] In another aspect, a computer implemented format preservation based masking
   method is provided. The method, comprising: obtaining an input set of letters and a private key
   from a user; encrypting a set of letters to obtain an encrypted letters list using the set of letters
   and the private key, wherein the encrypted letters list comprises a set of encrypted letters;
20 generating a dynamic map based on the encrypted letters list, wherein the dynamic map
   comprises a set of keys wherein each key is specific to a letter in the set of letters; calculating a
   position of each of maskable letters in the input set of letters that are to be masked using the
   dynamic map; and performing masking of the maskable letters based on the position of each of
   the maskable letters to obtain masked data using the dynamic map.
                                                        3

            [0011] The set of letters and the input set of letters comprises at least one of a character, a
   numeric, and a symbol, and wherein the set of letters and the input set of letters are selected from
   one or more languages.
            [0012] When the input set of letters comprises one or more numerals, the method
 5 comprising: generating a Most Significant Bit (MSB) map for the one or more numerals;
   calculating a position of each of maskable letters in the input set of letters using the dynamic map
   and the MSB map; and performing masking of the maskable letters based on the position of each
   of the maskable letters to obtain masked data using the dynamic map and the MSB map.
            [0013] The method comprising: determining an order of letters in the encrypted letters
 0 list; sorting the encrypted letters list from the order of letters to obtain a sorted encrypted letters
   list; generating a dynamic map based on the sorted encrypted letters list, wherein the dynamic
   map comprises a set of keys and values, each key specific to at least one letter in the set of letters,
   and, each value comprises one or more rearranged letters to be masked from the set of letters;
   calculating a position of each of maskable letters in the input set of letters that are to be masked
 5 using the dynamic map; and perform masking of the maskable letters based on the position of
   each of the maskable letters to obtain masked data using the dynamic map.
            [0014] In yet another aspect, one or more non-transitory machine readable information
   storage mediums comprising one or more instructions is provided. The one or more instructions
   which when executed by one or more hardware processors causes obtaining an input set of letters
20 and a private key from a user; encrypting a set of letters to obtain an encrypted letters list using
   the set of letters and the private key, wherein the encrypted letters list comprises a set of
   encrypted letters; generating a dynamic map based on the encrypted letters list , wherein the
   dynamic map comprises a set of keys wherein each key is specific to a letter in the set of letters;
   calculating a position of each of maskable letters in the input set of letters that are to be masked
25 using the dynamic map; and performing masking of the maskable letters based on the position of
   each of the maskable letters to obtain masked data using the dynamic map.
                                                      4

            [0015] The set of letters and the input set of letters comprises at least one of a character, a
   numeric, and a symbol, and wherein the set of letters and the input set of letters are selected from
   one or more languages.
            [0016] When the input set of letters comprises one or more numerals, the one or more
 5 instructions which when executed by one or more hardware processors causes: generating a Most
   Significant Bit (MSB) map for the one or more numerals; calculating a position of each of
   maskable letters in the input set of letters using the dynamic map and the MSB map; and
   performing masking of the maskable letters based on the position of each of the maskable letters
   to obtain masked data using the dynamic map and the MSB map.
 0          [0017] The one or more instructions which when executed by one or more hardware
   processors further causes: determining an order of letters in the encrypted letters list; sorting the
   encrypted letters list from the order of letters to obtain a sorted encrypted letters list; generating a
   dynamic map based on the sorted encrypted letters list, wherein the dynamic map comprises a set
   of keys and values, each key specific to at least one letter in the set of letters, and, each value
 5 comprises one or more rearranged letters to be masked from the set of letters; calculating a
   position of each of maskable letters in the input set of letters that are to be masked using the
   dynamic map; and perform masking of the maskable letters based on the position of each of the
   maskable letters to obtain masked data using the dynamic map. When the one or more numerals
   is indicative of a specified range, the maskable letters comprising the one or more numerals are
20 masked within the specified range.
            [0018] It should be appreciated by those skilled in the art that any block diagram herein
   represent conceptual views of illustrative systems embodying the principles of the present subject
   matter. Similarly, it will be appreciated that any flow charts, flow diagrams, state transition
   diagrams, pseudo code, and the like represent various processes which may be substantially
25 represented in computer readable medium and so executed by a computing device or processor,
   whether or not such computing device or processor is explicitly shown.
                                                       5

                             BRIEF DESCRIPTION OF THE DRAWINGS
           [0019] The embodiments herein will be better understood from the following detailed
 5 description with reference to the drawings, in which:
           [0020] FIG. 1 illustrates a block diagram of a format preservation based masking system
   100 according to an embodiment of the present disclosure;
           [0021] FIG. 2 is a flow diagram illustrating a computer implemented format preservation
   based masking method using the format preservation based masking system of FIG. 1 according
 0 to an embodiment of the present disclosure;
           [0022] FIG. 3A illustrate comparative exemplary views of the original data and the
   masked data for a set of letters comprising characters (e.g., street address) according to one or
   more embodiments of the present disclosure;
           [0023] FIG. 3B illustrates an exemplary view of the original data and the masked data for
 5 minimum salary with range specified according to one or more embodiments of the present
   disclosure;
           [0024] FIG. 3C illustrates an exemplary view of the original data and the masked data for
   minimum salary without range being specified according to one or more embodiments of the
   present disclosure;
20         [0025] FIG. 3D illustrates an exemplary view of the original data and the masked data for
   Chinese characters according to one or more embodiments of the present disclosure; and
           [0026] FIG. 3E illustrates an exemplary view of the original data and the masked data for
   exceptional scenarios indicative of certain values to be masked with predefined values according
   to one or more embodiments of the present disclosure.
25
                          DETAILED DESCRIPTION OF EMBODIMENTS
                                                    6

           [0027] The embodiments herein and the various features and advantageous details thereof
   are explained more fully with reference to the non-limiting embodiments that are illustrated in
   the accompanying drawings and detailed in the following description. The examples used herein
   are intended merely to facilitate an understanding of ways in which the embodiments herein may
 5 be practiced and to further enable those of skill in the art to practice the embodiments herein.
   Accordingly, the examples should not be construed as limiting the scope of the embodiments
   herein.
           [0028] The words "comprising," "having," "containing," and "including," and other
   forms thereof, are intended to be equivalent in meaning and be open ended in that an item or
 0 items following any one of these words is not meant to be an exhaustive listing of such item or
   items, or meant to be limited to only the listed item or items.
           [0029] It must also be noted that as used herein and in the appended claims, the singular
   forms a," an," and "the" include plural references unless the context clearly dictates otherwise.
   Although any systems and methods similar or equivalent to those described herein can be used in
 5 the practice or testing of embodiments of the present disclosure, the preferred, systems and
   methods are now described.
           [0030] Some embodiments of this disclosure, illustrating all its features, will now be
   discussed in detail. The disclosed embodiments are merely exemplary of the disclosure, which
   may be embodied in various forms.
20         [0031] Before setting forth the detailed explanation, it is noted that all of the discussion
   below, regardless of the particular implementation being described, is exemplary in nature, rather
   than limiting.
           [0032] Referring now to the drawings, and more particularly to FIG. 1 through 3F, where
   similar reference characters denote corresponding features consistently throughout the figures,
25 there are shown preferred embodiments and these embodiments are described in the context of
   the following exemplary system and/or method.
                                                      7

            [0033] FIG. 1 illustrates a block diagram of a format preservation based masking system
   100 according to an embodiment of the present disclosure. The term "format preservation based
   masking system" and "system" may be interchangeably used herein. The format preservation
   based masking system 100 comprises a memory 102, a hardware processor 104, and an
 5 input/output (I/O) interface 106. The memory 102 further includes one or more modules 108 (or
   modules 108). The memory 102, the hardware processor 104, the input/output (1/0) interface
   106, and/or the modules 108 may be coupled by a system bus or a similar mechanism.
            [0034] The memory 102, may store instructions, any number of pieces of information,
   and data, used by a computer system, for example the format preservation based masking system
 0 100 to implement the functions (or embodiments) of the present disclosure. The memory 102
   may include for example, volatile memory and/or non-volatile memory. Examples of volatile
   memory may include, but are not limited to volatile random access memory (RAM). The non
   volatile   memory    may    additionally   or alternatively    comprise    an   electrically erasable
   programmable read only memory (EEPROM), flash memory, hard drive, or the like.                  Some
 5 examples of the volatile memory includes, but are not limited to, random access memory,
   dynamic random access memory, static random access memory, and the like. Some example of
   the non-volatile memory includes, but are not limited to, hard disks, magnetic tapes, optical
   disks, programmable read only memory, erasable programmable read only memory, electrically
   erasable programmable read only memory, flash memory, and the like. The memory 102 may be
20 configured to store information, data, applications, instructions or the like for enabling the format
   preservation based masking system 100 to carry out various functions in accordance with various
   example embodiments.
            [0035] Additionally or alternatively, the memory 102 may be configured to store
   instructions which when executed by the hardware processor 104 causes the format preservation
25 based masking system 100 to behave in a manner as described in various embodiments (e.g.,
   dynamic map generation, masking of data, encrypting letters list, and sorting encrypted letters
                                                     8

   list, if any). The memory 102 stores information for example, information comprising at least
   one of letters, and the like. The letters comprises at least one of a character, a numeral, a symbol,
   or a whitespace/blank space. The character is at least one of an upper case, or a lower case. The
   letters comprises of one or more languages (e.g., English, Hindi, Kannada, Tamil, Telugu,
 5 Chinese, Japanese, and the like).
             [0036] The   hardware    processor    104  may     be  implemented      as  one   or  more
   microprocessors, microcomputers, microcontrollers, digital signal processors, central processing
   units, state machines, logic circuitries, and/or any devices that manipulate signals based on
   operational instructions.     Further, the hardware processor 104 may comprise a multi-core
 0 architecture. Among other capabilities, the hardware processor 104 is configured to fetch and
   execute computer-readable instructions or modules stored in the memory 102.            The hardware
   processor 104 may include circuitry implementing, among others, audio and logic functions
   associated with the communication. For example, the hardware processor 104 may include, but
   are not limited to, one or more digital signal processors (DSPs), one or more microprocessor, one
 5 or more special-purpose computer chips, one or more field-programmable gate arrays (FPGAs),
   one or more application-specific integrated circuits (ASICs), one or more computer(s), various
   analog to digital converters, digital to analog converters, and/or other support circuits.
             [0037] The hardware processor 104 thus may also include the functionality to encode
   messages and/or data or information. The hardware processor 104 may include, among other
20 things, a clock, an arithmetic logic unit (ALU) and logic gates configured to support operation of
   the hardware processor 104. Further, the hardware processor 104 may include functionality to
   execute one or more software programs, which may be stored in the memory 102 or otherwise
   accessible to the hardware processor 104.
             [0038] The hardware processor 104 is configured by the instructions stored in the
25 memory 102. The hardware processor 104 when configured by the instructions obtains a set of
   letters and a private key as an input. The input may be obtained from one or more users, in one
                                                      9

   or more languages.       The input may include a selection of letters from one or more languages
   through one or more input devices (e.g., multi-lingual keyboards) as described above. Consider,
   the set of letters (also referred herein as Charset), and a private key (also referred herein as "user
   key") as follows:
 5                   Set of letters ={a, b, c, d, e .... x, y, z}
                     Private key= 'Key'
            [0039] The hardware processor 104 is configured to receive an input set of letters (e.g.
   Name, Salary, Street address, etc.) from the user. The set of letters may be optional, in case, the
   format preservation based masking system 100 utilizes an English character keyboard, (e.g., in
 0 case of a client system using English keyboard). When the set of letters (may also be referred as
   first set of letters), and the input set of letters (a second set of letters) are non-English characters,
   the set of letters, and the input set of letters may be received as input from one or more input
   devices (e.g., Non-English keyboards or any virtual keyboard that is capable of providing Non
   English letters). In one embodiment, the non-English letters may not be stored in the memory
 5 102. The set of letters and input set of letters (from one or more languages) may (or may not) be
   stored in the memory 102.         In another embodiment, the set of letters and the input set of letters
   (from one or more languages) can be obtained from one or more sources (e.g., cloud, remote
   servers, and/or third party sources), in real-time or near real-time. The hardware processor 104 is
   further configured by the instructions to encrypt the set of letters (e.g., the first set of letters) by
20 using one or more encryption techniques. The hardware processor 104 performs encryption on
   the set of letters such that it accounts for the private key as one of the parameter. In other words,
   the hardware processor 104 encrypts the set of letters to obtain an encrypted letters list using the
   set of letters and the private key. The encrypted letters list comprises a set of encrypted letters as
   shown in below Table 1:
                                  Set of letters (input)     Encrypted letters list
                                             a                      dcmn
                                             b                       edoi
                                                          10

                                            c                         fend
                                            d                         cbvf
                                            e                         baiu
                                                           Table 1
           [0040] Post encryption, the hardware processor 104 checks whether the list contains
   sorted set of encrypted letters. When the encrypted letters list comprising a set of encrypted
   letters is found to be sorted in a particular order (e.g., an ascending order), the hardware
 5 processor 104 generates a dynamic map based on the set of encrypted letters without having to
   necessarily performing sorting. The dynamic map comprises a set of keys wherein each key is
   specific to a letter in the set of letters.
           [0041] In case, the encrypted letters list comprising the set of encrypted letters is found to
   be in another particular order (e.g., an unacceptable order), the hardware processor 104 sorts the
 0 set of encrypted letters (e.g., unsorted encrypted letters), such that the format preservation based
   masking system 100 outputs a sorted encrypted letters list as shown in the below table 2:
                                                             Sorted encrypted
                                                                  letters
                                          e                        baiu
                                          d                          cvf
                                          a                        dcmn
                                          c                         edoi
                                          b                         fend
                                                      Table 2
           [0042] Post sorting (if required), the hardware processor 104 then generates a dynamic
   map as shown in the below table 3:
                                   Set of letters (input)     Output from dynamic map
                                               a                           e
                                               b                           d
                                               c                           a
                                               d                           c
                                               e                           b
15                                                    Table 3
           [0043] When the format preservation based masking system 100 outputs the sorted
                                                          11

   encrypted letters list, the dynamic map generated using the sorted encrypted letters list comprises
   a set of keys and values. Each value comprises one or more rearranged letters to be masked from
   the set of letters. The dynamic map generated will differ when there is a change in the private
   key.    The hardware processor 104 is further configured to calculate a position of each of
 5 maskable letters in the input set of letters (e.g., the second set of letters such as, but not limited
   to, Name, Salary, Street address, etc.,) using the dynamic map, and perform masking of the
   maskable letters based on the position of each of the maskable letters to obtain masked data using
   the dynamic map. For example, the private key        =  "My key", the masked data is as shown in the
   below table 4:
                           Set of letters (Original character)    Masked character
                                             a                           c
                                             b                           d
                                             c                           e
                                             d                           b
                                             e                           a
 0                                                      Table 4
            [0044] Further, as described above, the dynamic map generated differs when there is a
   change the private key. For example, the private key = "New Key", the masked data is as shown
   in the below table 5:
                              Set of letters (Original character)  Masked character
                                               a                            d
                                               b                            c
                                               c                            a
                                               d                            e
                                               e                            b
                                                     Table 5
15          [0045] As can be seen from the above tables 4 and 5, the format or the original letters (or
   characters) are preserved when the data is masked. The dynamic map comprises an index that is
   indicative of masked replace letter for each letter in the set of letters as can be seen from the
   above tables.     The challenge remains when the input also comprises numerals (be it just
   numerals, or in combination of characters and symbols).
                                                       12

            [0046] The embodiments of the present disclosure also resolves one of the major
   challenges in the above approach while generating unique numeric masked values. Consider the
   set of letters comprising of one or more numerals, the hardware processor 104 generates a Non
   Most Significant Bit (MSB) map for the one or more numerals, calculates a position of each of
 5 maskable letters (or numerals in this case) in the encrypted letters list using the Non-MSB map
   (and the dynamic map already generated in case the input includes both characters and
   numerals).    The encrypted letters comprises the set of letters and one or more numerals being
   encrypted.     The hardware processor 104 then performs masking of the maskable letters (or
   numerals) based on the position of each of the maskable letters to obtain masked data.
 0 Considering the private key = "Key", an illustrate example of masked data for one or more
   numerals (obtained as input), is as shown in the below table 6 (Non-MSB map table 6):
                                  Original number        Masked number
                                          1                     0
                                         2                      4
                                          3                      1
 5                                       4                      3
                                          0                     2
                                                      Table 6
            [0047] On basis of this Non-MSB map, the masked value will be as shown in below table
   7:
                      Original data         Masked data (when datatype is numeric)
                      13                    01
                      113                   001
                      1113                  001
                      11113                 0001
20                                                       Table 7
            [0048] The hardware processor 104 (or the format preservation based masking system
   100) generates a Most Significant Bit (MSB) map for numeric datatype data. This MSB map is
   created for only for non-zero numbers. This will obtain and ensure consistent data without
                                                    13

   compromising its uniqueness. For example, consider the private key = "Key", the MSB map is
   illustrated in the below table 8 (MSB map table 8):
                                  Original number        Masked number
                                          1                      4
                                         2                       3
 5
                                          3                      2
                                         4                        1
                                                          Table 8
            [0049] On basis of the table 6 and table 8, map masked value will be as shown in below
 0 table 9:
                         Original data       Masked data(if datatype is numeric)
                         13                  4
                         113                 41
                         1113                441
                         11113               4441
                                                          Table 9
            [0050] From table 4, one can observe that though by making use of the dynamic map the
   masked value generation is secure. But, when a user understands the map formation for a
   particular key value then ascertaining the original data from the masked data is still possible.
 5 Therefore, to make the data masking more secure and consistent in data, the final masked output
   for any data depends on the position of the individual letters (characters, numeric, or symbols) in
   the data.
            [0051] For better understanding of the embodiments of the present disclosure described
   herein, an example for dynamic map generation is discussed. Form dynamic map (A-Z, a-z, 0-9,
20 user input numerals and alphabets). Here, the key is the original character whereas the value will
   contain: list-index of the masked character in the sorted masked array and the sorted masked
   array pointer. In parallel, form a map where the key is the sorted masked array pointer and the
   value is the sorted masked array. Masking of multilingual character is carried out by providing
   the user an option to import the non-English characters and the numerals other than [0-9]. These
25 characters after getting imported undergo the same procedure of dynamic map formation and the
                                                     14

   masked value for the input data will depend on this map and the position of individual characters
   in the map.
            [0052] Alternatively, the format preservation based masking system 100 may execute the
   modules comprising an input processing module that when executed by the hardware processor
 5 104 obtains a set of letters and a private key (from a user by way of entry of letters from one or
   more input devices, for example, keyboard), and processes for encryption.                 The format
   preservation based masking system 100 may execute the modules comprising an encryption
   module that when executed by the hardware processor 104 encrypts letters to obtain an encrypted
   letters list using letters and private key. The format preservation based masking system 100 may
 0 execute the modules comprising a map generation module that when executed by the hardware
   processor 104 generates a dynamic map based on the set of encrypted letters.              The format
   preservation based masking system 100 may execute the modules comprising a position
   calculation module that when executed by the hardware processor 104 calculates a position of
   each of maskable letters in the input set of letters using the dynamic map.
 5          [0053] The format preservation based masking system 100 may execute the modules
   comprising a masking module that when executed by the hardware processor 104 performs
   masking of the maskable letters based on the position of each of the maskable letters to obtain
   masked data using the dynamic map. The format preservation based masking system 100 may
   execute the modules comprising a sorting module that when executed by the hardware processor
20 104 determines an order of letters in the encrypted letters list, sorts the encrypted letters list from
   the order of letters to obtain a sorted encrypted letters list and thereby enabling the map
   generation module to generate a dynamic map based on the sorted encrypted letters list. The
   dynamic map generated using the sorted encrypted letters list comprises a set of keys and values.
   Each value comprises one or more rearranged letters to be masked from the set of letters.
25          [0054] The position calculation module then calculates a position of each of maskable
   letters in the input set of letters using the dynamic map, and the masking module performs
                                                      15

   masking of the maskable letters based on the position of each of the maskable letters to obtain
   masked data. When the letters comprising numerals, the map generation module generates a
   Most Significant Bit (MSB) map for the one or more numerals, thereby enabling the position
   calculation module to calculate a position of each of maskable letters in the input set of letters
 5 using the dynamic map and the MSB map. The masking module then performs masking of the
   maskable letters based on the position of each of the maskable letters to obtain masked data using
   the dynamic map and the MSB map.
            [0055] The modules for example, the input processing module, the encryption module,
   the map generation module, the position calculation module, the masking module, the sorting
 0 module, are implemented as at least one of a logically self-contained part of a software program,
   a self-contained hardware component, and/or, a self-contained hardware component, with a
   logically self-contained part of a software program embedded into each of the hardware
   component that when executed perform the above method described herein, in one embodiment.
            [0056] FIG. 2, with reference to FIG. 1, is a flow diagram illustrating a computer
 5 implemented format preservation based masking method using the format preservation based
   masking system 100 of FIG. 1 according to an embodiment of the present disclosure. In step
   202, a set of letters and a private key is obtained (e.g., from a user). An input set of letters (e.g.,
   name, address, country name, etc.) is additionally received other than the set of letters (e.g., a, b,
   c, d, e..., x, y, z). The set of letters may be optional, in case, the format preservation based
20 masking system 100 utilizes an English character keyboard, (e.g., in case of a client system using
   English keyboard).      The set of letters are essentially received as input in case of non-English
   characters, wherein the non-English characters are not stored in the memory 102. However, the
   set of letters (from one or more languages) may be stored in the memory 102 or obtained from
   one or more sources (e.g., cloud, remote servers, and/or third party sources), in real-time or near
25 real-time. In step 204, the set of letters are encrypted to obtain an encrypted letters list using the
   set of letters and the private key. The encrypted letters list comprises a set of encrypted letters.
                                                      16

            [0057]    In step 206, a dynamic map is generated based on (or using) the set of encrypted
   letters in the encrypted letters list. The dynamic map comprises a set of keys, wherein each key
   is specific to a letter (e.g., a character) in the set of letters. In step 208, a position of each of
   maskable letters in the input set of letters is calculated using the dynamic map.
 5          [0058] In step 210, masking of the maskable letters is performed based on (or using) the
   position of each of the maskable letters and the dynamic map to obtain masked data.                  As
   described above, when the letters comprise of numerals, the format preservation based masking
   system 102 generates a MSB map.            In other words, the method includes generating a Most
   Significant Bit (MSB) map for the numerals; calculating a position of each of maskable letters in
 0 the input set of letters using the dynamic map and the MSB map; and performing masking of the
   maskable letters based on the position of each of the maskable letters to obtain masked data using
   the dynamic map and the MSB map.
            [0059] The method further includes determining an order of letters in the encrypted
   letters list; sorting the encrypted letters list from the order of letters to obtain a sorted encrypted
 5 letters list; generating a dynamic map based on the sorted encrypted letters list, wherein the
   dynamic map comprises a set of keys and values, each key is specific to at least one letter in the
   set of letters, and, each value comprises one or more rearranged letters to be masked from the set
   of letters; calculating a position of each of maskable letters in the input set of letters using the
   dynamic map; and perform masking of the maskable letters based on the position of each of the
20 maskable letters to obtain masked data using the dynamic map. When the one or more numerals
   are indicative of a specified range, the maskable letters comprising the one or more numerals are
   masked within the specified range.
            [0060] For better understanding of the embodiments, the present disclosure describes the
   proposed methodology by way of example as below:
25          [0061] Form dynamic map for set of letters. Consider letters A-Z, a-z, 0-9, user input
   numerals and alphabets, which are the original input data.        As described above, here, the key is
                                                       17

   the original character whereas the value will contain the following: list-index of the masked
   character in the sorted masked array, and the sorted masked array pointer. In parallel, form a
   map where the key is the sorted masked array pointer and the value is the sorted masked array.
   Form the MSB map for numerals (Numbers other than zero) in the same manner as generated for
 5 the dynamic map.      Calculate the number of maskable characters (characters present in the
   dynamic map) and the index of the first maskable character in the original input data. These
   values will be required in order to preserve the format of the original data. If the first maskable
   character is a numeral then mask. If this character is zero then it is not masked i.e., keep all the
   preceding zeros as zero, until a non-zero character is reached (or identified).       For example,
 0 1234567890 is masked to 2143658709 as described. 123-456-7890 will also be masked to 214
   365-8709 since special character   "-" is not present. In the dynamic map, it will bypassed while
   masking.
           [0062] Ascertaining the final masked value for any given character is discussed below
   with an example.
 5         Example: 123-ABC-pqr
            Character     1     2      3      -     A     B      C    -      p     q       r
            Index value   9     10     11           12    13     14           15    16     17
           [0063] The first maskable character is assigned the index value as the total number of
   maskable characters and for the next succeeding character the index value will be incremented by
20 1. As mentioned above, this index value will be required as one of the parameter to obtain the
   final masked character for the original character.       The input data is iterated character by
   character. Since the first character is a numeral so the MSBMap will be generated. For the key
   '1' the value from the MSBMap will be:
                      a. masked char:6
25                    b. list-index:1
                      c. sorted masked array pointer (pointing to a array (5,4,3,2,7,1,8,6,9))
                      Result index  = (index value+list index)%(sorted masked array size)
                                                     18

                          =(9+1)%9
                          =10%9
                          =1
           [0064] The character at index value 1 is obtained, which in this case is 5. Similarly, the
 5 masked characters for the remaining characters are found using the dynamic map and appended
   to the masked string.       Therefore, the masked output will be 501-GIS-ksj.            The format
   preservation based masking system 100 enables masking of data, particularly, in case where the
   input comprises one or more numerals, with or without ranges specified.
           [0065] FIG. 3A-3E, with reference to FIG. 1 to 2, illustrates exemplary views of the
 0 original data and the masked data according to one or more embodiments of the present
   disclosure. In particular, FIG. 3A illustrate comparative exemplary views of the original data and
   the masked data for a set of letters comprising characters (e.g., street address) according to one or
   more embodiments of the present disclosure.        FIG. 3B illustrates an exemplary view of the
   original data and the masked data for minimum salary (e.g., numerals (salary) received as input
 5 for masking data with range specified as Minimum: 1000 and Maximum: 25000) according to
   one or more embodiments of the present disclosure.        Since the range is specified, the output
   masked data should also lie within this range, and then the user has the provision to enter the
   range. When the one or more numerals are indicative of a specified range, the maskable letters
   comprising the one or more numerals are masked within the specified range. In other words, the
20 range is provided by the user at the time of providing letters in case of numeric.        The format
   preservation based masking system 100 masks the numerals within the specified range.
           [0066] FIG. 3C illustrates an exemplary view of the original data and the masked data for
   minimum salary (e.g., numerals received as input for masking data without range being
   specified) according to one or more embodiments of the present disclosure. When the range is
25 not specified, there could be values out of the input values range. For example the minimum
   salary 15000 is masked to minimum salary 69628.
                                                    19

           [0067] FIG. 3D illustrates an exemplary view of the original data and the masked data for
   Non-English character according to one or more embodiments of the present disclosure.             In
   particular, FIG. 3D illustrates an exemplary view of the original data and the masked data for
   Chinese characters. FIG. 3E illustrates an exemplary view of the original data and the masked
 5 data for exceptional scenarios where the user has specified that certain values should be masked
   by pre-defined values. The format preservation based masking system 100 is configured in such
   a way that Australia should be masked with United Kingdom, and Italy should be masked with
   Singapore. So, whenever these two values will occur they will get masked by their respective
   pre-defined values and will not undergo the character replacement masking.
 0         [0068] The written description describes the subject matter herein to enable any person
   skilled in the art to make and use the embodiments.               The scope of the subject matter
   embodiments is defined by the claims and may include other modifications that occur to those
   skilled in the art. Such other modifications are intended to be within the scope of the claims if
   they have similar elements that do not differ from the literal language of the claims or if they
 5 include equivalent elements with insubstantial differences from the literal language of the claims.
           [0069] The embodiments of the present disclosure implements a format preservation
   based masking system and method that maintains consistency of data at an enterprise level,
   preserves the format of the input data, ensuring that masked data is not decipherable, leading to
   data security. The format preservation based masking system 100 further supports non-English
20 characters and numerals. Unlike the conventional systems and methods generate static lookup
   table which consume more disk space and more time in terms of creating, updating and
   processing of the data in a presentable that is less secured, the format preservation based masking
   system 100 dynamically generates maps (e.g., the dynamic map and the Non-MSB and MSB
   maps, which act as a dynamic lookup table at runtime that are used as reference to perform
25 masking of data results in less disk space consumption (or consuming reduced memory space),
   and less time in processing and updating the data. Unlike conventional masking tools, the format
                                                     20

   preservation based masking system 100 calculates position of letter in the input data that plays a
   vital role in determining the final replace (or masking) for respective letters.
            [0070] It is, however to be understood that the scope of the protection is extended to such
   a program and in addition to a computer-readable means having a message therein; such
 5 computer-readable storage means contain program-code means for implementation of one or
   more steps of the method, when the program runs on a server or mobile device or any suitable
   programmable device. The hardware device can be any kind of device which can be programmed
   including e.g. any kind of computer like a server or a personal computer, or the like, or any
   combination thereof. The device may also include means which could be e.g. hardware means
 0 like e.g. an application-specific integrated circuit (ASIC), a field-programmable gate array
   (FPGA), or a combination of hardware and software means, e.g. an ASIC and an FPGA, or at
   least one microprocessor and at least one memory with software modules located therein. Thus,
   the means can include both hardware means and software means. The method embodiments
   described herein could be implemented in hardware and software. The device may also include
 5 software means. Alternatively, the embodiments may be implemented on different hardware
   devices, e.g. using a plurality of CPUs.
            [0071] The embodiments herein can comprise hardware and software elements. The
   embodiments that are implemented in software include but are not limited to, firmware, resident
   software, microcode, etc. The functions performed by various modules described herein may be
20 implemented in other modules or combinations of other modules. For the purposes of this
   description, a computer-usable or computer readable medium can be any apparatus that can
   comprise, store, communicate, propagate, or transport the program for use by or in connection
   with the instruction execution system, apparatus, or device.
            [0072] The medium can be an electronic, magnetic, optical, electromagnetic, infrared, or
25 semiconductor system (or apparatus or device) or a propagation medium. Examples of a
   computer-readable medium include a semiconductor or solid state memory, magnetic tape, a
                                                     21

   removable computer diskette, a random access memory (RAM), a read-only memory (ROM), a
   rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk
   read only memory (CD-ROM), compact disk-read/write (CD-R/W) and DVD.
            [0073] A data processing system suitable for storing and/or executing program code will
 5 include at least one processor coupled directly or indirectly to memory elements through a
   system bus. The memory elements can include local memory employed during actual execution
   of the program code, bulk storage, and cache memories which provide temporary storage of at
   least some program code in order to reduce the number of times code must be retrieved from
   bulk storage during execution.
 0          [0074] Input/output (I/O) devices (including but not limited to keyboards, displays,
   pointing devices, etc.) can be coupled to the system either directly or through intervening I/O
   controllers. Network adapters may also be coupled to the system to enable the data processing
   system to become coupled to other data processing systems or remote printers or storage devices
   through intervening private or public networks. Modems, cable modem and Ethernet cards are
 5 just a few of the currently available types of network adapters.
            [0075] A representative hardware environment for practicing the embodiments may
   include a hardware configuration of an information handling/computer system in accordance
   with the embodiments herein. The system herein comprises at least one processor or central
   processing unit (CPU). The CPUs are interconnected via system bus to various devices such as a
20 random access memory (RAM), read-only memory (ROM), and an input/output (I/O) adapter.
   The 11O adapter can connect to peripheral devices, such as disk units and tape drives, or other
   program storage devices that are readable by the system. The system can read the instructions on
   the program storage devices and follow these instructions to execute the methodology of the
   embodiments herein.
25          [0076] The system further includes a user interface adapter that connects a keyboard,
   mouse, speaker, microphone, and/or other user interface devices such as a touch screen device
                                                     22

  (not shown) to the bus to gather user input. Additionally, a communication adapter connects the
  bus to a data processing network, and a display adapter connects the bus to a display device
  which may be embodied as an output device such as a monitor, printer, or transmitter, for
  example.
5         [0077] The preceding description      has been presented with reference to various
  embodiments. Persons having ordinary skill in the art and technology to which this application
  pertains will appreciate that alterations and changes in the described structures and methods of
  operation can be practiced without meaningfully departing from the principle, spirit and scope.
0
                                                  23

                                                     CLAIMS
We Claim:
1.      A format preservation based masking system, comprising:
        a memory storing instructions;
        a hardware processor coupled to said memory, wherein said hardware processor is
configured by said instructions to:
                 obtain an input set of letters and a private key from a user,
                 encrypt a set of letters to obtain an encrypted letters list using said set of letters
        and said private key, wherein said encrypted letters list comprises a set of encrypted
        letters,
                 generate a dynamic map based on said encrypted letters list, wherein said
        dynamic map comprises a set of keys, wherein each key is specific to a letter in said set of
        letters,
                 perform masking of one or more maskable letters based on a position of each of
        said one or more maskable letters to obtain masked data using said dynamic map;
                 generate a Most Significant Bit (MSB) map for one or more numerals, based on
        said dynamic map; and
                 calculate the position of each of the maskable letters in said inputted set of letters
        using said dynamic map and said MSB map.
2.      The format preservation based masking system of claim 1, wherein said set of letters and
said input set of letters comprises at least one of a character, a numeric, and a symbol.
3.      The format preservation based masking system of claim 1, wherein said set of letters and
said input set of letters are selected from one or more languages.
                                                    24

4.      The format preservation based masking system of claim 1, wherein an index of said
dynamic map is indicative of a masked replace letter for each letter in said set of letters.
5.      The format preservation based masking system of claim 1, wherein when said one or
more numerals is indicative of a specified range, said maskable letters comprising said one or
more numerals are masked within said specified range.
6.      A computer implemented format preservation based masking method, comprising:
        obtaining an input set of letters and a private key from a user;
        encrypting a set of letters to obtain an encrypted letters list using said set of letters and
said private key, wherein said encrypted letters list comprises a set of encrypted letters;
        generating a dynamic map based on said encrypted letters list, wherein said dynamic map
comprises a set of keys, wherein each key is specific to a letter in said set of letters;
        performing masking of one or more maskable letters based on a position of each of said
one or more maskable letters to obtain masked data using said dynamic map;
        generate a Most Significant Bit (MSB) map for one or more numerals, based on said
dynamic map; and
        calculate the position of each of the maskable letters in said inputted set of letters using
said dynamic map and said MSB map.
7.      The computer implemented format preservation based masking method of claim 6,
wherein said set of letters and said input set of letters comprises at least one of a character, a
numeric, and a symbol, and wherein said set of letters and said input set of letters are selected
from one or more languages.
8.      The computer implemented format preservation based masking method of claim 6,
                                                   25

wherein when said input set of letters comprises one or more numerals, said method comprising:
         generating a Most Significant Bit (MSB) map for said one or more numerals;
         calculating a position of each of maskable letters in said input set of letters using said
dynamic map and said MSB map; and
         performing masking of said maskable letters based on said position of each of said
maskable letters to obtain masked data using said dynamic map and said MSB map.
9.       The computer implemented format preservation based masking method of claim 6, further
comprising:
         determining an order of letters in said encrypted letters list;
         sorting said encrypted letters list from said order of letters to obtain a sorted encrypted
letters list;
         generating a dynamic map based on said sorted encrypted letters list, wherein said
dynamic map comprises a set of keys and values, each key is specific to at least one letter in said
set of letters, and, each value comprises one or more rearranged letters to be masked from said
set of letters;
         calculating a position of each of maskable letters in said input set of letters that are to be
masked using said dynamic map; and
         perform masking of said maskable letters based on said position of each of said maskable
letters to obtain masked data using the said dynamic map.
10.      The computer implemented format preservation based masking method of claim 6,
wherein when said one or more numerals are indicative of a specified range, said maskable letters
comprising said one or more numerals are masked within said specified range.
                                                   26

11.      One or more non-transitory machine readable information storage mediums comprising
one or more instructions, which when executed by one or more hardware processors causes to
perform a computer implemented format preservation based masking method comprising:
        obtaining an input set of letters and a private key from a user;
        encrypting a set of letters to obtain an encrypted letters list using said set of letters and
said private key, wherein said encrypted letters list comprises a set of encrypted letters;
        generating a dynamic map based on said encrypted letters list, wherein said dynamic map
comprises a set of keys, wherein each key is specific to a letter in said set of letters;
        calculating a position of each of maskable letters in said input set of letters that are to be
masked using said dynamic map; and
        performing masking of said maskable letters based on said position of each of said
maskable letters to obtain masked data using said dynamic map.
12.     The one or more non-transitory machine readable information storage mediums of claim
11, wherein said set of letters and said input set of letters comprises at least one of a character, a
numeric, and a symbol.
13.     The one or more non-transitory machine readable information storage mediums of claim
11, wherein said set of letters and said input set of letters are selected from one or more
languages.
14.     The one or more non-transitory machine readable information storage mediums of claim
11, wherein when said input set of letters comprises one or more numerals, said method
comprising:
        generating a Most Significant Bit (MSB) map for said one or more numerals;
                                                   27

         calculating a position of each of maskable letters in said input set of letters using said
dynamic map and said MSB map; and
         performing masking of said maskable letters based on said position of each of said
maskable letters to obtain masked data using said dynamic map and said MSB map.
15.      The one or more non-transitory machine readable information storage mediums of claim
11, wherein said method further comprises:
         determining an order of letters in said encrypted letters list;
         sorting said encrypted letters list from said order of letters to obtain a sorted encrypted
letters list;
         generating a dynamic map based on said sorted encrypted letters list, wherein said
dynamic map comprises a set of keys and values, each key is specific to at least one letter in said
set of letters, and, each value comprises one or more rearranged letters to be masked from said
set of letters;
         calculating a position of each of maskable letters in said input set of letters that are to be
masked using said dynamic map; and
         perform masking of said maskable letters based on said position of each of said maskable
letters to obtain masked data using the said dynamic map.
16.      The one or more non-transitory machine readable information storage mediums of claim
14, wherein when said one or more numerals are indicative of a specified range, said maskable
letters comprising said one or more numerals are masked within said specified range.
                                                    28

                                                     Sheet: 1/5
<removed-date>
<removed-apn>
              FORMAT PRESERVATION BASED MASKING
                           SYSTEM
                             100
                MEMORY               HARDWARE
                  102                PROCESSOR
                                        104
              MODULES 108
                                     I/O INTERFACE
                                           106
                            FIG. 1

                                                                 Sheet: 2/5
<removed-date>
               OBTAINING AN INPUT SET OF LETTERS AND A PRIVATE
                                                                       202
                               KEY FROM A USER
<removed-apn>
                 ENCRYPTING A SET OF LETTERS TO OBTAIN AN
              ENCRYPTED LETTERS LIST USING THE SET OF LETTERS          204
              AND THE PRIVATE KEY, THE ENCRYPTED LETTERS LIST
                  COMPRISES A SET OF ENCRYPTED LETTERS
               GENERATING A DYNAMIC MAP BASED ON THE SET OF
              ENCRYPTED LETTERS, THE DYNAMIC MAP COMPRISES A
                                                                       206
               SET OF KEYS, EACH KEY IS SPECIFIC TO A LETTER IN
                             THE SET OF LETTERS
                 CALCULATING A POSITION OF EACH OF MASKABLE
                LETTERS IN THE INPUT SET OF LETTERS USING THE          208
                                 DYNAMIC MAP
                PERFORMING MASKING OF THE MASKABLE LETTERS
               BASED ON THE POSITION OF EACH OF THE MASKABLE
                                                                       210
              LETTERS TO OBTAIN MASKED DATA USING THE DYNAMIC
                                    MAP
                                   FIG. 2

                                                               Sheet: 3/5
<removed-date>
<removed-apn>
                 ORIGINAL DATA                 MASKED DATA
                STREET ADDRESS             STREET ADDRESS
              1297 Via Cola di Rie       8326 Jux Dkmd pm Rky
              93091 Calle della Testa    17114 Mdkcr ryobl Ziuec
              2017 Shinjuku-ku           2427 Tdgleolw-mq
                                     FIG. 3A
                 ORIGINAL DATA                 MASKED DATA
                     MIN_SALARY                 MIN_SALARY
              20080                      21263
              15000                      10283
              3000                       2462
                                     FIG. 3B

                                                          Sheet: 4/5
<removed-date>
                 ORIGINAL DATA              MASKED DATA
<removed-apn>
                     MIN_SALARY              MIN_SALARY
              20080                   24648
              15000                   69628
              3000                    2746
                                  FIG. 3C
                 ORIGINAL DATA              MASKED DATA
               CHINESE LETTERS          CHINESE LETTERS
              <U+271F> <U+2701><U+2702><U+2704><U+260E>                  <U+2706><U+271D><U+271E><U+2720><U+2721><U+2701>
              <U+2702><U+2704><U+260E><U+261B><U+261E>                   <U+271D><U+271E><U+2720><U+2721><U+2701>
              <U+2713><U+2714><U+2715><U+2716><U+2717><U+2718><U+2719>                 <U+270C> <U+270D><U+270E><U+270F><U+2711><U+2712>
                                  FIG. 3D

                                                           Sheet: 5/5
<removed-date>
<removed-apn>
                  ORIGINAL DATA             MASKED DATA
                  COUNTRY NAME              COUNTRY NAME
              Argentina               Atwfdrouw
              Australia               United Kingdom
              Italy                   Singapore
                                  FIG. 3E

