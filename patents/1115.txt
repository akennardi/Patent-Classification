1002128544
                                   ABSTRACT
An intelligent automated assistant system engages with the user in an integrated,
conversational manner using natural language dialog, and invokes external
services when appropriate to obtain information or perform various actions. The
system can be implemented using any of a number of different platforms, such as
the web, email, smartphone, and the like, or any combination thereof. In one
embodiment, the system is based on sets of interrelated domains and tasks, and
employs additional functionally powered by external services with which the
system can interact.

1002128544
  MAINTAINING CONTEXT INFORMATION BETWEEN USER
            INTERACTIONS WITH A VOICE ASSISTANT
              CROSS-REFERENCE TO RELATED APPLICATIONS
[0001]       This application claims priority from U.S. Provisional Patent
Application Serial No. 61/295,774 for "Intelligent Automated Assistant", filed
January 18, 2010, which is incorporated herein by reference.
[0002]       This application further claims priority from U.S. Utility Patent
Application Serial No. 12/987,982 for "Intelligent Automated Assistant", filed
January 10, 2011, which is incorporated herein by reference.
[0003]      This application is further related to U.S. Patent Application Serial No.
11/518,292 for "Method and Apparatus for Building an Intelligent Automated
Assistant", filed September 8, 2006, which is incorporated herein by reference.
[0004]       This application is further related to U.S. Provisional Patent
Application Serial No. 61/186,414 for "System and Method for Semantic
AutoCompletion", filed June 12, 2009, which is incorporated herein by reference.
[0004A]      This application is further related to Australian Patent Application
2011205426 for "Intelligent Automated Assistant", filed 11 January 2011, which
is incorporated herein by reference.
                            FIELD OF THE INVENTION
[0005]       The present invention relates to intelligent systems, and more
specifically for classes of applications for intelligent automated assistants.
                      BACKGROUND OF THE INVENTION
[0006]       Today's electronic devices are able to access a large, growing, and
diverse quantity of functions, services, and information, both via the Internet and
from other sources. Functionality for such devices is increasing rapidly, as many
consumer devices, smartphones, tablet computers, and the like, are able to run
software applications to perform various tasks and provide different types of
information. Often, each application, function, website, or feature has its own user
interface and its own operational paradigms, many of which can be burdensome to
learn or overwhelming for users. In addition, many users may have difficulty even
discovering what functionality and/or information is available on their electronic
                                          -1-

1002128544
devices or on various websites; thus, such users may become frustrated or
overwhelmed, or may simply be unable to use the resources available to them in
an effective manner.
[0007]       In particular, novice users, or individuals who are impaired or disabled
in some manner, and/ or are elderly, busy, distracted, and/ or operating a vehicle
may have difficulty interfacing with their electronic devices effectively, and/ or
engaging online services effectively. Such users are particularly likely to have
difficulty with the large number of diverse and inconsistent functions, applications,
and websites that may be available for their use.
[0008]      Accordingly, existing systems are often difficult to use and to navigate,
and often present users with inconsistent and overwhelming interfaces that often
prevent the users from making effective use of the technology.
                                      SUMMARY
[0008a]      According to a first aspect of the invention there is provided an
automated assistant operating on one or more computing devices, the automated
assistant comprising: a speech input component, for receiving user input; a
language interpreter component, for interpreting the received user input to derive
a representation of user intent; a dialog flow processor component, for identifying
at least one task based at least in part on the derived representation of user intent;
a services orchestration component, for calling at least one service for performing
the identified task; and an output processor component, for causing a first output
to be displayed prior to receiving the user input, and for causing a second output
to be displayed based on data received from the at least one called service;
wherein the first output comprises a plurality of core competencies of the
automated assistant and an example of a natural language input for invoking each
of the plurality of core competencies.
[0008b]      According to a second aspect of the invention there is provided a
method for implementing an automated assistant on one or more computing
devices having one or more processors and memory, the method comprising: at
the one or more computing devices: invoking the automated assistant; causing a
first output to be displayed, wherein the first output comprises a plurality of core
competencies of the automated assistant and an example of a natural language
                                          -2-

1002128544
input for invoking each of the plurality of core competencies; at a speech input
component, receiving user input; interpreting the received user input to derive a
representation of user intent; identifying at least one task based at least in part on
the derived representation of user intent; calling at least one service for
performing the identified task; and causing a second output to be displayed based
on data received from the at least one called service; wherein the first output is
displayed prior to receiving the user input.
[0008c]      According to a third aspect of the invention there is provided a non
transitory computer-readable medium for implementing an automated assistant on
one or more computing devices, the computer-readable medium having
instructions stored thereon, the instructions, when executed by one or more
processors, cause the processors to perform operations comprising: invoking the
automated assistant; causing a first output to be displayed in a conversation
interface of the automated assistant, wherein the first output comprises a plurality
of core competencies of the automated assistant and an example of a natural
language input for invoking each of the plurality of core competencies; at a
speech input component, receiving user input; interpreting the received user input
to derive a representation of user intent; identifying at least one task based at least
in part on the derived representation of user intent; calling at least one service for
performing the identified task; and causing a second output to be displayed based
on data received from the at least one called service; wherein the first output is
displayed prior to receiving the user input.
[0009]       According to various embodiments of the present invention, an
intelligent automated assistant is implemented on an electronic device, to facilitate
user interaction with a device, and to help the user more effectively engage with
local and/ or remote services. In various embodiments, the intelligent automated
assistant engages with the user in an integrated, conversational manner using
natural language dialog, and invokes external services when appropriate to obtain
information or perform various actions.
[0010]       According to various embodiments of the present invention, the
intelligent automated assistant integrates a variety of capabilities provided by
different software components (e.g., for supporting natural language recogni
                                         - 2a -

WO 2011/088053                                                      PCT/US2011/020861
tion and dialog, multimodal input, personal information management, task
flow management, orchestrating distributed services, and the like). Further
more, to offer intelligent interfaces and useful functionality to users, the intel
ligent automated assistant of the present invention may, in at least some em
bodiments, coordinate these components and services. The conversation in
terface, and the ability to obtain information and perform follow-on task, are
implemented, in at least some embodiments, by coordinating various compo
nents such as language components, dialog components, task management
 components, information management components and/or a plurality of ex
 ternal services.
 [0011]     According to various embodiments of the present invention, intelli
 gent automated assistant systems may be configured, designed, and/or oper
 able to provide various different types of operations, functionalities, and/or
 features, and/or to combine a plurality of features, operations, and applica
 tions of an electronic device on which it is installed. In some embodiments,
 the intelligent automated assistant systems of the present invention can per
 form any or all of: actively eliciting input from a user, interpreting user intent,
 disambiguating among competing interpretations, requesting and receiving
 clarifying information as needed, and performing (or initiating) actions based
  on the discerned intent. Actions can be performed, for example, by activating
  and/or interfacing with any applications or services that may be available on
  an electronic device, as well as services that are available over an electronic
  network such as the Internet. In various embodiments, such activation of ex
  ternal services can be performed via APIs or by any other suitable mecha
  nism. In this manner, the intelligent automated assistant systems of various
  embodiments of the present invention can unify, simplify, and improve the
  user's experience with respect to many different applications and functions of
  an electronic device, and with respect to services that may be available over
  the Internet. The user can thereby be relieved of the burden of learning what
   functionality may be available on the device and on web-connected services,
                                            -3-

WO 2011/088053                                                     PCT/US2011/020861
how to interface with such services to get what he or she wants, and how to
interpret the output received from such services; rather, the assistant of the
present invention can act as a go-between between the user and such diverse
services.
[0012]      In addition, in various embodiments, the assistant of the present
invention provides a conversational interface that the user may find more in
tuitive and less burdensome than conventional graphical user interfaces. The
user can engage in a form of conversational dialog with the assistant using
any of a number of available input and output mechanisms, such as for ex
ample speech, graphical user interfaces (buttons and links), text entry, and the
like. The system can be implemented using any of a number of different plat
forms, such as device APIs, the web, email, and the like, or any combination
thereof. Requests for additional input can be presented to the user in the con
 text of such a conversation. Short and long term memory can be engaged so
 that user input can be interpreted in proper context given previous events and
 communications within a given session, as well as historical and profile in
 formation about the user.
 [0013]      In addition, in various embodiments, context information derived
 from user interaction with a feature, operation, or application on a device can
 be used to streamline the operation of other features, operations, or applica
 tions on the device or on other devices. For example, the intelligent auto
 mated assistant can use the context of a phone call (such as the person called)
 to streamline the initiation of a text message (for example to determine that
 the text message should be sent to the same person, without the user having
 to explicitly specify the recipient of the text message). The intelligent auto
 mated assistant of the present invention can thereby interpret instructions
 such as "send him a text message", wherein the "him" is interpreted accord
 ing to context information derived from a current phone call, and/or from
 any feature, operation, or application on the device. In various embodiments,
 the intelligent automated assistant takes into account various types of avail
                                           -4-

WO 2011/088053                                                      PCT/US2011/020861
able context data to determine which address book contact to use, which con
tact data to use, which telephone number to use for the contact, and the like,
so that the user need not re-specify such information manually.
[0014]      In various embodiments, the assistant can also take into account ex
ternal events and respond accordingly, for example, to initiate action, initiate
communication with the user, provide alerts, and/or modify previously initi
ated action in view of the external events. If input is required from the user, a
conversational interface can again be used.
 [0015]     In one embodiment, the system is based on sets of interrelated do
 mains and tasks, and employs additional functionally powered by external
 services with which the system can interact. In various embodiments, these
 external services include web-enabled services, as well as functionality related
 to the hardware device itself. For example, in an embodiment where the in
 telligent automated assistant is implemented on a smartphone, personal digi
 tal assistant, tablet computer, or other device, the assistant can control many
 operations and functions of the device, such as to dial a telephone number,
 send a text message, set reminders, add events to a calendar, and the like.
 [0016]      In various embodiments, the system of the present invention can be
 implemented to provide assistance in any of a number of different domains.
 Examples include:
         " Local Services (including location- and time-specific services such
             as restaurants, movies, automated teller machines (ATMs), events,
             and places to meet);
         " Personal and Social Memory Services (including action items, notes,
             calendar events, shared links, and the like);
         " E-commerce (including online purchases of items such as books,
             DVDs, music, and the like);
         " Travel Services (including flights, hotels, attractions, and the like).
                                           -5-

WO 2011/088053                                                      PCT/US2011/020861
[0017]      One skilled in the art will recognize that the above list of domains is
merely exemplary. In addition, the system of the present invention can be
implemented in any combination of domains.
[0018]       In various embodiments, the intelligent automated assistant sys
tems disclosed herein may be configured or designed to include functionality
for automating the application of data and services available over the Internet
to discover, find, choose among, purchase, reserve, or order products and
services. In addition to automating the process of using these data and ser
vices, at least one intelligent automated assistant system embodiment dis
closed herein may also enable the combined use of several sources of data and
 services at once. For example, it may combine information about products
 from several review sites, check prices and availability from multiple distribu
 tors, and check their locations and time constraints, and help a user find a
 personalized solution to their problem. Additionally, at least one intelligent
 automated assistant system embodiment disclosed herein may be configured
 or designed to include functionality for automating the use of data and ser
 vices available over the Internet to discover, investigate, select among, re
 serve, and otherwise learn about things to do (including but not limited to
 movies, events, performances, exhibits, shows and attractions); places to go
  (including but not limited to travel destinations, hotels and other places to
 stay, landmarks and other sites of interest, etc.); places to eat or drink (such as
 restaurants and bars), times and places to meet others, and any other source
  of entertainment or social interaction which may be found on the Internet.
 Additionally, at least one intelligent automated assistant system embodiment
  disclosed herein may be configured or designed to include functionality for
  enabling the operation of applications and services via natural language dia
  log that may be otherwise provided by dedicated applications with graphical
  user interfaces including search (including location-based search); navigation
  (maps and directions); database lookup (such as finding businesses or people
  by name or other properties); getting weather conditions and forecasts, check
                                           -6-

WO 2011/088053                                                      PCT/US2011/020861
ing the price of market items or status of financial transactions; monitoring
traffic or the status of flights; accessing and updating calendars and sched
ules; managing reminders, alerts, tasks and projects; communicating over
email or other messaging platforms; and operating devices locally or remotely
 (e.g., dialing telephones, controlling light and temperature, controlling home
security devices, playing music or video, etc.). Further, at least one intelligent
 automated assistant system embodiment disclosed herein may be configured
 or designed to include functionality for identifying, generating, and/or pro
 viding personalized recommendations for activities, products, services, source
 of entertainment, time management, or any other kind of recommendation
 service that benefits from an interactive dialog in natural language and auto
 mated access to data and services.
 [0019]       In various embodiments, the intelligent automated assistant of the
 present invention can control many features and operations of an electronic
 device. For example, the intelligent automated assistant can call services that
 interface with functionality and applications on a device via APIs or by other
 means, to perform functions and operations that might otherwise be initiated
  using a conventional user interface on the device. Such functions and opera
  tions may include, for example, setting an alarm, making a telephone call,
  sending a text message or email message, adding a calendar event, and the
  like. Such functions and operations may be performed as add-on functions in
  the context of a conversational dialog between a user and the assistant. Such
  functions and operations can be specified by the user in the context of such a
  dialog, or they may be automatically performed based on the context of the
  dialog. One skilled in the art will recognize that the assistant can thereby be
  used as a control mechanism for initiating and controlling various operations
   on the electronic device, which may be used as an alternative to conventional
   mechanisms such as buttons or graphical user interfaces.
                                            -7-

WO 2011/088053                                                     PCT/US2011/020861
                    BRIEF DESCRIPTION OF THE DRAWINGS
[0020]      The accompanying drawings illustrate several embodiments of the
invention and, together with the description, serve to explain the principles of
the invention according to the embodiments. One skilled in the art will recog
nize that the particular embodiments illustrated in the drawings are merely
exemplary, and are not intended to limit the scope of the present invention.
[0021]      Fig. 1 is a block diagram depicting an example of one embodiment
of an intelligent automated assistant system.
[0022]      Fig. 2 illustrates an example of an interaction between a user and an
intelligent automated assistant according to at least one embodiment.
[0023]      Fig. 3 is a block diagram depicting a computing device suitable for
implementing at least a portion of an intelligent automated assistant accord
ing to at least one embodiment.
[0024]      Fig. 4 is a block diagram depicting an architecture for implementing
at least a portion of an intelligent automated assistant on a standalone com
puting system, according to at least one embodiment.
 [0025]     Fig. 5 is a block diagram depicting an architecture for implementing
at least a portion of an intelligent automated assistant on a distributed com
puting network, according to at least one embodiment.
 [0026]     Fig. 6 is a block diagram depicting a system architecture illustrating
several different types of clients and modes of operation.
 [0027]     Fig. 7 is a block diagram depicting a client and a server, which com
municate with each other to implement the present invention according to
 one embodiment.
 [0028]     Fig. 8 is a block diagram depicting a fragment of an active ontology
 according to one embodiment.
 [0029]     Fig. 9 is a block diagram depicting an example of an alternative em
bodiment of an intelligent automated assistant system.
 [0030]     Fig. 10 is a flow diagram depicting a method of operation for active
 input elicitation component(s) according to one embodiment.
                                          -8-

WO 2011/088053                                                      PCT/US2011/020861
[0031]      Fig. 11 is a flow diagram depicting a method for active typed-input
elicitation according to one embodiment.
[0032]      Figs. 12 to 21 are screen shots illustrating some portions of some of
the procedures for active typed-input elicitation according to one embodi
ment.
[0033]      Fig. 22 is a flow diagram depicting a method for active input elicita
tion for voice or speech input according to one embodiment.
 [0034]     Fig. 23 is a flow diagram depicting a method for active input elicita
tion for GUI-based input according to one embodiment.
 [0035]     Fig. 24 is a flow diagram depicting a method for active input elicita
tion at the level of a dialog flow according to one embodiment.
 [0036]     Fig. 25 is a flow diagram depicting a method for active monitoring
 for relevant events according to one embodiment.
 [0037]     Fig. 26 is a flow diagram depicting a method for multimodal active
 input elicitation according to one embodiment.
 [0038]     Fig. 27 is a set of screen shots illustrating an example of various
 types of functions, operations, actions, and/or other features which may be
 provided by domain models component(s) and services orchestration accord
 ing to one embodiment.
 [0039]     Fig. 28 is a flow diagram depicting an example of a method for
 natural language processing according to one embodiment.
 [0040]     Fig. 29 is a screen shot illustrating natural language processing ac
 cording to one embodiment.
  [0041]    Figs. 30 and 31 are screen shots illustrating an example of various
 types of functions, operations, actions, and/or other features which may be
 provided by dialog flow processor component(s) according to one embodi
  ment.
  [0042]    Fig. 32 is a flow diagram depicting a method of operation for dialog
  flow processor component(s) according to one embodiment.
                                            -9-

WO 2011/088053                                                    PCT/US2011/020861
[0043]      Fig. 33 is a flow diagram depicting an automatic call and response
procedure, according to one embodiment.
[0044]      Fig. 34 is a flow diagram depicting an example of task flow for a
constrained selection task according to one embodiment.
[0045]      Figs. 35 and 36 are screen shots illustrating an example of the opera
tion of constrained selection task according to one embodiment.
[0046]      Fig. 37 is a flow diagram depicting an example of a procedure for
executing a service orchestration procedure according to one embodiment.
[0047]      Fig. 38 is a flow diagram depicting an example of a service invoca
tion procedure according to one embodiment.
[0048]      Fig. 39 is a flow diagram depicting an example of a multiphase out
put procedure according to one embodiment.
 [0049]     Figs. 40 and 41 are screen shots depicting examples of output proc
essing according to one embodiment.
 [0050]     Fig. 42 is a flow diagram depicting an example of multimodal out
put processing according to one embodiment.
 [0051]     Figs. 43A and 43B are screen shots depicting an example of the use
 of short term personal memory component(s) to maintain dialog context
 while changing location, according to one embodiment.
 [0052]     Figs. 44A through 44C are screen shots depicting an example of the
 use of long term personal memory component(s), according to one embodi
 ment.
 [0053]     Fig. 45 depicts an example of an abstract model for a constrained
 selection task.
 [0054]     Fig. 46 depicts an example of a dialog flow model to help guide the
 user through a search process.
 [0055]     Fig. 47 is a flow diagram depicting a method of constrained selec
 tion according to one embodiment.
                                         -10-

WO 2011/088053                                                     PCT/US2011/020861
              DETAILED DESCRIPTION OF THE EMBODIMENTS
[0056]      Various techniques will now be described in detail with reference to
a few example embodiments thereof as illustrated in the accompanying draw
ings. In the following description, numerous specific details are set forth in
order to provide a thorough understanding of one or more aspects and/or
features described or reference herein. It will be apparent, however, to one
skilled in the art, that one or more aspects and/or features described or refer
ence herein may be practiced without some or all of these specific details. In
 other instances, well known process steps and/or structures have not been
 described in detail in order to not obscure some of the aspects and/or features
 described or reference herein.
 [0057]     One or more different inventions may be described in the present
 application. Further, for one or more of the invention(s) described herein,
 numerous embodiments may be described in this patent application, and are
 presented for illustrative purposes only. The described embodiments are not
 intended to be limiting in any sense. One or more of the invention(s) may be
 widely applicable to numerous embodiments, as is readily apparent from the
 disclosure. These embodiments are described in sufficient detail to enable
 those skilled in the art to practice one or more of the invention(s), and it is to
 be understood that other embodiments may be utilized and that structural,
 logical, software, electrical and other changes may be made without departing
 from the scope of the one or more of the invention(s). Accordingly, those
 skilled in the art will recognize that the one or more of the invention(s) may
 be practiced with various modifications and alterations. Particular features of
  one or more of the invention(s) may be described with reference to one or
  more particular embodiments or figures that form a part of the present disclo
  sure, and in which are shown, by way of illustration, specific embodiments of
  one or more of the invention(s). It should be understood, however, that such
  features are not limited to usage in the one or more particular embodiments
  or figures with reference to which they are described. The present disclosure
                                          - 11 -

WO 2011/088053                                                       PCT/US2011/020861
is neither a literal description of all embodiments of one or more of the inven
tion(s) nor a listing of features of one or more of the invention(s) that must be
present in all embodiments.
[0058]       Headings of sections provided in this patent application and the
title of this patent application are for convenience only, and are not to be
taken as limiting the disclosure in any way.
 [0059]      Devices that are in communication with each other need not be in
continuous communication with each other, unless expressly specified other
wise. In addition, devices that are in communication with each other may
 communicate directly or indirectly through one or more intermediaries.
 [0060]      A description of an embodiment with several components in com
 munication with each other does not imply that all such components are re
 quired. To the contrary, a variety of optional components are described to il
 lustrate the wide variety of possible embodiments of one or more of the in
 vention(s).
 [0061]      Further, although process steps, method steps, algorithms or the
 like may be described in a sequential order, such processes, methods and al
 gorithms may be configured to work in alternate orders. In other words, any
 sequence or order of steps that may be described in this patent application
 does not, in and of itself, indicate a requirement that the steps be performed in
 that order. The steps of described processes may be performed in any order
 practical. Further, some steps may be performed simultaneously despite be
 ing described or implied as occurring non-simultaneously (e.g., because one
  step is described after the other step). Moreover, the illustration of a process
  by its depiction in a drawing does not imply that the illustrated process is ex
  clusive of other variations and modifications thereto, does not imply that the
  illustrated process or any of its steps are necessary to one or more of the in
  vention(s), and does not imply that the illustrated process is preferred.
  [0062]     When a single device or article is described, it will be readily appar
  ent that more than one device/article (whether or not they cooperate) may be
                                           -12-

WO 2011/088053                                                    PCT/US2011/020861
used in place of a single device/article. Similarly, where more than one device
or article is described (whether or not they cooperate), it will be readily ap
parent that a single device/article may be used in place of the more than one
 device or article.
 [0063]      The functionality and/or the features of a device may be alterna
 tively embodied by one or more other devices that are not explicitly described
 as having such functionality/features. Thus, other embodiments of one or
 more of the invention(s) need not include the device itself.
 [0064]      Techniques and mechanisms described or reference herein will
 sometimes be described in singular form for clarity. However, it should be
 noted that particular embodiments include multiple iterations of a technique
 or multiple instantiations of a mechanism unless noted otherwise.
  [0065]     Although described within the context of intelligent automated as
  sistant technology, it may be understood that the various aspects and tech
  niques described herein (such as those associated with active ontologies, for
  example) may also be deployed and/or applied in other fields of technology
  involving human and/or computerized interaction with software.
  [0066]     Other aspects relating to intelligent automated assistant technology
  (e.g., which may be utilized by, provided by, and/or implemented at one or
  more intelligent automated assistant system embodiments described herein)
  are disclosed in one or more of the following references:
  " U.S. Provisional Patent Application Serial No. 61/295,774 for "Intelligent
      Automated Assistant", attorney docket number SIRIP003P, filed January
      18, 2010, the disclosure of which is incorporated herein by reference;
   " U.S. Patent Application Serial No. 11/518,292 for "Method And Apparatus
      for Building an Intelligent Automated Assistant", filed September 8, 2006,
      the disclosure of which is incorporated herein by reference; and
   * U.S. Provisional Patent Application Serial No. 61/186,414 for "System and
       Method for Semantic Auto-Completion", filed June 12, 2009, the disclosure
       of which is incorporated herein by reference.
                                           -13  -

WO 2011/088053                                                    PCT/US2011/020861
 Hardware Architecture
[0067]      Generally, the intelligent automated assistant techniques disclosed
herein may be implemented on hardware or a combination of software and
hardware. For example, they may be implemented in an operating system
kernel, in a separate user process, in a library package bound intn  nPhAor
applications, on a specially constructed machine, or on a network interface
card. In a specific embodiment, the techniques disclosed herein may be im
plemented in software such as an operating system or in an application run
ning on an operating system.
[0068]      Software/hardware hybrid implementation(s) of at least some of
the intelligent automated assistant embodiment(s) disclosed herein may be
implemented on a programmable machine selectivelv activt-d or reconfig
ured by a computer program stored in memory. Such network devices may
have multiple network interfaces which may be configured or designed to
utilize different types of network communication protocols. A general archi
tecture for some of these machines may appear from the descriptions dis
closed herein. According to specific embodiments, at least some of the fea
tures and/or functionalities of the various intelligent automated assistant em
bodiments disclosed herein may be implemented on one or more general
purpose network host machines such as an end-user computer system, com
puter, network server or server system, mobile computing device (e.g., per
sonal digital assistant, mobile phone, smartphone, laptop, tablet computer, or
the like), consumer electronic device, music player, or any other suitable elec
tronic device, router, switch, or the like, or any combination thereof. In at
least some embodiments, at least some of the features and/or functionalities
of the various intelligent automated assistant embodiments disclosed herein
may be implemented in one or more virtualized computing environments
(e.g., network computing clouds, or the like).
[0069]      Referring now to Fig. 3, there is shown a block diagram depicting a
computing device 60 suitable for implementing at least a portion of the intel
                                         -14-

WO 2011/088053                                                   PCT/US2011/020861
ligent automated assistant features and/or functionalities disclosed herein.
Computing device 60 may be, for example, an end-user computer system,
network server or server system, mobile computing device (e.g., personal
digital assistant, mobile phone, smartphone, laptop, tablet computer, or the
like), consumer electronic device, music player, or any other suitable elec
tronic device, or any combination or portion thereof. Computing device 60
may be adapted to communicate with other computing devices, such as cli
ents and/or servers, over a communications network such as the Internet, us
ing known protocols for such communication, whether wireless or wired.
[0070]      In one embodiment, computing device 60 includes central process
ing unit (CPU) 62, interfaces 68, and a bus 67 (such as a peripheral component
interconnect (PCI) bus). When acting under the control of appropriate soft
ware or firmware, CPU 62 may be responsible for implementing specific func
tions associated with the functions of a specifically configured computing de
vice or machine. For example, in at least one embodiment, a user's personal
 digital assistant (PDA) may be configured or designed to function as an intel
ligent automated assistant system utilizing CPU 62, memory 61, 65, and inter
face(s) 68. In at least one embodiment, the CPU 62 may be caused to perform
 one or more of the different types of intelligent automated assistant functions
 and/or operations under the control of software modules/components,
 which for example, may include an operating system and any appropriate
 applications software, drivers, and the like.
 [0071]     CPU 62 may include one or more processor(s) 63 such as, for exam
 ple, a processor from the Motorola or Intel family of microprocessors or the
 MIPS family of microprocessors. In some embodiments, processor(s) 63 may
 include specially designed hardware (e.g., application-specific integrated cir
 cuits (ASICs), electrically erasable programmable read-only memories
 (EEPROMs), field-programmable gate arrays (FPGAs), and the like) for con
 trolling the operations of computing device 60. In a specific embodiment, a
 memory 61 (such as non-volatile random access memory (RAM) and/or read
                                          -15-

WO 2011/088053                                                     PCT/US2011/020861
only memory (ROM)) also forms part of CPU 62. However, there are many
different ways in which memory may be coupled to the system. Memory
block 61 may be used for a variety of purposes such as, for example, caching
and/or storing data, programming instructions, and the like.
[0072]     As used herein, the term "processor" is not limited merely to those
integrated circuits referred to in the art as a processor, but broadly refers to a
microcontroller, a microcomputer, a programmable logic controller, an appli
cation-specific integrated circuit, and any other programmable circuit.
[0073]     In one embodiment, interfaces 68 are provided as interface cards
(sometimes referred to as "line cards"). Generally, they control the sending
and receiving of data packets over a computing network and sometimes sup
port other peripherals used with computing device 60. Among the interfaces
that may be provided are Ethernet interfaces, frame relay interfaces, cable in
terfaces, DSL interfaces, token ring interfaces, and the like. In addition, vari
ous types of interfaces may be provided such as, for example, universal serial
bus (USB), Serial, Ethernet, Firewire, PCI, parallel, radio frequency (RF), Blue
toothTM, near-field communications (e.g., using near-field magnetics), 802.11
(WiFi), frame relay, TCP/IP, ISDN, fast Ethernet interfaces, Gigabit Ethernet
interfaces, asynchronous transfer mode (ATM) interfaces, high-speed serial
interface (HSSI) interfaces, Point of Sale (POS) interfaces, fiber data distrib
uted interfaces (FDDIs), and the like. Generally, such interfaces 68 may in
clude ports appropriate for communication with the appropriate media. In
some cases, they may also include an independent processor and, in some in
stances, volatile and/or non-volatile memory (e.g., RAM).
[0074]     Although the system shown in Fig. 3 illustrates one specific archi
tecture for a computing device 60 for implementing the techniques of the in
vention described herein, it is by no means the only device architecture on
which at least a portion of the features and techniques described herein may
be implemented. For example, architectures having one or any number of
processors 63 can be used, and such processors 63 can be present in a single
                                         - 16 -

WO 2011/088053                                                     PCT/US2011/020861
device or distributed among any number of devices. In one embodiment, a
single processor 63 handles communications as well as routing computations.
In various embodiments, different types of intelligent automated assistant
features and/or functionalities may be implemented in an intelligent auto
mated assistant system which includes a client device (such as a personal
 digital assistant or smartphone running client software) and server system(s)
 (such as a server system described in more detail below).
 [0075]      Regardless of network device configuration, the system of the pre
 sent invention may employ one or more memories or memory modules (such
 as, for example, memory block 65) configured to store data, program instruc
 tions for the general-purpose network operations and/or other information
 relating to the functionality of the intelligent automated assistant techniques
 described herein. The program instructions may control the operation of an
 operating system and/or one or more applications, for example. The memory
 or memories may also be configured to store data structures, keyword taxon
 omy information, advertisement information, user click and impression in
 formation, and/or other specific non-program information described herein.
 [0076]      Because such information and program instructions may be em
 ployed to implement the systems/methods described herein, at least some
 network device embodiments may include nontransitory machine-readable
 storage media, which, for example, may be configured or designed to store
 program instructions, state information, and the like for performing various
  operations described herein. Examples of such nontransitory machine
  readable storage media include, but are not limited to, magnetic media such
  as hard disks, floppy disks, and magnetic tape; optical media such as CD
  ROM disks; magneto-optical media such as floptical disks, and hardware de
  vices that are specially configured to store and perform program instructions,
  such as read-only memory devices (ROM), flash memory, memristor memory,
  random access memory (RAM), and the like. Examples of program instruc
  tions include both machine code, such as produced by a compiler, and files
                                           -17-

WO 2011/088053                                                   PCT/US2011/020861
containing higher level code that may be executed by the computer using an
interpreter.
[0077]      In one embodiment, the system of the present invention is imple
mented on a standalone computing system. Referring now to Fig. 4, there is
shown a block diagram depicting an architecture for implementing at least a
portion of an intelligent automated assistant on a standalone computing sys
tem, according to at least one embodiment. Computing device 60 includes
processor(s) 63 which run software for implementing intelligent automated
assistant 1002. Input device 1206 can be of any type suitable for receiving
user input, including for example a keyboard, touchscreen, microphone (for
example, for voice input), mouse, touchpad, trackball, five-way switch, joy
stick, and/or any combination thereof. Output device 1207 can be a screen,
speaker, printer, and/or any combination thereof. Memory 1210 can be ran
dom-access memory having a structure and architecture as are known in the
art, for use by processor(s) 63 in the course of running software. Storage de
vice 1208 can be any magnetic, optical, and/or electrical storage device for
storage of data in digital form; examples include flash memory, magnetic
hard drive, CD-ROM, and/or the like.
[0078]      In another embodiment, the system of the present invention is im
plemented on a distributed computing network, such as one having any
number of clients and/or servers. Referring now to Fig. 5, there is shown a
block diagram depicting an architecture for implementing at least a portion of
an intelligent automated assistant on a distributed computing network, ac
cording to at least one embodiment.
[0079]      In the arrangement shown in Fig. 5, any number of clients 1304 are
provided; each client 1304 may run software for implementing client-side por
tions of the present invention. In addition, any number of servers 1340 can be
provided for handling requests received from clients 1304. Clients 1304 and
servers 1340 can communicate with one another via electronic network 1361,
                                         -18-

WO 2011/088053                                                     PCT/US2011/020861
such as the Internet. Network 1361 may be implemented using any known
network protocols, including for example wired and/or wireless protocols.
[0080]       In addition, in one embodiment, servers 1340 can call external ser
vices 1360 when needed to obtain additional information or refer to store data
concerning previous interactions with particular users. Communications with
external services 1360 can take place, for example, via network 1361. In vari
ous embodiments, external services 1360 include web-enabled services
 and/or functionality related to or installed on the hardware device itself.
For example, in an embodiment where assistant 1002 is implemented on a
 smartphone or other electronic device, assistant 1002 can obtain information
 stored in a calendar application ("app"), contacts, and/or other sources.
 [0081]      In various embodiments, assistant 1002 can control many features
 and operations of an electronic device on which it is installed. For example,
 assistant 1002 can call external services 1360 that interface with functionality
 and applications on a device via APIs or by other means, to perform functions
 and operations that might otherwise be initiated using a conventional user
 interface on the device. Such functions and operations may include, for ex
 ample, setting an alarm, making a telephone call, sending a text message or
 email message, adding a calendar event, and the like. Such functions and op
 erations may be performed as add-on functions in the context of a conversa
 tional dialog between a user and assistant 1002. Such functions and opera
 tions can be specified by the user in the context of such a dialog, or they may
 be automatically performed based on the context of the dialog. One skilled in
  the art will recognize that assistant 1002 can thereby be used as a control
  mechanism for initiating and controlling various operations on the electronic
  device, which may be used as an alternative to conventional mechanisms such
  as buttons or graphical user interfaces.
  [0082]     For example, the user may provide input to assistant 1002 such as "I
  need to wake tomorrow at 8am". Once assistant 1002 has determined the
  user's intent, using the techniques described herein, assistant 1002 can call ex
                                           -19-

WO 2011/088053                                                      PCT/US2011/020861
ternal services 1340 to interface with an alarm clock function or application on
the device. Assistant 1002 sets the alarm on behalf of the user. In this man
ner, the user can use assistant 1002 as a replacement for conventional mecha
nisms for setting the alarm or performing other functions on the device. If the
user's requests are ambiguous or need further clarification, assistant 1002 can
use the various techniques described herein, including active elicitation,
paraphrasing, suggestions, and the like, to obtain the needed information so
that the correct services 1340 are called and the intended action taken. In one
embodiment, assistant 1002 may prompt the user for confirmation before call
ing a service 1340 to perform a function. In one embodiment, a user can selec
tively disable assistant's 1002 ability to call particular services 1340, or can
disable all such service-calling if desired.
[0083]      The system of the present invention can be implemented with many
different types of clients 1304 and modes of operation. Referring now to Fig.
6, there is shown a block diagram depicting a system architecture illustrating
several different types of clients 1304 and modes of operation. One skilled in
the art will recognize that the various types of clients 1304 and modes of op
eration shown in Fig. 6 are merely exemplary, and that the system of the pre
sent invention can be implemented using clients 1304 and/or modes of opera
tion other than those depicted. Additionally, the system can include any or
all of such clients 1304 and/or modes of operation, alone or in any combina
tion. Depicted examples include:
            Computer devices with input/output devices and/or sensors 1402.
            A client component may be deployed on any such computer device
            1402. At least one embodiment may be implemented using a web
            browser 1304A or other software application for enabling commu
            nication with servers 1340 via network 1361. Input and output
            channels may of any type, including for example visual and/or
            auditory channels. For example, in one embodiment, the system of
            the invention can be implemented using voice-based communica
                                          - 20 -

WO 2011/088053                                                    PCT/US2011/020861
           tion methods, allowing for an embodiment of the assistant for the
           blind whose equivalent of a web browser is driven by speech and
           uses speech for output.
       " Mobile Devices with I/O and sensors 1406, for which the client may
           be implemented as an application on the mobile device 1304B. This
           includes, but is not limited to, mobile phones, smartphones, per
           sonal digital assistants, tablet devices, networked game consoles,
           and the like.
        " Consumer Appliances with I/O and sensors 1410, for which the cli
           ent may be implemented as an embedded application on the appli
            ance 1304C.
        * Automobiles and other vehicles with dashboard interfaces and sen
            sors 1414, for which the client may be implemented as an embed
            ded system application 1304D. This includes, but is not limited to,
            car navigation systems, voice control systems, in-car entertainment
            systems, and the like.
        * Networked computing devices such as routers 1418 or any other
            device that resides on or interfaces with a network, for which the
            client may be implemented as a device-resident application 1304E.
        " Email clients 1424, for which an embodiment of the assistant is con
            nected via an Email Modality Server 1426. Email Modality server
            1426 acts as a communication bridge, for example taking input from
            the user as email messages sent to the assistant and sending output
            from the assistant to the user as replies.
        " Instant messaging clients 1428, for which an embodiment of the as
             sistant is connected via a Messaging Modality Server 1430. Messag
             ing Modality server 1430 acts as a communication bridge, taking
             input from the user as messages sent to the assistant and sending
             output from the assistant to the user as messages in reply.
                                          -21  -

WO 2011/088053                                                      PCT/US2011/020861
        e  Voice telephones 1432, for which an embodiment of the assistant is
           connected via a Voice over Internet Protocol (VoIP) Modality Server
           1430. VoIP Modality server 1430 acts as a communication bridge,
           taking input from the user as voice spoken to the assistant and
           sending output from the assistant to the user, for example as syn
           thesized speech, in reply.
[0084]     For messaging platforms including but not limited to email, instant
messaging, discussion forums, group chat sessions, live help or customer sup
port sessions and the like, assistant 1002 may act as a participant in the con
versations. Assistant 1002 may monitor the conversation and reply to indi
viduals or the group using one or more the techniques and methods described
herein for one-to-one interactions.
[0085]     In various embodiments, functionality for implementing the tech
niques of the present invention can be distributed among any number of cli
ent and/or server components. For example, various software modules can
be implemented for performing various functions in connection with the pre
sent invention, and such modules can be variously implemented to run on
server and/or client components. Referring now to Fig. 7, there is shown an
example of a client 1304 and a server 1340, which communicate with each
other to implement the present invention according to one embodiment. Fig.
7 depicts one possible arrangement by which software modules can be dis
tributed among client 1304 and server 1340. One skilled in the art will recog
nize that the depicted arrangement is merely exemplary, and that such mod
ules can be distributed in many different ways. In addition, any number of
clients 1304 and/or servers 1340 can be provided, and the modules can be dis
 tributed among these clients 1304 and/or servers 1340 in any of a number of
 different ways.
 [0086]    In the example of Fig. 7, input elicitation functionality and output
 processing functionality are distributed among client 1304 and server 1340,
 with client part of input elicitation 1094a and client part of output processing
                                          -22-

WO 2011/088053                                                     PCT/US2011/020861
1092a located at client 1304, and server part of input elicitation 1094b and
server part of output processing 1092b located at server 1340. The following
components are located at server 1340:
         e  complete vocabulary 1058b;
         e  complete library of language pattern recognizers 1060b;
         * master version of short term personal memory 1052b;
         e  master version of long term personal memory 1054b.
 [0087]     In one embodiment, client 1304 maintains subsets and/or portions
 of these components locally, to improve responsiveness and reduce depend
 ence on network communications. Such subsets and/or portions can be
 maintained and updated according to well known cache management tech
 niques. Such subsets and/or portions include, for example:
         e subset of vocabulary 1058a;
         e  subset of library of language pattern recognizers 1060a;
         e  cache of short term personal memory 1052a;
         e  cache of long term personal memory 1054a.
 [0088]     Additional components may be implemented as part of server 1340,
 including for example:
          " language interpreter 1070;
          e dialog flow processor 1080;
          e  output processor 1090;
          " domain entity databases 1072;
          " task flow models 1086;
          e  services orchestration 1082;
          e  service capability models 1088.
  [0089]     Each of these components will be described in more detail below.
  Server 1340 obtains additional information by interfacing with external ser
  vices 1360 when needed.
                                          -23-

WO 2011/088053                                                     PCT/US2011/020861
 Conceptual Architecture
[0090]      Referring now to Fig. 1, there is shown a simplified block diagram
of a specific example embodiment of an intelligent automated assistant 1002.
As described in greater detail herein, different embodiments of intelligent
automatedassirntaant systems Mc ma   be conci-,figured, d ned, anid /or
to provide various different types of operations, functionalities, and/or fea
tures generally relating to intelligent automated assistant technology. Fur
ther, as described in greater detail herein, many of the various operations,
functionalities, and/or features of the intelligent automated assistant sys
tem(s) disclosed herein may provide may enable or provide different types of
advantages and/or benefits to different entities interacting with the intelligent
 automated assistant system(s). The embodiment shown in Fig. 1 may be im
plemented using any of the hardware architectures described above, or using
a different type of hardware architecture.
 [0091]     For example, according to different embodiments, at least some in
telligent automated assistant system(s) may be configured, designed, and/or
operable to provide various different types of operations, functionalities,
 and/or features, such as, for example, one or more of the following (or com
binations thereof):
        * automate the application of data and services available over the
            Internet to discover, find, choose among, purchase, reserve, or or
            der products and services. In addition to automating the process of
            using these data and services, intelligent automated assistant 1002
            may also enable the combined use of several sources of data and
            services at once. For example, it may combine information about
            products from several review sites, check prices and availability
            from multiple distributors, and check their locations and time con
            straints, and help a user find a personalized solution to their prob
            lem.
                                          -24-

WO 2011/088053                                                     PCT/US2011/020861
       e   automate the use of data and services available over the Internet to
           discover, investigate, select among, reserve, and otherwise learn
           about things to do (including but not limited to movies, events, per
           formances, exhibits, shows and attractions); places to go (including
           but not limited to travel destinations, hotels and other places to
           stay, landmarks and other sites of interest, and the like); places to
           eat or drink (such as restaurants and bars), times and places to meet
           others, and any other source of entertainment or social interaction
           which may be found on the Internet.
        " enable the operation of applications and services via natural lan
           guage dialog that are otherwise provided by dedicated applications
           with graphical user interfaces including search (including location
           based search); navigation (maps and directions); database lookup
            (such as finding businesses or people by name or other properties);
           getting weather conditions and forecasts, checking the price of
           market items or status of financial transactions; monitoring traffic
           or the status of flights; accessing and updating calendars and
            schedules; managing reminders, alerts, tasks and projects; commu
            nicating over email or other messaging platforms; and operating
            devices locally or remotely (e.g., dialing telephones, controlling
            light and temperature, controlling home security devices, playing
            music or video, and the like). In one embodiment, assistant 1002
            can be used to initiate, operate, and control many functions and
            apps available on the device.
        " offer personal recommendations for activities, products, services,
            source of entertainment, time management, or any other kind of
            recommendation service that benefits from an interactive dialog in
            natural language and automated access to data and services.
 [0092]     According to different embodiments, at least a portion of the vari
 ous types of functions, operations, actions, and/or other features provided by
                                          -25-

WO 2011/088053                                                     PCT/US2011/020861
intelligent automated assistant 1002 may be implemented at one or more cli
ent systems(s), at one or more server systems (s), and/or combinations
thereof.
[0093]     According to different embodiments, at least a portion of the vari
ous types of functions, operations, actions, and/or other features provided by
assistant 1002 may implement by at least one embodiment of an automated
call and response procedure, such as that illustrated and described, for exam
ple, with respect to Fig. 33.
[0094]     Additionally, various embodiments of assistant 1002 described
herein may include or provide a number of different advantages and/or
benefits over currently existing intelligent automated assistant technology
such as, for example, one or more of the following (or combinations thereof):
        " The integration of speech-to-text and natural language understand
           ing technology that is constrained by a set of explicit models of do
           mains, tasks, services, and dialogs. Unlike assistant technology that
           attempts to implement a general-purpose artificial intelligence sys
           tem, the embodiments described herein may apply the multiple
           sources of constraints to reduce the number of solutions to a more
           tractable size. This results in fewer ambiguous interpretations of
           language, fewer relevant domains or tasks, and fewer ways to op
           erationalize the intent in services. The focus on specific domains,
           tasks, and dialogs also makes it feasible to achieve coverage over
           domains and tasks with human-managed vocabulary and map
           pings from intent to services parameters.
        " The ability to solve user problems by invoking services on their be
           half over the Internet, using APIs. Unlike search engines which
            only return links and content, some embodiments of automated as
            sistants 1002 described herein may automate research and problem
            solving activities. The ability to invoke multiple services for a given
            request also provides broader functionality to the user than is
                                          -26-

WO 2011/088053                                                     PCT/US2011/020861
           achieved by visiting a single site, for instance to produce a product
           or service or find something to do.
       " The application of personal information and personal interaction
           history in the interpretation and execution of user requests. Unlike
           conventional search engines or question answering services, the
           embodiments described herein use information from personal in
           teraction history (e.g., dialog history, previous selections from re
           sults, and the like), personal physical context (e.g., user's location
           and time), and personal information gathered in the context of in
           teraction (e.g., name, email addresses, physical addresses, phone
           numbers, account numbers, preferences, and the like). Using these
           sources of information enables, for example,
                o better interpretation of user input (e.g., using personal his
                   tory and physical context when interpreting language);
                o more personalized results (e.g., that bias toward preferences
                   or recent selections);
                o improved efficiency for the user (e.g., by automating steps
                   involving the signing up to services or filling out forms).
        " The use of dialog history in interpreting the natural language of
            user inputs. Because the embodiments may keep personal history
            and apply natural language understanding on user inputs, they
            may also use dialog context such as current location, time, domain,
            task step, and task parameters to interpret the new inputs. Conven
            tional search engines and command processors interpret at least
            one query independent of a dialog history. The ability to use dialog
            history may make a more natural interaction possible, one which
            resembles normal human conversation.
        " Active input elicitation, in which assistant 1002 actively guides and
            constrains the input from the user, based on the same models and
            information used to interpret their input. For example, assistant
                                          - 27-

WO 2011/088053                                                     PCT/US2011/020861
           1002 may apply dialog models to suggest next steps in a dialog with
           the user in which they are refining a request; offer completions to
           partially typed input based on domain and context specific possi
           bilities; or use semantic interpretation to select from among am
           biguous interpretations of speech as text or text as intent.
       " The explicit modeling and dynamic management of services, with
           dynamic and robust services orchestration. The architecture of em
           bodiments described enables assistant 1002 to interface with many
           external services, dynamically determine which services may pro
           vide information for a specific user request, map parameters of the
           user request to different service APIs, call multiple services at once,
           integrate results from multiple services, fail over gracefully on
           failed services, and/or efficiently maintain the implementation of
           services as their APIs and capabilities evolve.
       " The use of active ontologies as a method and apparatus for building
           assistants 1002, which simplifies the software engineering and data
           maintenance of automated assistant systems. Active ontologies are
           an integration of data modeling and execution environments for as
           sistants. They provide a framework to tie together the various
           sources of models and data (domain concepts, task flows, vocabu
           lary, language pattern recognizers, dialog context, user personal in
           formation, and mappings from domain and task requests to exter
           nal services. Active ontologies and the other architectural innova
           tions described herein make it practical to build deep functionality
           within domains, unifying multiple sources of information and ser
           vices, and to do this across a set of domains.
[00951     In at least one embodiment, intelligent automated assistant 1002
may be operable to utilize and/or generate various different types of data
and/or other types of information when performing specific tasks and/or op
erations. This may include, for example, input data/information and/or out
                                         -28-

WO 2011/088053                                                    PCT/IUS2011/020861
put data/information. For example, in at least one embodiment, intelligent
automated assistant 1002 may be operable to access, process, and/or other
wise utilize information from one or more different types of sources, such as,
for example, one or more local and/or remote memories, devices and/or sys
tems. Additionally, in at least one embodiment, intelligent automated assis
tant 1002 may be operable to generate one or more different types of output
data/information, which, for example, may be stored in memory of one or
more local and/or remote devices and/or systems.
[0096]     Examples of different types of input data/information which may
be accessed and/or utilized by intelligent automated assistant 1002 may in
clude, but are not limited to, one or more of the following (or combinations
thereof):
       * Voice input: from mobile devices such as mobile telephones and
           tablets, computers with microphones, Bluetooth headsets, automo
           bile voice control systems, over the telephone system, recordings on
           answering services, audio voicemail on integrated messaging ser
           vices, consumer applications with voice input such as clock radios,
           telephone station, home entertainment control systems, and game
           consoles.
       " Text input from keyboards on computers or mobile devices, key
           pads on remote controls or other consumer electronics devices,
           email messages sent to the assistant, instant messages or similar
           short messages sent to the assistant, text received from players in
           multiuser game environments, and text streamed in message feeds.
        " Location information coming from sensors or location-based sys
            tems. Examples include Global Positioning System (GPS) and As
            sisted GPS (A-GPS) on mobile phones. In one embodiment, loca
            tion information is combined with explicit user input. In one em
            bodiment, the system of the present invention is able to detect when
            a user is at home, based on known address information and current
                                        -29-

WO 2011/088053                                                      PCT/US2011/020861
            location determination. In this manner, certain inferences may be
            made about the type of information the user might be interested in
            when at home as opposed to outside the home, as well as the type
            of services and actions that should be invoked on behalf of the user
            depending on whether or not he or she is at home.
        " Time information from clocks on client devices. This may include,
            for example, time from telephones or other client devices indicating
            the local time and time zone. In addition, time may be used in the
            context of user requests, such as for instance, to interpret phrases
            such as "in an hour" and "tonight".
        * Compass, accelerometer, gyroscope, and/or travel velocity data, as
            well as other sensor data from mobile or handheld devices or em
            bedded systems such as automobile control systems. This may also
            include device positioning data from remote controls to appliances
            and game consoles.
        * Clicking and menu selection and other events from a graphical user
            interface (GUI) on any device having a GUI. Further examples in
            clude touches to a touch screen.
        " Events from sensors and other data-driven triggers, such as alarm
            clocks, calendar alerts, price change triggers, location triggers, push
            notification onto a device from servers, and the like.
 [0097]     The input to the embodiments described herein also includes the
 context of the user interaction history, including dialog and request history.
 [0098]     Examples of different types of output data/information which may
 be generated by intelligent automated assistant 1002 may include, but are not
 limited to, one or more of the following (or combinations thereof):
        * Text output sent directly to an output device and/or to the user in
            terface of a device
        " Text and graphics sent to a user over email
        " Text and graphics send to a user over a messaging service
                                          -30 -

WO 2011/088053                                                    PCT/US2011/020861
        "   Speech output, may include one or more of the following (or com
            binations thereof):
                 o  Synthesized speech
                 o Sampled speech
                 o Recorded messages
        " Graphical layout of information with photos, rich text, videos,
             sounds, and hyperlinks. For instance, the content rendered in a web
             browser.
        " Actuator output to control physical actions on a device, such as
             causing it to turn on or off, make a sound, change color, vibrate,
             control a light, or the like.
        " Invoking other applications on a device, such as calling a mapping
             application, voice dialing a telephone, sending an email or instant
             message, playing media, making entries in calendars, task manag
             ers, and note applications, and other applications.
         " Actuator output to control physical actions to devices attached or
             controlled by a device, such as operating a remote camera, control
             ling a wheelchair, playing music on remote speakers, playing vid
             eos on remote displays, and the like.
 [0099]      It may be appreciated that the intelligent automated assistant 1002
 of Fig. 1 is but one example from a wide range of intelligent automated assis
 tant system embodiments which may be implemented. Other embodiments
 of the intelligent automated assistant system (not shown) may include addi
 tional, fewer and/or different components/features than those illustrated, for
 example, in the example intelligent automated assistant system embodiment
 of Fig. 1.
  User Interaction
  [0100]      Referring now to Fig. 2, there is shown an example of an interaction
  between a user and at least one embodiment of an intelligent automated assis
                                            -31 -

WO 2011/088053                                                       PCT/US2011/020861
tant 1002. The example of Fig. 2 assumes that a user is speaking to intelligent
automated assistant 1002 using input device 1206, which may be a speech in
put mechanism, and the output is graphical layout to output device 1207,
which may be a scrollable screen. Conversation screen 101A features a con
versational user interface showing what the user said 101B ("I'd like a roman
tic place for Italian food near my office") and assistant's 1002 response, which
is a summary of its findings 101C ("OK, I found these Italian restaurants
which reviews say are romantic close to your work:") and a set of results 101D
 (the first three of a list of restaurants are shown). In this example, the user
clicks on the first result in the list, and the result automatically opens up to
reveal more information about the restaurant, shown in information screen
101E. Information screen 101E and conversation screen 101A may appear on
the same output device, such as a touchscreen or other display device; the ex
amples depicted in Fig. 2 are two different output states for the same output
device.
 [0101]      In one embodiment, information screen 101E shows information
 gathered and combined from a variety of services, including for example, any
 or all of the following:
         " Addresses and geolocations of businesses;
         " Distance from user's current location;
         " Reviews from a plurality of sources;
 [0102]      In one embodiment, information screen 101E also includes some
 examples of services that assistant 1002 might offer on behalf of the user, in
 cluding:
         " Dial a telephone to call the business ("call");
         e   Remember this restaurant for future reference ("save");
         " Send an email to someone with the directions and information
             about this restaurant ("share");
         e   Show the location of and directions to this restaurant on a map
              ("map it");
                                            - 32 -

WO 2011/088053                                                     PCT/US2011/020861
        e   Save personal notes about this restaurant ("my notes").
[0103]      As shown in the example of Fig. 2, in one embodiment, assistant
1002 includes intelligence beyond simple database applications, such as, for
example,
        e   Processing a statement of intent in a natural language 101B, not just
            keywords;
        e   Inferring semantic intent from that language input, such as inter
            preting "place for Italian food" as "Italian restaurants";
        " Operationalizing semantic intent into a strategy for using online
            services and executing that strategy on behalf of the user (e.g., op
            erationalizing the desire for a romantic place into the strategy of
            checking online review sites for reviews that describe a place as "ro
            mantic").
 IntelligentAutomated AssistantComponents
 [0104]     According to various embodiments, intelligent automated assistant
 1002 may include a plurality of different types of components, devices, mod
 ules, processes, systems, and the like, which, for example, may be imple
 mented and/or instantiated via the use of hardware and/or combinations of
 hardware and software. For example, as illustrated in the example embodi
 ment of Fig. 1, assistant 1002 may include one or more of the following types
 of systems, components, devices, processes, and the like (or combinations
 thereof):
          * One or more active ontologies 1050;
          " Active input elicitation component(s) 1094 (may include client part
             1094a and server part 1094b);
          " Short term personal memory component(s) 1052 (may include mas
             ter version 1052b and cache 1052a);
          e  Long-term personal memory component(s) 1054 (may include mas
             ter version 1052b and cache 1052a);
                                          - 33 -

WO 2011/088053                                                       PCT/US2011/020861
         "  Domain models component(s) 1056;
         * Vocabulary component(s) 1058 (may include complete vocabulary
             1058b and subset 1058a);
         " Language pattern recognizer(s) component(s) 1060 (may include
             full library 1060b and subset 1560a);
         * Language interpreter component(s) 1070;
         " Domain entity database(s) 1072;
         * Dialog flow processor component(s) 1080;
         " Services orchestration component(s) 1082;
         e   Services component(s) 1084;
         * Task flow models component(s) 1086;
         * Dialog flow models component(s) 1087;
         " Service models component(s) 1088;
         " Output processor component(s) 1090.
 [0105]      As described in connection with Fig. 7, in certain client/server
based embodiments, some or all of these components may be distributed be
tween client 1304 and server 1340.
 [0106]      For purposes of illustration, at least a portion of the different types
 of components of a specific example embodiment of intelligent automated as
 sistant 1002 will now be described in greater detail with reference to the ex
 ample intelligent automated assistant 1002 embodiment of Fig. 1.
 Active Ontologies 1050
 [0107]      Active ontologies 1050 serve as a unifying infrastructure that inte
 grates models, components, and/or data from other parts of embodiments of
 intelligent automated assistants 1002. In the field of computer and informa
 tion science, ontologies provide structures for data and knowledge represen
 tation such as classes/types, relations, attributes/ properties and their instan
 tiation in instances. Ontologies are used, for example, to build models of data
 and knowledge. In some embodiments of the intelligent automated system
                                          - 34  -

WO 2011/088053                                                   PCT/US2011/020861
1002, ontologies are part of the modeling framework in which to build models
such as domain models.
[0108]     Within the context of the present invention, an "active ontology"
1050 may also serve as an execution environment, in which distinct process
ing elements are arranged in an ontology-like manner (e.g., having distinct
attributes and relations with other processing elements). These processing
elements carry out at least some of the tasks of intelligent automated assistant
1002. Any number of active ontologies 1050 can be provided.
[0109]     In at least one embodiment, active ontologies 1050 may be operable
to perform and/or implement various types of functions, operations, actions,
and/or other features such as, for example, one or more of the following (or
combinations thereof):
        " Act as a modeling and development environment, integrating mod
           els and data from various model and data components, including
           but not limited to
                o Domain models 1056
                o Vocabulary 1058
                o Domain entity databases 1072
                o Task flow models 1086
                o Dialog flow models 1087
                o Service capability models 1088
        " Act as a data-modeling environment on which ontology-based edit
           ing tools may operate to develop new models, data structures, da
           tabase schemata, and representations.
        " Act as a live execution environment, instantiating values for ele
            ments of domain 1056, task 1086, and/or dialog models 1087, lan
            guage pattern recognizers, and/or vocabulary 1058, and user
            specific information such as that found in short term personal
            memory 1052, long term personal memory 1054, and/or the results
            of service orchestration 1182. For example, some nodes of an active
                                         - 35 -

WO 2011/088053                                                    PCT/US2011/020861
            ontology may correspond to domain concepts such as restaurant
            and its property restaurantname. During live execution, these active
            ontology nodes may be instantiated with the identity of a particular
            restaurant entity and its name, and how its name corresponds to
            words in a natural language input utterance. Thus, in this em
            bodiment, the active ontology is serving as both a modeling envi
            ronment specifying the concept that restaurants are entities with
            identities that have names, and for storing dynamic bindings of
            those modeling nodes with data from entity databases and parses
            of natural language.
        a   Enable the communication and coordination among components
            and processing elements of an intelligent automated assistant, such
            as, for example, one or more of the following (or combinations
            thereof):
                o Active input elicitation component(s) 1094
                o Language interpreter component(s) 1070
                o Dialog flow processor component(s) 1080
                o Services orchestration component(s) 1082
                o Services component(s) 1084
[0110]      In one embodiment, at least a portion of the functions, operations,
actions, and/or other features of active ontologies 1050 described herein may
be implemented, at least in part, using various methods and apparatuses de
scribed in U.S. Patent Application Serial No. 11/518,292 for "Method and Ap
paratus for Building an Intelligent Automated Assistant", filed September 8,
2006.
[01111]     in at least one embodiment, a given instance of active ontology 1050
may access and/or utilize information from one or more associated databases.
In at least one embodiment, at least a portion of the database information may
be accessed via communication with one or more local and/or remote mem
ory devices. Examples of different types of data which may be accessed by
                                         - 36 -

WO 2011/088053                                                     PCT/US2011/020861
active ontologies 1050 may include, but are not limited to, one or more of the
following (or combinations thereof):
         * Static data that is available from one or more components of intelli
            gent automated assistant 1002;
         * Data that is dynamically instantiated per user session, for example,
            but not limited to, maintaining the state of the user-specific inputs
            and outputs exchanged among components of intelligent auto
            mated assistant 1002, the contents of short term personal memory,
            the inferences made from previous states of the user session, and
            the like.
 [0112]     In this manner, active ontologies 1050 are used to unify elements of
 various components in intelligent automated assistant 1002. An active ontol
 ogy 1050 allows an author, designer, or system builder to integrate compo
 nents so that the elements of one component are identified with elements of
 other components. The author, designer, or system builder can thus combine
 and integrate the components more easily.
 [0113]     Referring now to Fig. 8, there is shown an example of a fragment of
 an active ontology 1050 according to one embodiment. This example is in
 tended to help illustrate some of the various types of functions, operations,
 actions, and/or other features that may be provided by active ontologies 1050.
  [0114]     Active ontology 1050 in Fig. 8 includes representations of a restau
 rant and meal event. In this example, a restaurant is a concept 1610 with
  properties such as its name 1612, cuisines served 1615, and its location 1613,
  which in turn might be modeled as a structured node with properties for
  street address 1614. The concept of a meal event might be modeled as a node
  1616 including a dining party 1617 (which has a size 1619) and time period
  1618.
          * Active ontologies may include and/or make reference to domain
             models 1056. For example, Fig. 8 depicts a dining out domain
             model 1622 linked to restaurant concept 1610 and meal event con
                                           -37-

WO 2011/088053                                                    PCT/US2011/020861
           cept 1616. In this instance, active ontology 1050 includes dining out
           domain model 1622; specifically, at least two nodes of active ontol
           ogy 1050, namely restaurant 1610 and meal event 1616, are also in
           cluded in and/or referenced by dining out domain model 1622.
           This domain model represents, among other things, the idea that
           dining out involves meal event that occur at restaurants. The ac
           tive ontology nodes restaurant 1610 and meal event 1616 are also
           included and/or referenced by other components of the intelligent
           automated assistant, a shown by dotted lines in Fig. 8.
       e   Active ontologies may include and/or make reference to task flow
           models 1086. For example, Fig. 8 depicts an event planning task
           flow model 1630, which models the planning of events independent
           of domains, applied to a domain-specific kind of event: meal event
           1616. Here, active ontology 1050 includes general event planning
           task flow model 1630, which comprises nodes representing events
           and other concepts involved in planning them. Active ontology
           1050 also includes the node meal event 1616, which is a particular
           kind of event. In this example, meal event 1616 is included or made
           reference to by both domain model 1622 and task flow model 1630,
           and both of these models are included in and/or referenced by ac
           tive ontology 1050. Again, meal event 1616 is an example of how
           active ontologies can unify elements of various components in
           cluded and/or referenced by other components of the intelligent
           automated assistant, a shown by dotted lines in Fig. 8.
       " Active ontologies may include and/or make reference to dialog
           flow models 1087. For example, Fig. 8 depicts a dialog flow model
           1642 for getting the values of constraints required for a transaction
           instantiated on the constraint party size as represented in concept
           1619. Again, active ontology 1050 provides a framework for relat
           ing and unifying various components such as dialog flow models
                                         - 38 -

WO 2011/088053                                                       PCT/US2011/020861
           1087. In this case, dialog flow model 1642 has a general concept of a
           constraint that is instantiated in this particular example to the active
           ontology node party size 1619. This particular dialog flow model
           1642 operates at the abstraction of constraints, independent of do
           main. Active ontology 1050 represents party size property 1619 of
           party node 1617, which is related to meal event node 1616. In such
           an embodiment, intelligent automated assistant 1002 uses active on
           tology 1050 to unify the concept of constraint in dialog flow model
           1642 with the property of party size 1619 as part of a cluster of
           nodes representing meal event concept 1616, which is part of the
           domain model 1622 for dining out.
       " Active ontologies may include and/or make reference to service
           models 1088. For example, Fig. 8 depicts a model of a restaurant
           reservation service 1672 associated with the dialog flow step for get
           ting values required for that service to perform a transaction. In
           this instance, service model 1672 for a restaurant reservation service
           specifies that a reservation requires a value for party size 1619 (the
           number of people sitting at a table to reserve). The concept party
           size 1619, which is part of active ontology 1050, also is linked or re
           lated to a general dialog flow model 1642 for asking the user about
            the constraints for a transaction; in this instance, the party size is a
            required constraint for dialog flow model 1642.
        " Active ontologies may include and/or make reference to domain
            entity databases 1072. For example, Fig. 8 depicts a domain entity
            database of restaurants 1652 associated with restaurant node 1610
            in active ontology 1050. Active ontology 1050 represents the gen
            eral concept of restaurant 1610, as may be used by the various com
            ponents of intelligent automated assistant 1002, and it is instanti
            ated by data about specific restaurants in restaurant database 1652.
                                           - 39 -

WO 2011/088053                                                    PCT/US2011/020861
       "   Active ontologies may include and/or make reference to vocabu
           lary databases 1058. For example, Fig. 8 depicts a vocabulary data
           base of cuisines 1662, such as Italian, French, and the like, and the
           words associated with each cuisine such as "French", "continental",
           "provincial", and the like. Active ontology 1050 includes restaurant
           node 1610, which is related to cuisines served node 1615, which is
           associated with the representation of cuisines in cuisines database
           1662. A specific entry in database 1662 for a cuisine, such as
           "French", is thus related through active ontology 1050 as an in
           stance of the concept of cuisines served 1615.
       " Active ontologies may include and/or make reference to any data
           base that can be mapped to concepts or other representations in on
           tology 1050. Domain entity databases 1072 and vocabulary data
           bases 1058 are merely two examples of how active ontology 1050
           may integrate databases with each other and with other compo
           nents of automated assistant 1002. Active ontologies allow the au
           thor, designer, or system builder to specify a nontrivial mapping
           between representations in the database and representations in on
           tology 1050. For example, the database schema for restaurants da
           tabase 1652 may represent a restaurant as a table of strings and
           numbers, or as a projection from a larger database of business, or
           any other representation suitable for database 1652. In this example
           active ontology 1050, restaurant 1610 is a concept node with proper
           ties and relations, organized differently from the database tables. In
           this example, nodes of ontology 1050 are associated with elements
           of database schemata. The integration of database and ontology
           1050 provides a unified representation for interpreting and acting
           on specific data entries in databases in terms of the larger sets of
           models and data in active ontology 1050. For instance, the word
           "French" may be an entry in cuisines database 1662. Because, in
                                         -40-

WO 2011/088053                                                     PCT/US2011/020861
            this example, database 1662 is integrated in active ontology 1050,
            that same word "French" also has an interpretation as a possible
            cuisine served at a restaurant, which is involved in planning meal
            events, and this cuisine serves as a constraint to use when using res
            taurants reservation services, and so forth. Active ontologies can
            thus integrate databases into the modeling and execution environ
            ment to inter-operate with other components of automated assistant
            1002.
 [0115]     As described above, active ontology 1050 allows the author, de
 signer, or system builder to integrate components; thus, in the example of Fig.
 8, the elements of a component such as constraint in dialog flow model 1642
 can be identified with elements of other components such as required pa
 rameter of restaurant reservation service 1672.
 [0116]     Active ontologies 1050 may be embodied as, for example, configu
 rations of models, databases, and components in which the relationships
 among models, databases, and components are any of:
         e   containership and/or inclusion;
         * relationship with links and/or pointers;
         e   interface over APIs, both internal to a program and between pro
             grams.
  [0117]     For example, referring now to Fig. 9, there is shown an example of
  an alternative embodiment of intelligent automated assistant system 1002,
 wherein domain models 1056, vocabulary 1058, language pattern recognizers
  1060, short term personal memory 1052, and long term personal memory 1054
  components are organized under a common container associated with active
  ontology 1050, and other components such as active input elicitation compo
  nent(s) 1094, language interpreter 1070 and dialog flow processor 1080 are as
  sociated with active ontology 1050 via API relationships.
                                          - 41 -

WO 2011/088053                                                       PCT/US2011/020861
Active Input Elicitation Component(s) 1094
[0118]      In at least one embodiment, active input elicitation component(s)
1094 (which, as described above, may be implemented in a stand-alone con
figuration or in a configuration including both server and client components)
may h nnprable tn perform and/or implement various types of functions,
operations, actions, and/or other features such as, for example, one or more
of the following (or combinations thereof):
        e   Elicit, facilitate and/or process input from the user or the user's en
            vironment, and/or information about their need(s) or request(s).
            For example, if the user is looking to find a restaurant, the input
            elicitation module may get information about the user's constraints
            or preferences for location, time, cuisine, price, and so forth.
        * Facilitate different kinds of input from various sources, such as for
            example, one or more of the following (or combinations thereof):
                o input from keyboards or any other input device that gener
                     ates text
                o input from keyboards in user interfaces that offer dynamic
                     suggested completions of partial input
                o input from voice or speech input systems
                o input from Graphical User Interfaces (GUIs) in which users
                     click, select, or otherwise directly manipulate graphical ob
                     jects to indicate choices
                o input from other applications that generate text and send it
                     to the automated assistant, including email, text messaging,
                     or other text communication platforms
[0119]      By performing active input elicitation, assistant 1002 is able to dis
ambiguate intent at an early phase of input processing. For example, in an
embodiment where input is provided by speech, the waveform might be sent
to a server 1340 where words are extracted, and semantic interpretation per
formed. The results of such semantic interpretation can then be used to drive
                                             - 42 -

WO 2011/088053                                                       PCT/US2011/020861
active input elicitation, which may offer the user alternative candidate words
to choose among based on their degree of semantic fit as well as phonetic
match.
[0120]       In at least one embodiment, active input elicitation component(s)
1094 actively, automatically, and dynamically guide the user toward inputs
that may be acted upon by one or more of the services offered by embodi
ments of assistant 1002. Referring now to Fig. 10, there is shown a flow dia
gram depicting a method of operation for active input elicitation compo
nent(s) 1094 according to one embodiment.
[0121]       The procedure begins 20. In step 21, assistant 1002 may offer inter
faces on one or more input channels. For example, a user interface may offer
the user options to speak or type or tap at any stage of a conversational inter
 action. In step 22, the user selects an input channel by initiating input on one
modality, such as pressing a button to start recording speech or to bring up an
interface for typing.
 [0122]      In at least one embodiment, assistant 1002 offers default sugges
 tions for the selected modality 23. That is, it offers options 24 that are relevant
 in the current context prior to the user entering any input on that modality.
 For example, in a text input modality, assistant 1002 might offer a list of
 common words that would begin textual requests or commands such as, for
 example, one or more of the following (or combinations thereof): imperative
 verbs (e.g., find, buy, reserve, get, call, check, schedule, and the like), nouns
 (e.g., restaurants, movies, events, businesses, and the like), or menu-like op
 tions naming domains of discourse (e.g., weather, sports, news, and the like)
 [0123]      If the user selects one of the default options in 25, and a preference
 to autosubmit 30 is set, the procedure may return immediately. This is similar
 to the operation of a conventional menu selection.
  [0124]     However, the initial option may be taken as a partial input, or the
  user may have started to enter a partial input 26. At any point of input, in at
                                            -43  -

WO 2011/088053                                                     PCT/US2011/020861
least one embodiment, the user may choose to indicate that the partial input is
complete 22, which causes the procedure to return.
[0125]     In 28, the latest input, whether selected or entered, is added to the
cumulative input.
[0126]     In 29, the system suggestions next possible inputs that are relevant
given the current input and other sources of constraints on what constitutes
relevant and/or meaningful input.
[0127]     In at least one embodiment, the sources of constraints on user input
(for example, which are used in steps 23 and 29) are one or more of the vari
ous models and data sources that may be included in assistant 1002, which
may include, but are not limited to, one or more of the following (or combina
tions thereof):
        " Vocabulary 1058. For example, words or phrases that match the
           current input may be suggested. In at least one embodiment, vo
           cabulary may be associated with any or one or more nodes of active
           ontologies, domain models, task models, dialog models, and/or
           service models.
        " Domain models 1056, which may constrain the inputs that may in
           stantiate or otherwise be consistent with the domain model.      For
           example, in at least one embodiment, domain models 1056 may be
           used to suggest concepts, relations, properties, and/or instances
           that would be consistent with the current input.
        * Language pattern recognizers 1060, which may be used to recog
           nize idioms, phrases, grammatical constructs, or other patterns in
           the current input and be used to suggest completions that fill out
           the pattern.
        " Domain entity databases 1072, which may be used to suggest possi
           ble entities in the domain that match the input (e.g., business
           names, movie names, event names, and the like).
                                         - 44 -

WO 2011/088053                                                     PCT/US2011/020861
       "   Short term memory 1052, which may be used to match any prior
           input or portion of prior input, and/or any other property or fact
           about the history of interaction with a user. For example, partial
           input may be matched against cities that the user has encountered
           in a session, whether hypothetically (e.g., mentioned in queries)
           and/or physically (e.g., as determined from location sensors).
       * In at least one embodiment, semantic paraphrases of recent inputs,
           request, or results may be matched against the current input. For
           example, if the user had previously request "live music" and ob
           tained concert listing, and then typed "music" in an active input
           elicitation environment, suggestions may include "live music"
           and/or "concerts".
       " Long term personal memory 1054, which may be used to suggest
           matching items from long term memory. Such matching items may
           include, for example, one or more or any combination of: domain
           entities that are saved (e.g., "favorite" restaurants, movies, theaters,
           venues, and the like), to-do items, list items, calendar entries, peo
           ple names in contacts/address books, street or city names men
            tioned in contact/address books, and the like.
        * Task flow models 1086, which may be used to suggest inputs based
            on the next possible steps of in a task flow.
        " Dialog flow models 1087, which may be used to suggest inputs
            based on the next possible steps of in a dialog flow.
        * Service capability models 1088, which may be used to suggest pos
            sible services to employ, by name, category, capability, or any other
            property in the model. For example, a user may type part of the
            name of a preferred review site, and assistant 1002 may suggest a
            complete command for querying that review site for review.
 [0128]     In at least one embodiment, active input elicitation component(s)
 1094 present to the user a conversational interface, for example, an interface in
                                           - 45 -

WO 2011/088053                                                       PCT/US2011/020861
which the user and assistant communicate by making utterances back and
forth in a conversational manner. Active input elicitation component(s) 1094
may be operable to perform and/or implement various types of conversa
tional interfaces.
 [0129]     In at least one embodiment, active input elicitation component(s)
1094 may be operable to perform and/or implement various types of conver
sational interfaces in which assistant 1002 uses plies of the conversation to
prompt for information from the user according to dialog models. Dialog
models may represent a procedure for executing a dialog, such as, for exam
ple, a series of steps required to elicit the information needed to perform a
service.
[0130]      In at least one embodiment, active input elicitation component(s)
1094 offer constraints and guidance to the user in real time, while the user is
in the midst of typing, speaking, or otherwise creating input. For example,
active elicitation may guide the user to type text inputs that are recognizable
by an embodiment of assistant 1002 and/or that may be serviced by one or
more services offered by embodiments of assistant 1002. This is an advantage
over passively waiting for unconstrained input from a user because it enables
the user's efforts to be focused on inputs that may or might be useful, and/or
it enables embodiments of assistant 1002 to apply its interpretations of the in
put in real time as the user is inputting it.
[0131]      At least a portion of the functions, operations, actions, and/or other
features of active input elicitation described herein may be implemented, at
least in part, using various methods and apparatuses described in U.S. Patent
Application   SLri   INo. 11/5 8,2    I   "VhLILJ   a LIApA         for
                                                                    iUl L)LLI
                                                                        BJCLiiLLng Cut
Intelligent Automated Assistant", filed September 8, 2006.
[0132]      According to specific embodiments, multiple instances or threads of
active input elicitation component(s) 1094 may be concurrently implemented
and/or initiated via the use of one or more processors 63 and/or other com
binations of hardware and/or hardware and software.
                                           - 46   -

WO 2011/088053                                                        PCT/US2011/020861
[0133]      According to different embodiments, one or more different threads
or instances of active input elicitation component(s) 1094 may be initiated in
response to detection of one or more conditions or events satisfying one or
more different types of minimum threshold criteria for triggering initiation of
at least one instance of active input elicitation component(s) 1094. Various ex
amples of conditions or events which may trigger initiation and/or imple
mentation of one or more different threads or instances of active input elicita
tion component(s) 1094 may include, but are not limited to, one or more of the
following (or combinations thereof):
        e   Start of user session. For example, when the user session starts up
            an application that is an embodiment of assistant 1002, the interface
            may offer the opportunity for the user to initiate input, for example,
            by pressing a button to initiate a speech input system or clicking on
            a text field to initiate a text input session.
        " User input detected.
        e   When assistant 1002 explicitly prompts the user for input, as when
            it requests a response to a question or offers a menu of next steps
            from which to choose.
         " When assistant 1002 is helping the user perform a transaction and is
            gathering data for that transaction, e.g., filling in a form.
 [0134]     In at least one embodiment, a given instance of active input elicita
 tion component(s) 1094 may access and/or utilize information from one or
 more associated databases. In at least one embodiment, at least a portion of
 the database information may be accessed via communication with one or
 more local and/or remote memory devices. Examples of different types of
 data which may be accessed by active input elicitation component(s) 1094
 may include, but are not limited to, one or more of the following (or combina
 tions thereof):
         * database of possible words to use in a textual input;
         e  grammar of possible phrases to use in a textual input utterance;
                                             -47-

WO 2011/088053                                                    PCT/US2011/020861
        e   database of possible interpretations of speech input;
        e   database of previous inputs from a user or from other users;
        e   data from any of the various models and data sources that may be
            part of embodiments of assistant 1002, which may include, but are
            not limited to, one or more of the following (or combinations
            thereof):
            e   Domain models 1056;
            e   Vocabulary 1058;
            * Language pattern recognizers 1060;
            " Domain entity databases 1072;
            * Short term memory 1052;
            e   Long term personal memory 1054;
            e   Task flow models 1086;
            e   Dialog flow models 1087;
            " Service capability models 1088.
 [0135]     According to different embodiments, active input elicitation com
ponent(s) 1094 may apply active elicitation procedures to, for example, one or
more of the following (or combinations thereof):
            e   typed input;
            e   speech input;
            e   input from graphical user interfaces (GUIs), including gestures;
            " input from suggestions offered in a dialog; and
            * events from the computational and/or sensed environments.
 A ctive Tipd nnut Elicitation
 [0136]     Referring now to Fig. 11, there is shown a flow diagram depicting a
 method for active typed input elicitation according to one embodiment.
 [0137]     The method begins 110. Assistant 1002 receives 111 partial text in
 put, for example via input device 1206. Partial text input may include, for ex
 ample, the characters that have been typed so far in a text input field. At any
                                         - 48 -

WO 2011/088053                                                     PCT/US2011/020861
time, a user may indicate that the typed input is complete 112, as, for exam
ple, by pressing an Enter key. If not complete, a suggestion generator gener
ates 114 candidate suggestions 116. These suggestions may be syntactic, se
mantic, and/or other kinds of suggestion based any of the sources of informa
tion or constraints described herein. If the suggestion is selected 118, the in
put is transformed 117 to include the selected suggestion.
[0138]      In at least one embodiment, the suggestions may include extensions
to the current input. For example, a suggestion for "rest" may be "restau
rants".
[0139]      In at least one embodiment, the suggestions may include replace
ments of parts of the current input. For example, a suggestion for "rest" may
be "places to eat".
[0140]      In at least one embodiment, the suggestions may include replacing
and rephrasing of parts of the current input. For example, if the current input
is "find restaurants of style" a suggestion may be "italian" and when the sug
gestion is chosen, the entire input may be rewritten as "find Italian restau
rants".
 [0141]     In at least one embodiment, the resulting input that is returned is
 annotated 119, so that information about which choices were made in 118 is
preserved along with the textual input. This enables, for example, the seman
 tic concepts or entities underlying a string to be associated with the string
 when it is returned, which improves accuracy of subsequent language inter
 pretation.
 [0142]     Referring now to Figs. 12 to 21, there are shown screen shots illus
 trating some portions of some of the procedures for active typed-input elicita
 tion according to one embodiment. The screen shots depict an example of an
 embodiment of assistant 1002 as implemented on a smartphone such as the
 iPhone available from Apple Inc. of Cupertino, California. Input is provided
 to such device via a touchscreen, including on-screen keyboard functionality.
 One skilled in the art will recognize that the screen shots depict an embodi
                                          - 49 -

WO 2011/088053                                                     PCT/US2011/020861
ment that is merely exemplary, and that the techniques of the present inven
tion can be implemented on other devices and using other layouts and ar
rangements.
[0143]     In Fig. 12, screen 1201 includes a top-level set of suggestions 1202
shown when no input has been provided in field 1203. This corresponds to
no-input step 23 of Fig. 10 applied to step 114 of Fig. 11 where there is no in
put.
[0144]     In Fig. 13, screen 1301 depicts an example of the use of vocabulary
to offer suggested completions 1303 of partial user input 1305 entered in field
1203 using on-screen keyboard 1304. These suggested completions 1303 may
be part of the function of active input elicitation 1094. The user has entered
partial user input 1305 including the string "comm". Vocabulary component
1058 has provided a mapping of this string into three different kinds of in
stances, which are listed as suggested completions 1303: the phrase "commu
nity & local events" is a category of the events domain; "chambers of com
merce" is a category of the local business search domain, and "Jewish Com
munity Center" is the name of an instance of local businesses. Vocabulary
component 1058 may provide the data lookup and management of name
spaces like these. The user can tap Go button 1306 to indicate that he or she
has finished entering input; this causes assistant 1002 to proceed with the
completed text string as a unit of user input.
[0145]     In Fig. 14, screen 1401 depicts an example in which suggested se
mantic completions 1303 for a partial string "wh" 1305 include entire phrases
with typed parameters. These kinds of suggestions may be enabled by the
use of one or more of the various models and sources of input constraints de
scribed herein. For example, in one embodiment shown in Fig. 14, "what is
happening in city" is an active elicitation of the location parameter of the Lo
cal Events domain; "where is business name" is an active elicitation of the
Business Name constraint of the Local Business Search domain; "what is
showing at the venue name" is an active elicitation of the Venue Name con
                                         - 50 -

WO 2011/088053                                                      PCT/US2011/020861
straint of the Local Events domain; and "what is playing at the movie theater"
is an active elicitation of the Movie Theater Name constraint of the Local
Events domain. These examples illustrate that the suggested completions are
generatedby models rather than simply drawn from a database of previously
entered queries.
 [0146]     In Fig. 15, screen 1501 depicts a continuation of the same example,
after the user has entered additional text 1305 in field 1203. Suggested com
pletions 1303 are updated to match the additional text 1305. In this example,
 data from a domain entity database 1072 were used: venues whose name
 starts with "f". Note that this is a significantly smaller and more semantically
 relevant set of suggestions than all words that begin with "f". Again, the sug
 gestions are generated by applying a model, in this case the domain model
 that represents Local Events as happening at Venues, which are Businesses
 with Names. The suggestions actively elicit inputs that would make potentially
 meaningful entries when using a Local Events service.
 [0147]      In Fig. 16, screen 1601 depicts a continuation of the same example,
 after the user has selected one of suggested completions 1303. Active elicita
 tion continues by prompting the user to further specify the type of informa
 tion desired, here by presenting a number of specifiers 1602 from which the
 user can select. In this example, these specifiers are generated by the domain,
 task flow, and dialog flow models. The Domain is Local Events, which in
 cludes Categories of events that happen on Dates in Locations and have Event
 Names and Feature Performers. In this embodiment, the fact that these five
 options are offered to the user is generated from the Dialog Flow model that
 indicates that users should be asked for Constraints that they have not yet en
 tered and from the Service Model that indicates that these five Constraints are
 parameters to Local Event services available to the assistant. Even the choice
  of preferred phrases to use as specifiers, such as "by category" and "fea
  tured", are generated from the Domain Vocabulary databases.
                                           -51  -

WO 2011/088053                                                    PCT/US2011/020861
[0148]     In Fig. 17, screen 1701 depicts a continuation of the same example,
after the user has selected one of specifiers 1602.
[0149]     In Fig. 18, screen 1801 depicts a continuation of the same example,
wherein the selected specifier 1602 has been added to field 1203, and addi
tional specifiers 1602 are presented. The user can select one of specifiers 1602
and/or provide additional text input via keyboard 1304.
[0150]     In Fig. 19, screen 1901 depicts a continuation of the same example,
wherein the selected specifier 1602 has been added to field 1203, and yet more
specifiers 1602 are presented. In this example, previously entered constraints
are not actively elicited redundantly.
[0151]     In Fig. 20, screen 2001 depicts a continuation of the same example,
wherein the user has tapped the Go button 1306. The user's input is shown in
box 2002, and a message is shown in box 2003, providing feedback to the user
as to the query being performed in response to the user's input.
[0152]     In Fig. 21, screen 2101 depicts a continuation of the same example,
wherein results have been found. Message is shown in box 2102. Results
2103, including input elements allowing the user to view further details, save
the identified event, buy tickets, add notes, or the like.
[0153]     In one screen 2101, and other displayed screens, are scrollable, al
lowing the user to scroll upwards to see screen 2001 or other previously pre
sented screens, and to make changes to the query if desired.
Active Speech Input Elicitation
[0154]     Referring now to Fig. 22, there is shown a flow diagram depicting a
method for active input elicitation for voice or speech input according to one
embodiment.
[0155]     The method begins 221. Assistant 1002 receives 121 voice or speech
input in the form of an auditory signal. A speech-to-text service 122 or proc
essor generates a set of candidate text interpretations 124 of the auditory sig
nal. In one embodiment, speech-to-text service 122 is implemented using, for
                                        - 52 -

WO 2011/088053                                                    PCT/US2011/020861
example, Nuance Recognizer, available from Nuance Communications, Inc. of
Burlington, MA.
[0156]       In one embodiment, assistant 1002 employs statistical language
models to generate candidate text interpretations 124 of speech input 121.
[0157]       In addition, in one embodiment, the statistical language models are
tuned to look for words, names, and phrases that occur in the various models
of assistant 1002 shown in Fig. 8. For example, in at least one embodiment the
statistical language models are given words, names, and phrases from some
or all of: domain models 1056 (e.g., words and phrases relating to restaurant
and meal events), task flow models 1086 (e.g., words and phrases relating to
planning an event), dialog flow models 1087 (e.g., words and phrases related
to the constraints that are needed to gather the inputs for a restaurant reserva
tion), domain entity databases 1072 (e.g., names of restaurants), vocabulary
 databases 1058 (e.g., names of cuisines), service models 1088 (e.g., names of
 service provides such as OpenTable), and/or any words, names, or phrases
 associated with any node of active ontology 1050.
 [0158]      In one embodiment, the statistical language models are also tuned
 to look for words, names, and phrases from long-term personal memory 1054.
 For example, statistical language models can be given text from to-do items,
 list items, personal notes, calendar entries, people names in contacts/ address
 books, email addresses, street or city names mentioned in contact/address
 books, and the like.
 [0159]      A ranking component analyzes the candidate interpretations 124
 and ranks 126 them according to how well they fit syntactic and/or semantic
 models of intelligent automated assistant 1002. Any sources of constraints on
 user input may be used. For example, in one embodiment, assistant 1002 may
 rank the output of the speech-to-text interpreter according to how well the in
 terpretations parse in a syntactic and/or semantic sense, a domain model,
 task flow model, and/or dialog model, and/or the like: it evaluates how well
 various combinations of words in the text interpretations 124 would fit the
                                          -53-

WO 2011/088053                                                     PCT/US2011/020861
concepts, relations, entities, and properties of active ontology 1050 and its as
sociated models. For example, if speech-to-text service 122 generates the two
candidate interpretations "italian food for lunch" and "italian shoes for
lunch", the ranking by semantic relevance 126 might rank "italian food for
lunch" higher if it better matches the nodes assistant's 1002 active ontology
1050 (e.g., the words "italian", "food" and "lunch" all match nodes in ontol
ogy 1050 and they are all connected by relationships in ontology 1050,
whereas the word "shoes" does not match ontology 1050 or matches a node
that is not part of the dining out domain network).
[0160]      In various embodiments, algorithms or procedures used by assis
tant 1002 for interpretation of text inputs, including any embodiment of the
natural language processing procedure shown in Fig. 28, can be used to rank
and score candidate text interpretations 124 generated by speech-to-text ser
vice 122.
[0161]      In one embodiment, if ranking component 126 determines 128 that
the highest-ranking speech interpretation from interpretations 124 ranks
above a specified threshold, the highest-ranking interpretation may be auto
matically selected 130. If no interpretation ranks above a specified threshold,
possible candidate interpretations of speech 134 are presented 132 to the user.
The user can then select 136 among the displayed choices.
[0162]      In various embodiments, user selection 136 among the displayed
choices can be achieved by any mode of input, including for example any of
the modes of multimodal input described in connection with Fig. 16. Such
input modes include, without limitation, actively elicited typed input 2610,
     aciel licitedC spech inputf 262,                       T for
                                      acivelyA prese~nted GUI     inputi1 2640,)
and/or the like. In one embodiment, the user can select among candidate in
terpretations 134, for example by tapping or speaking. In the case of speak
ing, the possible interpretation of the new speech input is highly constrained
by the small set of choices offered 134. For example, if offered "Did you mean
italian food or italian shoes?" the user can just say "food" and the assistant
                                          - 54 -

WO 2011/088053                                                     PCT/US2011/020861
can match this to the phrase "italian food" and not get it confused with other
global interpretations of the input.
[0163]      Whether input is automatically selected 130 or selected 136 by the
user, the resulting input 138 is returned. In at least one embodiment, the re
turned input is annotated 138, so that information about which choices were
made in step 136 is preserved along with the textual input. This enables, for
example, the semantic concepts or entities underlying a string to be associated
 with the string when it is returned, which improves accuracy of subsequent
 language interpretation. For example, if "Italian food" was offered as one of
 the candidate interpretations 134 based on a semantic interpretation of Cui
 sine=ltalianFood,then the machine-readable semantic interpretation can be
 sent along with the user's selection of the string "Italian food" as annotated
 text input 138.
 [0164]      In at least one embodiment, candidate text interpretations 124 are
 generated based on speech interpretations received as output of speech-to
 text service 122.
 [0165]      In at least one embodiment, candidate text interpretations 124 are
 generated by paraphrasing speech interpretations in terms of their semantic
 meaning. In some embodiments, there can be multiple paraphrases of the
 same speech interpretation, offering different word sense or homonym alter
 natives. For example, if speech-to-text service 122 indicates "place for meet",
 the candidate interpretations presented to the user could be paraphrased as
  "place to meet (local businesses)" and "place for meat (restaurants)".
  [0166]     In at least one embodiment, candidate text interpretations 124 in
  clude offers to correct substrings.
  [0167]     In at least one embodiment, candidate text interpretations 124 in
  clude offers to correct substrings of candidate interpretations using syntactic
  and semantic analysis as described herein.
  [0168]     In at least one embodiment, when the user selects a candidate in
  terpretation, it is returned.
                                          - 55 -

WO 2011/088053                                                    PCT/US2011/020861
[0169]     In at least one embodiment, the user is offered an interface to edit
the interpretation before it is returned.
[0170]     In at least one embodiment, the user is offered an interface to con
tinue with more voice input before input is returned. This enables one to in
crementally build up an input utterance, getting syntactic and semantic cor
rections, suggestions, and guidance at one iteration.
[0171]     In at least one embodiment, the user is offered an interface to pro
ceed directly from 136 to step 111 of a method of active typed input elicitation
(described above in connection with Fig. 11). This enables one to interleave
typed and spoken input, getting syntactic and semantic corrections, sugges
tions, and guidance at one step.
[0172]     In at least one embodiment, the user is offered an interface to pro
ceed directly from step 111 of an embodiment of active typed input elicitation
to an embodiment of active speech input elicitation. This enables one to inter
leave typed and spoken input, getting syntactic and semantic corrections,
suggestions, and guidance at one step.
Active GUI-based Input Elicitation
[0173]     Referring now to Fig. 23, there is shown a flow diagram depicting a
method for active input elicitation for GUI-based input according to one em
bodiment.
[0174]     The method begins 140. Assistant 1002 presents 141 graphical user
interface (GUI) on output device 1207, which may include, for example, links
and buttons. The user interacts 142 with at least one GUI element. Data 144 is
received, and converted 146 to a uniform format. The converted data is then
returned.
[0175]     In at least one embodiment, some of the elements of the GUI are
generated dynamically from the models of the active ontology, rather than
written into a computer program. For example, assistant 1002 can offer a set
of constraints to guide a restaurant reservation service as regions for tapping
on a screen, with each region representing the name of the constraint and/or
                                        - 56 -

WO 2011/088053                                                    PCT/US2011/020861
a value. For instance, the screen could have rows of a dynamically generated
GUI layout with regions for the constraints Cuisine, Location, and Price
Range. If the models of the active ontology change, the GUI screen would
automatically change without reprogramming.
Active DialogSuggestion Input Elicitation
[0176]      Fig. 24 is a flow diagram depicting a method for active input elicita
tion at the level of a dialog flow according to one embodiment. Assistant 1002
suggests 151 possible responses 152. The user selects 154 a suggested re
sponse. The received input is converted 154 to a uniform format. The con
verted data is then returned.
[0177]      In at least one embodiment, the suggestions offered in step 151 are
offered as follow-up steps in a dialog and/or task flow.
[0178]      In at least one embodiment, the suggestions offer options to refine a
query, for example using parameters from a domain and/or task model. For
example, one may be offered to change the assumed location or time of a re
quest.
[0179]      In at least one embodiment, the suggestions offer options to choose
among ambiguous alternative interpretations given by a language interpreta
tion procedure or component.
 [0180]     In at least one embodiment, the suggestions offer options to choose
among ambiguous alternative interpretations given by a language interpreta
tion procedure or component.
 [0181]     In at least one embodiment, the suggestions offer options to choose
 among next steps in a workflow associated dialog flow model 1087. For ex
 ample, dialog flow model 1087 may suggest that after gathering the con
 strained for one domain (e.g., restaurant dining), assistant 1002 should sug
 gest other related domains (e.g., a movie nearby).
                                        - 57 -

WO 2011/088053                                                       PCT/US2011/020861
Active Monitoring for Relevant Events
[0182]      In at least one embodiment, asynchronous events may be treated as
inputs in an analogous manner to the other modalities of active elicited input.
Thus, such events may be provided as inputs to assistant 1002. Once inter
preted, such events can be treated in a manner similar to any other input.
[0183]      For example, a flight status change may initiate an alert notification
to be sent to a user. If a flight is indicated as being late, assistant 1002 may
continue the dialog by presenting alternative flights, making other sugges
tions, and the like, based on the detected event.
[0184]      Such events can be of any type. For example, assistant 1002 might
detect that the user just got home, or is lost (off a specified route), or that a
stock price hit a threshold value, or that a television show the user is inter
ested in is starting, or that a musician of interest is touring in the area. In any
of these situations, assistant 1002 can proceed with a dialog in substantially
the same manner as if the user had him- or herself initiated the inquiry. In
one embodiment, events can even be based on data provided from other de
vices, for example to tell the user when a coworker has returned from lunch
(the coworker's device can signal such an event to the user's device, at which
time assistant 1002 installed on the user's device responds accordingly).
[0185]      In one embodiment, the events can be notifications or alerts from a
calendar, clock, reminder, or to-do application. For example, an alert from a
calendar application about a dinner date can initiate a dialog with assistant
1002 about the dining event. The dialog can proceed as if the user had just
spoken or typed the information about the upcoming dinner event, such as
"Ainner frr 2 in San Franriso".
[0186]      In one embodiment, the context of possible event trigger 162 can
include information about people, places, times, and other data. These data
can be used as part of the input to assistant 1002 to use in various steps of
processing.
                                           - 58 -

WO 2011/088053                                                     PCT/US2011/020861
[0187]      In one embodiment, these data from the context of event trigger 162
can be used to disambiguate speech or text inputs from the user. For exam
ple, if a calendar event alert includes the name of a person invited to the
event, that information can help disambiguate input which might match sev
eral people with the same or similar name.
[0188]      Referring now to Fig. 25, there is shown a flow diagram depicting a
method for active monitoring for relevant events according to one embodi
ment. In this example, event trigger events are sets of input 162. Assistant
1002 monitors 161 for such events. Detected events may be filtered and sorted
164 for semantic relevance using models, data and information available from
other components in intelligent automated assistant 1002. For example, an
event that reports a change in flight status may be given higher relevance if
the short-term or long-term memory records for a user indicate that the user
is on that flight and/or have made inquiries about it to assistant 1002. This
sorting and filtering may then present only the top events for review by the
user, who may then choose to pick one or more and act on them.
[0189]      Event data is converted 166 to a uniform input format, and re
turned.
 [0190]     In at least one embodiment, assistant 1002 may proactively offer
services associated with events that were suggested for user attention. For ex
ample, if a flight status alert indicates a flight may be missed, assistant 1002
may suggest to the user a task flow for re-planning the itinerary or booking a
hotel.
 Input ElicitationComponent(s) Example:
 [0191]     The following example is intended to help illustrate some of the
 various types of functions, operations, actions, and/or other features which
 may be provided by active input elicitation component(s) 1094.
 Example: Command completion (what can the user say to assistant 1002?)
 [0192]     The user is facing a text input box with the general instruction to
 enter "what do you want to do?" Depending on the context and the user in
                                          - 59 -

WO 2011/088053                                                   PCT/US2011/020861
put, any of several system responses are provided. Examples are shown be
low
Case: Null input
User Input                 System Response                        Comment
With an empty field        o Find restaurants, hotels, movies,    Black text would be
and no dialog context,     ...                                    inserted into the in
type a question or         o Book a table, a room, a seat,  ...   put field. Italicized
space character, or en-    o Order food, flowers, ...             text would be the
ter nothing for some       e   Buy a ticket, a book, a DVD,  ...  follow-up sugges
period of time.            o Schedule a meeting, an event,...     tions once the text
                           o Remember to a thing to do...         was inserted.
                           o Explain results
Case: First word input
User Input                 System Response                        Comment
With empty dialog          o Find restaurants, hotels, movies,    Black text would be
context If the user        ...                                    inserted into the in
types the first letter of  *                                      put field. Italicized
any command, it is                                                text would be the
suggested. For exam-                                              follow-up sugges
ple                                                               tions once the text
         F|                                                       was inserted.
 Case: Key word input
User Input                System Response                          Comment
 With empty dialog        o _Remember to a thing to do...          Black text would be
 context If the user      o Find restaurants by location, cui- inserted into the in
 types the first two let- sine,                                    put field. Italicized
 ters of any keyword, it o                                         text would be the
                                         - 60 -

WO 2011/088053                                                        PCT/US2011/020861
is suggested as well as                                                  follow-up sugges
command. For exam-                                                       tions once the text
ple                                                                      was inserted.
       Rel
Case: Prompting for arguments
User Input                System Response                               Comment
The user has entered or   e     restaurants by location, cuisine, Offer not only the
selected a "command"      ...                                           selection class but
verb and nothing else.    e     hotels by location, availability, ...   advertise the con
For example,              e     movies by location, genre,  ...         straint options. Note
       Find -                   name of place                           that name of place is
                                                                        a just a prompt, and
                                                                        would not insert
                                                                        text.
Case: Suggesting criteria
User Input                   System Response                          Comment
The user has already en-      e   in city, zip code                   Black text would be
tered enough to establish     e   near home, office, place name       inserted into the input
a task and domain, and        e   named restaurant name               field. Italicized text
now is prompted for           .                                       would be the follow
constraints in order.                                                 up suggestions once
Find restaurants I                                                    the text was inserted.
Case: Adding criteria
User Input                            System Response         Comment
The user has said "in" and now        e city, zip code        Until they enter the next
is prompted for locations             * Palo Alto, CA         word, the suggestions are a
                                           - 61 -

WO 2011/088053                                                        PCT/US2011/020861
Find restaurants ind                    Menlo Park, CA        prompt for what kind of
                                                              thing to type. The Places are
                                                              cities from personal mem
                                                              ory.
The user has said "near" and          e my home               The Places are one or more
now is prompted for locations         e my work               places from personal mem
        Find restaurants near_        o Palo Alto, CA         ory.
                                      e Menlo Park, CA
Case: Adding location or other constraints
User Input                System Response                         Comment
Find restaurants in        * serving food type or cuisine         Prompt for other
Palo Alto_                 e with availability tonight, to-       constraints
                          morrow, ...
                           * described as romantic, good
                          service
Find restaurants in        * tonight                              The 7:00 and 9:00
Palo Alto with avail-      e tomorrow                             are our sugges
 ability_|                 e at 7pm                               tions based on cur
                           * at 9pm                               rent time
                           * other time or date
 Case: Starting from constraint, unknown task or domain
 User Input       System Response                        Comment
 romantic  _          restaurants by location, cui-      Constraint value from on
                   sine, ...                             tology tells you which se
                   e hotels by location, availabil-      lection classes to use.
                   ity, ...
                   * movies by location, genre,    ...
                                          - 62 -

WO 2011/088053                                                    PCT/US2011/020861
comedy_           e movies by location, genre,   ...   "comedy" is a constraint
                  * events by location,   ...          value for genre in movies,
                  e clubs by location                  a genre in events, and
                                                       "comedy clubs" is a local
                                                       directory business cate
                                                       gory
Example: Name completion
 [0193]    Here, the user has typed some text without accepting any of the
commands, or he or she is just extending a command with an entity name.
The system may attempt to complete the names, depending on context. It
 also disambiguates the domain.
 Case: words without context
 User Input       System Response               Comment
 il for           9 Il Fornaio (restaurant)     May require entity name
                  * Ill Forgotten Gains         lookup. Notice multi-word
                  (movie)                       completion. Show domain as a
                                                suggestion.
 tom cruise       e movies                      May require entity name
                                                lookup.
 romantic         a movies                      Based on ontology only
                  e restaurants
 Case: name with context
 User Input          System Response             Comment
 Find restaurants    e  Il Fornaio (restaurant) May require entity name
 il for              e                           lookup. Uses selection class
                                                 and location context from cur
                                                 rent and past queries to con
                                         -63-

WO 2011/088053                                                    PCT/US2011/020861
                                                  strain completion. Show do
                                                  main as a suggestion.
tom cruise            e   movies                  May require entity name
                                                  lookup.
Find movies rom       e romantic                  Based on ontology only
                      e   Roman Holiday
                      (movie)
g-rated               0 movies
Example: Choosing values from a set
[0194]      Here, the user is responding to a system request to enter a value for
a specific parameter, such as location, time, cuisine, or genre. The user may
either select from a list or enter a value. As she types, matching items from
the list are shown as options. Examples are shown below.
Case: valueclass selection
User Input              System Response        Comment
Restaurants serv-       * burgers              User may type anything else and doesn't
ing                     o Ice cream            have to pick from the menu.
                        * Hot dogs
Restaurants serv-       e  Hamburgers
ing h                   e  Hot dogs
                        e Hot sauce
Movies playing          *  today
                        * tonight
                        __Friday   night
Example: Reusing previous commands
[0195]      Previous queries are also options to complete on in an autocomplete
interface. They may be just matched as strings (when the input field is empty
                                          -64-

WO 2011/088053                                                   PCT/US2011/020861
and there are no known constraints) or they may be suggested as relevant
when in certain situations.
Case: completion on previous queries
User Input       System Response                        Comment
Ital             a Italian restaurants (normal com-     Using string matching
                 pletion)                               to retrieve previous
                 @ Films starring Italian actors (re-   queries
                 cent query)
Lunch            e lunch places in marin (recent
                 query)
                 e  buy the book naked lunch
 Example: Retrieving Personal Memory items
 [0196]    Assistant 1002 may remember certain events and/or entities in per
 sonal memory associated with the user. Autocomplete can be performed
 based on such remembered items. Examples appear below.
 Case: completion on events and entities in personal memory
 User Input        System Response                                    Comment
 Mary              * lunch with Mary on Saturday (from My
                   Events)
                   * films called "Something about Mary"
 Lunch             * lunch with Mary on Saturday (from My
                   Events)
                   * buy the book naked lunch (from My Todos)
 Hob               e Hobee's Restaurant in Palo Alto (from My
                   Restaurants)
                                        - 65 -

WO 2011/088053                                                    PCT/US2011/020861
Multimodal Active Input Elicitation
 [0197]    In at least one embodiment, active input elicitation component(s)
1094 may process input from a plurality of input modalities. At least one mo
dality might be implemented with an active input elicitation procedure that
takes advantages of the particular kinds of inputs and methods for selecting
from suggested options. A described herein, they may be embodiments of
procedures for active input elicitation for text input, speech input, GUI-based
input, input in the context of a dialog, and/or input resulting from event trig
gers.
[0198]     In at least one embodiment, for a single instance of intelligent auto
mated assistant 1002, there may be support for one or more (or any combina
tion of) typed input, speech input, GUI input, dialog input, and/or event in
put.
[0199]     Referring now to Fig. 26, there is shown a flow diagram depicting a
method for multimodal active input elicitation according to one embodiment.
The method begins 100. Inputs may be received concurrently from one or
more or any combination of the input modalities, in any sequence. Thus, the
method includes actively eliciting typed input 2610, speech input 2620, GUI
based input 2640, input in the context of a dialog 2650, and/or input resulting
from event triggers 2660. Any or all of these input sources are unified into
unified input format 2690 and returned. Unified input format 2690 enables
the other components of intelligent automated assistant 1002 to be designed
and to operate independently of the particular modality of the input.
[0200]     Offering active guidance for multiple modalities and levels enables
constraint and guidance on the input beyond those available to isolated mo
dalities. For example, the kinds of suggestions offered to choose among
speech, text, and dialog steps are independent, so their combination is a sig
nificant improvement over adding active elicitation techniques to individual
modalities or levels.
                                        - 66 -

WO 2011/088053                                                     PCT/US2011/020861
[0201]     Combining multiple sources of constraints as described herein (syn
tactic/linguistic, vocabulary, entity databases, domain models, task models,
service models, and the like) and multiple places where these constraints may
be actively applied (speech, text, GUI, dialog, and asynchronous events) pro
vides a new level of functionality for human-machine interaction.
Domain Models Component(s) 1056
[0202]     Domain models 1056 component(s) include representations of the
concepts, entities, relations, properties, and instances of a domain. For exam
ple, dining out domain model 1622 might include the concept of a restaurant
as a business with a name and an address and phone number, the concept of a
meal event with a party size and date and time associated with the restaurant.
[0203]     In at least one embodiment, domain models component(s) 1056 of
assistant 1002 may be operable to perform and/or implement various types of
functions, operations, actions, and/or other features such as, for example, one
or more of the following (or combinations thereof):
        " Domain model component(s) 1056 may be used by automated assis
           tant 1002 for several processes, including: eliciting input 100, inter
           preting natural language 200, dispatching to services 400, and gen
           erating output 600.
        *  Domain model component(s) 1056 may provide lists of words that
           might match a domain concept or entity, such as names of restau
           rants, which may be used for active elicitation of input 100 and
           natural language processing 200.
        " Domain model component(s) 1056 may classify candidate words in
           processes, for instance, to determine that a word is the name of a
           restaurant.
        " Domain model component(s) 1056 may show the relationship be
           tween partial information for interpreting natural language, for ex
           ample that cuisine may be associated with business entities (e.g.,
                                         -67-

WO 2011/088053                                                    PCT/US2011/020861
           "local Mexican food" may be interpreted as "find restaurants with
           style = Mexican", and this inference is possible because of the in
           formation in domain model 1056).
        e Domain model component(s) 1056 may organize information about
           services used in service orchestration 1082, for example, that a par
           ticular web service may provide reviews of restaurants.
        0 Domain model component(s) 1056 may provide the information for
           generating natural language paraphrases and other output format
           ting, for example, by providing canonical ways of describing con
           cepts, relations, properties and instances.
[0204]     According to specific embodiments, multiple instances or threads of
the domain models component(s) 1056 may be concurrently implemented
and/or initiated via the use of one or more processors 63 and/or other com
binations of hardware and/or hardware and software. For example, in at
least some embodiments, various aspects, features, and/or functionalities of
domain models component(s) 1056 may be performed, implemented and/or
initiated by one or more of the following types of systems, components, sys
tems, devices, procedures, processes, and the like (or combinations thereof):
        * Domain models component(s) 1056 may be implemented as data
           structures that represent concepts, relations, properties, and in
           stances. These data structures may be stored in memory, files, or
           databases.
        " Access to domain model component(s) 1056 may be implemented
           through direct APIs, network APIs, database query interfaces,
           andu/or heLILlie.
        " Creation and maintenance of domain models component(s) 1056
           may be achieved, for example, via direct editing of files, database
           transactions, and/or through the use of domain model editing
           tools.
                                         - 68 -

WO 2011/088053                                                     PCT/US2011/020861
         e  Domain models component(s) 1056 may be implemented as part of
            or in association with active ontologies 1050, which combine mod
            els with instantiations of the models for servers and users.
 [0205]     According to various embodiments, one or more different threads
 or instances of domain models component(s) 1056 may be initiated in re
 sponse to detection of one or more conditions or events satisfying one or more
 different types of minimum threshold criteria for triggering initiation of at
 least one instance of domain models component(s) 1056. For example, trigger
 initiation and/or implementation of one or more different threads or in
 stances of domain models component(s) 1056 may be triggered when domain
 model information is required, including during input elicitation, input inter
 pretation, task and domain identification, natural language processing, ser
 vice orchestration, and/or formatting output for users.
 [0206]     In at least one embodiment, a given instance of domain models
 component(s) 1056 may access and/or utilize information from one or more
 associated databases. In at least one embodiment, at least a portion of the da
 tabase information may be accessed via communication with one or more lo
 cal and/or remote memory devices. For example, data from domain model
 component(s) 1056 may be associated with other model modeling compo
 nents including vocabulary 1058, language pattern recognizers 1060, dialog
 flow models 1087, task flow models 1086, service capability models 1088, do
 main entity databases 1072, and the like. For example, businesses in domain
  entity databases 1072 that are classified as restaurants might be known by
  type identifiers which are maintained in the dining out domain model com
  ponents.
  Domain Models Component(s) Example:
  [0207]     Referring now to Fig. 27, there is shown a set of screen shots illus
  trating an example of various types of functions, operations, actions, and/or
  other features which may be provided by domain models component(s) 1056
  according to one embodiment.
                                          - 69 -

WO 2011/088053                                                          PCT/US2011/020861
[0208]     In at least one embodiment, domain models component(s) 1056 are
the unifying data representation that enables the presentation of information
shown in screens 103A and 103B about a restaurant, which combines data
from several distinct data sources and services and which includes, for exam
ple: name, address, business categories, phone number, identifier for saving
to long term personal memory, identifier for sharing over email, reviews from
multiple sources, map coordinates, personal notes, and the like.
 Language Interpreter Component(s) 1070
[0209]     In at least one embodiment, language interpreter component(s)
1070 of assistant 1002 may be operable to perform and/or implement various
types of functions, operations, actions, and/or other features such as, for ex
ample, one or more of the following (or combinations thereof):
           Analyze user input and identify a set of parse results.
               o User input can include any information from the user and
                   his/her device context that can contribute to understanding
                   the user's intent, which can include, for example one or more
                   of the following (or combinations thereof): sequences of
                   words, the identity of gestures or GUI elements involved in
                   eliciting the input, current context of the dialog, current de
                   vice application and its current data objects, and/or any
                   other personal dynamic data obtained about the user such as
                   location, time, and the like. For example, in one embodi
                   ment, user input is in the form of the uniform annotated in
                     ut f-rmt   2691100 resulin       fr om ctiv i p elicitton  194L .
               o Parse results are associations of data in the user input with
                   concerts. relationships, properties, instances, and/or other
                   nodes and/or data structures in models, databases, and/or
                   other representations of user intent and/context. Parse re
                   sult associations can be complex mappings from sets and se
                                                - 70 -

WO 2011/088053                                                    PCT/US2011/020861
                   quences of words, signals, and other elements of user input
                   to one or more associated concepts, relations, properties, in
                   stances, other nodes, and/or data structures described
                   herein.
       -   Analyze user input and identify a set of syntactic parse results,
           which are parse results that associate data in the user input with
           structures that represent syntactic parts of speech, clauses and
           phrases including multiword names, sentence structure, and/or
           other grammatical graph structures. Syntactic parse results are de
           scribed in element 212 of natural language processing procedure
           described in connection with Fig. 28.
       " Analyze user input and identify a set of semantic parse results,
           which are parse results that associate data in the user input with
           structures that represent concepts, relationships, properties, enti
           ties, quantities, propositions, and/or other representations of mean
           ing and user intent. In one embodiment, these representations of
           meaning and intent are represented by sets of and/or elements of
           and/or instances of models or databases and/or nodes in ontolo
           gies, as described in element 220 of natural language processing
           procedure described in connection with Fig. 28.
        " Disambiguate among alternative syntactic or semantic parse results
           as described in element 230 of natural language processing proce
           dure described in connection with Fig. 28.
        " Determine whether a partially typed input is syntactically and/or
           semantically meaningful in an autocomplete procedure such as one
           described in connection with Fig. 11.
        " Help generate suggested completions 114 in an autocomplete pro
           cedure such as one described in connection with Fig. 11.
                                          -71 -

WO 2011/088053                                                      PCT/US2011/020861
        e  Determine whether interpretations of spoken input are syntactically
           and/or semantically meaningful in a speech input procedure such
           as one described in connection with Fig. 22.
[02101     According to specific embodiments, multiple instances or threads of
language interpreter component(s) 1070 may be concurrently implemented
and/or initiated via the use of one or more processors 63 and/or other com
binations of hardware and/or hardware and software.
[0211]     According to different embodiments, one or more different threads
or instances of language interpreter component(s) 1070 may be initiated in re
sponse to detection of one or more conditions or events satisfying one or more
different types of minimum threshold criteria for triggering initiation of at
least one instance of language interpreter component(s) 1070. Various exam
ples of conditions or events which may trigger initiation and/or implementa
tion of one or more different threads or instances of language interpreter
component(s) 1070 may include, but are not limited to, one or more of the fol
lowing (or combinations thereof):
        e  while eliciting input, including but not limited to
                o Suggesting possible completions of typed input 114 (Fig. 11);
                o Ranking interpretations of speech 126 (Fig. 22);
                o When offering ambiguities as suggested responses in dialog
                      152 (Fig. 24);
        * when the result of eliciting input is available, including when input
           is elicited by any mode of active multimodal input elicitation 100.
[0212]     In at least one embodiment, a given instance of language interpreter
component (UsU1) 1'7/  Vmay access   anL/for uti1Lze IILILatLin 1U11 one or 11r
associated databases. In at least one embodiment, at least a portion of such
database information may be accessed via communication with one or more
local and/or remote memory devices. Examples of different types of data
which may be accessed by the Language Interpreter component(s) may in
                                            -72-

WO 2011/088053                                                    PCT/US2011/020861
clude, but are not limited to, one or more of the following (or combinations
thereof):
         * Domain models 1056;
         " Vocabulary 1058;
         " Domain entity databases 1072;
         " Short term memory 1052;
         " Long term personal memory 1054;
         " Task flow models 1086;
         e  Dialog flow models 1087;
         * Service capability models 1088.
 [0213]     Referring now also to Fig. 29, there is shown a screen shot illustrat
 ing natural language processing according to one embodiment. The user has
 entered (via voice or text) language input 2902 consisting of the phrase "who
 is playing this weekend at the filmore". This phrase is echoed back to the user
 on screen 2901. Language interpreter component(s) 1070 component process
 input 2902 and generates a parse result. The parse result associates that input
 with a request to show the local events that are scheduled for any of the up
 coming weekend days at any event venue whose name matches "filmore". A
 paraphrase of the parse results is shown as 2903 on screen 2901.
 [0214]     Referring now also to Fig. 28, there is shown a flow diagram depict
 ing an example of a method for natural language processing according to one
 embodiment.
 [0215]      The method begins 200. Language input 202 is received, such as the
 string "who is playing this weekend at the filmore" in the example of Fig. 29.
 In one embodiment, the input is augmented by current context information,
 such as the current user location and local time. In word/phrase matching
 210, language interpreter component(s) 1070 find associations between user
  input and concepts. In this example, associations are found between the
  string "playing" and the concept of listings at event venues; the string "this
  weekend" (along with the current local time of the user) and an instantiation
                                         -73-

WO 2011/088053                                                  PCT/US2011/020861
of an approximate time period that represents the upcoming weekend; and
the string "filmore" with the name of a venue. Word/phrase matching 210
may use data from, for example, language pattern recognizers 1060, vocabu
lary database 1058, active ontology 1050, short term personal memory 1052,
and long term personal memory 1054.
[0216]     Language interpreter component(s) 1070 generate candidate syntac
tic parses 212 which include the chosen parse result but may also include
other parse results. For example, other parse results may include those
wherein "playing" is associated with other domains such as games or with a
category of event such as sporting events.
[0217]     Short- and/or long-term memory 1052, 1054 can also be used by
language interpreter component(s) 1070 in generating candidate syntactic
parses 212. Thus, input that was provided previously in the same session,
and/or known information about the user, can be used, to improve perform
ance, reduce ambiguity, and reinforce the conversational nature of the interac
tion. Data from active ontology 1050, domain models 1056, and task flow
models 1086 can also be used, to implement evidential reasoning in determin
ing valid candidate syntactic parses 212.
[0218]     In semantic matching 220, language interpreter component(s) 1070
consider combinations of possible parse results according to how well they fit
semantic models such as domain models and databases. In this case, the
parse includes the associations (1) "playing" (a word in the user input) as "Lo
cal Event At Venue" (part of a domain model 1056 represented by a cluster of
nodes in active ontology 1050) and (2) "filmore" (another word in the input)
as a match to an entity name in a domain enti-T database 1072 for Local Event
Venues, which is represented by a domain model element and active ontology
node (Venue Name).
[0219]     Semantic matching 220 may use data from, for example, active on
tology 1050, short term personal memory 1052, and long term personal mem
ory 1054. For example, semantic matching 220 may use data from previous
                                        -74-

WO 2011/088053                                                    PCT/US2011/020861
references to venues or local events in the dialog (from short term personal
memory 1052) or personal favorite venues (from long term personal memory
1054).
[0220]      A set of candidate, or potential, semantic parse results is generated
222.
 [0221]     In disambiguation step 230, language interpreter component(s) 1070
weigh the evidential strength of candidate semantic parse results 222. In this
example, the combination of the parse of "playing" as "Local Event At Venue"
 and the match of "filmore" as a Venue Name is a stronger match to a domain
 model than alternative combinations where, for instance, "playing" is associ
 ated with a domain model for sports but there is no association in the sports
 domain for "filmore".
 [0222]     Disambiguation 230 may use data from, for example, the structure
 of active ontology 1050. In at least one embodiment, the connections between
 nodes in an active ontology provide evidential support for disambiguating
 among candidate semantic parse results 222. For example, in one embodi
 ment, if three active ontology nodes are semantically matched and are all con
 nected in active ontology 1050, this indicates higher evidential strength of the
 semantic parse than if these matching nodes were not connected or connected
 by longer paths of connections in active ontology 1050. For example, in one
 embodiment of semantic matching 220, the parse that matches both Local
 Event At Venue and Venue Name is given increased evidential support because
 the combined representations of these aspects of the user intent are connected
 by links and/or relations in active ontology 1050: in this instance, the Local
  Event node is connected to the Venue node which is connected to the Venue
  Name node which is connected to the entity name in the database of venue
  names.
  [0223]    In at least one embodiment, the connections between nodes in an
  active ontology that provide evidential support for disambiguating among
  candidate semantic parse results 222 are directed arcs, forming an inference
                                          -75  -

WO 2011/088053                                                                              PCT/US2011/020861
lattice, in which matching nodes provide evidence for nodes to which they are
connected by directed arcs.
[0224]      In 232, language interpreter component(s) 1070 sort and select 232
the top semantic parses as the representation of user intent 290.
Domain Entity Database(s) 1072
[0225]      In at least one embodiment, domain entity database(s) 1072 may be
operable to perform and/or implement various types of functions, operations,
actions, and/or other features such as, for example, one or more of the follow
ing (or combinations thereof):
         * Store data about domain entities. Domain entities are things in the
            world or computing environment that may be modeled in domain
            models. Examples may include, but are not limited to, one or more
            of the following (or combinations thereof):
                  o Businesses of any kind;
                  o Movies, videos, songs and/or other musical products,
                        and/or any other named entertainment products;
                  o Products of any kind;
                  o Events;
                  o Calendar entries;
                  o Cities, states, countries, neighborhoods, and/or other geo
                        graphic, geopolitical, and/or geospatial points or regions;
                  o Named places such as landmarks, airports, and the like;
         e  Provide database services on these databases, including but not lim
            i4-d     t simp       an    m   plex  qries,         rasacin,            t-rigged
                                                                                     4-,          ets
            ILtA.  LW.. 0--~ij-i.  LAi1   ILVi.l~         ~~
                                                        --.   , LI   L    LOCL I~LO,
                                                                               W      LLIbb.l     LVV.tA.
                                                                                                       LLD
            and the like.
 [02261     According to specific embodiments, multiple instances or threads of
 domain entity database(s) 1072 may be concurrently implemented and/or ini
 tiated via the use of one or more processors 63 and/or other combinations of
 hardware and/or hardware and software. For example, in at least some em
                                                   -76      -

WO 2011/088053                                                     PCT/US2011/020861
bodiments, various aspects, features, and/or functionalities of domain entity
database(s) 1072 may be performed, implemented and/or initiated by data
base software and/or hardware residing on client(s) 1304 and/or on server(s)
1340.
[0227]       One example of a domain entity database 1072 that can be used in
connection with the present invention according to one embodiment is a da
tabase of one or more businesses storing, for example, their names and loca
tions. The database might be used, for example, to look up words contained
in an input request for matching businesses and/or to look up the location of
 a business whose name is known. One skilled in the art will recognize that
 many other arrangements and implementations are possible.
 Vocabulary Component(s) 1058
 [0228]      In at least one embodiment, vocabulary component(s) 1058 may be
 operable to perform and/or implement various types of functions, operations,
 actions, and/or other features such as, for example, one or more of the follow
 ing (or combinations thereof):
         " Provide databases associating words and strings with concepts,
             properties, relations, or instances of domain models or task models;
         " Vocabulary from vocabulary components may be used by auto
             mated assistant 1002 for several processes, including for example:
             eliciting input, interpreting natural language, and generating out
             put.
  [0229]     According to specific embodiments, multiple instances or threads of
 vocabulary component(s) 1058 may be concurrently implemented and/or ini
  tiated via the use of one or more processors 63 and/or other combinations of
  hardware and/or hardware and software. For example, in at least some em
  bodiments, various aspects, features, and/or functionalities of vocabulary
  component(s) 1058 may be implemented as data structures that associate
  strings with the names of concepts, relations, properties, and instances. These
                                            -77-

WO 2011/088053                                                   PCT/US2011/020861
data structures may be stored in memory, files, or databases. Access to vo
cabulary component(s) 1058 may be implemented through direct APIs, net
work APIs, and/or database query interfaces. Creation and maintenance of
vocabulary component(s) 1058 may be achieved via direct editing of files, da
tabase transactions, or through the use of domain model editing tools. Vo
cabulary component(s) 1058 may be implemented as part of or in association
with active ontologies 1050. One skilled in the art will recognize that many
other arrangements and implementations are possible.
[0230]     According to different embodiments, one or more different threads
or instances of vocabulary component(s) 1058 may be initiated in response to
detection of one or more conditions or events satisfying one or more different
types of minimum threshold criteria for triggering initiation of at least one in
stance of vocabulary component(s) 1058. In one embodiment, vocabulary
component(s) 1058 are accessed whenever vocabulary information is re
quired, including, for example, during input elicitation, input interpretation,
and formatting output for users. One skilled in the art will recognize that
other conditions or events may trigger initiation and/or implementation of
one or more different threads or instances of vocabulary component(s) 1058.
           T   -',%          11
[U23 j     In at least one enbodiment, a given instance of vocabulary compo
nent(s) 1058 may access and/or utilize information from one or more associ
ated databases. In at least one embodiment, at least a portion of the database
information may be accessed via communication with one or more local
and/or remote memory devices. In one embodiment, vocabulary compo
nent(s) 1058 may access data from external databases, for instance, from a
data warehouse or dictionary.
Language Pattern Recognizer Component(s) 1060
[0232]     In at least one embodiment, language pattern recognizer compo
nent(s) 1060 may be operable to perform and/or implement various types of
functions, operations, actions, and/or other features such as, for example,
                                       - 78 -

WO 2011/088053                                                     PCT/US2011/020861
looking for patterns in language or speech input that indicate grammatical,
idiomatic, and/or other composites of input tokens. These patterns corre
spond to, for example, one or more of the following (or combinations thereof):
words, names, phrases, data, parameters, commands, and/or signals of
speech acts.
[0233]      According to specific embodiments, multiple instances or threads of
pattern recognizer component(s) 1060 may be concurrently implemented
and/or initiated via the use of one or more processors 63 and/or other com
binations of hardware and/or hardware and software. For example, in at
least some embodiments, various aspects, features, and/or functionalities of
language pattern recognizer component(s) 1060 may be performed, imple
mented and/or initiated by one or more files, databases, and/or programs
containing expressions in a pattern matching language. In at least one em
bodiment, language pattern recognizer component(s) 1060 are represented
 declaratively, rather than as program code; this enables them to be created
 and maintained by editors and other tools other than programming tools. Ex
 amples of declarative representations may include, but are not limited to, one
 or more of the following (or combinations thereof): regular expressions, pat
 tern matching rules, natural language grammars, parsers based on state ma
 chines and/or other parsing models.
 [0234]     One skilled in the art will recognize that other types of systems,
 components, systems, devices, procedures, processes, and the like (or combi
 nations thereof) can be used for implementing language pattern recognizer
 component(s) 1060.
 [0235]     According to different embodiments, one or more different threads
 or instances of language pattern recognizer component(s) 1060 may be initi
 ated in response to detection of one or more conditions or events satisfying
 one or more different types of minimum threshold criteria for triggering ini
 tiation of at least one instance of language pattern recognizer component(s)
 1060. Various examples of conditions or events which may trigger initiation
                                          - 79 -

WO 2011/088053                                                    PCT/US2011/020861
and/or implementation of one or more different threads or instances of lan
guage pattern recognizer component(s) 1060 may include, but are not limited
to, one or more of the following (or combinations thereof):
        e  during active elicitation of input, in which the structure of the lan
           guage pattern recognizers may constrain and guide the input from
           the user;
        "  during natural language processing, in which the language pattern
           recognizers help interpret input as language;
        * during the identification of tasks and dialogs, in which the lan
           guage pattern recognizers may help identify tasks, dialogs, and/or
           steps therein.
[0236]     In at least one embodiment, a given instance of language pattern
recognizer component(s) 1060 may access and/or utilize information from
one or more associated databases. In at least one embodiment, at least a por
tion of the database information may be accessed via communication with
one or more local and/or remote memory devices. Examples of different
types of data which may be accessed by language pattern recognizer compo
nent(s) 1060 may include, but are not limited to, data from any of the models
various models and data sources that may be part of embodiments of assis
tant 1002, which may include, but are not limited to, one or more of the fol
lowing (or combinations thereof):
        e Domain models 1056;
        e  Vocabulary 1058;
        " Domain entity databases 1072;
        " Short term memory 1052;
        " Long term personal memory 1054;
        " Task flow models 1086;
        " Dialog flow models 1087;
        " Service capability models 1088.
                                         - 80 -

WO 2011/088053                                                    PCT/US2011/020861
[0237]      In one embodiment, access of data from other parts of embodiments
of assistant 1002 may be coordinated by active ontologies 1050.
[0238]      Referring again to Fig. 14, there is shown an example of some of the
various types of functions, operations, actions, and/or other features which
may be provided by language pattern recognizer component(s) 1060. Fig. 14
illustrates language patterns that language pattern recognizer component(s)
1060 may recognize. For example, the idiom "what is happening" (in a city)
may be associated with the task of event planning and the domain of local
events.
 Dialog Flow Processor Component(s) 1080
 [0239]     In at least one embodiment, dialog flow processor component(s)
1080 may be operable to perform and/or implement various types of func
tions, operations, actions, and/or other features such as, for example, one or
more of the following (or combinations thereof):
        e   Given a representation of the user intent 290 from language inter
            pretation 200, identify the task a user wants performed and/or a
            problem the user wants solved. For example, a task might be to
            find a restaurant.
        " For a given problem or task, given a representation of user intent
            290, identify parameters to the task or problem. For example, the
            user might be looking for a recommended restaurant that serves
            Italian food near the user's home. The constraints that a restaurant
            be recommended, serving Italian food, and near home are parame
            ters to the task of finding a restaurant.
        " Given the task interpretation and current dialog with the user, such
            as that which may be represented in personal short term memory
            1052, select an appropriate dialog flow model and determine a step
            in the flow model corresponding to the current state.
                                           - 81 -

WO 2011/088053                                                   PCT/US2011/020861
[0240]     According to specific embodiments, multiple instances or threads of
dialog flow processor component(s) 1080 may be concurrently implemented
and/or initiated via the use of one or more processors 63 and/or other com
binations of hardware and/or hardware and software.
[0241]     In at least one embodiment, a given instance of dialog flow proces
sor component(s) 1080 may access and/or utilize information from one or
more associated databases. In at least one embodiment, at least a portion of
the database information may be accessed via communication with one or
more local and/or remote memory devices. Examples of different types of
data which may be accessed by dialog flow processor component(s) 1080 may
include, but are not limited to, one or more of the following (or combinations
thereof):
       e   task flow models 1086;
       * domain models 1056;
       e   dialog flow models 1087.
[0242]     Referring now to Figs. 30 and 31, there are shown screen shots illus
trating an example of various types of functions, operations, actions, and/or
other features which may be provided by dialog flow processor component(s)
according to one embodiment.
[0243]     As shown in screen 3001, user requests a dinner reservation by pro
viding speech or text input "book me a table for dinner". Assistant 1002 gen
erates a prompt 3003 asking the user to specify time and party size.
[0244]     Once these parameters have been provided, screen 3101 is shown.
Assistant 1002 outputs a dialog box 3102 indicating that results are being pre
sented, and a prompt 3103 asking the user to click a time. Listings 3104 are
also displayed.
[0245]     In one embodiment, such a dialog is implemented as follows. Dia
log flow processor component(s) 1080 are given a representation of user intent
from language interpreter component 1070 and determine that the appropri
ate response is to ask the user for information required to perform the next
                                         -82-

WO 2011/088053                                                     PCT/US2011/020861
step in a task flow. In this case, the domain is restaurants, the task is getting a
reservation, and the dialog step is to ask the user for information required to
accomplish the next step in the task flow. This dialog step is exemplified by
prompt 3003 of screen 3001.
[0246]      Referring now also to Fig. 32, there is shown a flow diagram depict
ing a method of operation for dialog flow processor component(s) 1080 ac
cording to one embodiment. The flow diagram of Fig. 32 is described in con
nection with the example shown in Figs. 30 and 31.
[0247]      The method begins 200. Representation of user intent 290 is re
ceived. As described in connection with Fig. 28, in one embodiment, repre
sentation of user intent 290 is a set of semantic parses. For the example shown
in Figs. 30 and 31, the domain is restaurants, the verb is "book" associated
with restaurant reservations, and the time parameter is the evening of the cur
rent day.
[0248]      In 310, dialog flow processor component(s) 1080 determine whether
this interpretation of user intent is supported strongly enough to proceed,
and/or if it is better supported than alternative ambiguous parses. In the cur
rent example, the interpretation is strongly supported, with no competing
ambiguous parses. If, on the other hand, there are competing ambiguities or
sufficient uncertainty, then step 322 is performed, to set the dialog flow step
 so that the execution phase causes the dialog to output a prompt for more in
formation from the user.
 [0249]     In 312, the dialog flow processor component(s) 1080 determine the
 preferred interpretation of the semantic parse with other information to de
 termine the task to perform and its parameters. Information may be ob
 tained, for example, from domain models 1056, task flow models 1086,
 and/or dialog flow models 1087, or any combination thereof. In the current
 example, the task is identified as getting a reservation, which involves both
 finding a place that is reservable and available, and effecting a transaction to
                                          -83 -

WO 2011/088053                                                     PCT/US2011/020861
reserve a table. Task parameters are the time constraint along with others that
are inferred in step 312.
[0250]      In 320, the task flow model is consulted to determine an appropri
ate next step. Information may be obtained, for example, from domain models
1056, task flow models 1086, and/or dialog flow models 1087, or any combi
nation thereof. In the example, it is determined that in this task flow the next
step is to elicit missing parameters to an availability search for restaurants,
resulting in prompt 3003 illustrated in Fig. 30, requesting party size and time
for a reservation.
[0251]      As described above, Fig. 31 depicts screen 3101 is shown including
dialog element 3102 that is presented after the user answers the request for
the party size and reservation time. In one embodiment, screen 3101 is pre
sented as the result of another iteration through an automated call and re
sponse procedure, as described in connection with Fig. 33, which leads to an
other call to the dialog and flow procedure depicted in Fig. 32. In this instan
tiation of the dialog and flow procedure, after receiving the user preferences,
dialog flow processor component(s) 1080 determines a different task flow step
in step 320: to do an availability search. When request 390 is constructed, it
includes the task parameters sufficient for dialog flow processor compo
nent(s) 1080 and services orchestration component(s) 1082 to dispatch to a res
taurant booking service.
Dialog Flow Models Component(s) 1087
[0252]      In at least one embodiment, dialog flow models component(s) 1087
may be operable to provide dialog flow models, which represent the steps one
takes in a particular kind of conversation between a user and intelligent auto
mated assistant 1002. For example, the dialog flow for the generic task of per
forming a transaction includes steps for getting the necessary data for the
transaction and confirming the transaction parameters before committing it.
                                         - 84 -

WO 2011/088053                                                      PCT/US2011/020861
 Task Flow Models Component(s) 1086
[0253]      In at least one embodiment, task flow models component(s) 1086
may be operable to provide task flow models, which represent the steps one
takes to solve a problem or address a need. For example, the task flow for
getting a dinner reservation involves finding a desirable restaurant, checking
availability, and doing a transaction to get a reservation for a specific time
with the restaurant.
[0254]      According to specific embodiments, multiple instances or threads of
task flow models component(s) 1086 may be concurrently implemented
and/or initiated via the use of one or more processors 63 and/or other com
binations of hardware and/or hardware and software. For example, in at
least some embodiments, various aspects, features, and/or functionalities of
task flow models component(s) 1086 may be may be implemented as pro
grams, state machines, or other ways of identifying an appropriate step in a
flow graph.
[0255]      In at least one embodiment, task flow models component(s) 1086
may use a task modeling framework called generic tasks. Generic tasks are
abstractions that model the steps in a task and their required inputs and gen
erated outputs, without being specific to domains. For example, a generic
task for transactions might include steps for gathering data required for the
transaction, executing the transaction, and outputting results of the transac
tion -- all without reference to any particular transaction domain or service for
implementing it. It might be instantiated for a domain such as shopping, but
it is independent of the shopping domain and might equally well apply to
domains of reserving, scheduling, and the like.
[0256]      At least a portion of the functions, operations, actions, and/or other
features associated with task flow models component(s) 1086 and/or proce
dure(s) described herein may be implemented, at least in part, using concepts,
features, components, processes, and/or other aspects disclosed herein in
connection with generic task modeling framework.
                                          - 85 -

WO 2011/088053                                                     PCT/US2011/020861
[0257]      Additionally, at least a portion of the functions, operations, actions,
and/or other features associated with task flow models component(s) 1086
and/or procedure(s) described herein may be implemented, at least in part,
using concepts, features, components, processes, and/or other aspects relat
ing to constrained selection tasks, as described herein. For example, one em
bodiment of generic tasks may be implemented using a constrained selection
task model.
[0258]      In at least one embodiment, a given instance of task flow models
component(s) 1086 may access and/or utilize information from one or more
associated databases. In at least one embodiment, at least a portion of the da
tabase information may be accessed via communication with one or more lo
cal and/or remote memory devices. Examples of different types of data
which may be accessed by task flow models component(s) 1086 may include,
but are not limited to, one or more of the following (or combinations thereof):
        e   Domain models 1056;
        " Vocabulary 1058;
        e   Domain entity databases 1072;
        " Short term memory 1052;
        " Long term personal memory 1054;
        e   Dialog flow models 1087;
        e   Service capability models 1088.
[0259]      Referring now to Fig. 34, there is shown a flow diagram depicting
an example of task flow for a constrained selection task 351 according to one
embodiment.
[0260]      Constrained selection is a kind of generic task in which the goal is
to select some item from a set of items in the world based on a set of con
straints. For example, a constrained selection task 351 may be instantiated for
the domain of restaurants. Constrained selection task 351 starts by soliciting
criteria and constraints from the user 352. For example, the user might be in
terested in Asian food and may want a place to eat near his or her office.
                                         - 86 -

WO 2011/088053                                                     PCT/US2011/020861
[0261]      In step 353, assistant 1002 presents items that meet the stated crite
ria and constraints for the user to browse. In this example, it may be a list of
restaurants and their properties which may be used to select among them.
 [0262]     In step 354, the user is given an opportunity to refine criteria and
constraints. For example, the user might refine the request by saying "near
my office". The system would then present a new set of results in step 353.
 [0263]     Referring now also to Fig. 35, there is shown an example of screen
3501 including list 3502 of items presented by constrained selection task 351
 according to one embodiment.
 [0264]     In step 355, the user can select among the matching items. Any of a
 number of follow-on tasks 359 may then be made available, such as for exam
 ple book 356, remember 357, or share 358. In various embodiments, follow-on
 tasks 359 can involve interaction with web-enabled services, and/or with
 functionality local to the device (such as setting a calendar appointment, mak
 ing a telephone call, sending an email or text message, setting an alarm, and
 the like).
 [0265]     In the example of Fig. 35, the user can select an item within list 3502
 to see more details and to perform additional actions. Referring now also to
 Fig. 36, there is shown an example of screen 3601 after the user has selected an
 item from list 3502. Additional information and options corresponding to fol
 low-on tasks 359 concerning the selected item are displayed.
 [0266]      In various embodiments, the flow steps may be offered to the user
 in any of several input modalities, including but not limited to any combina
 tion of explicit dialog prompts and GUI links.
  Services Component(s) 1084
  [0267]     Services component(s) 1084 represent the set of services that intelli
  gent automated assistant 1002 might call on behalf of the user. Any service
  that can be called may be offered in a services component 1084.
                                          -87 -

WO 2011/088053                                                     PCT/US2011/020861
[0268]     In at least one embodiment, services component(s) 1084 may be op
erable to perform and/or implement various types of functions, operations,
actions, and/or other features such as, for example, one or more of the follow
ing (or combinations thereof):
       e   Provide the functions over an API that would normally be provided
           by a web-based user interface to a service. For example, a review
           website might provide a service API that would return reviews of a
           given entity automatically when called by a program. The API of
           fers to intelligent automated assistant 1002 the services that a hu
           man would otherwise obtain by operating the user interface of the
           website.
       -   Provide the functions over an API that would normally be provided
           by a user interface to an application. For example, a calendar appli
           cation might provide a service API that would return calendar en
           tries automatically when called by a program. The API offers to in
           telligent automated assistant 1002 the services that a human would
           otherwise obtain by operating the user interface of the application.
           In one embodiment, assistant 1002 is able to initiate and control any
           of a number of different functions available on the device. For ex
           ample, if assistant 1002 is installed on a smartphone, personal digi
           tal assistant, tablet computer, or other device, assistant 1002 can
           perform functions such as: initiate applications, make calls, send
           emails and/or text messages, add calendar events, set alarms, and
           the like. In one embodiment, such functions are activated using
           services component(s) 1084.
       " Provide services that are not currently implemented in a user inter
           face, but that are available through an API to assistant in larger
           tasks. For example, in one embodiment, an API to take a street ad
           dress and return machine-readable geo-coordinates might be used
                                         - 88 -

WO 2011/088053                                                     PCT/US2011/020861
           by assistant 1002 as a service component 1084 even if it has no di
           rect user interface on the web or a device.
[0269]     According to specific embodiments, multiple instances or threads of
services component(s) 1084 may be concurrently implemented and/or initi
ated via the use of one or more processors 63 and/or other combinations of
hardware and/or hardware and software. For example, in at least some em
bodiments, various aspects, features, and/or functionalities of services com
ponent(s) 1084 may be performed, implemented and/or initiated by one or
more of the following types of systems, components, systems, devices, proce
dures, processes, and the like (or combinations thereof):
        e  implementation of an API exposed by a service, locally or remotely
           or any combination;
        e  inclusion of a database within automated assistant 1002 or a data
           base service available to assistant 1002.
[0270]     For example, a website that offers users an interface for browsing
movies might be used by an embodiment of intelligent automated assistant
1002 as a copy of the database used by the website. Services component(s)
1084 would then offer an internal API to the data, as if it were provided over a
network API, even though the data is kept locally.
 [0271]    As another example, services component(s) 1084 for an intelligent
 automated assistant 1002 that helps with restaurant selection and meal plan
 ning might include any or all of the following set of services which are avail
 able from third parties over the network:
        " a set of restaurant listing services which lists restaurants matching
           name, location, or other constraints;
        e  a set of restaurant rating services which return rankings for named
           restaurants;
         e a set of restaurant reviews services which returns written reviews
           for named restaurants;
         " a geocoding service to locate restaurants on a map;
                                         - 89 -

WO 2011/088053                                                      PCT/US2011/020861
        e   a reservation service that enables programmatic reservation of ta
           bles at restaurants.
Services Orchestration Component(s) 1082
[0272]     Services orchestration component(s) 1082 of intelligent automated
assistant 1002 executes a service orchestration procedure.
[0273]     In at least one embodiment, services orchestration component(s)
1082 may be operable to perform and/or implement various types of func
tions, operations, actions, and/or other features such as, for example, one or
more of the following (or combinations thereof):
       " Dynamically and automatically determine which services may meet
           the user's request and/or specified domain(s) and task(s);
       " Dynamically and automatically call multiple services, in any com
           bination of concurrent and sequential ordering;
       " Dynamically and automatically transform task parameters and con
           straints to meet input requirements of service APIs;
       " Dynamically and automatically monitor for and gather results from
           multiple services;
       " Dynamically and automatically merge service results data from
           various services into to a unified result model;
       " Orchestrate a plurality of services to meet the constraints of a re
           quest;
       e   Orchestrate a plurality of services to annotate an existing result set
           with auxiliary information;
       e   Output the result of calling a plurality of services in a uniform, ser
           vice independent representation that unifies the results from the
           various services (for example, as a result of calling several restau
           rant services that return lists of restaurants, merge the data on at
           least one restaurant from the several services, removing redun
           dancy).
                                          - 90 -

WO 2011/088053                                                    PCT/US2011/020861
[0274]      For example, in some situations, there may be several ways to ac
complish a particular task. For example, user input such as "remind me to
leave for my meeting across town at 2pm" specifies an action that can be ac
complished in at least three ways: set alarm clock; create a calendar event; or
call a to-do manager. In one embodiment, services orchestration compo
nent(s) 1082 makes the determination as to which way to best satisfy the re
quest.
[0275]      Services orchestration component(s) 1082 can also make determina
tions as to which combination of several services would be best to invoke in
order to perform a given overall task. For example, to find and reserve a table
for dinner, services orchestration component(s) 1082 would make determina
tions as to which services to call in order to perform such functions as looking
up reviews, getting availability, and making a reservation. Determination of
which services to use may depend on any of a number of different factors.
For example, in at least one embodiment, information about reliability, ability
 of service to handle certain types of requests, user feedback, and the like, can
 be used as factors in determining which service(s) is/are appropriate to in
 voke.
 [0276]     According to specific embodiments, multiple instances or threads of
 services orchestration component(s) 1082 may be concurrently implemented
 and/or initiated via the use of one or more processors and/or other combina
 tions of hardware and/or hardware and software.
 [0277]     In at least one embodiment, a given instance of services orchestra
 tion component(s) 1082 may use explicit service capability models 1088 to
 represent the capabilities and other properties of external services, and reason
 about these capabilities and properties while achieving the features of services
 orchestration component(s) 1082. This affords advantages over manually
 programming a set of services that may include, for example, one or more of
 the following (or combinations thereof):
         * Ease of development;
                                         - 91 -

WO 2011/088053                                                    PCT/US2011/020861
         " Robustness and reliability in execution;
         " The ability to dynamically add and remove services without dis
           rupting code;
        * The ability to implement general distributed query optimization al
           gorithms that are driven by the properties and capabilities rather
           than hard coded to specific services or APIs.
[0278]     In at least one embodiment, a given instance of services orchestra
tion component(s) 1082 may access and/or utilize information from one or
more associated databases. In at least one embodiment, at least a portion of
the database information may be accessed via communication with one or
more local and/or remote memory devices. Examples of different types of
data which may be accessed by services orchestration component(s) 1082 may
include, but are not limited to, one or more of the following (or combinations
thereof):
        e  Instantiations of domain models;
        e  Syntactic and semantic parses of natural language input;
        e  Instantiations of task models (with values for parameters);
        " Dialog and task flow models and/or selected steps within them;
        * Service capability models 1088;
        e  Any other information available in an active ontology 1050.
[0279]     Referring now to Fig. 37, there is shown an example of a procedure
for executing a service orchestration procedure according to one embodiment.
[0280]     In this particular example, it is assumed a single user is interesting
in finding a good place for dinner at a restaurant, and is engaging intelligent
automated assistant 1002 in a conversation to help provide this service.
[0281]     Consider the task of finding restaurants that are of high quality, are
well reviewed, near a particular location, available for reservation at a par
ticular time, and serve a particular kind of food. These domain and task pa
rameters are given as input 390.
                                        -  92-

WO 2011/088053                                                       PCT/US2011/020861
[0282]      The method begins 400. At 402, it is determined whether the given
request may require any services. In some situations, services delegation may
not be required, for example if assistant 1002 is able to perform the desired
task itself. For example, in one embodiment, assistant 1002 may be able to an
swer a factual question without invoking services delegation. Accordingly, if
the request does not require services, then standalone flow step is executed in
403 and its result 490 is returned. For example, if the task request was to ask
for information about automated assistant 1002 itself, then the dialog re
sponse may be handled without invoking any external services.
 [0283]     If, in step 402, it is determined that services delegation is required,
 services orchestration component(s) 1082 proceed to step 404. In 404, services
 orchestration component(s) 1082 may match up the task requirements with
 declarative descriptions of the capabilities and properties of services in service
 capability models 1088. At least one service provider that might support the
 instantiated operation provides declarative, qualitative metadata detailing, for
 example, one or more of the following (or combinations thereof):
         " the data fields that are returned with results;
         * which classes of parameters the service provider is statically known
            to support;
         " policy functions for parameters the service provider might be able
            to support after dynamic inspection of the parameter values;
         e  a performance rating defining how the service performs (e.g. rela
            tional DB, web service, triple store, full-text index, or some combi
            nation thereof);
         e  property quality ratings statically defining the expected quality of
            property values returned with the result object;
         e  an overall quality rating of the results the service may expect to re
            turn.
  [0284]    For example, reasoning about the classes of parameters that service
  may support, a service model may state that services 1, 2, 3, and 4 may pro
                                            - 93 -

WO 2011/088053                                                       PCT/US2011/020861
vide restaurants that are near a particular location (a parameter), services 2
and 3 may filter or rank restaurants by quality (another parameter), services 3,
4, and 5 may return reviews for restaurants (a data field returned), service 6
may list the food types served by restaurants (a data field returned), and ser
vice 7 may check availability of restaurants for particular time ranges (a pa
rameter). Services 8 through 99 offer capabilities that are not required for this
particular domain and task.
[0285]      Using this declarative, qualitative metadata, the task, the task pa
rameters, and other information available from the runtime environment of
the assistant, services orchestration component(s) 1082 determines 404 an op
timal set of service providers to invoke. The optimal set of service providers
may support one or more task parameters (returning results that satisfy one
or more parameters) and also considers the performance rating of at least one
service provider and the overall quality rating of at least one service provider.
[0286]      The result of step 404 is a dynamically generated list of services to
call for this particular user and request.
[0287]      In at least one embodiment, services orchestration component(s)
1082 considers the reliability of services as well as their ability to answer spe
cific information requests.
[0288]      In at least one embodiment, services orchestration component(s)
1082 hedges against unreliability by calling overlapping or redundant ser
vices.
[0289]      In at least one embodiment, services orchestration component(s)
1082 considers personal information about the user (from the short term per
sonal memory component) to select services. For example, the user may pre
fer some rating services over others.
[0290]      In step 450, services orchestration component(s) 1082 dynamically
and automatically invokes multiple services on behalf of a user. In at least
one embodiment, these are called dynamically while responding to a user's
request. According to specific embodiments, multiple instances or threads of
                                          - 94 -

WO 2011/088053                                                    PCT/US2011/020861
the services may be concurrently called. In at least one embodiment, these are
called over a network using APIs, or over a network using web service APIs,
or over the Internet using web service APIs, or any combination thereof.
[0291]      In at least one embodiment, the rate at which services are called is
programmatically limited and/or managed.
[0292]      Referring now also to Fig. 38, there is shown an example of a ser
vice invocation procedure 450 according to one embodiment. Service invoca
tion is used, for example, to obtain additional information or to perform tasks
by the use of external services. In one embodiment, request parameters are
transformed as appropriate for the service's API. Once results are received
 from the service, the results are transformed to a results representation for
presentation to the user within assistant 1002.
 [0293]      In at least one embodiment, services invoked by service invocation
 procedure 450 can be a web service, application running on the device, oper
 ating system function, or the like.
 [0294]      Representation of request 390 is provided, including for example
 task parameters and the like. For at least one service available from service
 capability models 1088, service invocation procedure 450 performs transfor
 mation 452, calling 454, and output-mapping 456 steps.
 [0295]      In transformation step 452, the current task parameters from re
 quest representation 390 are transformed into a form that may be used by at
 least one service. Parameters to services, which may be offered as APIs or da
 tabases, may differ from the data representation used in task requests, and
 also from at least one other. Accordingly, the objective of step 452 is to map at
 least one task parameter in the one or more corresponding formats and values
 in at least one service being called.
  [0296]     For example, the names of businesses such as restaurants may vary
  across services that deal with such businesses. Accordingly, step 452 would
  involve transforming any names into forms that are best suited for at least one
  service.
                                          - 95 -

WO 2011/088053                                                     PCT/US2011/020861
[0297]      As another example, locations are known at various levels of preci
sion and using various units and conventions across services. Service 1 might
may require ZIP codes, service 2 GPS coordinates, and service 3 postal street
addresses.
[0298]      The service is called 454 over an API and its data gathered. In at
least one embodiment, the results are cached. In at least one embodiment, the
services that do not return within a specified level performance (e.g., as speci
fied in Service Level Agreement or SLA) are dropped.
[0299]      In output mapping step 456, the data returned by a service is
mapped back onto unified result representation 490. This step may include
dealing with different formats, units, and so forth.
[0300]      In step 412, results from multiple services are validated and
merged. In one embodiment, if validated results are collected, an equality pol
icy function--defined on a per-domain basis--is then called pair-wise across
one or more results to determine which results represent identical concepts in
the real world. When a pair of equal results is discovered, a set of property
policy functions--also defined on a per-domain basis--are used to merge
property values into a merged result. The property policy function may use
the property quality ratings from the service capability models, the task pa
rameters, the domain context, and/or the long-term personal memory 1054 to
decide the optimal merging strategy.
[0301]      For example, lists of restaurants from different providers of restau
rants might be merged and duplicates removed. In at least one embodiment,
the criteria for identifying duplicates may include fuzzy name matching,
fuzzy location matching, fuzzy matching against multiple properties of do
main entities, such as name, location, phone number, and/or website address,
and/or any combination thereof.
[0302]     In step 414, the results are sorted and trimmed to return a result list
of the desired length.
                                         - 96 -

WO 2011/088053                                                        PCT/US2011/020861
[0303]       In at least one embodiment, a request relaxation loop is also ap
plied. If, in step 416, services orchestration component(s) 1082 determines
that the current result list is not sufficient (e.g., it has fewer than the desired
number of matching items), then task parameters may be relaxed 420 to allow
for more results. For example, if the number of restaurants of the desired sort
found within N miles of the target location is too small, then relaxation would
run the request again, looking in an area larger than N miles away, and/or
relaxing some other parameter of the search.
 [0304]      In at least one embodiment, the service orchestration method is ap
 plied in a second pass to "annotate" results with auxiliary data that is useful
 to the task.
 [0305]      In step 418, services orchestration component(s) 1082 determines
 whether annotation is required. It may be required if, for example, if the task
 may require a plot of the results on a map, but the primary services did not
 return geo-coordinates required for mapping.
 [0306]      In 422, service capability models 1088 are consulted again to find
 services that may return the desired extra information. In one embodiment,
 the annotation process determines if additional or better data may be anno
 tated to a merged result. It does this by delegating to a property policy func
 tion--defined on a per-domain basis--for at least one property of at least one
 merged result. The property policy function may use the merged property
 value and property quality rating, the property quality ratings of one or more
  other service providers, the domain context, and/or the user profile to decide
  if better data may be obtained. If it is determined that one or more service
  providers may annotate one or more properties for a merged result, a cost
  function is invoked to determine the optimal set of service providers to anno
  tate.
  [0307]      At least one service provider in the optimal set of annotation service
  providers is then invoked 450 with the list of merged results, to obtain results
  424. The changes made to at least one merged result by at least one service
                                           -97-

WO 2011/088053                                                    PCT/US2011/020861
provider are tracked during this process, and the changes are then merged
using the same property policy function process as was used in step 412.
Their results are merged 426 into the existing result set.
[0308]      The resulting data is sorted 428 and unified into a uniform repre
sentation 490.
[0309]      It may be appreciated that one advantage of the methods and sys
tems described above with respect to services orchestration component(s)
1082 is that they may be advantageously applied and/or utilized in various
fields of technology other than those specifically relating to intelligent auto
mated assistants. Examples of such other areas of technologies where aspects
and/or features of service orchestration procedures include, for example, one
or more of the following:
        " Dynamic "mash ups" on websites and web-based applications and
            services;
        e   Distributed database query optimization;
        " Dynamic service oriented architecture configuration.
Service Capability Models Component(s) 1088
[0310]      In at least one embodiment, service capability models component(s)
1088 may be operable to perform and/or implement various types of func
tions, operations, actions, and/or other features such as, for example, one or
more of the following (or combinations thereof):
        e   Provide machine readable information about the capabilities of ser
            vices to perform certain classes of computation;
        e   Provide machine readable information about the capabilities of ser
            vices to answer certain classes of queries;
        " Provide machine readable information about which classes of
            transactions are provided by various services;
        " Provide machine readable information about the parameters to
            APIs exposed by various services;
                                         - 98 -

WO 2011/088053                                                     PCT/US2011/020861
         * Provide machine readable information about the parameters that
            may be used in database queries on databases provided by various
            services.
 Output Processor Component(s) 1090
 [0311]     In at least one embodiment, output processor component(s) 1090
may be operable to perform and/or implement various types of functions,
 operations, actions, and/or other features such as, for example, one or more
 of the following (or combinations thereof):
         " Format output data that is represented in a uniform internal data
            structure into forms and layouts that render it appropriately on dif
            ferent modalities. Output data may include, for example, communi
            cation in natural language between the intelligent automated assis
            tant and the user; data about domain entities, such as properties of
            restaurants, movies, products, and the like; domain specific data re
            sults from information services, such as weather reports, flight
            status checks, prices, and the like; and/or interactive links and but
            tons that enable the user to respond by directly interacting with the
             output presentation.
         " Render output data for modalities that may include, for example,
             any combination of: graphical user interfaces; text messages; email
             messages; sounds; animations; and/or speech output.
         " Dynamically render data for different graphical user interface dis
             play engines based on the request. For example, use different out
             put processing layouts and formats depending on which web
             browser and/or device is being used.
         " Render output data in different speech voices dynamically.
         " Dynamically render to specified modalities based on user prefer
             ences.
                                          - 99 -

WO 2011/088053                                                   PCT/US2011/020861
        * Dynamically render output using user-specific "skins" that custom
           ize the look and feel.
        * Send a stream of output packages to a modality, showing interme
           diate status, feedback, or results throughout phases of interaction
           with assistant 1002.
[0312]     According to specific embodiments, multiple instances or threads of
output processor component(s) 1090 may be concurrently implemented
and/or initiated via the use of one or more processor(s) 63 and/or other com
binations of hardware and/or hardware and software. For example, in at
least some embodiments, various aspects, features, and/or functionalities of
output processor component(s) 1090 may be performed, implemented and/or
initiated by one or more of the following types of systems, components, sys
tems, devices, procedures, processes, and the like (or combinations thereof):
        e  software modules within the client or server of an embodiment of
           an intelligent automated assistant;
        e  remotely callable services;
        e  using a mix of templates and procedural code.
[0313]     Referring now to Fig. 39, there is shown a flow diagram depicting
an example of a multiphase output procedure according to one embodiment.
The multiphase output procedure includes automated assistant 1002 process
ing steps 702 and multiphase output steps 704
[0314]     In step 710, a speech input utterance is obtained and a speech-to
text component (such as component described in connection with Fig. 22) in
terprets the speech to produce a set of candidate speech interpretations 712.
In one embodiment, speech-to-text component is implemented using, for ex
ample, Nuance Recognizer, available from Nuance Communications, Inc. of
Burlington, MA. Candidate speech interpretations 712 may be shown to the
user in 730, for example in paraphrased form. For example, the interface
might show "did you say?" alternatives listing a few possible alternative tex
tual interpretations of the same speech sound sample.
                                        -100-

WO 2011/088053                                                       PCT/US2011/020861
[0315]       In at least one embodiment, a user interface is provided to enable
the user to interrupt and choose among the candidate speech interpretations.
[0316]       In step 714, the candidate speech interpretations 712 are sent to a
language interpreter 1070, which may produce representations of user intent
716 for at least one candidate speech interpretation 712. In step 732, para
phrases of these representations of user intent 716 are generated and pre
sented to the user. (See related step 132 of procedure 120 in Fig. 22).
[0317]       In at least one embodiment, the user interface enables the user to
interrupt and choose among the paraphrases of natural language interpreta
tions 732.
[0318]       In step 718, task and dialog analysis is performed. In step 734, task
and domain interpretations are presented to the user using an intent para
phrasing algorithm.
 [0319]      Referring now also to Fig. 40, there is shown a screen shot depicting
 an example of output processing according to one embodiment. Screen 4001
 includes echo 4002 of the user's speech input, generated by step 730. Screen
 4001 further includes paraphrase 4003 of the user's intent, generated by step
 734. In one embodiment, as depicted in the example of Fig. 40, special format
 ting/highlighting is used for key words such as "events", which may be used
 to facilitate training of the user for interaction with intelligent automated as
 sistant 1002. For example, by visually observing the formatting of the dis
 played text, the user may readily identify and interpret back the intelligent
 automated assistant recognizes keywords such as "events", "next Wednes
 day", "San Francisco", and the like.
 [0320]      Returning to Fig. 39, as requests are dispatched 720 to services and
 results are dynamically gathered, intermediate results may be displayed in
 the form of real-time progress 736. For example, a list of restaurants may be
 returned and then their reviews may be populated dynamically as the results
  from the reviews services arrive. Services can include web-enabled services
                                            - 101 -

WO 2011/088053                                                    PCT/US2011/020861
 and/or services that access information stored locally on the device and/or
from any other source.
 [0321]    A uniform representation of response 722 is generated and format
ted 724 for the appropriate output modality. After the final output format is
completed, a different kind of paraphrase may be offered in 738. In this
phase, the entire result set may be analyzed and compared against the initial
request. A summary of results or answer to a question may then be offered.
[0322]     Referring also to Fig. 41, there is shown another example of output
processing according to one embodiment. Screen 4101 depicts paraphrase
4102 of the text interpretation, generated by step 732, real-time progress 4103
generated by step 736, and paraphrased summary 7104 generated by step 738.
Also included are detailed results 4105.
[0323]     In one embodiment, assistant 1002 is capable of generating output
in multiple modes. Referring now to Fig. 42, there is shown a flow diagram
depicting an example of multimodal output processing according to one em
bodiment.
[0324]     The method begins 600. Output processor 1090 takes uniform rep
resentation of response 490 and formats 612 the response according to the de
vice and modality that is appropriate and applicable. Step 612 may include
information from device and modality models 610 and/or domain data mod
els 614.
[0325]     Once response 490 has been formatted 612, any of a number of dif
ferent output mechanisms can be used, in any combination. Examples de
picted in Fig. 42 include:
        " Generating 620 text message output, which is sent 630 to a text mes
           sage channel;
        e  Generating 622 email output, which is sent 632 as an email message;
        e  Generating 624 GUI output, which is sent 634 to a device or web
           browser for rendering;
                                        -102-

WO 2011/088053                                                       PCT/US2011/020861
            Generating 626 speech output, which is sent 636 to a speech genera
             tion module.
[0326]       One skilled in the art will recognize that many other output mecha
nisms can be used.
[0327]       In one embodiment, the content of output messages generated by
multiphase output procedure 700 is tailored to the mode of multimodal out
put processing 600. For example, if the output modality is speech 626, the
language of used to paraphrase user input 730, text interpretations 732, task
and domain interpretations 734, progress 736, and/or result summaries 738
may be more or less verbose or use sentences that are easier to comprehend in
 audible form than in written form. In one embodiment, the language is tai
 lored in the steps of the multiphase output procedure 700; in other embodi
 ments, the multiphase output procedure 700 produces an intermediate result
 that is further refined into specific language by multimodal output processing
 600.
 Short Term Personal Memory Component(s) 1052
 [0328]      In at least one embodiment, short term personal memory compo
 nent(s) 1052 may be operable to perform and/or implement various types of
 functions, operations, actions, and/or other features such as, for example, one
 or more of the following (or combinations thereof):
         " Keep a history of the recent dialog between the embodiment of the
              assistant and the user, including the history of user inputs and their
              interpretations;
         " Keep a history of recent selections by the user in the GUI, such as
              which items were opened or explored, which phone numbers were
              called, which items were mapped, which movie trailers where
              played, and the like;
                                           - 103 -

WO 2011/088053                                                        PCT/US2011/020861
        "   Store the history of the dialog and user interactions in a database on
            the client, the server in a user-specific session, or in client session
            state such as web browser cookies or RAM used by the client;
        " Store the list of recent user requests;
        * Store the sequence of results of recent user requests;
        " Store the click-stream history of UI events, including button
            presses, taps, gestures, voice activated triggers, and/or any other
            user input.
        e   Store device sensor data (such as location, time, positional orienta
            tion, motion, light level, sound level, and the like) which might be
            correlated with interactions with the assistant.
[0329]      According to specific embodiments, multiple instances or threads of
short term personal memory component(s) 1052 may be concurrently imple
mented and/or initiated via the use of one or more processors 63 and/or
other combinations of hardware and/or hardware and software.
[0330]      According to different embodiments, one or more different threads
or instances of short term personal memory component(s) 1052 may be initi
ated in response to detection of one or more conditions or events satisfying
one or more different types of minimum threshold criteria for triggering ini
tiation of at least one instance of short term personal memory component(s)
1052. For example, short term personal memory component(s) 1052 may be
invoked when there is a user session with the embodiment of assistant 1002,
on at least one input form or action by the user or response by the system.
[0331]      In at least one embodiment, a given instance of short term personal
memory component(s) 1052 may access and/or utilize information from one
or more associated databases. In at least one embodiment, at least a portion
of the database information may be accessed via communication with one or
more local and/or remote memory devices. For example, short term personal
memory component(s) 1052 may access data from long-term personal mem
ory components(s) 1054 (for example, to obtain user identity and personal
                                          -104-

WO 2011/088053                                                     PCT/US2011/020861
preferences) and/or data from the local device about time and location, which
may be included in short term memory entries.
[0332]      Referring now to Figs. 43A and 43B, there are shown screen shots
depicting an example of the use of short term personal memory component(s)
1052 to maintain dialog context while changing location, according to one
embodiment. In this example, the user has asked about the local weather,
 then just says "in new york". Screen 4301 shows the initial response, includ
 ing local weather. When the user says "in new york", assistant 1002 uses
 short term personal memory component(s) 1052 to access the dialog context
 and thereby determine that the current domain is weather forecasts. This en
 ables assistant 1002 to interpret the new utterance "in new york" to mean
 "what is the weather forecast in New York this coming Tuesday?". Screen
 4302 shows the appropriate response, including weather forecasts for New
 York.
 [0333]     In the example of Figs. 43A and 43B, what was stored in short term
 memory was not only the words of the input "is it going to rain the day after
 tomorrow?" but the system's semantic interpretation of the input as the
 weather domain and the time parameter set to the day after tomorrow.
  Long-Term Personal Memory Component(s) 1054
  [0334]    In at least one embodiment, long-term personal memory compo
 nent(s) 1054 may be operable to perform and/or implement various types of
  functions, operations, actions, and/or other features such as, for example, one
  or more of the following (or combinations thereof):
         " To persistently store the personal information and data about a
             user, including for example his or her preferences, identities, au
             thentication credentials, accounts, addresses, and the like;
         " To store information that the user has collected by using the em
             bodiment of assistant 1002, such as the equivalent of bookmarks,
             favorites, clippings, and the like;
                                          -105-

WO 2011/088053                                                       PCT/US2011/020861
        "   To persistently store saved lists of business entities including res
            taurants, hotels, stores, theaters and other venues. In one embodi
            ment, long-term personal memory component(s) 1054 saves more
            than just the names or URLs, but also saves the information suffi
            cient to bring up a full listing on the entities including phone num
            bers, locations on a map, photos, and the like;
        e   To persistently store saved movies, videos, music, shows, and other
            items of entertainment;
        "   To persistently store the user's personal calendar(s), to do list(s),
            reminders and alerts, contact databases, social network lists, and
            the like;
        * To persistently store shopping lists and wish lists for products and
            services, coupons and discount codes acquired, and the like;
        " To persistently store the history and receipts for transactions in
            cluding reservations, purchases, tickets to events, and the like.
[0335]      According to specific embodiments, multiple instances or threads of
long-term personal memory component(s) 1054 may be concurrently imple
mented and/or initiated via the use of one or more processors 63 and/or
other combinations of hardware and/or hardware and software. For exam
ple, in at least some embodiments, various aspects, features, and/or function
alities of long-term personal memory component(s) 1054 may be performed,
implemented and/or initiated using one or more databases and/or files on
(or associated with) clients 1304 and/or servers 1340, and/or residing on stor
age devices.
[0336]      According to different embodiments, one or more different threads
or instances of long-term personal memory component(s) 1054 may be initi
ated in response to detection of one or more conditions or events satisfying
one or more different types of minimum threshold criteria for triggering ini
tiation of at least one instance of long-term personal memory component(s)
1054. Various examples of conditions or events which may trigger initiation
                                           -106-

WO 2011/088053                                                       PCT/US2011/020861
and/or implementation of one or more different threads or instances of long
term personal memory component(s) 1054 may include, but are not limited to,
one or more of the following (or combinations thereof):
         * Long term personal memory entries may be acquired as a side ef
             fect of the user interacting with an embodiment of assistant 1002.
             Any kind of interaction with the assistant may produce additions to
             the long term personal memory, including browsing, searching,
             finding, shopping, scheduling, purchasing, reserving, communicat
             ing with other people via an assistant.
         0 Long term personal memory may also be accumulated as a conse
             quence of users signing up for an account or service, enabling assis
             tant 1002 access to accounts on other services, using an assistant
             1002 service on a client device with access to other personal infor
             mation databases such as calendars, to-do lists, contact lists, and the
             like.
 [0337]      In at least one embodiment, a given instance of long-term personal
 memory component(s) 1054 may access and/or utilize information from one
 or more associated databases. In at least one embodiment, at least a portion
 of the database information may be accessed via communication with one or
 more local and/or remote memory devices, which may be located, for exam
 ple, at client(s) 1304 and/or server(s) 1340. Examples of different types of data
 which may be accessed by long-term personal memory component(s) 1054
 may include, but are not limited to data from other personal information da
 tabases such as contact or friend lists, calendars, to-do lists, other list manag
 ers, personal account and wallet managers provided by external services 1360,
 and the like.
  [0338]      Referring now to Figs. 44A through 44C, there are shown screen
 shots depicting an example of the use of long term personal memory compo
  nent(s) 1054, according to one embodiment. In the example, a feature is pro
  vided (named "My Stuff"), which includes access to saved entities such as res
                                           -107-

WO 2011/088053                                                     PCT/US2011/020861
taurants, movies, and businesses that are found via interactive sessions with
an embodiment of assistant 1002. In screen 4401 of Fig. 44A, the user has
found a restaurant. The user taps on Save to My Stuff 4402, which saves in
formation about the restaurant in long-term personal memory component(s)
1054.
[0339]      Screen 4403 of Fig. 44B depicts user access to My Stuff. In one em
bodiment, the user can select among categories to navigate to the desired
item.
[0340]      Screen 4404 of Fig. 44C depicts the My Restaurant category, includ
ing items previously stored in My Stuff.
Automated Call and Response Procedure
[0341]      Referring now to Fig. 33, there is shown a flow diagram depicting
an automatic call and response procedure, according to one embodiment. The
procedure of Fig. 33 may be implemented in connection with one or more
embodiments of intelligent automated assistant 1002. It may be appreciated
that intelligent automated assistant 1002 as depicted in Fig. 1 is merely one
example from a wide range of intelligent automated assistant system em
bodiments which may be implemented. Other embodiments of intelligent
automated assistant systems (not shown) may include additional, fewer
and/or different components/features than those illustrated, for example, in
the example intelligent automated assistant 1002 depicted in Fig. 1.
[0342]      In at least one embodiment, the automated call and response pro
cedure of Fig. 33 may be operable to perform and/or implement various
types of functions, operations, actions, and/or other features such as, for ex
ample, one or more of the following (or combinations thereof):
        * The automated call and response procedure of Fig. 33 may provide
            an interface control flow loop of a conversational interface between
            the user and intelligent automated assistant 1002. At least one itera
            tion of the automated call and response procedure may serve as a
                                         -108-

WO 2011/088053                                                   PCT/US2011/020861
           ply in the conversation. A conversational interface is an interface in
           which the user and assistant 1002 communicate by making utter
           ances back and forth in a conversational manner.
        * The automated call and response procedure of Fig. 33 may provide
           the executive control flow for intelligent automated assistant 1002.
           That is, the procedure controls the gathering of input, processing of
           input, generation of output, and presentation of output to the user.
        " The automated call and response procedure of Fig. 33 may coordi
           nate communications among components of intelligent automated
           assistant 1002. That is, it may direct where the output of one com
           ponent feeds into another, and where the overall input from the en
           vironment and action on the environment may occur.
[0343]     In at least some embodiments, portions of the automated call and
response procedure may also be implemented at other devices and/or sys
tems of a computer network.
 [0344]    According to specific embodiments, multiple instances or threads of
the automated call and response procedure may be concurrently imple
mented and/or initiated via the use of one or more processors 63 and/or
 other combinations of hardware and/or hardware and software. In at least
 one embodiment, one or more or selected portions of the automated call and
 response procedure may be implemented at one or more client(s) 1304, at one
 or more server(s) 1340, and/or combinations thereof.
 [0345]     For example, in at least some embodiments, various aspects, fea
 tures, and/or functionalities of the automated call and response procedure
 may be performed, implemented and/or initiated by software components,
 network services, databases, and/or the like, or any combination thereof.
 [0346]     According to different embodiments, one or more different threads
 or instances of the automated call and response procedure may be initiated in
 response to detection of one or more conditions or events satisfying one or
 more different types of criteria (such as, for example, minimum threshold cri
                                         -109-

WO 2011/088053                                                      PCT/US2011/020861
teria) for triggering initiation of at least one instance of automated call and
response procedure. Examples of various types of conditions or events which
may trigger initiation and/or implementation of one or more different
threads or instances of the automated call and response procedure may in
clude, but are not limited to, one or more of the following (or combinations
thereof):
        e   a user session with an instance of intelligent automated assistant
            1002, such as, for example, but not limited to, one or more of:
                o  a mobile device application starting up, for instance, a mo
                   bile device application that is implementing an embodiment
                   of intelligent automated assistant 1002;
                o  a computer application starting up, for instance, an applica
                   tion that is implementing an embodiment of intelligent
                   automated assistant 1002;
                o  a dedicated button on a mobile device pressed, such as a
                   "speech input button";
                o  a button on a peripheral device attached to a computer or
                   mobile device, such as a headset, telephone handset or base
                   station, a GPS navigation system, consumer appliance, re
                   mote control, or any other device with a button that might be
                   associated with invoking assistance;
                o  a web session started from a web browser to a website im
                   plementing intelligent automated assistant 1002;
                o  an interaction started from within an existing web browser
                   session to a website implementing intelligent automated as
                   sistant 1002, in which, for example, intelligent automated as
                   sistant 1002 service is requested;
                o  an email message sent to a modality server 1426 that is me
                   diating communication with an embodiment of intelligent
                   automated assistant 1002;
                                          -110-

WO 2011/088053                                                      PCT/US2011/020861
                o a text message is sent to a modality server 1426 that is medi
                    ating communication with an embodiment of intelligent
                     automated assistant 1002;
                o    a phone call is made to a modality server 1434 that is mediat
                    ing communication with an embodiment of intelligent auto
                     mated assistant 1002;
                o an event such as an alert or notification is sent to an applica
                     tion that is providing an embodiment of intelligent auto
                     mated assistant 1002.
         * when a device that provides intelligent automated assistant 1002 is
             turned on and/or started.
 [0347]      According to different embodiments, one or more different threads
 or instances of the automated call and response procedure may be initiated
 and/or implemented manually, automatically, statically, dynamically, con
 currently, and/or combinations thereof. Additionally, different instances
 and/or embodiments of the automated call and response procedure may be
 initiated at one or more different time intervals (e.g., during a specific time
 interval, at regular periodic intervals, at irregular periodic intervals, upon
 demand, and the like).
  [0348]     In at least one embodiment, a given instance of the automated call
 and response procedure may utilize and/or generate various different types
  of data and/or other types of information when performing specific tasks
  and/or operations.      This may include, for example, input data/information
  and/or output data/information. For example, in at least one embodiment, at
  least one instance of the automated call and response procedure may access,
  process, and/or otherwise utilize information from one or more different
  types of sources, such as, for example, one or more databases. In at least one
  embodiment, at least a portion of the database information may be accessed
  via communication with one or more local and/or remote memory devices.
  Additionally, at least one instance of the automated call and response proce
                                           - 111 -

WO 2011/088053                                                      PCT/US2011/020861
dure may generate one or more different types of output data/information,
which, for example, may be stored in local memory and/or remote memory
devices.
[0349]      In at least one embodiment, initial configuration of a given instance
of the automated call and response procedure may be performed using one or
more different types of initialization parameters. In at least one embodiment,
at least a portion of the initialization parameters may be accessed via commu
nication with one or more local and/or remote memory devices. In at least
one embodiment, at least a portion of the initialization parameters provided
to an instance of the automated call and response procedure may correspond
to and/or may be derived from the input data/information.
[0350]      In the particular example of Fig. 33, it is assumed that a single user
is accessing an instance of intelligent automated assistant 1002 over a network
from a client application with speech input capabilities. The user is interested
in finding a good place for dinner at a restaurant, and is engaging intelligent
automated assistant 1002 in a conversation to help provide this service.
[0351]      In step 100, the user is prompted to enter a request. The user inter
face of the client offers several modes of input, as described in connection
with Fig. 26. These may include, for example:
        e   an interface for typed input, which may invoke an active typed
            input elicitation procedure as illustrated in Fig. 11;
        e   an interface for speech input, which may invoke an active speech
            input elicitation procedure as illustrated in Fig. 22.
        e   an interface for selecting inputs from a menu, which may invoke ac
            tive GUI-based input elicitation as illustrated in Fig. 23.
[0352]      One skilled in the art will recognize that other input modes may be
provided.
[0353]      In one embodiment, step 100 may include presenting options re
maining from a previous conversation with assistant 1002, for example using
                                          -112-

WO 2011/088053                                                      PCT/US2011/020861
the techniques described in the active dialog suggestion input elicitation pro
cedure described in connection with Fig. 24.
[0354]      For example, by one of the methods of active input elicitation in
step 100, the user might say to assistant 1002, "where may I get some good
Italian around here?" For example, the user might have spoken this into a
speech input component. An embodiment of an active input elicitation com
ponent 1094 calls a speech-to-text service, asks the user for confirmation, and
then represents the confirmed user input as a uniform annotated input format
2690.
[0355]      An embodiment of language interpreter component 1070 is then
called in step 200, as described in connection with Fig. 29. Language inter
preter component 1070 parses the text input and generates a list of possible
interpretations of the user's intent 290. In one parse, the word "italian" is as
sociated with restaurantsof style Italian; "good" is associated with the recom
mendation property of restaurants;and "around here" is associated with a loca
tion parameter describing a distance from a global sensor reading (for exam
ple, the user's location as given by GPS on a mobile device).
[0356]      In step 300, the representation of the user's intent 290 is passed to
dialog flow processor 1080, which implements an embodiment of a dialog and
flow analysis procedure as described in connection with Fig. 32. Dialog flow
processor 1080 determines which interpretation of intent is most likely, maps
this interpretation to instances of domain models and parameters of a task
model, and determines the next flow step in a dialog flow. In the current ex
 ample, a restaurant domain model is instantiated with a constrained selection
 task to find a restaurant by constraints (the cuisine style, recommendation
 level, and proximity constraints). The dialog flow model indicates that the
 next step is to get some examples of restaurants meeting these constraints and
 present them to the user.
 [0357]     In step 400, an embodiment of the flow and service orchestration
 procedure 400 is invoked, via services orchestration component 1082. It in
                                         -113-

WO 2011/088053                                                       PCT/US2011/020861
evokes a set of services 1084 on behalf of the user's request to find a restaurant.
In one embodiment, these services 1084 contribute some data to a common
result. Their data are merged and the resulting list of restaurants is repre
sented in a uniform, service-independent form.
[0358]     In step 500, output processor 1092 generates a dialog summary of
the results, such as, "I found some recommended Italian restaurants near
here." Output processor 1092 combines this summary with the output result
data, and then sends the combination to a module that formats the output for
the user's particular mobile device in step 600.
[0359]     In step 700, this device-specific output package is sent to the mobile
device, and the client software on the device renders it on the screen (or other
output device) of the mobile device.
[0360]     The user browses this presentation, and decides to explore different
options. If the user is done 790, the method ends. If the user is not done 490,
another iteration of the loop is initiated by returning to step 100.
[0361]     The automatic call and response procedure may be applied, for ex
ample to a user's query "how about mexican food?". Such input may be elic
ited in step 100. In step 200, the input is interpreted as restaurantsof style
ivxUICrt, dRU cfminedL1CU wILIL tIhe ULer sLdLte ieli in short term personal
memory 1052) to support the interpretation of the same intent as the last time,
with one change in the restaurant style parameter. In step 300, this updated
intent produces a refinement of the request, which is given to service orches
tration component(s) 1082 in step 400.
[0362]     In step 400 the updated request is dispatched to multiple services
1084, resulting in a new set of restaurants which are summarized in dialog in
500, formatted for the device in 600, and sent over the network to show new
information on the user's mobile device in step 700.
[0363]     In this case, the user finds a restaurant of his or her liking, shows it
on a map, and sends directions to a friend.
                                         -114-

WO 2011/088053                                                      PCT/US2011/020861
[0364]       One skilled in the art will recognize that different embodiments of
the automated call and response procedure (not shown) may include addi
tional features and/or operations than those illustrated in the specific em
bodiment of Fig. 33, and/or may omit at least a portion of the features and/or
operations of automated call and response procedure illustrated in the spe
cific embodiment of Fig. 33.
 Constrained Selection
 [0365]      In one embodiment, intelligent automated assistant 1002 uses con
 strained selection in its interactions with the user, so as to more effectively
 identify and present items that are likely to be of interest to the user.
 [0366]      Constrained selection is a kind of generic task. Generic tasks are
 abstractions that characterize the kinds of domain objects, inputs, outputs,
 and control flow that are common among a class of tasks. A constrained se
 lection task is performed by selecting items from a choice set of domain objects
 (such as restaurants) based on selection constraints (such as a desired cuisine or
 location). In one embodiment, assistant 1002 helps the user explore the space
 of possible choices, eliciting the user's constraints and preferences, presenting
 choices, and offering actions to perform on those choices such as to reserve,
 buy, remember, or share them. The task is complete when the user selects one
 or more items on which to perform the action.
 [0367]      Constrained selection is useful in many contexts: for example, pick
 ing a movie to see, a restaurant for dinner, a hotel for the night, a place to buy
 a book, or the like. In general, constrained selection is useful when one knows
 the category and needs to select an instance of the category with some desired
 properties.
  [0368]     One conventional approach to constrained selection is a directory
  service. The user picks a category and the system offers a list of choices. In a
  local directory, one may constrain the directory to a location, such as a city.
  For instance, in a "yellow pages" service, users select the book for a city and
                                           -115-

WO 2011/088053                                                          PCT/US2011/020861
then look up the category, and the book shows one or more items for that
category. The main problem with a directory service is that the number of
possibly relevant choices is large (e.g., restaurants in a given city).
[0369]     Another conventional approach is a database application, which
provides a way to generate a choice set by eliciting a query from the user, re
trieving matching items, and presenting the items in some way that highlights
salient features. The user browses the rows and columns of the result set,
possibly sorting the results or changing the query until he or she finds some
suitable candidates. The problem with the database service is that it may re
quire the user to operationalize their human need as a formal query and to
use the abstract machinery of sort, filter, and browse to explore the resulting
data. These are difficult for most people to do, even with graphical user inter
faces.
[0370]     A third conventional approach is open-ended search, such as "local
search". Search is easy to do, but there are several problems with search ser
vices that make them difficult for people to accomplish the task of constrained
selection. Specifically:
        " As with directory search, the user may not just enter a category and
           took at one or more possible cIice, but must narrow down the list.
        " If the user can narrow the selection by constraints, it is not obvious
           what constraints may be used (e.g., may I search for places that are
           within walking distance or are open late?)
        e  It is not clear how to state constraints (e.g., is it called cuisine or res
           taurant type, and what are the possible values?)
        e  Multiple preferences conflict; there is usually no objectively "best"
           answer to a given situation (e.g., I want a place that is close by and
           cheap serving gourmet food with excellent service and which is
           open until midnight).
        * Preferences are relative, and they depend on what is available. For
           example, if the user may get a table at a highly rated restaurant, he
                                          -116-

WO 2011/088053                                                          PCT/US2011/020861
             or she might choose it even though it is expensive. In general,
             though, the user would prefer less expensive options.
[0371]       In various embodiments, assistant 1002 of the present invention
helps streamline the task of constrained selection. In various embodiments,
 assistant 1002 employs database and search services, as well as other func
tionality, to reduce the effort, on the part of the user, of stating what he or she
is looking for, considering what is available, and deciding on a satisfactory
 solution.
 [0372]      In various embodiments, assistant 1002 helps to make constrained
 selection simpler for humans in any of a number of different ways.
 [0373]      For example, in one embodiment, assistant 1002 may operationalize
 properties into constraints. The user states what he or she wants in terms of
 propertiesof the desired outcome. Assistant 1002 operationalizes this input into
 formal constraints. For example, instead of saying "find one or more restau
 rants less than 2 miles from the center of Palo Alto whose cuisine includes
 Italian food" the user may just say "Italian restaurants in palo alto". Assistant
 1002 may also operationalize qualities requested by the user that are not pa
 rameters to a database. For example, if the user requests romantic restau
 rants, the system may operationalize this as a text search or tag matching con
 straint. In this manner, assistant 1002 helps overcome some of the problems
 users may otherwise have with constrained selection. It is easier, for a user, to
 imagine and describe a satisfactory solution than to describe conditions that
 would distinguish suitable from unsuitable solutions.
  [0374]      In one embodiment, assistant 1002 may suggest useful selection cri
 teria, and the user need only say which criteria are important at the moment.
  For example, assistant 1002 may ask "which of these matter: price (cheaper is
  better), location (closer is better), rating (higher rated is better)?" Assistant
  1002 may also suggest criteria that may require specific values; for example,
  "you can say what kind of cuisine you would like or a food item you would
  like".
                                             -117-

WO 2011/088053                                                        PCT/US2011/020861
[0375]      In one embodiment, assistant 1002 may help the user make a deci
sion among choices that differ on a number of competing criteria (for exam
ple, price, quality, availability, and convenience).
[0376]      By providing such guidance, assistant 1002 may help users in mak
ing multiparametric decisions in any of several ways:
        -   One is to reduce the dirmensionality of the space, combining raw data
            such as ratings from multiple sources into a composite "recom
            mendation" score. The composite score may take into account do
            main knowledge about the sources of data (e.g., Zagat ratings may
            be more predictive of quality than Yelp).
        e   Another approach is tofocus on a subset of criteria,turning a problem
            of "what are all the possible criteria to consider and how to they
            combine?" into a selection of the most important criteria in a given
            situation (e.g., "which is more important, price or proximity?").
        " Another way to simply the decision making is to assume default val
            ues and preference orders (e.g., all things being equal, higher rated
            and closer and cheaper are better). The system may also remember
            users' previous responses that indicate their default values and
            preferences.
        * Fourth, the system may offer salient properties of items in the
            choice set that were not mentioned in the original request. For ex
             ample, the user may have asked for local Italian food. The system
             may offer a choice set of restaurants, and with them, a list of popu
             lar tags used by reviewers or a tag line from a guide book (e.g., "a
             nice spot for a date" "great pasta"). This could let people pick out a
             specific item and complete the task. Research shows that most
             people make decisions by evaluating specific instances rather than
             deciding on criteria and rationally accepting the one that pops to
             the top. It also shows that people learn about features from con
             crete cases. For example, when choosing among cars, buyers may
                                           -118-

WO 2011/088053                                                     PCT/US2011/020861
            not care about navigation systems until they see that some of the
            cars have them (and then the navigation system may become an
            important criterion). Assistant 1002 may present salient properties
            of listed items that help people pick a winner or that suggest a di
            mension along which to optimize.
 Conceptual Data Model
[0377]      In one embodiment, assistant 1002 offers assistance with the con
strained selection task by simplifying the conceptual data model. The concep
tual data model is the abstraction presented to users in the interface of assis
tant 1002. To overcome the psychological problems described above, in one
embodiment assistant 1002 provides a model that allows users to describe
what they want in terms of a few easily recognized and recalled properties of
 suitable choices rather than constraint expressions. In this manner, properties
can be made easy to compose in natural language requests (e.g., adjectives
 modifying keyword markers) and be recognizable in prompts ("you may also
 favor recommended restaurants..."). In one embodiment, a data model is used
 that allows assistant 1002 to determine the domain of interest (e.g., restaurants
 versus hotels) and a general approach to guidance that may be instantiated
 with domain-specific properties.
 [0378]     In one embodiment, the conceptual data model used by assistant
 1002 includes a selection class. This is a representation of the space of things
 from which to choose. For example, in the find-a-restaurant application, the
 selection class is the class of restaurants. The selection class may be abstract
 and have subclasses, such as "things to do while in a destination". In one
 embodiment, the conceptual data model assumes that, in a given problem
 solving situation, the user is interested in choosing from a single selection
 class. This assumption simplifies the interaction and also allows assistant
  1002 to declare its boundaries of competence ("I know about restaurants, ho
  tels, and movies" as opposed to "I know about life in the city").
                                           -119-

WO 2011/088053                                                         PCT/US2011/020861
[0379]      Given a selection class, in one embodiment the data model pre
sented to the user for the constrained selection task includes, for example:
items; item features; selection criteria; and constraints.
[0380]      Items are instances of the selection class.
[0381]      Item features are properties, attributes, or computed values that
may be presented and/or associated with at least one item. For example, the
name and phone number of a restaurant are item features. Features may be
intrinsic (the name or cuisine of a restaurant) or relational (e.g., the distance
from one's current location of interest). They may be static (e.g., restaurant
name) or dynamic (rating). They may be composite values computed from
other data (e.g., a "value for money" score). Item features are abstractions for
the user made by the domain modeler; they do not need to correspond to un
derlying data from back-end services.
[0382]      Selection criteria are item features that may be used to compare the
value or relevance of items. That is, they are ways to say which items are pre
ferred. Selection criteria are modeled as features of the items themselves,
whether they are intrinsic properties or computed. For example, proximity
 (defined as distance from the location of interest) is a selection criterion. Loca
 tion in space-time is a property, not a selection criterion, and it is used along
with the location of interest to compute the distance from the location of in
terest.
 [0383]     Selection criteria may have an inherent preference order. That is,
the values of any particular criterion may be used to line up items in a best
first order. For example, the proximity criterion has an inherent preference
 that closer is better. Location, on the other hand. has no inherent preference
 value. This restriction allows the system to make default assumptions and
 guide the selection if the user only mentions the criterion. For example, the
 user interface might offer to "sort by rating" and assume that higher rated is
 better.
                                          - 120 -

WO 2011/088053                                                      PCT/US2011/020861
[0384]       One or more selection criteria are also item features; they are those
features related to choosing among possible items. However, item features
are not necessarily related to a preference (e.g., the names and phone numbers
of restaurants are usually irrelevant to choosing among them).
[0385]       In at least one embodiment, constraints are restrictions on the de
sired values of the selection criteria. Formally, constraints might be repre
sented as set membership (e.g., cuisine type includes Italian), pattern matches
 (e.g., restaurant review text includes "romantic"), fuzzy inequalities (e.g., dis
tance less than a few miles), qualitative thresholds (e.g., highly rated), or more
complex functions (e.g., a good value for money). To make things simple
 enough for normal humans, this data model reduces at least one or more con
 straints to symbolic values that may be matched as words. Time and distance
 may be excluded from this reduction. In one embodiment, the operators and
 threshold values used for implementing constraints are hidden from the user.
 For example, a constraint on the selection criteria called "cuisine" may be rep
 resented as a symbolic value such as "Italian" or "Chinese".      A constraint on
 rating is "recommended" (a binary choice). For time and distance, in one em
 bodiment assistant 1002 uses proprietary representations that handle a range
 of inputs and constraint values. For example, distance might be "walking dis
 tance" and time might be "tonight"; in one embodiment, assistant 1002 uses
 special processing to match such input to more precise data.
  [0386]     In at least one embodiment, some constraints may be required con
  straints. This means that the task simply cannot be completed without this
  data. For example, it is hard to pick a restaurant without some notion of de
  sired location, even if one knows the name.
  [0387]      To summarize, a domain is modeled as selection classes with item
  features that are important to users. Some of the features are used to select
  and order items offered to the user - these features are called selection criteria.
  Constraints are symbolic limits on the selection criteria that narrow the set of
  items to those that match.
                                          -121 -

WO 2011/088053                                                       PCT/US2011/020861
[0388]       Often, multiple criteria may compete and constraints may match
partially. The data model reduces the selection problem from an optimization
(finding the best solution) to a matching problem (finding items that do well
on a set of specified criteria and match a set of symbolic constraints). The al
gorithms for selecting criteria and constraints and determining an ordering
are described in the next section.
Methodology for Constrained Selection
[0389]       In one embodiment, assistant 1002 performs constrained selection
by taking as input an ordered list of criteria, with implicit or explicit con
straints on at least one, and generating a set of candidate items with salient
features. Computationally, the selection task may be characterized as a
nested search: first, identify a selection class, then identify the important se
lection criteria, then specify constraints (the boundaries of acceptable solu
tions), and search through instances in order of best-fit to find acceptable
items.
[0390]       Referring now to Fig. 45, there is shown an example of an abstract
model 4500 for a constrained selection task as a nested search. In the example
assistant 1002 identifies 4505 a selection call among all local search types 4501.
The identified class is restaurant. Within the set of all restaurants 4502, assis
tant 1002 selects 4506 criteria. In the example, the criterion is identified as dis
tance. Within the set of restaurants in PA 4503, assistant 1002 specifies 4507
constraints for the search. In the example, the identified constraint is "Italian
cuisine"). Within the set of Italian restaurants in PA 4504, assistant 4508 se
lects4 itemsn frv presntation  to t-he user.
 [0391]      In one embodiment, such a nested search is what assistant 1002
 does once it has the relevant input data, rather than the flow for eliciting the
 data and presenting results. In one embodiment, such control flow is gov
 erned via a dialog between assistant 1002 and the user which operates by
 other procedures, such as dialog and task flow models. Constrained selection
                                           -122-

WO 2011/088053                                                      PCT/US2011/020861
offers a framework for building dialog and task flow models at this level of
abstraction (that is, suitable for constrained selection tasks regardless of do
main).
[0392]      Referring now to Fig. 46, there is shown an example of a dialog 4600
to help guide the user through a search process, so that the relevant input
data can be obtained.
[0393]      In the example dialog 4600, the first step is for the user to state the
kind of thing they are looking for, which is the selection class. For example,
the user might do this by saying "dining in palo alto". This allows assistant
1002 to infer 4601 the task and domain.
 [0394]     Once assistant 1002 has understood the task and domain binding
 (selection class = restaurants), the next step is to understand which selection
criteria are important to this user, for example by soliciting 4603 criteria
 and/or constraints. In the example above, "in palo alto" indicates a location
 of interest. In the context of restaurants, the system may interpret a location
 as a proximity constraint (technically, a constraint on the proximity criterion).
 Assistant 1002 explains what is needed, receives input. If there is enough in
 formation to constrain the choice set to a reasonable size, then assistant 1002
 paraphrases the input and presents 4605 one or more restaurants that meet
 the proximity constraint, sorted in some useful order. The user can then select
 4607 from this list, or refine 4606 the criteria and constraints. Assistant 1002
 reasons about the constraints already stated, and uses domain-specific knowl
 edge to suggest other criteria that might help, soliciting constraints on these
 criteria as well. For example, assistant 1002 may reason that, when recom
 mending restaurants within walking distance of a hotel, the useful criteria to
 solicit would be cuisine and table availability.
 [0395]      The constrained selection task is complete when the user selects
 4607 an instance of the selection class. In one embodiment, additional follow
 on tasks 4602 are enabled by assistant 1002. Thus, assistant 1002 can offer
 services that indicate selection while providing some other value. Examples
                                          -123-

WO 2011/088053                                                                                PCT/US2011/020861
4608 booking a restaurant, setting a reminder on a calendar, and/or sharing
the selection with others by sending an invitation. For example, booking a
restaurant certainly indicates that it was selected; other options might be to
put the restaurant on a calendar or send in invitation with directions to
friends.
[0396]        Referring now to Fig. 47, there is shown a flow diagram depicting a
method of constrained selection according to one embodiment. In one em
bodiment, assistant 1002 operates in an opportunistic and mixed-initiative
manner, permitting the user to jump to the inner loop, for instance, by stating
task, domain, criteria, and constraints one or more at once in the input.
[0397]         The method begins 4701. Input is received 4702 from the user, ac
cording to any of the modes described herein. If, based on the input, the task
not known, assistant 1002 requests 4705 clarifying input from the user.
[0398]         In step 4717, assistant 1002 determines whether the user provides
additional input. If so, assistant 1002 returns to step 4702. Otherwise the
method ends 4799.
 [0399]        If, in step 4703, the task is known, assistant 1002 determines 4704
whether the task is constrained selection. If not, assistant 1002 proceeds 4706
to the specified task flow.
 [0400]        If, in step 4704, the task is constrained selection, assistant 1002 de
termines 4707 whether the selection class can be determined. If not, assistant
1002 offers 4708 a choice of known selection classes, and returns to step 4717.
 [0401]        If, in step 4707, the selection class can be determined, assistant 1002
 determines 4709 whether all required constraints can be determined. If not,
 -s--   4.nt 1002    p-    -r t   A 710 f      reqifre-r                m ation, an
                                                                                  -nrd   retu   r n to   te
 aDDIDLaLL LV/ UUA       l~     L -1  W   W. -1-             -nu~aLIt,          un    tti ~U I n L-_  OLp
                                                                                                       DL
4717.
 [04021
 L-  -- A
               Tf. in step 4709. all required constants can be determined, assistant
                -
 1002 determines 4711 whether any result items can be found, given the con
 straints. If there are no items that meet the constraints, assistant 1002 offers
 4712 ways to relax the constraints. For example, assistant 1002 may relax the
                                                         -124-

WO 2011/088053                                                        PCT/US2011/020861
constraints from lowest to highest precedence, using a filter/sort algorithm.
In one embodiment, if there are items that meet some of the constraints, then
assistant 1002 may paraphrase the situation (outputting, for example, "I could
not find Recommended Greek restaurants that deliver on Sundays in San Car
los. However, I found 3 Greek restaurants and 7 Recommend restaurants in
San Carlos."). In one embodiment, if there are no items that match any con
straints, then assistant 1002 may paraphrase this situation and prompt for dif
ferent constraints (outputting, for example, "Sorry, I could not find any res
taurants in Anytown, Texas. You may pick a different location."). Assistant
 1002 returns to step 4717.
 [0403]       If, in step 4711, result items can be found, assistant 1002 offers 4713
 a list of items. In one embodiment, assistant 1002 paraphrases the currently
 specified criteria and constraints (outputting, for example, "Here are some
 recommended Italian restaurants in San Jose." (recommended=yes, cui
 sine=Italian, proximity=<in San Jose>)). In one embodiment, assistant 1002
 presents a sorted, paginated list of items that meet the known constraints.        If
 an item only shows some of the constraints, such a condition can be shown as
 part of the item display. In one embodiment, assistant 1002 offers the user
 ways to select an item, for example by initiating another task on that item
 such as booking, remembering, scheduling, or sharing. In one embodiment,
 on any given item, assistant 1002 presents item features that are salient for
 picking instances of the selection class. In one embodiment, assistant 1002
  shows how the item meets a constraint; for example, Zagat rating of 5 meets
  the Recommended=yes constraint, and "1 mile away" meets the "within
  walking distance of an address" constraint. In one embodiment, assistant
  1002 allows the user to drill down for more detail on an item, which results in
  display of more item features.
  [0404]       Assistant 1002 determines 4714 whether the user has selected an
  item. If the user selects an item, the task is complete. Any follow-on task is
  performed 4715, if there is one, and the method ends 4799.
                                             -125-

WO 2011/088053                                                        PCT/US2011/020861
[0405]      If, in step 4714, the user does not select an item, assistant 1002 offers
4716 the user ways to select other criteria and constraints and returns to step
4717. For example, given the currently specified criteria and constraints, as
sistant 1002 may offer criteria that are most likely to constrain the choice set to
a desired size. If the user selects a constraint value, that constraint value is
added to the previously determined constraints when steps 4703 to 4713 are
repeated.
[0406]      Since one or more criteria may have an inherent preference value,
selecting the criteria may add information to the request. For example, allow
ing the user to indicate that positive reviews are valued allows assistant 1002
to sort by this criterion. Such information can be taken into account when
steps 4703 to 4713 are repeated.
[0407]      In one embodiment, assistant 1002 allows the user to raise the im
portance of a criterion that is already specified, so that it would be higher in
the precedence order. For example, if the user asked for fast, cheap, highly
recommended restaurants within one block of their location, assistant 1002
may request that the user chooses which of these criteria are more important.
Such information can be taken into account when steps 4703 to 4713 are re
peated.
[0408]      In one embodiment, the user can provide additional input at any
point while the method of Fig. 47 is being performed. In one embodiment,
assistant 1002 checks periodically or continuously for such input, and, in re
sponse, loops back to step 4703 to process it.
[0409]      In one embodiment, when outputting an item or list of items, assis
tant     .10     Lidit, in t1e presetation of items,   ite feLu   thtL were used   to
select and order them. For example, if the user asked for nearby Italian restau
rants, such itpm fpaures for distanr and cuisine may be shown in the presen
tation of the item. This may include highlighting matches, as well as listing
selection criteria that were involved in the presentation of an item.
                                          - 126 -

            WO 2011/088053                                                                PCT/US2011/020861
            Example Domains
            [0410]        Table 1 provides an example of constrained selection domains that
            may be handled by assistant 1002 according to various embodiments.
Select a        Based on these criteria
                Location   -Price      Availability  lype          Quality    Name        Services  special     general
                                                                                                    search      search
Restaurant      proximity    attord-   open tables  cuisine        rating by  restaurant  delivery  menu        keywords
                             ability                               guide, re- name                  items
                                                                   view
Hotel           proximity    price     available    motel, no-     rating by  nlotel name amenities             keywords
                             range     rooms        tel, B&B, ...  guide, re
                                                                   view
Movie           tfeatre                show times   genre          rating by  movie title           actors,
                proximity                                          review                           etc
Local Busi-     proximity                            5siness       rating by  business                          keywords
ness                                                category       review     name
Local event     venue                   by date                               event title                       keywords
                proximity
concert         venue                   by tour     music                     band name             bn          keywords
                proximity               schedule    genre                                           members
 CD, book,                   price      onlme, in   download,      popularity album or              artist,     keywords
 DVD to buy                  range      store, etc  physical                  song name             title, etc.
                                                            Table 1
             Filtering and Sorting Results
             [0411]       In one embodiment, when presenting items that meet currently
             specified criteria and constraints, a filter/sort methodology can be employed.
             In one embodiment selection constraints may serve as both filter and sort pa
             rameters to the underlying services. Thus, any selection criterion can be used
                                                                -127   -

WO 2011/088053                                                       PCT/US2011/020861
to determine which items are in the list, and to compute the order in which to
paginate and show them. Sort order for this task is akin to relevance rank in
search. For example, proximity is a criterion with symbolic constraint values
such as "within driving distance" and a general notion of sorting by distance.
The "driving distance" constraint might be used to select a group of candidate
items. Within that group, closer items might be sorted higher in the list.
[0412]     In one embodiment, selection constraints and associated filtering
and sorting are at discrete "levels", which are functions of both the underly
ing data and the input from the user. For example, proximity is grouped into
levels such as "walking distance", "taxi distance", "driving distance". When
sorting, one or more items within walking distance are treated as if they were
the same distance. The input from the user may come into play in the way he
or she specifies a constraint. If the user enters "in palo alto", for example,
then one or more items within the Palo Alto city limits are perfect matches
and are equivalent. If the user enters, "near the University Avenue train sta
tion" then the match would depend on a distance from that address, with the
degree of match dependent on the selection class (e.g., near for restaurants is
different than near for hotels). Even within a constraint that may be specified
with a continuous value, a discretization may be applied. This may be impor
tant for sorting operations, so that multiple criteria may participate in deter
mining the best-first ordering.
[0413]     In one embodiment, the item list -- those items that are considered
"matching" or "good enough" -- may be shorter or longer than the number of
items shown on one "page" of the output. Generally, items in the first page
are given  Uthe 11st attention, bUL  oLe1LLpLUa1y LLr is   a long1er lit, and pagi
nation is simply a function of the form factor of the output medium. This
means, for instance, that if the user is offered a way to sort or browse the
items by some criterion, then it is the entire set of items (more than one page
worth) that is sorted or browsed.
                                         - 128 -

WO 2011/088053                                                    PCT/US2011/020861
[0414]      In one embodiment, there is a precedence ordering among selection
criteria. That is, some criteria may matter more than others in the filter and
sort. In one embodiment, those criteria selected by the user are given higher
precedence than others, and there is a default ordering over one or more crite
ria. This allows for a general lexicographic sort. The assumption is that there
is a meaningful a prioriprecedence. For example, unless the user states oth
erwise, it may be more important for a restaurant to be close than to be inex
pensive. In one embodiment, the a priori precedence ordering is domain
specific. The model allows for user-specific preferences to override the do
main defaults, if that is desired.
[0415]      Since the values of constraints can represent several internal data
types, there are different ways for constraints to match, and they may be spe
cific to the constraint. For example, in one embodiment:
         " Binary constraints match one or more or none. For example,
            whether a restaurant is "Fast" might be either true or not.
         " Set membership constraints match one or more or none based on a
            property value. For example, cuisine=Greek means the set of cui
            sines for a restaurant includes Greek.
         " Enumeration constraints match at a threshold. For example, a rat
            ing criterion might have constraint values rated, highly-rated, or
            top-rated. Constraining to highly-rated would also match top
            rated.
         " Numeric constraints match at a threshold that may be criterion spe
            cific. For example, "open late" might be a criterion, and the user
            might ask for places open after 10:00pm. This kind of constraint
            may be slightly out of scope for the constrained selection task, since
            it is not a symbolic constraint value. However, in one embodiment,
            assistant 1002 recognizes some cases of numeric constraints like
            this, and maps them to threshold values with symbolic constraints
                                         -129-

WO 2011/088053                                                       PCT/US2011/020861
           (e.g., "restaurants in palo alto open now" -> "here are 2 restaurants
           in palo alto that are open late").
        a  Location and time are handled specially. A constraint on proximity
           might be a location of interest specified at some level of granularity,
           and that determines the match. If the user specifies a city, then city
           level matching is appropriate; a ZIP code may allow for a radius.
           Assistant 1002 may also understand locations that are "near" other
           locations of interest, also based on special processing. Time is rele
           vant as a constraint value of criteria that have threshold value based
           on a service call, such as table availability or flights within a given
           time range.
[0416]     In one embodiment, constraints can be modeled so that there is a
single threshold value for selection and a small set of discrete values for sort
ing. For example, the affordability criterion might be modeled as a roughly bi
nary constraint, where affordable restaurants are any under some threshold
price range. When the data justify multiple discrete levels for selection, con
straints can be modeled using a gradient of matching. In one embodiment
two levels of matching (such as strong and weak matching) may be provided;
however, one skilled in the art will recognize that in other embodiments, any
number of levels of matching can be provided. For example, proximity may
be matched with a fuzzy boundary, so that things that are near the location of
interest may match weakly. The operational consequence of a strong or weak
match is in the filter/ sort algorithm as described below.
[0417]     For at least one criterion, an approach to matching and default
tnreshold-s can be estabiheu, i reevaia.        11e user may be able to say just the
name of the constraint, a symbolic constraint value, or a precise constraint ex
pression if it is handled specially (such as time and location).
[0418]     An ideal situation for constrained selection occurs when the user
states constraints that result in a short list of candidates, one or more of which
meet the constraints. The user then chooses among winners based on item
                                         -130-

WO 2011/088053                                                        PCT/US2011/020861
features. In many cases, however, the problem is over- or under-constrained.
When it is over-constrained, there are few or no items that meet the con
straints. When it is under-constrained, there are so many candidates that ex
amining the list is not expedient. In one embodiment, the general constrained
selection model of the present invention is able to handle multiple constraints
with robust matching and usually produce something to choose from. Then
the user may elect to refine their criteria and constraints or just complete the
 task with a "good enough" solution.
Method
 [0419]    In one embodiment, the following method is used for filtering and
 sorting results:
     1. Given an ordered list of selection criteria selected by the user, deter
        mine constraints on at least one.
            a. If the user specified a constraint value, use it. For example, if
                the user said "greek food" the constraint is cuisine=Greek. If the
                user said "san Francisco" the constraint is In the City of San Fran
                cisco. If the user said "south of market" then the constraint is In
                the Neighborhood of SoMa.
            b. Otherwise use a domain- and criteria-specific default. For ex
                ample, if the user said "a table at some thai place" he or she is
                indicating that the availabilitycriterion is relevant, but he or she
                did not specify a constraint value. The default constraint values
                for availability might be some range of date times such as tonight
                and a default party size of 2.
     2. Select a minimum of N results by specified constraints.
            a. Try to get N results at strong match.
            b. If that fails, try to relax constraints, in reverse precedence order.
                 That is, match at strong level for one or more of the criteria ex
                 cept the last, which may match at a weak level. If there is no
                                            -131 -

WO 2011/088053                                                       PCT/US2011/020861
               weak match for that constraint, then try weak matches up the
               line from lowest to highest precedence.
           c. Then repeat the loop allowing failure to match on constraints,
               from lowest to highest precedence.
   3. After getting a minimum choice set, sort lexicographically over one or
       more criteria (which may include user-specified criteria as well as other
       criteria) in precedence order.
           a. Consider the set of user-specified criteria as highest precedence,
               then one or more remaining criteria in their a priori precedence.
               For example, if the a priori precedence is (availability, cuisine,
               proximity, rating), and the user gives constraints on proximity
               and cuisine, then the sort precedence is (cuisine, proximity,
               availability, rating).
           b. Sort on criteria using discrete match levels (strong, weak, none),
               using the same approach as in relaxing constraints, this time ap
               plied the full criteria list.
                    i. If a choice set was obtained without relaxing constraints,
                       then one or more of the choice set may "tie" in the sort
                       because they one or more match at strong levels. Then,
                       the next criteria in the precedence list may kick in to sort
                       them. For example, if the user says cuisine=ltalian, prox
                       imity=In San Francisco,and the sort precedence is (cui
                       sine, proximity, availability, rating), then one or more the
                       places on the list have equal match values for cuisine and
                       proximiLty. So the list would be sorted on availability
                       (places with tables available bubble to the top). Within
                       thep avaiLAle pAce, t-he   -highestrated nes,would ber   at
                       the top.
                   ii. If the choice set was obtained by relaxing constraints,
                       then one or more of the fully matching items are at the
                                           -132-

WO 2011/088053                                                        PCT/US2011/020861
                       top of the list, then the partially matching items. Within
                       the matching group, they are sorted by the remaining cri
                       teria, and the same for the partially matching group. For
                       example, if there were only two Italian restaurants in San
                       Francisco, then the available one would be shown first,
                       then the unavailable one. Then the rest of the restaurants
                       in San Francisco would be shown, sorted by availability
                        and rating.
 Precedence Ordering
 [0420]      The techniques described herein allow assistant 1002 to be ex
 tremely robust in the face of partially specified constraints and incomplete
 data. In one embodiment, assistant 1002 uses these techniques to generate a
 user list of items in best-first order, i.e. according to relevance.
 [0421]      In one embodiment, such relevance sorting is based on an a priori
 precedence ordering. That is, of the things that matter about a domain, a set
 of criteria is chosen and placed in order of importance. One or more things
 being equal, criteria higher in the precedence order may be more relevant to a
 constrained selection among items than those lower in the order. Assistant
 1002 may operate on any number of criteria. In addition, criteria may be
 modified over time without breaking existing behaviors.
  [0422]     In one embodiment, the precedence order among criteria may be
  tuned with domain-specific parameters, since the way criteria interact may
  depend on the selection class. For example, when selecting among hotels,
  availability and price may be dominant constraints, whereas for restaurants,
  cuisine and proximity may be more important.
  [0423]     In one embodiment, the user may override the default criteria or
  dering in the dialog. This allows the system to guide the user when searches
  are over-constrained, by using the ordering to determine which constraints
  should be relaxed. For example, if the user gave constraints on cuisine, prox
  imity, recommendation, and food item, and there were no fully matching
                                            -133-

WO 2011/088053                                                      PCT/US2011/020861
items, the user could say that food item was more important than recommen
dation level and change the mix so the desired food item matches were sorted
to the top.
[0424]      In one embodiment, when precedence order is determined, user
specified constraints take precedence over others. For example, in one em
bodiment, proximity is a required constraint and so is always specified, and
further has precedence over other unselected constraints. Therefore it does
not have to be the highest precedence constraint in order to be fairly domi
nant. Also, many criteria may not match at one or more unless a constraint is
given by the user, and so the precedence of these criteria only matters within
user-selected criteria. For example, when the user specifies a cuisine it is im
portant to them, and otherwise is not relevant to sorting items.
[0425]      For example, the following is a candidate precedence sorting para
digm for the restaurant domain:
    1. cuisine* (not sortable unless a constraint value is given)
    2. availability* (sortable using a default constraint value, e.g., time)
    3. recommended
    4. proximity* (a constraint value is always given)
    5. affordability
    6. may deliver
    7. food item (not sortable unless a constraint value, e.g., a keyword, is
        given)
    8. keywords (not sortable unless a constraint value, e.g., a keyword, is
        given)
    9. restaurant name
 [0426]     The following is an example of a design rationale for the above sort
ing-parnrlio-m
        * If a user specifies a cuisine, he or she wants it to stick.
                                         -134-

WO 2011/088053                                                     PCT/US2011/020861
       e   One or more things being equal, sort by rating level (it is the highest
           precedence among criteria than may be used to sort without a con
           straint).
       * In at least one embodiment, proximity may be more important than
           most things. However, since it matches at discrete levels (in a city,
           within a radius for walking and the like), and it is always specified,
           then most of the time most matching items may "tie" on proximity.
       " Availability (as determined by a search on a website such as open
           table.com, for instance) is a valuable sort criterion, and may be
           based on a default value for sorting when not specified. If the user
           indicates a time for booking, then only available places may be in
           the list and the sort may be based on recommendation.
       " If the user says they want highly recommended places, then it may
           sort above proximity and availability, and these criteria may be re
           laxed before recommendation. The assumption is that if someone is
           looking for nice place, they may be willing to drive a bit farther and
           it is more important than a default table availability. If a specific
           time for availability is specified, and the user requests recom
           mended places, then places that are both recommended and avail
           able may come first, and recommendation may relax to a weak
           match before availability fails to match at one or more.
        " The remaining constraints except for name are one or more based
           on incomplete data or matching. So they are weak sort heuristics
           by default, and when they are specified the match one or more-or
           none.
        " Name may be used as a constraint to handle the case where some
            one mentions the restaurant by name, e.g., find one or more Ho
           bee's restaurants near Palo Alto. In this case, one or more items
            may match the name, and may be sorted by proximity (the other
            specified constraint in this example).
                                          -135 -

WO 2011/088053                                                       PCT/US2011/020861
Domain Modeling: Mapping Selection Criteria to underlyingdata
[0427]     It may be desirable to distinguish between the data that are avail
able for computation by assistant 1002 and the data used for making selec
tions. In one embodiment, assistant 1002 uses a data model that reduces the
complexity for the user by folding one or more kinds of data used to distin
guish among items into a simple selection criteria model. Internally, these
data may take several forms. Instances of the selection class can have intrinsic
properties and attributes (such as cuisine of a restaurant), may be compared
along dimensions (such as the distance from some location), and may be dis
covered by some query (such as whether it matches a text pattern or is avail
able at a given time). They may also be computed from other data which are
not exposed to the user as selection criteria (e.g., weighted combinations of
ratings from multiple sources). These data are one or more relevant to the
task, but the distinctions among these three kinds of data are not relevant to
the user. Since the user thinks in terms of features of the desired choice rather
than in properties and dimensions, assistant 1002 operationalizes these vari
ous criteria into features of the items. Assistant 1002 provides a user-facing
domain data model and maps it to data found in web services.
[0428]     One type of mapping is an isomorphism from underlying data to
user-facing criteria. For example, the availability of tables for reservations as
seen by the user could be exactly what an online reservation website, such as
opentable.com, offers, using the same granularity for time and party size.
[0429]     Another type of mapping is a normalization of data from one or
more services to a common value set, possibly with a unification of equivalent
values. For example, cuisines of one or more restaurants may be represented
as a single ontology in assistant 1002, and mapped to various vocabularies
used in different services. That ontology might be hierarchical, and have leaf
nodes poining tspecii values fr            at least one service. For example, one
service might have a cuisine value for "Chinese", another for "Szechuan", and
a third for "Asian". The ontology used by assistant 1002 would cause refer
                                         -136   -

WO 2011/088053                                                       PCT/US2011/020861
ences to "Chinese food" or "Szechuan" to semantically match one or more of
these nodes, with confidence levels reflecting the degree of match.
[0430]     Normalization might also be involved when resolving differences
in precision. For example, the location of a restaurant may be given to the
street level in one service but only to city in another. In one embodiment, as
sistant 1002 uses a deep structural representation of locations and times that
may be mapped to different surface data values.
[0431]     In one embodiment, assistant 1002 uses a special kind of mapping
for open-ended qualifiers (e.g., romantic, quiet) which may be mapped to
matches in full text search, tags, or other open-textured features. The name of
the selection constraint in this case would be something like "is described as".
 [0432]    In at least one embodiment, constraints may be mapped to opera
tional preference orderings. That is, given the name of a selection criterion
 and its constraint value, assistant 1002 is able to interpret the criterion as an
 ordering over possible items. There are several technical issues to address in
 such a mapping. For example:
        * Preference orderings may conflict. The ordering given by one con
            straint may be inconsistent or even inversely correlated with the
            ordering given by another. For example, price and quality tend to
            be in opposition. In one embodiment, assistant 1002 interprets con
            straints chosen by the user in a weighted or otherwise combined
            ordering that reflects the user's desires but is true to the data. For
            example, the user may ask for "cheap fast food French restaurants
            within walking distance rated highly". In many locations, there
            may not be any such restaurant. However, in one embodiment, as
            sistant 1002 may show a list of items that tries to optimize for at
            least one constraint, and explain why at least one is listed. For ex
            ample, item one might be "highly rated French cuisine" and an
            other "cheap fast food within walking distance".
                                         -137  -

WO 2011/088053                                                      PCT/US2011/020861
        "  Data may be used as either hard or soft constraints. For example,
           the price range of a restaurant may be important to choosing one,
           but it may be difficult to state a threshold value for price up-front.
           Even seemingly hard constraints like cuisine may be, in practice,
           soft constraints because of partial matching. Since, in one embodi
           ment, assistant 1002 using a data modeling strategy that seeks to
           flatten one or more criteria into symbolic values (such as "cheap" or
           "close"), these constraints may be mapped into a function that gets
           the criteriaand order right, without being strict about matching spe
           cific threshold values. For symbolic criteria with clear objective
           truth values, assistant 1002 may weight the objective criteria higher
           than other criteria, and make it clear in the explanation that it
           knows that some of the items do not strictly match the requested
           criteria.
       * Items may match some but not one or more constraints, and the
           "best fitting" items may be shown.
       * In general, assistant 1002 determines which item features are salient
           for a domain, and which may serve as selection criteria, and for at
           least one criteria, possible constraint values. Such informnanon can
           be provided, for example, via operational data and API calls.
Paraphrase and Prompt Text
[0433]     As described above, in one embodiment assistant 1002 provides
feedback to show it understands the user's intent and is working toward the
user's goal by producing paraphrases of its current understanding. In the
conversational dialog model of the present invention, the paraphrase is what
assistant 1002 ULpuLs aLfter       us
                                 LtL     input, as a preface (for example, para
phrase 4003 in Fig. 40) or summary of the results to follow (for example, list
3502 in Fig. 35). The prompt is a suggestion to the user about what else they
                                         -138-

WO 2011/088053                                                      PCT/US2011/020861
can do to refine their request or explore the selection space along some di
mensions.
[0434]      In one embodiment, the purposes of paraphrase and prompt text
include, for example:
        * to show that assistant 1002 understands the concepts in the user's
            input, not just the text;
         " to indicate the boundaries of assistant's 1002 understanding;
         e  to guide the user to enter text that is required for the assumed task;
         " to help the user explore the space of possibilities in constrained se
             lection;
         e   to explain the current results obtained from services in terms of the
             user's stated criteria and assistant's 1002 assumptions (for example,
             to explain the results of under- and over-constrained requests).
 [0435]      For example, the following paraphrase and prompt illustrates sev
 eral of these goals:
         User input: indonesian food in menlo park
         System interpretation:
         Task=constrainedSelection
         SelectionClass=restaurant
          Constraints:
                 Location=Menlo Park, CA
                 Cuisine=Indonesian (known in ontology)
          Results from Services: no strong matches
          Paraphrase: Sorry, I can't find any Indonesian restaurants near Menlo
 Park.
          Prompt: You could try other cuisines or locations.
          Prompt under hypertext links:
                                           -139-

WO 2011/088053                                                      PCT/US2011/020861
        Indonesian: You can try other food categories such as Chinese, or a fa
           vorite food item such as steak.
        Menlo Park: Enter a location such as a city, neighborhood, street ad
           dress, or "near" followed by a landmark.
        Cuisines: Enter a food category such as Chinese or Pizza.
        Locations: Enter a location: a city, zip code, or "near" followed by the
           name of a place.
[0436]     In one embodiment, assistant 1002 responds to user input relatively
quickly with the paraphrase. The paraphrase is then updated after results are
known. For example, an initial response may be "Looking for Indonesian res
taurants near Menlo Park..." Once results are obtained, assistant 1002 would
update the text to read, "Sorry, I can't find any Indonesian restaurants near
Menlo Park. You could try other cuisines or locations." Note that certain
items are highlighted (indicated here by underline), indicating that those
items represent constraints that can be relaxed or changed.
[0437]     In one embodiment, special formatting/highlighting is used for key
words in the paraphrase. This can be helpful to facilitate training of the user
for interaction with intelli gent automated assistant 1002, by indicating to the
user which words are most important to, and more likely to be recognized by,
assistant 1002. User may then be more likely to use such words in the future.
[0438]     In one embodiment, paraphrase and prompt are generated using
any relevant context data. For example, any of the following data items can
be used, alone or in combination:
        -  The parse - a tree of ontology nodes bound to their matching input
           tokens, with annotations and exceptions. For each node in the
           parse, this may include the node's metadata and/or any tokens in
           the input that provide evidence for the node's value.
        " The task, if known
        " The selection class.
                                         -140-

WO 2011/088053                                                         PCT/US2011/020861
         "  The location constraint, independent of selection class.
         -  Which requiredparameters are unknown for the given selection
            class (e.g., location is a required constraint on restaurants).
         " The name of a named entity in the parse that is an instance of the
            selection class, if there is one (e.g., a specific restaurant or movie
            name.)
         e  Is this a follow-up refinement or the beginning of a conversation?
            (Reset starts a new conversation.)
         " Which constraints in the parse are bound to values in the input that
            changed their values? In other words, which constraints were just
            changed by the latest input?
         " Is the selection class inferred or directly stated?
         * Sorted by quality, relevance, or proximity?
         " For each constraint specified, how well was it matched?
         * Was refinement entered as text or clicking?
 [0439]     In one embodiment, the paraphrase algorithm accounts for the
 query, domain model 1056, and the service results. Domain model 1056 con
 tains classes and features including metadata that is used to decide how to
 generate text. Examples of such metadata for paraphrase generation include:
         " IsConstraint={true Ifalse}
          " IsMultiValued={true Ifalse}
          e ConstraintType={EntityName, Location, Time, CategoryConstraint,
            AvailabilityConstraint, BinaryConstraint, SearchQualifier, Guess
            edQualifier}
          " DisplayName=string
          e  DisplayTemplateSingular=string
          " DisplayTemplatePlural=string
          " Grammatical
             Role={AdjectiveBeforeNounNounThatClauseModifer}
  [0440]     For example, a parse might contain these elements:
                                           -141   -

WO 2011/088053                                                PCT/US2011/020861
               Class: Restaurant
               IsConstraint=false
               DisplayTemplateSingular="restaurant"
               DisplayTemplatePlural="restaurants"
               GrammaticalRole=Noun
               Feature: RestaurantName (example: "Il Fornaio")
               IsConstraint=true
               IsMultiValued=false
               ConstraintType=EntityName
               DisplayTemplateSingular="named $1"
               DisplayTemplatePlural="named $1"
               GrammaticalRole=Noun
               Feature: RestaurantCuisine (example: "Chinese")
               IsConstraint=true
               IsMultiValued=false
                       ConstraintType= CategoryConstraint
               Graic        a    le =iveforeNoun
               Feature: RestaurantSubtype (example: "caf6")
               IsConstraint=true
               IsMultiValued=false
               ConstraintType= CategoryConstraint
               DisplayTemplateSingular="$1"
               DisplayTemplatePlural="$1s"
                                        UI
               Gr-lirammatllcEdalX'Jl=iNon
               Feature: RestaurantQualifiers (example: "romantic")
               IsConstraint=true
                                           - 142 -

WO 2011/088053                                               PCT/US2011/020861
               IsMultiValued=true
               ConstraintType=SearchQualifier
               DisplayTemplateSingular="is described as $1"
               DisplayTemplatePlural="are described as $1"
               DisplayTemplateCompact="matching $1"
               GrammaticalRole=Noun
               Feature: FoodType (example: "burritos")
               IsConstraint=true
               IsMultiValued=false
               ConstraintType= SearchQualifier
               DisplayTemplateSingular="serves $1"
               DisplayTemplatePlural="serve $1"
               DisplayTemplateCompact="serving $1"
               GrammaticalRole=ThatClauseModifer
               Feature: IsRecommended (example: true)
               IsConstraint=true
               IsMultiValued=false
               ConstraintType= BinaryConstraint
               DisplayTemplateSingular="recommended"
               DisplayTemplatePlural="recommended"
               GrammaticalRole=AdjectiveBeforeNoun
               Feature: RestaurantGuessedQualifiers (example: "spectacular")
               IsConstraint=true
               IsMultiValued=false
               ConstraintType= GuessedQualifier
               DisplayTemplateSingular=" matches $1 in reviews"
               DisplayTemplatePlural="match $1 in reviews"
                                     -143  -

WO 2011/088053                                                       PCT/US2011/020861
                DisplayTemplateCompact="matching $1"
                GrammaticalRole=ThatClauseModifer
[0441]      In one embodiment, assistant 1002 is able to handle unmatched in
put. To handle such input, domain model 1056 can provide for nodes of type
GuessedQualifier for each selection class, and rules that match otherwise un
matched words if they are in the right grammatical context. That is, Guess
edQualifiers are treated as miscellaneous nodes in the parse which match
when there are words that are not found in the ontology but which are in the
right context to indicate that that are probably qualifiers of the selection class.
The difference between GuessedQualifiers and SearchQualifiers is that the lat
ter are matched to vocabulary in the ontology. This distinction allows us to
paraphrase that assistant 1002 identified the intent solidly on the SearchQuali
fiers and can be more hesitant when echoing back the GuessedQualifiers.
[0442]      In one embodiment, assistant 1002 performs the following steps
when generating paraphrase text:
    1. If the task is unknown, explain what assistant 1002 can do and prompt
        for more input.
    2.  Ifithe Lask1 is  consrai
                            a    l    slectiotlask  and  the location is known,
        then explain the domains that assistant 1002 knows and prompt for the
        selection class.
    3. If the selection class is known but a required constraint is missing, then
        prompt for that constraint. (for example, location is required for con
        strained selection on restaurants)
    4. if the input contains an EntityName of the selection class, then output
        "looking up" <name> in <location>.
    5. If this is the initial requestin a conversation, then output "looking for"
        followed by the complex noun phrase that describes the constraints.
    6. If this is a follow-up refinement step in the dialog,
                                             -144-

WO 2011/088053                                                              PCT/US2011/020861
             a. If the user just completed a requiredinput, then output "thanks"
                 and then paraphrase normally. (This happens when there is a
                 required constraint that is mapped to the user input.)
             b. If the user is changing a constraint, acknowledge this and then
                 paraphrase normally.
             c. If the user typed in the proper name of an instance of the selec
                 tion class, handle this specially.
             d. If the user just added an unrecognized phrase, then indicate
                 how it will be folded in as search. If appropriate, the input may
                 be dispatched to a search service.
             e. If the user is just adding a normal constraint, then output "OK",
                 and paraphrase normally.
     7. To explain results, use the same approach for paraphrase. However,
         when the results are surprising or unexpected, then explain the results
         using knowledge about the data and service. Also, when the query is
         over- or underconstrained, prompt for more input.
 Grammarfor ConstructingComplex Noun Phrases
 [0443]      In one embodiment, when paraphrasing 734 a constrained selection
task query, the foundation is a complex noun phrase around the selection
 class that refers to the current constraints. Each constraint has a grammatical
 position, based on its type. For example, in one embodiment, assistant 1002
 may construct a paraphrase such as:
         recommended romantic Italian restaurants near Menlo Park
         with open tables for 2 that serve osso buco and are described as "guiet"
         A grammar to construct this is
                                               - 145 -

WO 2011/088053                                                        PCT/US2011/020861
<paraphraseNounClause>:== <binaryConstraint> <searchQualifier> <cate
        goryConstraint> <itemNoun> <locationConstraint> <availabiltyCon
       straint> <adjectivalClauses>
<binaryConstraint> :== single adjective that indicates the presence or absence
        of a BinaryConstraint (e.g., recommended (best), affordable (cheap))
       It is possible to list more than one in the same query.
<searchQualifier>:== a word or words that match the ontology for a qualifier
        of the selection class, which would be passed into a search engine ser
        vice. (e.g., romantic restaurants, funny movies).
        Use when ConstraintType=SearchQualifier.
<categoryConstraint> :== an adjective that identifies the genre, cuisine, or
        category of the selection class (e.g., Chinese restaurant or R-rated file).
        It is the last prefix adjective because it is the most intrinsic. Useforfea
        tures of type CategoryConstraintand Grammatical
        Role=AdjectiveBeforeNoun.
<itemNoun>:== <namedEntityPhrase> I <selectionClass> I <selection
        ClassSubType>
       find the most specific way to display the noun. NamedEntity < SubType <
        Class
 <selectionClass> :== a noun that is the generic name for the selection class
        (e.g., restaurant, movie, place)
 <selectionClassSubType>:== a noun phrase that is the subtype of the selec
        tion class if it is known (e.g., diner, museum, store, bar for the selection
                                           -146-

WO 2011/088053                                                      PCT/US2011/020861
        class local business). Use forfeatures in which ConstraintType
        =CategoryConstraintand GrammaticalRole=AdjectiveBeforeNoun.
<namedEntityPhrase>:== <entityName> I
        "the" (<selectionClass> I <selectionClassSubType>)
<entityName>:== the proper name of an instance of the selection class (e.g.,
        "Il Fornaio" "Animal House" "Harry's Bar")
 <locationConstraint>:== <locationPreposition> <locationName>
 <locationPreposition>:== "in", "near", "at", and the like
 <locationName> :== city, street address, landmark, or something for GPS like
        "your current location"
 <availabilityConstraint>:== the availability constraint expressed as a preposi
        tional phrase that comes after the noun (e.g., "with open tables", "with
        seats available", "available online"). It comes right after the noun to
        give it salience.
 <adjectivalClauses> :== <modiferVerbPhrase> I "that"
        <modiferVerbPhrase> "and" <modiferVerbPhrase>
 <modiferVerbPhrase>:= a verb phrase that expresses a search-keyword style
        constraint on the selection class (e.g., restaurants that "are described as
        quiet", "serve meat after 11", "match 'tragically hip' in reviews"; mov
        ies that "contain violence", "star Billy Bob Thornton"). Include all con
        straints in the parse whose GrammaticalRole=ThatClauseModifer,using
        the "that.. .and" variant if there are more than one. Use the Display
        TemplatePlural to generate the "that" clauses, putting the Guessed
                                           - 147 -

WO 2011/088053                                                    PCT/US2011/020861
       Qualifier last. If there is only one such constraint, use the Display
       TemplateCompact variant.
[0444]     Table 2 provides some examples of paraphrases that may be pro
vided in response to the first input for a task, according to one embodiment.
                                         -148-

WO 2011/088053                                                              PCT/US2011/020861
 Input                         Initial Paraphrase
 tie house                     Sorry, I don't understand "tie house". I know about restaurants,
                               hotels, and other local businesses, flights, weather, and buying
                               things online. What are you looking for, and where?
 palo alto                     I can help you find restaurants, businesses, events, and things
                               to do in Palo Alto. What are you looking for?
 food                          Looking for a place to eat? Where? (examples)
 Italian food                  I can tell you about Italian restaurants in your area. Where
                               would you like to eat?
 burrito                       I can help you find places that serve burritos in your area.
                               Where would you like to eat?
 best mexican food             I can help you find good Mexican restaurants in your area.
                               Where are you?
 restaurants palo alto         Looking for restaurants near Palo Alto.
 Italian palo alto             Looking for Italian restaurants near Palo Alto.
 thai food in menlo park       Looking for Thai restaurants near Menlo Park
 indonesian food in menlo      Looking for Indonesian restaurants near Menlo Park
 park
 best mexican food in Palo     Looking for recommended Mexican restaurants near Palo Alto.
 Alto
 fast food menlo park          Looking for fast food restaurants near Menlo Park
 healthy food in menlo park    Looking for places near Menlo Park that serve healthy food.
 dive bar in menlo park        Looking for dive bars near Menlo Park.
 pool room in menlo park       Looking for pool rooms near Menlo Park.
 hookah room in menlo park     Looking for places near Menlo Park described as "hookah
                               room".
 spicy food in sf              Looking for places near Menlo Park that serve spicy food.
 burgers in Menlo park         Looking for places near Menlo Park that serve burgers.
 belly dancing place in sf     Looking for places near San Francisco described as "belly
                               dancing".
  belly dancing place in menlo Looking for places near Menlo Park described as "belly danc
 park                          ing".
 juke joint in sf              Looking for joints near San Francisco described as "juke".
 tie house Menlo park          Looking for places near Menlo Park described as "tie house".
 thai house palo alto          Looking up Thai House in Palo Alto
  ilfornaio menlo park         Looking up |I Fornaio in Palo Alto
  il fornao in Menlo park      Looking for places near Palo Alto described as "il fornao".
  cliff house in Menlo park    Looking up Cliff House in Palo Alto
                                            - 149  -

WO 2011/088053                                                                    PCT/US2011/020861
 romantic restaurant in palo        Looking for romantic restaurants in Palo Alto
 alto
 romantic restaurant in palo        Looking for romantic restaurants in Palo Alto
 alto
 quiet romantic restaurant in       Looking for romantic restaurants in Palo Alto described as
 palo alto                          "quiet"
 quiet romantic restaurant in       Looking for romantic restaurants in Palo Alto described as
 palo alto                           'quiet"
 tragically hip restaurant in       Looking for restaurants in Palo Alto described as "tragically hip"
 palo alto
 tragically hip restaurant in       Looking for restaurants in Palo Alto described as "tragically hip"
 paio alto
 table for two tonight in palo      Checking availability for tonight at restaurants near Palo Alto.
 alto
 table for two italian food to-     Checking availability for tonight at Italian restaurants near Palo
 night in palo alto                 Alto.
 il fornaio palo alto 6pm for 2     Checking availability for tables tonight at il Fornaio in Palo Alto.
 table for 2 at thai house in PA    Checking availability for tables tonight at Thai House in Palo
                                    Alto.
 pizza delivery in menlo park
 I want the best quiet romantic     OK, looking for recommended romantic italian restaurants near
 italian restaurant for osso        Menlo Park that serve osso buco and are described as "quiet".
 buco in or near menlo park
 Rnnk me a table for 2 at the       OK Ionkinn for recommended romantic italian restaurants near
 best quiet romantic italian        Menlo Park with open tables for 2 that serve osso buco and are
 restaurant for osso buco in or     described as "quiet".
 near menlo park                   I
          Table 2: Paraphrases in response to first input
Refining a query about places to eat
[04451        Table 3 provides some examples of paraphrases in response to a
situation where user's intent to find a place to eat is known, but they have not
selected a particular place to eat. They are facing a list of restaurants, and
they provide refinements.
 Refinements
 menlo park (was un
 known)                         Thanks, now looking for restaurants in Menlo Park.
                                                -150-

WO 2011/088053                                                                  PCT/US2011/020861
  cheapest                    OK, looking for affordable restaurants near Menlo Park.
                              OK, changing cuisine to Chinese. Looking for Chinese restaurants near
  chinese (was italian)       Menlo Park.
  pizza (adding food item)    OK, looking for Italian restaurants near Menlo Park that serve pizza.
  san francisco (was          OK, changing location to San Francisco. Looking for Italian restaurants
  menlo park)                 near San Francisco that serve pizza.
  tragically hip              OK, I'll search reviews for "tragically hip".
  quiet romantic              OK, looking for romantic restaurants in Palo Alto described as "quiet"
  cliff house                 Cliff House sounds familiar. I'll look it up in Palo Alto.
           Table 3: Paraphrases in response to refinements
 [0446]         Table 4 provides some examples of results summaries that are pro
vided once results are obtained.
   Input                      # Results      Results Summary
   tie house                  N/A            N/A (no call to services)
   palo alto                  N/A            N/A (no call to services)
   food                       N/A            N/A (no call to services)
   Italian food               N/A            N/A (no call to services)
   burrito                    N/A            N/A (no call to services)
   best mexican food          N/A            N/A (no call to services)
   restaurants palo alto      many           Here are some recommended restaurants near Palo Alto. Do
                                            you prefer any particular food type? Would you like a reserva
                                            tion?
   Italian palo alto          some           Here are some Italian restaurants near Palo Alto. To reserve
                                             a table, click on available times.
   thai food in menlo park    some           Here are some Thai restaurants near Menlo Park. To reserve
                                             a table, click on available times.
   indonesian food in menlo   0              Sorry, I can't find any Indonesian restaurants near Menlo Park.
   park                                      You could try other cuisines or locations.
   best mexican food in       some           Here are some recommended Mexican restaurants near Palo
    Palo Alto                                Alto.
   fast food menlo park       some           OK, here are some fast food restaurants near Menlo Park.
    healthy food in menlo     some           Here are some places near Menlo Park that might serve
    park                                     healthy food, based on reviews.
    dive bar in menlo park    some           Here are some bars near Menlo Park. I don't see anything
                                             specific to "dive bar". Are there other ways of saying it?
                                                 - 151   -

WO 2011/088053                                                         PCT/US2011/020861
 pool room in menlo park    some   Here are some places in Menlo Park that are described as
                                  pool rooms. You can add other words to describe what you
                                  want.
 hookah room in menlo       0      I can't find places Menlo Park matching "hookah room". Inter
 park                             ested in restaurants, hotels, or local businesses?
 spicy food in sf           weak   Here are some places to eat in San Francisco. I don't know
                            match which serve soicy food. Could it go by another name?
 burgers in Menlo park      some  You might find burgers at these places to eat near Menlo Park
 belly dancing place in sf  some   Here are some places in Menlo Park that are described as
                                  "belly dancing". You can add other words to describe what
                                  you want.
 belly dancing place in     0      I can help you find restaurants, businesses, events, and things
 menlo park                       to do in San Francisco. What are some other words for "belly
                                  dancing place"?
 juke joint in sf           0     I can help you find restaurants, businesses, events, and things
                                  to do in San Francisco. What are some other words for "juke
                                  joint"?
 tie house Menlo park       0     Sorry, I don't know about "tie house" in Menlo Park. Any other
                                  names for it?
 thai house palo alto       1     Got it: Thai House restaurant in Palo Alto, CA. Want to re
                                  serve a table? When and for how many?
 il fornaio menlo park      weak  There is a I Fornaio restaurant in Palo Alto, which is near
                            match Menlo Park.
 il fornao in Menlo park    spell Did you mean Il Fornaio in Palo Alto? If nnt try different
                            match words.
 cliff house in Menlo park  0      I couldn't find Cliff House in Palo Alto. Could it go by a differ
                                  ent name or be in a different city?
  romantic restaurant in    some  Here are some restaurants near Palo Alto that are described in
  palo alto                       reviews as romantic.
  romantic restaurant in    0     Here are restaurants near Palo Alto. Searching reviews did not
  palo alto                       find any described as romantic. Any other preferences?
 quiet romantic restaurant  some  Here are some restaurants near Palo Alto that match "quiet
  in palo alto                    romantic" in reviews.
  quiet romantic restaurant 0     Here are some restaurants near Palo Alto. Searching reviews
  in palo alto                    did not find any matching "quiet romantic". Any other prefer
                                  ences?
  tragically hip restaurant some  Here are some restaurants near Palo Alto that match "tragi
  in palo alto                    cally hip" in reviews.
                                       -152-

WO 2011/088053                                                               PCT/US2011/020861
 tragically hip restaurant   0            Here are some restaurants near Palo Alto. Searching reviews
 in palo alto                             did not find any matching "tragically hip". Any other prefer
                                          ences?
 table for two tonight in    some         Here are restaurants with open tables from 6pm to 8pm tonight
 palo alto                                for a party of two in Palo Alto, CA.
 table for two italian food  some         Here are restaurants with open tables from 6pm to 8pm tonight
 tonight in palo alto                     for a party of two in Palo Alto, CA.
  il fornaio palo alto 6pm   1            Here are table options at II Fornaio restaurant in Palo Alto, CA
  for 2                                   at 6pm today for a party of 2.
  table for 2 at thai house  1            Here is the information for Thai House in Palo Alto, CA. You
  in PA                                   can call them at the phone number listed.
  pizza delivery in menlo                 Here are places that serve pizza in menlo park. I do not have
  park                                    delivery options at this time. Click on restaurant phone num
                                          bers to call for delivery.
   I want the best quiet ro- weak         Here are the best matches for recommended romantic italian
   mantic italian restaurant match,       restaurants near Menlo Park that serve osso buco and are
   for osso buco in or near  sorted by    described as "quiet". Click on available times to reserve a ta
   menlo park                availability ble.
   Book me a table for 2 at  weak          Here are the best matches for recommended romantic italian
   the best quiet romantic   match,        restaurants near Menlo Park with open tables for 2 that serve
   italian restaurant for    sorted by    osso buco and are described as "quiet". Click on available
   osso buco in or near      availability times to reserve a table.
   menlo park
   refinements
   menlo park (was un-       some          Here are some recommended restaurants near Menlo Park.
   known)                                  Do you prefer any particular food type?
    cheapest                  some         I found 4 affordable restaurants near Menlo Park.
    chinese (was italian)                  I found 4 Chinese restaurants near Menlo Park.
    pizza (adding food item)  some         I found 4 Italian restaurants near Menlo Park that serve pjiza.
    san francisco (was        some         I found 4 talian restaurants near San Francisco.
    menlo park)
    tragically hip            some         I found 4 restaurants near Palo Alto that match "tragically hip"
                                           in reviews.
    quiet romantic            some         Here are some restaurants near Palo Alto that match "quiet
                                           romantic" in reviews.
                                                - 153 -

WO 2011/088053                                                                  PCT/US2011/020861
  cliff house                 0            I couldn't find Cliff House in Palo Alto. Could it go by a differ
                                           ent name or be in a different city?
          Table 4: Results Summaries
 [0447]       Table 5 provides some examples of prompts that are provided
when users click on active links.
 Prompts when users click on active links
  Anchor Text            Prompt Text                                    Notes
  Location,              Enter a location: a city, zip code, or         This prompt might be used when the
  where                  "near" followed by the name of a place.        user has not specified a location yet.
  Palo Alto              Enter a location such as a city, neigh-        This prompt might be used when the
                         borhood, street address, or "near" fol-        user is changing locations.
                         lowed by a landmark.
  food type              Enter a food category such as Chinese          Merge food type and cuisine can be
                         or Pizza.                                      merged
  Italian                You can try other food categories such         User already said Italian. Assistant
                         as Chinese, or a favorite food item such       1002 is helping the user explore alter
                         as steak.                                      natives. Ifit is a food item, it dominates
                                                                        over cuisine.
  reservation            Enter the day and time to reserve a            Prompting for a reservation
                         table, such as "tomorrow at 8".
  healthy food           You can also enter menu items or cui-          Known food type
                         sines
  spicy food             You can also enter menu items or cui-          Unknown food type
                         sines
  restaurants            What kind of restaurant? (e.g., Chi-           Clicking on the restaurants link should
                         nese, Pizza)                                   insert the word "restaurant" on the end
                                                                        of the text input.
  businesses             You can find local florists, ATMs, doc-        Clicking on the businesses link should
                         tors, drug stores, and the like What           add to the machine readable tag that
                          kind of business are you looking for?         this is a local search
  events                 You can discover upcoming converts,
                         shows, and the like What interests you?
  things to do            Music, art, theater, sports, and the like
                         What kind of thing would you like to do
                          in this area?
                                               -154-

WO 2011/088053                                                               PCT/US2011/020861
   hotels                  I can help you find an available hotel
                           room. Any preferences for amenities or
                           location?
   weather                 Enter a city, and I'll tell you what the If location is known, just show the
                          weather is like there.                    weather data
   buying things           I can help you find music, movies,
                           books, electronics, toys, and more -
                           and buy it from Amazon. What are you
                           looking for?
          Table 5: Prompts when users click on active links
 Suggesting Possible Responses in a Dialog
 [0448]       In one embodiment, assistant 1002 provides contextual suggestions.
 Suggestions a way for assistant 1002 to offer the user options to move forward
 from his or her current situation in the dialog. The set of suggestions offered
 by assistant 1002 depends on context, and the number of suggestions offered
 may depend on the medium and form factor. For example, in one embodi
 ment, the most salient suggestions may be offered in line in the dialog, an ex
 tended list of suggestions ("more") may be offered in a scrollable menu, and
 even more suggestions are reachable by typing a few characters and picking
 from autocomplete options. One skilled in the art will recognize that other
 mechanisms may be used for providing suggestions.
  [0449]      In various embodiments, different types of suggestions may be pro
  vided. Examples of suggestion types include:
          " options to refine a query, including adding or removing or chang
               ing constraint values;
          *    options to repair or recover from bad situations, such as "not what I
               mean" or "start over" or "search the web";
           e   options to disambiguate among;
           " interpretations of speech;
           *   interpretations of text, including spell correction and seman
               tic ambiguity;
                                                   - 155  -

WO 2011/088053                                                     PCT/US2011/020861
       e   context-specific commands, such as "show these on a map" or
           "send directions to my date" or "explain these results";
       e   suggested cross-selling offers, such as next steps in meal or event
           planning scenarios;
       " options to reuse previous commands, or parts of them.
[0450]     In various embodiments, the context that determines the most rele
vant suggestions may be derived from, for example:
       * dialog state
       e   user state, including, for example:
               o static properties (name, home address, etc)
               o dynamic properties (location, time, network speed)
       e   interaction history, including, for example:
               o query history
               o results history
               o   the text that has been entered so far into autocomplete.
[0451]     In various embodiments, suggestions may be generated by any
mechanism, such as for example:
       * paraphrasing a domain, task, or constraint based on the ontology
           model;
       * prompting in autocomplete based on the current domain and con
           straints;
       " paraphrasing ambiguous alternative interpretations;
       e   alternative interpretations of speech-to-text;
       e   hand authoring, based on special dialog conditions.
[0452]     According to one embodiment, suggestions are generated as opera
tions on commands in some state of completion. Commands are explicit, ca
nonical representations of requests, including assumptions and inferences,
based on attempted interpretations on user input. In situations where the
user input is incomplete or ambiguous, suggestions are an attempt to help the
user adjust the input to clarify the command.
                                         -156-

WO 2011/088053                                                       PCT/US2011/020861
[0453]      In one embodiment, each command is an imperative sentence hav
ing some combination of a
        * command verb (imperative such as "find" or "where is");
        * domain (selection class such as "restaurants");
        e   constraint(s) such as location=Palo Alto and cuisine=Italian.
 [0454]     These parts of a command (verb, domain, constraints) correspond
 to nodes in the ontology.
 [0455]     A suggestion, then, may be thought of as operations on a command,
 such as setting it, changing it, or declaring that it is relevant or not relevant.
 Examples include:
        e    setting a command verb or domain ("find restaurants")
        * changing a command verb ("book it", "map it", "save it")
        " changing a domain ("looking for a restaurant, not a local business")
        e    stating that a constraint is relevant ("try refining by cuisine")
         " choosing a value for a constraint ("Italian", "French", and the like)
         e   choosing a constraint and value together ("near here", "tables for
             2")
         " stating that a constraint value is wrong ("not that Boston")
         * stating that a constraint is not relevant ("ignore the expense")
         " stating the intent to change a constraint value ("try a different loca
             tion")
         " changing a constraint value ("Italian, not Chinese")
         e   adding to a constraint value ("and with a pool, too")
         * snapping a value to grid ("Los Angeles, not los angelos")
         e   initiating a new command, reusing context ([after movies] "find
             nearby restaurants", "send directions to my friend")
          e  initiating a command that is "meta" to context ("explain these re
              sults")
          e   initiating a new command, resetting or ignoring context ("start
              over", "help with speech")
                                            - 157 -

WO 2011/088053                                                    PCT/US2011/020861
[0456]     A suggestion may also involve some combination of the above. For
example:
        " "the movie Milk not [restaurants serving] the food item milk"
        e  "restaurants serving pizza, not just pizza joints"
        e  "The place called Costco in Mountain View, I don't care whether
           you think it is a restaurant or local business"
        e  "Chinese in mountain view" [a recent query]
 [0457]    In one embodiment, assistant 1002 includes a general mechanism to
 maintain a list of suggestions, ordered by relevance. The format in which a
 suggestion is offered may differ depending on current context, mode, and
 form factor of the device.
 [0458]    In one embodiment, assistant 1002 determines which constraints to
 modify by considering any or all of the following factors:
           " Consider whether the constraint has a value;
           e   Consider whether the constraint was inferred or explicitly
               stated;
           e   Consider its salience (suggestionIndex).
 [0459]    In one embodiment, assistant 1002 determines an output format for
 the suggestion. Examples of output formats include:
           e   change domain:
                " if autocomplete option "find restaurants", then "try some
                   thing different"
                e  else [was inferred] "not looking for restaurants"
            * change name constraint:
                " if name was inferred, offer alterative ambiguous interpreta
                    tion"
                " stuff into autocomplete the entity names from current results
                e   different name
                e   consider that it wasn't a name lookup (remove constraint)
                    maybe offer category in place of it
                                         -158-

WO 2011/088053                                                       PCT/US2011/020861
              e   "not named"
              *   "not in Berkeley"
              e   "some other day"
              " not that sense of (use ambiguity alternatives)
              * inferred date: "any day, I don't need a reservation"
 [0460]       In one embodiment, assistant 1002 attempts to resolve ambiguities
 via suggestions. For example, if the set of current interpretations of user in
 tent is too ambiguous 310, then suggestions are one way to prompt for more
 information 322. In one embodiment, for constrained selection tasks, assistant
 1002 factors out common constraints among ambiguous interpretations of in
 tent 290 and presents the differences among them to the user. For example, if
 the user input includes the word "caf&' and this word could match the name
 of a restaurant or the type of restaurant, then assistant 102 can ask "did you
 mean restaurants named 'caf6 or 'caf6 restaurants'?"
  [0461]       In one embodiment, assistant 1002 infers constraints under certain
 situations. That is, for constrained selection tasks, not all constraints need be
  mentioned explicitly in the user input; some can be inferred from other in
  formation available in active ontology 1050, short term memory 1052, and/or
  other sources of information available to assistant 1002. For example:
      " Inferring domain or location
       " Default assumption, like location
       " Weakly matched constraint (fuzzy, low salience location, etc)
       " Ambiguous criteria (match to constraint value without prefix (name vs.
           category, often ambiguous)
  [0462]       In cases where the assistant 1002 infers constraint values, it may
  also offer these assumptions as suggestions for the user to overrule. For ex
   ample, it might tell the user "I assumed you meant around here. Would you
   like to look at a different location?"
   [0463]       The present invention has been described in particular detail with
   respect to possible embodiments. Those of skill in the art will appreciate that
                                           -159-

WO 2011/088053                                                    PCT/US2011/020861
the invention may be practiced in other embodiments. First, the particular
naming of the components, capitalization of terms, the attributes, data struc
tures, or any other programming or structural aspect is not mandatory or sig
nificant, and the mechanisms that implement the invention or its features may
have different names, formats, or protocols. Further, the system may be im
plemented via a combination of hardware and software, as described, or en
tirely in hardware elements, or entirely in software elements. Also, the par
ticular division of functionality between the various system components de
scribed herein is merely exemplary, and not mandatory; functions performed
by a single system component may instead be performed by multiple compo
nents, and functions performed by multiple components may instead be per
formed by a single component.
 [0464]     In various embodiments, the present invention can be implemented
 as a system or a method for performing the above-described techniques, ei
 ther singly or in any combination. In another embodiment, the present inven
 tion can be implemented as a computer program product comprising a non
 transitory computer-readable storage medium and computer program code,
 encoded on the medium, for causing a processor in a computing device or
 other electronic device to performthe above-described techniques.
 [0465]     Reference in the specification to "one embodiment" or to "an em
 bodiment" means that a particular feature, structure, or characteristic de
 scribed in connection with the embodiments is included in at least one em
 bodiment of the invention. The appearances of the phrase "in one embodi
 ment" in various places in the specification are not necessarily all referring to
 the same embodiment.
 [0466]     Some portions of the above are presented in terms of algorithms
 and symbolic representations of operations on data bits within a memory of a
 computing device. These algorithmic descriptions and representations are the
 means used by those skilled in the data processing arts to most effectively
 convey the substance of their work to others skilled in the art. An algorithm
                                         -160  -

WO 2011/088053                                                      PCT/US2011/020861
is here, and generally, conceived to be a self-consistent sequence of steps (in
structions) leading to a desired result. The steps are those requiring physical
manipulations of physical quantities. Usually, though not necessarily, these
quantities take the form of electrical, magnetic or optical signals capable of
being stored, transferred, combined, compared and otherwise manipulated.
 It is convenient at times, principally for reasons of common usage, to refer to
 these signals as bits, values, elements, symbols, characters, terms, numbers, or
 the like. Furthermore, it is also convenient at times, to refer to certain ar
 rangements of steps requiring physical manipulations of physical quantities
 as modules or code devices, without loss of generality.
 [0467]       It should be borne in mind, however, that all of these and similar
 terms are to be associated with the appropriate physical quantities and are
 merely convenient labels applied to these quantities. Unless specifically
 stated otherwise as apparent from the following discussion, it is appreciated
 that throughout the description, discussions utilizing terms such as "process
 ing" or "computing" or "calculating" or "displaying" or "determining" or the
  like, refer to the action and processes of a computer system, or similar elec
  tronic computing module and/or device, that manipulates and transforms
  data represented as physical (electronic) quantities within the computer sys
  tem memories or registers or other such information storage, transmission or
  display devices.
  [0468]       Certain aspects of the present invention include process steps and
  instructions described herein in the form of an algorithm. It should be noted
  that the process steps and instructions of the present invention can be embod
  ied in software, firmware and/or hardware, and when embodied in software,
  can be downloaded to reside on and be operated from different platforms
   used by a variety of operating systems.
   [0469]      The present invention also relates to an apparatus for performing
   the operations herein. This apparatus may be specially constructed for the
   required purposes, or it may comprise a general-purpose computing device
                                           -161  -

WO 2011/088053                                                   PCT/US2011/020861
selectively activated or reconfigured by a computer program stored in the
computing device. Such a computer program may be stored in a computer
readable storage medium, such as, but is not limited to, any type of disk in
cluding floppy disks, optical disks, CD-ROMs, magnetic-optical disks, read
only memories (ROMs), random access memories (RAMs), EPROMs,
EEPROMs, magnetic or optical cards, application specific integrated circuits
(ASICs), or any type of media suitable for storing electronic instructions, and
each coupled to a computer system bus. Further, the computing devices re
ferred to herein may include a single processor or may be architectures em
ploying multiple processor designs for increased computing capability.
[0470]      The algorithms and displays presented herein are not inherently
related to any particular computing device, virtualized system, or other appa
ratus. Various general-purpose systems may also be used with programs in
accordance with the teachings herein, or it may prove convenient to construct
more specialized apparatus to perform the required method steps. The re
quired structure for a variety of these systems will be apparent from the de
scription provided herein. In addition, the present invention is not described
with reference to any particular programming language. It will be appreci
ated that a variety of programming languages may be used to implement the
teachings of the present invention as described herein, and any references
above to specific languages are provided for disclosure of enablement and
best mode of the present invention.
 [0471]     Accordingly, in various embodiments, the present invention can be
implemented as software, hardware, and/or other elements for controlling a
computer system, computing device, or other electronic device, or any combi
 nation or plurality thereof. Such an electronic device can include, for exam
 ple, a processor, an input device (such as a keyboard, mouse, touchpad,
 trackpad, joystick, trackball, microphone, and/or any combination thereof),
 an output device (such as a screen, speaker, and/or the like), memory, long
 term storage (such as magnetic storage, optical storage, and/or the like),
                                        -162-

WO 2011/088053                                                      PCT/US2011/020861
and/or network connectivity, according to techniques that are well known in
the art. Such an electronic device may be portable or nonportable. Examples
of electronic devices that may be used for implementing the invention in
clude: a mobile phone, personal digital assistant, smartphone, kiosk, desktop
computer, laptop computer, tablet computer, consumer electronic device,
consumer entertainment device; music player; camera; television; set-top box;
electronic gaming unit; or the like. An electronic device for implementing the
present invention may use any operating system such as, for example, iOS or
MacOS, available from Apple Inc. of Cupertino, California, or any other oper
 ating system that is adapted for use on the device.
 [0472]      While the invention has been described with respect to a limited
 number of embodiments, those skilled in the art, having benefit of the above
 description, will appreciate that other embodiments may be devised which do
 not depart from the scope of the present invention as described herein. In ad
 dition, it should be noted that the language used in the specification has been
 principally selected for readability and instructional purposes, and may not
 have been selected to delineate or circumscribe the inventive subject matter.
 Accordingly, the disclosure of the present invention is intended to be illustra
 tive, but not limiting, of the scope of the invention, which is set forth in the
 claims.
                                          - 163 -

1002128544
                                       CLAIMS
What is claimed is:
 1. An automated assistant operating on one or more computing devices, the
automated assistant comprising:
         a speech input component, for receiving user input;
         a language interpreter component, for interpreting the received user input
to derive a representation of user intent;
         a dialog flow processor component, for identifying at least one task based
at least in part on the derived representation of user intent;
         a services orchestration component, for calling at least one service for
performing the identified task; and
         an output processor component, for causing a first output to be displayed
prior to receiving the user input, and for causing a second output to be displayed
based on data received from the at least one called service;
         wherein the first output comprises a plurality of core competencies of the
automated assistant and an example of a natural language input for invoking each
of the plurality of core competencies.
2. The automated assistant of claim 1, wherein one of the plurality of core
competencies is setting a reminder.
3. The automated assistant of claim 1, wherein one of the plurality of core
competencies is getting directions.
4. The automated assistant of claim 1, wherein one of the plurality of core
competencies is searching for a restaurant.
5. The automated assistant of claim 1, wherein one of the plurality of core
competencies is searching for an entertainment event.
6. The automated assistant of claim 1, wherein one of the plurality of core
competencies is getting a weather forecast.
                                        -  164 -

1002128544
7. The automated assistant of claim 1, wherein one of the plurality of core
competencies is booking a taxi.
8. The automated assistant of claim 1, wherein the first output further comprises a
graphical icon for each of the core competencies.
9. The automated assistant of claim 1, wherein:
        the first output further comprises a user interface element for exploring a
core competency; and
        in response to a selection of the user interface element, the output
processor component causes a third output to be displayed comprising one or
more additional examples of natural language input for invoking the core
competency.
 10. The automated assistant of claim 1, wherein:
        the input device receives a natural language user input from a user; and
        in response to the natural language user input, the output processor
component causes a third output to be displayed comprising the natural language
user input and at least one of the plurality of core competencies.
 11. The automated assistant of claim 10, wherein:
the output processor component causes a fourth output to be displayed comprising
a natural language response to the natural language user input and the at least one
of the plurality of core competencies.
 12. The automated assistant of claim 1, wherein:
        the input device receives a natural language user input from a user, the
natural language user input requests a search for an event; and
        the output processor component causes a third output to be displayed
comprising an echo of the natural language user input, a paraphrase of the natural
language user input, and at least one search result.
                                        - 165 -

1002128544
 13. The automated assistant of claim 1, wherein:
        the input device receives a natural language user input from a user, the
natural language user input specifying parameters for making a restaurant
reservation;
        in response to the natural language input, the output processor component
causes a third output to be displayed comprising a summary of the parameters and
a plurality of restaurants meeting the specified parameters; and
        for at least one of the plurality of restaurants, the third output comprises
displays a reservation option meeting the specified parameters and at least one
additional reservation option different from the specified parameters.
 14. The automated assistant of claim 13, wherein the reservation option meeting
the specified parameters includes a reservation for a specified time in the natural
language input, and the additional reservation option different from the specified
parameters includes a reservation option for a different time from the specified
time.
 15. The automated assistant of claim 1, wherein:
        the input device receives a natural language question from a user; and
        the output processor component causes a third output to be displayed
comprising an echo of the natural language question, a natural language answer to
the natural language question, and an excerpt retrieved from an information
source based on which the natural language answer is produced.
 18. The automated assistant of claim 15, wherein the natural language question is
related to weather, the natural language answer describes the weather in a natural
language format, and the excerpt is a weather forecast excerpt.
 19. A method for implementing an automated assistant on one or more computing
devices having one or more processors and memory, the method comprising:
        at the one or more computing devices:
                 invoking the automated assistant;
                                          - 166 -

1002128544
         causing a first output to be displayed, wherein the first output comprises a
plurality of core competencies of the automated assistant and an example of a
natural language input for invoking each of the plurality of core competencies;
         at a speech input component, receiving user input;
         interpreting the received user input to derive a representation of user
intent;
         identifying at least one task based at least in part on the derived
representation of user intent;
         calling at least one service for performing the identified task; and
         causing a second output to be displayed based on data received from the at
least one called service;
        wherein the first output is displayed prior to receiving the user input.
20. A non-transitory computer-readable medium for implementing an automated
assistant on one or more computing devices, the computer-readable medium
having instructions stored thereon, the instructions, when executed by one or more
processors, cause the processors to perform operations comprising:
         invoking the automated assistant;
         causing a first output to be displayed in a conversation interface of the
automated assistant, wherein the first output comprises a plurality of core
competencies of the automated assistant and an example of a natural language
input for invoking each of the plurality of core competencies;
         at a speech input component, receiving user input;
         interpreting the received user input to derive a representation of user
intent;
         identifying at least one task based at least in part on the derived
representation of user intent;
         calling at least one service for performing the identified task; and
         causing a second output to be displayed based on data received from the at
least one called service;
        wherein the first output is displayed prior to receiving the user input.
                                          - 167 -

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
