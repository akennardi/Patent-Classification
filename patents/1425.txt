                                             - 58
     Abstract
     The present invention relates to transposing signals in time and/or frequency and
    in particular to coding of audio signals. More particular, the present invention
  5 relates to high frequency reconstruction (HFR) methods including a frequency
     domain harmonic transposer. A method and system for generating a transposed
    output signal from an input signal using a transposition factor T is described. The
    system comprises an analysis window of length La, extracting a frame of the input
    signal, and an analysis transformation unit of order M transforming the samples
10  into M complex coefficients. M is a function of the transposition factor T. The
    system further comprises a nonlinear processing unit altering the phase of the
    complex coefficients by using the transposition factor T, a synthesis
    transformation unit of order M transforming the altered coefficients into M altered
    samples, and a synthesis window of length Ls, generating a frame of the output
15  signal.
    (Fig. 3)

                                301
                                                    300
       -____             FL
                 *                               312
            311                                  310
                         0    t
                         L
324           321_30_322320
        Tto   FL         0           -   Tto
                                     2
                             Fig. 3
                                    3404
                        4024
    401
                                             404
                             Fig. 4
                              2/8

                                            -1
                            Improved Harmonic Transposition
   TECHNICAL FIELD
 5 The present invention relates to transposing signals in frequency and/or
   stretching/compressing a signal in time and in particular to coding of audio
   signals. In other words, the present invention relates to time-scale and/or
   frequency-scale modification. More particularly, the present invention relates to
   high frequency reconstruction (HFR) methods including a frequency domain
10 harmonic transposer.
   BACKGROUND OF THE INVENTION
15 HFR technologies, such as the Spectral Band Replication (SBR) technology,
   allow to significantly improve the coding efficiency of traditional perceptual
   audio codecs. In combination with MPEG-4 Advanced Audio Coding (AAC) it
   forms a very efficient audio codec, which is already in use within the XM Satellite
   Radio system and Digital Radio Mondiale, and also standardized within 3GPP,
20 DVD Forum and others. The combination of AAC and SBR is called aacPlus. It is
   part of the MPEG-4 standard where it is referred to as the High Efficiency AAC
   Profile (HE-AAC). In general, HFR technology can be combined with any
   perceptual audio codec in a back and forward compatible way, thus offering the
   possibility to upgrade already established broadcasting systems like the MPEG
25 Layer-2 used in the Eureka DAB system. HFR transposition methods can also be
   combined with speech codecs to allow wide band speech at ultra low bit rates.
   The basic idea behind HRF is the observation that usually a strong correlation
   between the characteristics of the high frequency range of a signal and the
30 characteristics of the low frequency range of the same signal is present. Thus, a
   good approximation for the representation of the original input high frequency

                                             -2
   range of a signal can be achieved by a signal transposition from the low frequency
   range to the high frequency range.
   This concept of transposition was established in WO 98/57436 which is
 5 incorporated by reference, as a method to recreate a high frequency band from a
   lower frequency band of an audio signal. A substantial saving in bit-rate can be
   obtained by using this concept in audio coding and/or speech coding. In the
   following, reference will be made to audio coding, but it should be noted that the
   described methods and systems are equally applicable to speech coding and in
10 unified speech and audio coding (USAC).
   In a HFR based audio coding system, a low bandwidth signal is presented to a
   core waveform coder for encoding, and higher frequencies are regenerated at the
   decoder side using transposition of the low bandwidth signal and additional side
15 information, which is typically encoded at very low bit-rates and which describes
   the target spectral shape. For low bit-rates, where the bandwidth of the core coded
   signal is narrow, it becomes increasingly important to reproduce or synthesize a
   high band, i.e. the high frequency range of the audio signal, with perceptually
   pleasant characteristics.
20
   In prior art there are several methods for high frequency reconstruction using, e.g.
   harmonic transposition, or time-stretching. One method is based on phase
   vocoders operating under the principle of performing a frequency analysis with a
   sufficiently high frequency resolution. A signal modification is performed in the
25 frequency domain prior to re-synthesising the signal. The signal modification may
   be a time-stretch or transposition operation.
   One of the underlying problems that exist with these methods are the opposing
   constraints of an intended high frequency resolution in order to get a high quality
30 transposition for stationary sounds, and the time response of the system for
   transient or percussive sounds. In other words, while the use of a high frequency

                                             -3
   resolution is beneficial for the transposition of stationary signals, such high
   frequency resolution typically requires large window sizes which are detrimental
   when dealing with transient portions of a signal. One approach to deal with this
   problem may be to adaptively change the windows of the transposer, e.g. by using
 5 window-switching, as a function of input signal characteristics. Typically long
   windows will be used for stationary portions of a signal, in order to achieve high
   frequency resolution, while short windows will be used for transient portions of
   the signal, in order to implement a good transient response, i.e. a good temporal
   resolution, of the transposer. However, this approach has the drawback that signal
10 analysis measures such as transient detection or the like have to be incorporated
   into the transposition system. Such signal analysis measures often involve a
   decision step, e.g. a decision on the presence of a transient, which triggers a
   switching of signal processing. Furthermore, such measures typically affect the
   reliability of the system and they may introduce signal artifacts when switching
15 the signal processing, e.g. when switching between window sizes.
   The present invention solves the aforementioned problems regarding the transient
   performance of harmonic transposition without the need for window switching.
   Furthermore, improved harmonic transposition is achieved at a low additional
20 complexity.
   SUMMARY OF THE INVENTION
25 The present invention relates to the problem of improved transient performance
   for harmonic transposition, as well as assorted improvements to known methods
   for harmonic transposition. Furthermore, the present invention outlines how
   additional complexity may be kept at a minimum while retaining the proposed
   improvements.
30

                                             -4
   Among others, the present invention may comprise at least one of the following
   aspects:
   -   Oversampling in frequency by a factor being a function of the transposition
       factor of the operation point of the transposer;
 5 -   Appropriate choice of the combination of analysis and synthesis windows; and
   -   Ensuring time-alignment of different transposed signals for the cases where
       such signals are combined.
   According to an aspect of the invention, a system for generating a transposed
10 output signal from an input signal using a transposition factor T is described. The
   transposed output signal may be a time-stretched and/or frequency-shifted version
   of the input signal. Relative to the input signal, the transposed output signal may
   be stretched in time by the transposition factor T. Alternatively, the frequency
   components of the transposed output signal may be shifted upwards by the
15 transposition factor T.
   The system may comprise an analysis window of length L which extracts L
   samples of the input signal. Typically, the L samples of the input signals are
   samples of the input signal, e.g. an audio signal, in the time domain. The extracted
20 L samples are referred to as a frame of the input signal. The system comprises
   further an analysis transformation unit of order M = F*L transforming the L time
   domain samples into M complex coefficients with F being a frequency
   oversampling factor. The M complex coefficients are typically coefficients in the
   frequency domain. The analysis transformation may be a Fourier transform, a Fast
25 Fourier Transform, a Discrete Fourier Transform, a Wavelet Transform or an
   analysis stage of a (possibly modulated) filter bank. The oversampling factor F is
   based on or is a function of the transposition factor T.
   The oversampling operation may also be referred to as zero padding of the
30 analysis window by additional (F-1)*L zeros. It may also be viewed as choosing a

                                             -5
   size of an analysis transformation M which is larger than the size of the analysis
   window by a factor F.
   The system may also comprise a nonlinear processing unit altering the phase of
 5 the complex coefficients by using the transposition factor T. The altering of the
   phase may comprise multiplying the phase of the complex coefficients by the
   transposition factor T. In addition, the system may comprise a synthesis
   transformation unit of order M transforming the altered coefficients into M altered
   samples and a synthesis window of length L for generating the output signal. The
10 synthesis transform may be an inverse Fourier Transform, an inverse Fast Fourier
   Transform, an inverse Discrete Fourier Transform, an inverse Wavelet Transform,
   or a synthesis stage of a (possibly) modulated filter bank. Typically, the analysis
   transform and the synthesis transform are related to each other, e.g. in order to
   achieve perfect reconstruction of an input signal when the transposition factor T
15  1.
   According to another aspect of the invention the oversampling factor F is
   proportional to the transposition factor T. In particular, the oversampling factor F
   may be greater or equal to (T+1)/2. This selection of the oversampling factor F
20 ensures that undesired signal artifacts, e.g. pre- and post-echoes, which may be
   incurred by the transposition are rejected by the synthesis window.
   It should be noted that in more general terms, the length of the analysis window
   may be La and the length of the synthesis window may be Ls. Also in such cases,
25 it may be beneficial to select the order of the transformation unit M based on the
   transposition order T, i.e. as a function of the transposition order T. Furthermore,
   it may be beneficial to select M to be greater than the average length of the
   analysis window and the synthesis window, i.e. greater than (La+Ls)/2. In an
   embodiment, the difference between the order of the transformation unit M and
30 the average window length is proportional to (T-1). In a further embodiment, M is
   selected to be greater or equal to (TLa+Ls)/2. It should be noted that the case

                                              -6
   where the length of the analysis window and the synthesis window is equal, i.e.
   La=Ls=L,   is a special case of the above generic case. For the generic case, the
   oversampling factor F may be
                                        51+(T -1)       "L+La
   The system may further comprise an analysis stride unit shifting the analysis
   window by an analysis stride of Sa samples along the input signal. As a result of
   the analysis stride unit, a succession of frames of the input signal is generated. In
10 addition, the system may comprise a synthesis stride unit shifting the synthesis
   window and/or successive frames of the output signal by a synthesis stride of Ss
   samples. As a result, a succession of shifted frames of the output signal is
   generated which may be overlapped and added in an overlap-add unit.
15 In other words, the analysis window may extract or isolate L or more generally La
   samples of the input signal, e.g. by multiplying a set of L samples of the input
   signal with non-zero window coefficients. Such a set of L samples may be
   referred to as an input signal frame or as a frame of the input signal. The analysis
   stride unit shifts the analysis window along the input signal and thereby selects a
20 different frame of the input signal, i.e. it generates a sequence of frames of the
   input signal. The sample distance between successive frames is given by the
   analysis stride. In a similar manner, the synthesis stride unit shifts the synthesis
   window and/or the frames of the output signal, i.e. it generates a sequence of
   shifted frames of the output signal. The sample distance between successive
25 frames of the output signal is given by the synthesis stride. The output signal may
   be determined by overlapping the sequence of frames of the output signal and by
   adding sample values which coincide in time.
   According to a further aspect of the invention, the synthesis stride is T times the
30 analysis stride. In such cases, the output signal corresponds to the input signal,

                                              -7
   time-stretched by the transposition factor T. In other words, by selecting the
   synthesis stride to be T times greater than the analysis stride, a time shift or time
   stretch of the output signal with regards to the input signal may be obtained. This
   time shift is of order T.
 5
   In other words, the above mentioned system may be described as follows: Using
   an analysis window unit, an analysis transformation unit and an analysis stride
   unit with an analysis stride Sa, a suite or sequence of sets of M complex
   coefficients may be determined from an input signal. The analysis stride defines
10 the number of samples that the analysis window is moved forward along the input
   signal. As the elapsed time between two successive samples is given by the
   sampling rate, the analysis stride also defines the elapsed time between two
   frames of the input signal. By consequences, also the elapsed time between two
   successive sets of M complex coefficients is given by the analysis stride Sa.
15
   After passing the nonlinear processing unit where the phase of the complex
   coefficients may be altered, e.g. by multiplying it with the transposition factor T,
   the suite or sequence of sets of M complex coefficients may be re-converted into
   the time-domain. Each set of M altered complex coefficients may be transformed
20 into M altered samples using the synthesis transformation unit. In a following
   overlap-add operation involving the synthesis window unit and the synthesis
   stride unit with a synthesis stride Ss, the suite of sets of M altered samples may be
   overlapped and added to form the output signal. In this overlap-add operation,
   successive sets of M altered samples may be shifted by Ss samples with respect to
25 one another, before they may be multiplied with the synthesis window and
   subsequently added to yield the output signal. Consequently, if the synthesis stride
   Ss is T times the analysis stride Sa, the signal may be time stretched by a factor T.
   According to a further aspect of the invention, the synthesis window is derived
30 from the analysis window and the synthesis stride. In particular, the synthesis
   window may be given by the formula:

                                                  -8-1
                            v, (n)= Va(n)   Y   (V(n - k -At)) 2
                                          \k=-oo
   with v, (n) being the synthesis window, Va(n) being the analysis window, and
 5  At being the synthesis stride Ss. The analysis and/or synthesis window may be one
   of a Gaussian window, a cosine window, a Hamming window, a Hann window, a
   rectangular window, a Bartlett windows, a Blackman windows, a window having
   the function v(n)= sint' (n +0.5),0! ; n < L, wherein in the case of different
                            (L
   lengths of the analysis window and the synthesis window, L may be La or Ls,
10 respectively.
   According to another aspect of the invention, the system further comprises a
   contraction unit performing e.g. a rate conversion of the output signal by the
   transposition order T, thereby yielding a transposed output signal. By selecting the
15 synthesis stride to be T times the analysis stride, a time-stretched output signal
   may be obtained as outlined above. If the sampling rate of the time-stretched
   signal is increased by a factor T or if the time-stretched signal is down-sampled by
   a factor T, a transposed output signal may be generated that corresponds to the
   input signal, frequency-shifted by the transposition factor T. The downsampling
20 operation may comprise the step of selecting only a subset of samples of the
   output signal. Typically, only every Tth sample of the output signal is retained.
   Alternatively, the sampling rate may be increased by a factor T, i.e. the sampling
   rate is interpreted as being T times higher. In other words, re-sampling or
   sampling rate conversion means that the sampling rate is changed, either to a
25 higher or a lower value. Downsampling means rate conversion to a lower value.
   According to a further aspect of the invention, the system may generate a second
    output signal from the input signal. The system may comprise a second nonlinear
   processing unit altering the phase of the complex coefficients by using a second

                                            -9
   transposition factor T2 and a second synthesis stride unit shifting the synthesis
   window and/or the frames of the second output signal by a second synthesis
   stride. Altering of the phase may comprise multiplying the phase by a factor T2 .
   By altering the phase of the complex coefficients using the second transposition
 5 factor and by transforming the second altered coefficients into M second altered
   samples and by applying the synthesis window, frames of the second output signal
   may be generated from a frame of the input signal. By applying the second
   synthesis stride to the sequence of frames of the second output signal, the second
   output signal may be generated in the overlap-add unit.
10
   The second output signal may be contracted in a second contracting unit
   performing e.g. a rate conversion of the second output signal by the second
   transposition order T2. This yields a second transposed output signal. In summary,
   a first transposed output signal can be generated using the first transposition factor
15 T and a second transposed output signal can be generated using the second
   transposition factor T2 . These two transposed output signals may then be merged
   in a combining unit to yield the overall transposed output signal. The merging
   operation may comprise adding of the two transposed output signals. Such
   generation and combining of a plurality of transposed output signals may be
20 beneficial to obtain good approximations of the high frequency signal component
   which is to be synthesized. It should be noted that any number of transposed
   output signals may be generated using a plurality of transposition orders. This
   plurality of transposed outputs signals may then be merged, e.g. added, in a
   combining unit to yield an overall transposed output signal.
25
   It may be beneficial that the combining unit weights the first and second
   transposed output signals prior to merging. The weighting may be performed such
   that the energy or the energy per bandwidth of the first and second transposed
   output signals corresponds to the energy or energy per bandwidth of the input
30 signal, respectively.

                                             - 10
   According to a further aspect of the invention, the system may comprise an
   alignment unit which applies a time offset to the first and second transposed
   output signals prior to entering the combining unit. Such time offset may
   comprise the shifting of the two transposed output signals with respect to one
 5 another in the time domain. The time offset may be a function of the transposition
   order and/or the length of the windows. In particular, the time offset may be
   determined as
                                          (T - 2)L
                                               4
10
   According to another aspect of the invention, the above described transposition
   system may be embedded into a system for decoding a received multimedia signal
   comprising an audio signal. The decoding system may comprise a transposition
   unit which corresponds to the system outlined above, wherein the input signal
15 typically is a low frequency component of the audio signal and the output signal is
   a high frequency component of the audio signal. In other words, the input signal
   typically is a low pass signal with a certain bandwidth and the output signal is a
   bandpass signal of typically a higher bandwidth. Furthermore, it may comprise a
   core decoder for decoding the low frequency component of the audio signal from
20 the received bitstream. Such core decoder may be based on a coding scheme such
   as Dolby E, Dolby Digital or AAC. In particular, such decoding system may be a
   set-top box for decoding a received multimedia signal comprising an audio signal
   and other signals such as video.
25 It should be noted that the present invention also describes a method for
   transposing an input signal by a transposition factor T. The method corresponds to
   the system outlined above and may comprise any combination of the above
   mentioned aspects. It may comprise the steps of extracting samples of the input
    signal using an analysis window of length L, and of selecting an oversampling
30  factor F as a function of the transposition factor T. It may further comprise the

                                            -11
   steps of transforming the L samples from the time domain into the frequency
   domain yielding F * L complex coefficients, and of altering the phase of the
   complex coefficients with the transposition factor T. In additional steps, the
   method may transform the F * L altered complex coefficients into the time
 5 domain yielding F * L altered samples, and it may generate the output signal
   using a synthesis window of length L. It should be noted that the method may also
   be adapted to general lengths of the analysis and synthesis window, i.e. to general
   La and Ls, at outlined above.
10 According to a further aspect of the invention, the method may comprise the steps
   of shifting the analysis window by an analysis stride of Sa samples along the input
   signal, and/or by shifting the synthesis window and/or the frames of the output
   signal by a synthesis stride of Ss samples. By selecting the synthesis stride to be T
   times the analysis stride, the output signal may be time-stretched with respect to
15 the input signal by a factor T. When executing an additional step of performing a
   rate conversion of the output signal by the transposition order T, a transposed
   output signal may be obtained. Such transposed output signal may comprise
   frequency components that are upshifted by a factor T with respect to the
   corresponding frequency components of the input signal.
20
   The method may further comprise steps for generating a second output signal.
   This may be implemented by altering the phase of the complex coefficients by
   using a second transposition factor T2, by shifting the synthesis window and/or the
   frames of the second output signal by a second synthesis stride a second output
25 signal may be generated using the second transposition factor T2 and the second
   synthesis stride. By performing a rate conversion of the second output signal by
   the second transposition order T2, a second transposed output signal may be
   generated. Eventually, by merging the first and second transposed output signals a
   merged or overall transposed output signal including high frequency signal
30 components generated by two or more transpositions with different transposition
   factors may be obtained.

                                            - 12
   According to other aspects of the invention, the invention describes a software
   program adapted for execution on a processor and for performing the method
   steps of the present invention when carried out on a computing device. The
 5 invention also describes a storage medium comprising a software program
   adapted for execution on a processor and for performing the method steps of the
   invention when carried out on a computing device. Furthermore, the invention
   describes a computer program product comprising executable instructions for
   performing the method of the invention when executed on a computer.
10
   According to a further aspect, another method and system for transposing an input
   signal by a transposition factor T is described. This method and system may be
   used standalone or in combination with the methods and systems outlined above.
   Any of the features outlined in the present document may be applied to this
15 method / system and vice versa.
   The method may comprise the step of extracting a frame of samples of the input
   signal using an analysis window of length L. Then, the frame of the input signal
   may be transformed from the time domain into the frequency domain yielding M
20 complex coefficients. The phase of the complex coefficients may be altered with
   the transposition factor T and the M altered complex coefficients may be
   transformed into the time domain yielding M altered samples. Eventually, a frame
   of an output signal may be generated using a synthesis window of length L. The
   method and system may use an analysis window and a synthesis window which
25 are different from each other. The analysis and the synthesis window may be
   different with regards to their shape, their length, the number of coefficients
   defining the windows and/or the values of the coefficients defining the windows.
   By doing this, additional degrees of freedom in the selection of the analysis and
   synthesis windows may be obtained such that aliasing of the transposed output
30 signal may be reduced or removed.

                                               - 13
   According to another aspect, the analysis window and the synthesis window are
   bi-orthogonal with respect to one another. The synthesis window vs(n) may be
   given by:
                           VS (n) = c         ",       ,)_
                                                         0 !s n < L,
                                        s(n(mod Ats))
 5 with c being a constant, va(n) being the analysis window (311), At, being a
   timestride of the synthesis window and s(n) being given by:
                                 L/(Ats-1)
                         s(m)=              2
                                     Iv       (m+ Atsi)   O!m<At
   The time stride of the synthesis window At, typically corresponds to the synthesis
   stride Ss.
10
   According to a further aspect, the analysis window may be selected such that its z
   transform has dual zeros on the unit circle. Preferably, the z transform of the
   analysis window only has dual zeros on the unit circle. By way of example, the
   analysis window may be a squared sine window. In another example, the analysis
15 window of length L may be determined by convolving two sine windows of
   length L, yielding a squared sine window of length 2L-1. In a further step a zero is
   appended to the squared sine window, yielding a base window of length 2L.
   Eventually, the base window may be resampled using linear interpolation, thereby
   yielding an even symmetric window of length L as the analysis window.
20
   The methods and systems described in the present document may be implemented
   as software, firmware and/or hardware. Certain components may e.g. be
   implemented as software running on a digital signal processor or microprocessor.
   Other component may e.g. be implemented as hardware and or as application
25 specific integrated circuits. The signals encountered in the described methods and
   systems may be stored on media such as random access memory or optical storage
   media. They may be transferred via networks, such as radio networks, satellite
   networks, wireless networks or wireline networks, e.g. the internet. Typical

                                              - 14
   devices making use of the method and system described in the present document
   are set-top boxes or other customer premises equipment which decode audio
   signals. On the encoding side, the method and system may be used in
   broadcasting stations, e.g. in video or TV head end systems.
 5
   It should be noted that the embodiments and aspects of the invention described in
   this document may be arbitrarily combined. In particular, it should be noted that
   the aspects outlined for a system are also applicable to the corresponding method
   embraced by the present invention. Furthermore, it should be noted that the
10 disclosure of the invention also covers other claim combinations than the claim
   combinations which are explicitly given by the back references in the dependent
   claims, i.e., the claims and their technical features can be combined in any order
   and any formation.
15
   BRIEF DESCRIPTION OF THE DRAWINGS
   The present invention will now be described by way of illustrative examples, not
   limiting the scope or spirit of the invention, with reference to the accompanying
20 drawings, in which:
   Fig. 1 illustrates a Dirac at a particular position as it appears in the analysis and
   synthesis windows of a harmonic transposer;
   Fig. 2 illustrates a Dirac at a different position as it appears in the analysis and
25 synthesis windows of a harmonic transposer;
   Fig. 3 illustrates a Dirac for the position of Fig. 2 as it will appear according to the
   present invention;
   Fig. 4 illustrates the operation of an HFR enhanced audio decoder;
   Fig. 5 illustrates the operation of a harmonic transposer using several orders;
30 Fig. 6 illustrates the operation of a frequency domain (FD) harmonic transposer
   Fig. 7 shows a succession of analysis synthesis windows;

                                             - 15
   Fig. 8 illustrates analysis and synthesis windows at different strides;
   Fig. 9 illustrates the effect of the re-sampling on the synthesis stride of windows;
   Figs. 10 and 11 illustrate embodiments of an encoder and a decoder, respectively,
   using the enhanced harmonic transposition schemes outlined in the present
 5 document; and
   Fig. 12 illustrates an embodiment of a transposition unit shown in Figs. 10 and 11.
   DETAILED DESCRIPTION
10
   The below-described embodiments are merely illustrative for the principles of the
   present invention for Improved Harmonic Transposition. It is understood that
   modifications and variations of the arrangements and the details described herein
   will be apparent to others skilled in the art. It is the intent, therefore, to be limited
15 only by the scope of the impending patent claims and not by the specific details
   presented by way of description and explanation of the embodiments herein.
   In the following, the principle of harmonic transposition in the frequency domain
   and the proposed improvements as taught by the present invention are outlined. A
20 key component of the harmonic transposition is time stretching by an integer
   transposition factor T which preserves the frequency of sinusoids. In other words,
   the harmonic transposition is based on time stretching of the underlying signal by
   a factor T. The time stretching is performed such that frequencies of sinusoids
   which compose the input signal are maintained. Such time stretching may be
25 performed using a phase vocoder. The phase vocoder is based on a frequency
   domain representation furnished by a windowed DFT filter bank with analysis
   window v,(n) and synthesis window v,(n). Such analysis/synthesis transform is
   also referred to as short-time Fourier Transform (STFT).
30 A short-time Fourier transform is performed on a time-domain input signal to
   obtain a succession of overlapped spectral frames. In order to minimize possible

                                             - 16
   side-band effects, appropriate analysis/synthesis windows, e.g. Gaussian
   windows, cosine windows, Hamming windows, Hann windows, rectangular
   windows, Bartlett windows, Blackman windows, and others, should be selected.
   The time delay at which every spectral frame is picked up from the input signal is
 5 referred to as the hop size or stride. The STFT of the input signal is referred to as
   the analysis stage and leads to a frequency domain representation of the input
   signal. The frequency domain representation comprises a plurality of subband
   signals, wherein each subband signal represents a certain frequency component of
   the input signal.
10
   The frequency domain representation of the input signal may then be processed in
   a desired way. For the purpose of time-stretching of the input signal, each
   subband signal may be time-stretched, e.g. by delaying the subband signal
   samples. This may be achieved by using a synthesis hop-size which is greater than
15 the analysis hop-size. The time domain signal may be rebuilt by performing an
   inverse (Fast) Fourier transform on all frames followed by a successive
   accumulation of the frames. This operation of the synthesis stage is referred to as
   overlap-add operation. The resulting output signal is a time-stretched version of
   the input signal comprising the same frequency components as the input signal. In
20 other words, the resulting output signal has the same spectral composition as the
   input signal, but it is slower than the input signal i.e. its progression is stretched in
   time.
   The transposition to higher frequencies may then be obtained subsequently, or in
25 an integrated manner, through downsampling of the stretched signals. As a result
   the transposed signal has the length in time of the initial signal, but comprises
   frequency components which are shifted upwards by a pre-defined transposition
   factor.
30 In mathematical terms, the phase vocoder may be described as follows. An input
    signal x(t) is sampled at a sampling rate R to yield the discrete input signal x(n) .

                                             - 17
   During the analysis stage, a STFT is determined for the input signal x(n) at
   particular analysis time instants t' for successive values k. The analysis time
   instants are preferably selected uniformly through t, = k -Ata, where Ata is the
   analysis hop factor or analysis stride. At each of these analysis time instants t , a
 5 Fourier transform is calculated over a windowed portion of the original signal
    x(n) , wherein the analysis window va (t) is centered around tk , i.e. v (t -t).
   This windowed portion of the input signal x(n) is referred to as a frame. The
   result is the STFT representation of the input signal x(n) , which may be denoted
   as:
10
                         X(tkQ,)=      $3V,(n  - tk)x(n)exp(-jQ,,n),
                                      12=-cO
   where QM     =2;c M-is the center frequency of the mth subband signal of the STFT
                     M
   analysis and M is the size of the discrete Fourier transform (DFT). In practice,
15 the window function v,(n) has a limited time span, i.e. it covers only a limited
   number of samples L, which is typically equal to the size M of the DFT. By
   consequence, the above sum has a finite number of terms. The subband
   signals X(t , Q,) are both a function of time, via index k , and frequency, via the
    subband center frequency Q,, .
20
   The synthesis stage may be performed at synthesis time instants t<which are
   typically uniformly distributed according to tk = k- Ats, where At, is the synthesis
   hop factor or synthesis stride. At each of these synthesis time instants, a short
    time signal Yk(n) is obtained by inverse-Fourier-transforming the STFT subband
25  signal Y(tk, Q,,), which may be identical to X(t,0.,), at the synthesis time
    instants t* . However, typically the STFT subband signals are modified, e.g. time-

                                               - 18
   stretched and/or phase modulated and/or amplitude modulated, such that the
   analysis subband signal X(tk,,Q,,) differs from the synthesis subband signal
    Y(t",Q, ). In a preferred embodiment, the STFT subband signals are phase
   modulated, i.e. the phase of the STFT subband signals is modified. The short-term
 5 synthesis signal   Yk (n) can be denoted as
                                        (A1
                                          M
                              yk (n)=     Y
                                      M11,_0
                                              Y(tk, q,)exp(jQ,,n) .
   The short-term signal     Yk (n) may be viewed as a component of the overall output
10 signal y(n) comprising the synthesis subband signals Y(t,Q,,) for
    m = 0,..., M -1, at the synthesis time instant t*.I.e. the short-term signal Yk(n) is
   the inverse DFT for a specific signal frame. The overall output signal y(n) can be
   obtained by overlapping and adding windowed short-time signals        Yk (n) at all
   synthesis time instants t*<.I.e. the output signal y(n) may be denoted as
15
                                 y(n)=Y0vs (n-_tk     jy
                                        k=-co
   where v, (n -t)is     the synthesis window centered around the synthesis time
   instant tk . It should be noted that the synthesis window typically has a limited
20 number of samples L, such that the above mentioned sum only comprises a
   limited number of terms.
   In the following, the implementation of time-stretching in the frequency domain is
   outlined. A suitable starting point in order to describe aspects of the time stretcher
25 is to consider the case T = 1, i.e. the case where the transposition factor T equals
    1 and where no stretching occurs. Assuming the analysis time stride At, and the

                                              - 19
   synthesis time stride At, of the DFT filter bank to be equal, i.e. At,    = At, = At,
   the combined effect of analysis followed by synthesis is that of an amplitude
   modulation with the At -periodic function
 5                             K(n)= Yq(n - kAt),              (1)
                                      k=-co
   where q(n)= v,(n)v,(n)is the point-wise product of the two windows, i.e. the
   point-wise product of the analysis window and the synthesis window. It is
   advantageous to choose the windows such that K(n)-=1 or another constant
10 value, since then the windowed DFT filter bank achieves perfect reconstruction. If
   the analysis window v,(n) is given, and if the analysis window is of sufficiently
   long duration compared to the stride At, one can obtain perfect reconstruction by
   choosing the synthesis window according to
15                    v,(n)=zVa(n)I         a (n - k- At)   j.        (2)
   For T > 1, i.e. for a transposition factor greater than 1, a time stretch may be
                                                           At
   obtained by performing the analysis at stride Ata =          whereas the synthesis
                                                           T
   stride is maintained at At, = At. In other words, a time stretch by a factor T may
20 be obtained by applying a hop factor or stride at the analysis stage which is
    T times smaller than the hop factor or stride at the synthesis stage. As can be seen
   from the formulas provided above, the use of a synthesis stride which is T times
   greater than the analysis stride will shift the short-term synthesis signals yk (n) by
    T times greater intervals in the overlap-add operation. This will eventually result
25 in a time-stretch of the output signal y(n).

                                            - 20
   It should be noted that the time stretch by the factor T may further involve a phase
   multiplication by a factor T between the analysis and the synthesis. In other
   words, time stretching by a factor T involves phase multiplication by a factor T of
   the subband signals.
 5
   In the following it is outlined how the above described time-stretching operation
   may be translated into a harmonic transposition operation. The pitch-scale
   modification or harmonic transposition may be obtained by performing a sample
   rate conversion of the time stretched output signal y(n). For performing a
10 harmonic transposition by a factor T, an output signal y(n) which is a time
   stretched version by the factor T of the input signal x(n) may be obtained using
   the above described phase vocoding method. The harmonic transposition may
   then be obtained by downsampling the output signal y(n) by a factor T or by
   converting the sampling rate from R to TR. In other words, instead of interpreting
15 the output signal y(n) as having the same sampling rate as the input signal
    x(n) but of T times duration, the output signal y(n) may be interpreted as being
   of the same duration but of T times the sampling rate. The subsequent
   downsampling of T may then be interpreted as making the output sampling rate
   equal to the input sampling rate so that the signals eventually may be added.
20 During these operations, care should be taken when downsampling the transposed
   signal so that no aliasing occurs.
   When assuming the input signal x(n)to be a sinusoid and when assuming a
   symmetric analysis windows v,(n), the method of time stretching based on the
25 above described phase vocoder will work perfectly for odd values of T, and it
   will result in a time stretched version of the input signal x(n) having the same
   frequency. In combination with a subsequent downsampling, a sinusoid y(n) with
   a frequency which is T times the frequency of the input signal x(n) will be
   obtained.
30

                                             -21
    For even values of T , the time stretching/harmonic transposition method outlined
    above will be more approximate, since negative valued side lobes of the
    frequency response of the analysis window v, (n) will be reproduced with
    different fidelity by the phase multiplication. The negative side lobes typically
 5  come from the fact that most practical windows (or prototype filters) have
   numerous discrete zeros located on the unit circle, resulting in 180 degree phase
    shifts. When multiplying the phase angles using even transposition factors the
   phase shifts are typically translated to 0 (or rather multiples of 360) degrees
   depending on the transposition factor used. In other words, when using even
10 transposition factors, the phase shifts vanish. This will typically give rise to
   aliasing in the transposed output signal y(n). A particularly disadvantageous
   scenario may arise when a sinusoidal is located in a frequency corresponding to
   the top of the first side lobe of the analysis filter. Depending on the rejection of
   this lobe in the magnitude response, the aliasing will be more or less audible in the
15 output signal. It should be noted that, for even factors T, decreasing the overall
   stride At typically improves the performance of the time stretcher at the expense
   of a higher computational complexity.
   In EP0940015B1 / W098/57436 entitled "Source coding enhancement using
20 spectral band replication" which is incorporated by reference, a method has been
   described on how to avoid aliasing emerging from a harmonic transposer when
   using even transposition factors. This method, called relative phase locking,
   assesses the relative phase difference between adjacent channels, and determines
   whether a sinusoidal is phase inverted in either channel. The detection is
25 performed by using equation (32) of EP0940015B 1. The channels detected as
   phase inverted are corrected after the phase angles are multiplied with the actual
   transposition factor.
   In the following a novel method for avoiding aliasing when using even and/or odd
30 transposition factors T is described. In contrary to the relative phase locking
   method of EP0940015B 1, this method does not require the detection and

                                                - 22
   correction of phase angles. The novel solution to the above problem makes use of
   analysis and synthesis transform windows that are not identical. In the perfect
   reconstruction (PR) case, this corresponds to a bi-orthogonal transform/filter bank
   rather than an orthogonal transform/filter bank.
 5
   To obtain a bi-orthogonal transform given a certain analysis window va(n), the
   synthesis window vs(n) is chosen to follow
                       LI(At,-l)
                         1v,(m+Atsi)v,(m+Atji)=c ,         0  m<At,
                          1=0
10
   where c is a constant, At, is the synthesis time stride and L is the window length.
   If the sequence s(n) is defined as
                                   L/(At,-l)
                           s(m)=Iva          2
                                               (m+Atsi), Osm<At,,
                                      1=0
15
   i.e. va(n)= vs(n) is used for both analysis and synthesis windowing, then the
   condition for an orthogonal transform is
                                     s(m)=c , 0 < m < At,.
20
   However, in the following another sequence w(n) is introduced, wherein w(n) is a
   measure on how much the synthesis window vs(n) deviates from the analysis
   window va(n), i.e. how much the bi-orthogonal transform differs from the
   orthogonal case. The sequence w(n) is given by
25
                                   w(n)=-"(,) 0 !sn< L.

                                                -23
   The condition for perfect reconstruction is then given by
                          L/(At,-l)
                            YV,
                                    2
                                      (m+Ati)w(m+Atsi)=c, Om<At.
                             i=O
 5 For a possible solution, w(n) could be restricted to be periodic with the synthesis
   time stride At,, i.e. w(n)= w(n + Atsi), Vin . Then, one obtains
       L/(At,-l)  2L/(Ats--1)                                  2
                 V (m+ Ati)w(m + Ati) = w(M)                v ,2 (m+±Atsi) = w(m)s(m)= c,
          i=Oi=0
                                             0 < m < At, .
10
   The condition on the synthesis window vs(n) is hence
                  v, (n)= w(n(mod At,))va(n) = c           V"(n)         0<! n < L.
                                                     s(n(mod At,))
15 By deriving the synthesis windows vs(n) as outlined above, a much larger freedom
   when designing the analysis window Va(n) is provided. This additional freedom
   may be used to design a pair of analysis/synthesis windows which does not
   exhibit aliasing of the transposed signal.
20 To obtain an analysis/synthesis window pair that suppresses aliasing for even
   transposition factors, several embodiments will be outlined in the following.
   According to a first embodiment the windows or prototype filters are made long
   enough to attenuate the level of the first side lobe in the frequency response below
   a certain "aliasing" level. The analysis time stride Ata will in this case only be a
25  (small) fraction of the window length L. This typically results in smearing of
   transients, e.g. in percussive signals.

                                             - 24
   According to a second embodiment, the analysis window va(n) is chosen to have
   dual zeros on the unit circle. The phase response resulting from a dual zero is a
   360 degree phase shift. These phase shifts are retained when the phase angles are
   multiplied with the transposition factors, regardless if the transposition factors are
 5 odd or even. When a proper and smooth analysis filter va(n), having dual zeros on
   the unit circle, is obtained, the synthesis window is obtained from the equations
   outlined above.
   In an example of the second embodiment, the analysis filter / window va(n) is the
10 "squared sine window", i.e. the sine window
                              v(n)= sin     (n +0.5)10 < n < L
   convolved with itself as v,(n) = v(n)0 v(n). However, it should be noted that the
15 resulting filter / window va(n) will be odd symmetric with length La=2L-1, i.e. an
   odd number of filter / window coefficients. When a filter / window with an even
   length is more appropriate, in particular an even symmetric filter, the filter may be
   obtained by first convolving two sine windows of length L. Then, a zero is
   appended to the end of the resulting filter. Subsequently, the 2L long filter is
20 resampled using linear interpolation to a length L even symmetric filter, which
   still has dual zeros only on the unit circle.
   Overall, it has been outlined, how a pair of analysis and synthesis windows may
   be selected such that aliasing in the transposed output signal may be avoided or
25 significantly reduced. The method is particularly relevant when using even
   transposition factors.
   Another aspect to consider in the context of vocoder based harmonic transposers
   is phase unwrapping. It should be noted that whereas great care has to be taken
30 related to phase unwrapping issues in general purpose phase vocoders, the

                                               - 25
   harmonic transposer has unambiguously defined phase operations when integer
   transposition factors T are used. Thus, in preferred embodiments the transposition
   order T is an integer value. Otherwise, phase unwrapping techniques could be
   applied, wherein phase unwrapping is a process whereby the phase increment
 5 between two consecutive frames is used to estimate the instantaneous frequency
   of a nearby sinusoid in each channel.
   Yet another aspect to consider, when dealing with the transposition of audio
   and/or voice signals, is the processing of stationary and/or transient signal
10 sections. Typically, in order to be able to transpose stationary audio signals
   without intermodulation artifacts, the frequency resolution of the DFT filter bank
   has to be rather high, and therefore the windows are long compared to transients
   in the input signals x(n), notably audio and/or voice signals. As a result, the
   transposer has a poor transient response. However, as will be described in the
15 following, this problem can be solved by a modification of the window design, the
   transform size and the time stride parameters. Hence, unlike many state of the art
   methods for phase vocoder transient response enhancement, the proposed solution
   does not rely on any signal adaptive operation such as transient detection.
20 In the following, the harmonic transposition of transient signals using vocoders is
   outlined. As a starting point, a prototype transient signal, a discrete time Dirac
   pulse at time instant t = to
                                                    1, t = to
                                     ,5(t - to )=   0      t,
25
   is considered. The Fourier transform of such a Dirac pulse has unit magnitude and
   a linear phase with a slope proportional to to:
                      X(,,)=       8o(n -to)exp(-jQ,,,n)-= exp(-jQ,,,tO).

                                             - 26
   Such Fourier transform can be considered as the analysis stage of the phase
   vocoder described above, wherein a flat analysis window v,(n) of infinite
   duration is used. In order to generate an output signal y(n) which is time-stretched
 5 by a factor T , i.e. a Dirac pulse 5(t - TO) at the time instant t = Tto, the phase of
   the analysis subband signals should be multiplied by the factor T in order to
   obtain the synthesis subband signal Y(Q,,,)= exp(-j,,2 Tto) which yields the
   desired Dirac pulse 4(t - TtO) as an output of an inverse Fourier Transform.
10 This shows that the operation of phase multiplication of the analysis subband
   signals by a factor T leads to the desired time-shift of a Dirac pulse, i.e. of a
   transient input signal. It should be noted that for more realistic transient signals
   comprising more than one non-zero sample, the further operations of time
   stretching of the analysis subband signals by a factor T should be performed. In
15 other words, different hop sizes should be used at the analysis and the synthesis
   side.
   However, it should be noted that the above considerations refer to an
   analysis/synthesis stage using analysis and synthesis windows of infinite lengths.
20 Indeed, a theoretical transposer with a window of infinite duration would give the
   correct stretch of a Dirac pulse 5(t -to).    For a finite duration windowed analysis,
   the situation is scrambled by the fact that each analysis block is to be interpreted
   as one period interval of a periodic signal with period equal to the size of the
   DFT.
25
   This is illustrated in Fig. 1 which shows the analysis and synthesis 100 of a Dirac
   pulse 5(t -to). The upper part of Fig. 1 shows the input to the analysis stage 110
   and the lower part of Fig. 1 shows the output of the synthesis stage 120. The upper
   and lower graphs represent the time domain. The stylized analysis window 111

                                                 - 27
   and synthesis window 121 are depicted as triangular (Bartlett) windows. The input
   pulse 9(t - to) 112 at time instant t =to is depicted on the top graph 110 as a
   vertical arrow. It is assumed that the DFT transform block is of size M =L, i.e.
   the size of the DFT transform is chosen to be equal to the size of the windows.
 5 The phase multiplication of the subband signals by the factor T will produce the
   DFT analysis of a Dirac pulse S(t - Tto) at t =Tto, however, periodized to a
   Dirac pulse train with period L. This is due to the finite length of the applied
   window and Fourier Transform. The periodized pulse train with period L is
   depicted by the dashed arrows 123, 124 on the lower graph.
10
   In a real-world system, where both the analysis and synthesis windows are of
   finite length, the pulse train actually contains a few pulses only (depending on the
   transposition factor), one main pulse, i.e. the wanted term, a few pre-pulses and a
   few post-pulses, i.e. the unwanted terms. The pre- and post-pulses emerge because
15 the DFT is periodic (with L). When a pulse is located within an analysis window,
   so that the complex phase gets wrapped when multiplied by T (i.e. the pulse is
   shifted outside the end of the window and wraps back to the beginning), an
   unwanted pulse emerges. The unwanted pulses may have, or may not have, the
   same polarity as the input pulse, depending on the location in the analysis window
20 and the transposition factor.
   This can be seen mathematically when transforming the Dirac pulse 6(t - to)
   situated in the interval -L /2       to < L /2 using a DFT with length L centered
   around t=0,
25
                    X(Q,) = ZS(n           - to) exp(-jQ,,n) = exp(-jQ,,to).
                               n=-L / 2

                                                - 28
   The analysis subband signals are phase multiplied with a factor T to obtain the
   synthesis subband signals Y(Q,,,)= exp(-jQ,,,TtO). Then the inverse DFT is
   applied to obtain the periodic synthesis signal:
                         1  L/2-1                              0
 5                y(n)=-          exp(-j,,,TtO)   exp(jQ,,,n)      (n - Tt +kL).
                         L ,=-L/2                             k=-o
   i.e. a Dirac pulse train with period L.
   In the example of Fig. 1, the synthesis windowing uses a finite window v, (n) 121.
10 The finite synthesis window 121 picks the desired pulse '(t - T[O) at t = Tto
   which is depicted as a solid arrow 122 and cancels the other contributions which
   are shown as dashed arrows 123, 124.
   As the analysis and synthesis stage move along the time axis according to the hop
15 factor or time stride At, the pulse 5(t -t o ) 112 will have another position relative
   to the center of the respective analysis window 111. As outlined above, the
   operation to achieve time-stretching consists in moving the pulse 112 to T times
   its position relative to the center of the window. As long as this position is within
   the window 121, this time-stretch operation guarantees that all contributions add
20 up to a single time stretched synthesized pulse S(t - Tto) at t = Tto.
   However, a problem occurs for the situation of Fig. 2, where the pulse
    5(t -to)212 moves further out towards the edge of the DFT block. Fig. 2
   illustrates a similar analysis/synthesis configuration 200 as Fig. 1. The upper
25 graph 210 shows the input to the analysis stage and the analysis window 211, and
   the lower graph 220 illustrates the output of the synthesis stage and the synthesis
   window 221. When time-stretching the input Dirac pulse 212 by a factor T, the
   time stretched Dirac pulse 222, i.e. S(t - Tto), is outside the synthesis window
   221. At the same time, another Dirac pulse 224 of the pulse train, i.e.

                                              -29
    9(t - Tto + L) at time instant t = Tto - L, is picked up by the synthesis window. In
   other words, the input Dirac pulse 212 is not delayed to a T times later time
   instant, but it is moved forward to a time instant that lies before the input Dirac
   pulse 212. The final effect on the audio signal is the occurrence of a pre-echo at a
 5 time distance of the scale of the rather long transposer windows, i.e. at a time
   instant t =Tto -L which is L - (T - 1)tO earlier than the input Dirac pulse 212.
   The principle of the solution proposed by the present invention is described in
   reference to Fig. 3. Fig. 3 illustrates an analysis/synthesis scenario 300 similar to
10 Fig. 2. The upper graph 310 shows the input to the analysis stage with the analysis
   window 311, and the lower graph 320 shows the output of the synthesis stage with
   the synthesis window 321. The basic idea of the invention is to adapt the DFT size
   so as to avoid pre-echoes. This may be achieved by setting the size M of the DFT
   such that no unwanted Dirac pulse images from the resulting pulse train are
15 picked up by the synthesis window. The size of the DFT transform 301 is
   increased toM = FL, where L is the length of the window function 302 and the
   factor F is a frequency domain oversampling factor. In other words, the size of
   the DFT transform 301 is selected to be larger than the window size 302. In
   particular, the size of the DFT transform 301 may be selected to be larger than the
20 window size 302 of the synthesis window. Due to the increased length 301 of the
   DFT transform, the period of the pulse train comprising the Dirac pulses 322, 324
   is FL. By selecting a sufficiently large value of F, i.e. by selecting a sufficiently
   large frequency domain oversampling factor, undesired contributions to the pulse
   stretch can be cancelled. This is shown in Fig. 3, where the Dirac pulse 324 at
25 time instant t  =  Tto -FL lies outside the synthesis window 321. Therefore, the
   Dirac pulse 324 is not picked up by the synthesis window 321 and by
   consequence, pre-echoes can be avoided.
   It should be noted that in a preferred embodiment the synthesis window and the
30 analysis window have equal ,,nominal" lengths. However, when using implicit

                                               -  30
    resampling of the output signal by discarding or inserting samples in the
     frequency bands of the transform or filter bank, the synthesis window size will
    typically be different from the analysis size, depending on the resampling or
    transposition factor.
  5
    The minimum value ofF , i.e. the minimum frequency domain oversampling
    factor, can be deduced from Fig. 3. The condition for not picking up undesired
    Dirac pulse images may be formulated as follows: For any input pulse 5(t -to)          at
                      L
    position t = to < - , i.e. for any input pulse comprised within the analysis window
                      2
10  311, the undesired image .(t - Tto + FL) at time instant t = Tto -FL must be
                                                                            L
    located to the left of the left edge of the synthesis window at t =
                                                                            2
                                      L            L
    Equivalently, the condition T L _ FL         - -   must be met, which leads to the rule
                                      2             2
                                             T+1
                                        F            .   (3)
                                                2
15
    As can be seen from formula (3), the minimum frequency domain oversampling
    factor F is a function of the transposition / time-stretching factor T. More
    specifically, the minimum frequency domain oversampling factor F is
    proportional to the transposition / time-stretching factor T.
20
    By repeating the line of thinking above for the case where the analysis and
    synthesis windows have different lengths one obtains a more general formula. Let
     LA and Ls be the lengths of the analysis and synthesis windows, respectively, and
    let M be the DFT size employed. The rule extending formula (3) is then
25
                                     M>TLA+LS.               (4)
                                             2

                                           - 31
   That this rule indeed is an extension of (3) can be verified by inserting M=FL,
   and LA = Ls =L in (4) and dividing by L on both side of the resulting equation.
 5 The above analysis is performed for a rather special model of a transient, i.e. a
   Dirac pulse. However, the reasoning can be extended to show that when using the
   above described time-stretching scheme, input signals which have a near flat
   spectral envelope and which vanish outside a time interval [a, b] will be stretched
   to output signals which are small outside the interval [Ta, Tb]. It can also be
10 checked by studying spectrograms of real audio and/or speech signals that pre
   echoes disappear in the stretched signals when the above described rule for
   selecting an appropriate frequency domain oversampling factor is respected. A
   more quantitative analysis also reveals that pre-echoes are still reduced when
   using frequency domain oversampling factors which are slightly inferior to the
15 value imposed by the condition of formula (3). This is due to the fact that typical
   window functions v, (n) are small near their edges, thereby attenuating undesired
   pre-echoes which are positioned near the edges of the window functions.
   In summary, the present invention teaches a new way to improve the transient
20 response of frequency domain harmonic transposers, or time-stretchers, by
   introducing an oversampled transform, where the amount of oversampling is a
   function of the transposition factor chosen.
   In the following, the application of harmonic transposition according to the
25 invention in audio decoders is described in further detail. A common use case for
   a harmonic transposer is in an audio/speech codec system employing so-called
   bandwidth extension or high frequency regeneration (HFR). It should be noted
   that even though reference may be made to audio coding, the described methods
   and systems are equally applicable to speech coding and in unified speech and
30 audio coding (USAC).

                                            - 32
   In such HFR systems the transposer may be used to generate a high frequency
   signal component from a low frequency signal component provided by the so
   called core decoder. The envelope of the high frequency component may be
 5 shaped in time and frequency based on side information conveyed in the bit
   stream.
   Fig. 4 illustrates the operation of an HFR enhanced audio decoder. The core audio
   decoder 401 outputs a low bandwidth audio signal which is fed to an up-sampler
10 404 which may be required in order to produce a final audio output contribution at
   the desired full sampling rate. Such up-sampling is required for dual rate systems,
   where the band limited core audio codec is operating at half the external audio
   sampling rate, while the HFR part is processed at the full sampling frequency.
   Consequently, for a single rate system, this up-sampler 404 is omitted. The low
15 bandwidth output of 401 is also sent to the transposer or the transposition unit 402
   which outputs a transposed signal, i.e. a signal comprising the desired high
   frequency range. This transposed signal may be shaped in time and frequency by
   the envelope adjuster 403. The final audio output is the sum of low bandwidth
   core signal and the envelope adjusted transposed signal.
20
   As outlined in the context of Fig. 4, the core decoder output signal may be up
   sampled as a pre-processing step by a factor 2 in the transposition unit 402. A
   transposition by a factor T results in a signal having T times the length of the un
   transposed signal, in case of time-stretching. In order to achieve the desired pitch
25 shifting or frequency transposition to T times higher frequencies, down-sampling
   or rate-conversion of the time-stretched signal is subsequently performed. As
   mentioned above, this operation may be achieved through the use of different
   analysis and synthesis strides in the phase vocoder.
30 The overall transposition order may be obtained in different ways. A first
   possibility is to up-sample the decoder output signal by the factor 2 at the entrance

                                            - 33
   to the transposer as pointed out above. In such cases, the time-stretched signal
   would need to be down-sampled by a factor T, in order to obtain the desired
   output signal which is frequency transposed by a factor T. A second possibility
   would be to omit the pre-processing step and to directly perform the time
 5 stretching operations on the core decoder output signal. In such cases, the
   transposed signals must be down-sampled by a factor T/2 to retain the global up
   sampling factor of 2 and in order to achieve frequency transposition by a factor T.
   In other words, the up-sampling of the core decoder signal may be omitted when
   performing a down-sampling of the output signal of the transposer 402 of T/2
10 instead of T. It should be noted, however, that the core signal still needs to be up
   sampled in the up-sampler 404 prior to combining the signal with the transposed
   signal.
   It should also be noted that the transposer 402 may use several different integer
15 transposition factors in order to generate the high frequency component. This is
   shown in Fig. 5 which illustrates the operation of a harmonic transposer 501,
   which corresponds to the transposer 402 of Fig. 4, comprising several transposers
   of different transposition order or transposition factor T. The signal to be
   transposed is passed to the bank of individual transposers 501-2, 501-3, ... , 501
20 Tmax having orders of transposition T = 2,3,...,T., respectively. Typically a
   transposition order 7,    = 4 suffices for most audio coding applications. The
   contributions of the different transposers 501-2, 501-3, ... , 501-Tmax are summed
   in 502 to yield the combined transposer output. In a first embodiment, this
   summing operation may comprise the adding up of the individual contributions. In
25 another embodiment, the contributions are weighted with different weights, such
   that the effect of adding multiple contributions to certain frequencies is mitigated.
   For instance, the third order contribution may be added with a lower gain than the
   second order contribution. Finally, the summing unit 502 may add the
   contributions selectively depending on the output frequency. For instance, the
30 second order transposition may be used for a first lower target frequency range,

                                            - 34
    and the third order transposition may be used for a second higher target frequency
   range.
   Fig. 6 illustrates the operation of a harmonic transposer, such as one of the
 5 individual blocks of 501, i.e. one of the transposers 501-T of transposition order T.
   An analysis stride unit 601 selects successive frames of the input signal which is
   to be transposed. These frames are super-imposed, e.g. multiplied, in an analysis
   window unit 602 with an analysis window. It should be noted that the operations
   of selecting frames of an input signal and multiplying the samples of the input
10 signal with an analysis window function may be performed in a unique step, e.g.
   by using a window function which is shifted along the input signal by the analysis
   stride. In the analysis transformation unit 603, the windowed frames of the input
   signal are transformed into the frequency domain. The analysis transformation
   unit 603 may e.g. perform a DFT. The size of the DFT is selected to be F times
15 greater than the size L of the analysis window, thereby generating M=F*L
   complex frequency domain coefficients. These complex coefficients are altered in
   the non-linear processing unit 604, e.g. by multiplying their phase with the
   transposition factor T. The sequence of complex frequency domain coefficients,
   i.e. the complex coefficients of the sequence of frames of the input signal, may be
20 viewed as subband signals. The combination of analysis stride unit 601, analysis
   window unit 602 and analysis transformation unit 603 may be viewed as a
   combined analysis stage or analysis filter bank.
   The altered coefficients or altered subband signals are retransformed into the time
25 domain using the synthesis transformation unit 605. For each set of altered
   complex coefficients, this yields a frame of altered samples, i.e. a set of M altered
   samples. Using the synthesis window unit 606, L samples may be extracted from
   each set of altered samples, thereby yielding a frame of the output signal. Overall,
   a sequence of frames of the output signal may be generated for the sequence of
30 frames of the input signal. This sequence of frames is shifted with respect to one
   another by the synthesis stride in the synthesis stride unit 607. The synthesis stride

                                            - 35
   may be T times greater than the analysis stride. The output signal is generated in
   the overlap-add unit 608, where the shifted frames of the output signal are
   overlapped and samples at the same time instant are added. By traversing the
   above system, the input signal may be time-stretched by a factor T, i.e. the output
 5 signal may be a time-stretched version of the input signal.
   Finally, the output signal may be contracted in time using the contracting unit
   609. The contracting unit 609 may perform a sampling rate conversion of order T,
   i.e. it may increase the sampling rate of the output signal by a factor T, while
10 keeping the number of samples unchanged. This yields a transposed output signal,
   having the same length in time as the input signal but comprising frequency
   components which are up-shifted by a factor T with respect to the input signal.
   The combining unit 609 may also perform a down-sampling operation by a factor
   T, i.e. it may retain only every  th sample while discarding the other samples. This
15 down-sampling operation may also be accompanied by a low pass filter operation.
   If the overall sampling rate remains unchanged, then the transposed output signal
   comprises frequency components which are up-shifted by a factor T with respect
   to the frequency components of the input signal.
20 It should be noted that the contracting unit 609 may perform a combination of
   rate-conversion and down-sampling. By way of example, the sampling rate may
   be increased by a factor 2. At the same time the signal may be down-sampled by a
   factor T/2. Overall, such combination of rate-conversion and down-sampling also
   leads to an output signal which is a harmonic transposition of the input signal by a
25 factor T. In general, it may be stated that the contracting unit 609 performs a
   combination of rate conversion and/or down-sampling in order to yield a
   harmonic transposition by the transposition order T. This is particularly useful
   when performing harmonic transposition of the low bandwidth output of the core
   audio decoder 401. As outlined above, such low bandwidth output may have been
30 down-sampled by a factor 2 at the encoder and may therefore require up-sampling
   in the up-sampling unit 404 prior to merging it with the reconstructed high

                                            - 36
   frequency component. Nevertheless, it may be beneficial for reducing
   computation complexity to perform harmonic transposition in the transposition
   unit 402 using the "non-up-sampled" low bandwidth output. In such cases, the
   contracting unit 609 of the transposition unit 402 may perform a rate-conversion
 5 of order 2 and thereby implicitly perform the required up-sampling operation of
   the high frequency component. By consequence, transposed output signals of
   order T are down-sampled in the contracting unit 609 by the factor T/2.
   In the case of multiple parallel transposers of different transposition orders such as
10 shown in Fig. 5, some transformation or filter bank operations may be shared
   between different transposers 501-2, 501-3, ... , 501-Tmax. The sharing of filter
   bank operations may be done preferably for the analysis in order to obtain more
   effective implementations of transposition units 402. It should be noted that a
   preferred way to resample the outputs from different tranposers is to discard DFT
15 bins or subband channels before the synthesis stage. This way, resampling filters
   may be omitted and complexity may be reduced when performing an inverse
   DFT/synthesis filter bank of smaller size.
   As just mentioned, the analysis window may be common to the signals of
20 different transposition factors. When using a common analysis window, an
   example of the stride of windows 700 applied to the low band signal is depicted in
   Fig. 7. Fig. 7 shows a stride of analysis windows 701, 702, 703 and 704, which
   are displaced with respect to one another by the analysis hop factor or analysis
   time stride At,
25
   An example of the stride of windows applied to the low band signal, e.g. the
   output signal of the core decoder, is depicted in Figure 8(a). The stride with which
   the analysis window of length L is moved for each analysis transform is denoted
    Ata Each such analysis transform and the windowed portion of the input signal is
30 also referred to as a frame. The analysis transform converts/transforms the frame

                                             - 37
    of input samples into a set of complex FFT coefficient. After the analysis
   transform, the complex FFT coefficients may be transformed from Cartesian to
   polar coordinates. The suite of FFT coefficients for subsequent frames makes up
   the analysis subband signals. For each of the transposition factors
 5  T =2,3,..., T. used, the phase angles of the FFT coefficients are multiplied by the
   respective transposition factor T and transformed back to Cartesian coordinates.
   Hence, there will be a different set of complex FFT coefficients representing a
   particular frame for every transposition factor T. In other words, for each of the
   transposition factors T = 2,3,..., T.  and for each frame, a separate set of FFT
10 coefficients is determined. By consequence, for every transposition order T a
   different set of synthesis subband signals Y(t,0,) is generated.
   In the synthesis stages, the synthesis strides At, of the synthesis windows are
   determined as a function of the transposition order T used in the respective
15 transposer. As outlined above, the time-stretch operation also involves time
   stretching of the subband signals, i.e. time stretching of the suite of frames. This
   operation may be performed by choosing a synthesis hop factor or synthesis stride
    At, which is increased over the analysis stride Ata by a factor T. Consequently,
   the synthesis stride AtT for the transposer of order T is given by At,= TAt.Figs.
20  8 (b) and 8 (c) show the synthesis stride AtT of synthesis windows for the
   transposition factors T=2 and T=3, respectively, where Ats2= 2Ata and
    Ats3 =3Ata.
   Fig. 8 also indicates the reference time tr which has been "stretched" by a factor
25  T=2 and T=3 in Figs. 8 (b) and 8 (c) compared to Fig. 8(a), respectively.
   However, at the outputs this reference time tr needs to be aligned for the two
   transposition factors. To align the output, the third order transposed signal, i.e.
   Fig. 8(c), needs to be down-sampled or rate-converted with the factor 3/2. This
   down-sampling leads to a harmonic transposition in respect to the second order

                                              - 38
   transposed signal. Fig.9 illustrates the effect of the re-sampling on the synthesis
   stride of windows for T= 3. If it is assumed that the analysed signal is the output
   signal of a core decoder which has not been up-sampled, then the signal of Fig. 8
   (b) has been effectively frequency transposed by a factor 2 and the signal of Fig. 8
 5 (c) has been effectively frequency transposed by a factor 3.
   In the following, the aspect of time alignment of transposed sequences of different
   transposition factors when using common analysis windows is addressed. In other
   words, the aspect of aligning the output signals of frequency transposers
10 employing a different transposition order is addressed. When using the methods
   outlined above, Dirac-functions 5(t -to) are time-stretched, i.e. moved along the
   time axis, by the amount of time given by the applied transposition factor T. In
   order to convert the time-stretching operation into a frequency shifting operation,
   a decimation or down-sampling using the same transposition factor T is
15 performed. If such decimation by the transposition factor or transposition order
    T is performed on the time-stretched Dirac-function 5(t - TtO), the down-sampled
   Dirac pulse will be time aligned with respect to the zero-reference time 710 in the
   middle of the first analysis window 701. This is illustrated in Fig. 7.
20 However, when using different orders of transposition T, the decimations will
   result in different offsets for the zero-reference, unless the zero-reference is
   aligned with "zero" time of the input signal. By consequence, a time offset
   adjustment of the decimated transposed signals need to be performed, before they
   can be summed up in the summing unit 502. As an example, a first transposer of
25 order T = 3 and a second transposer of order T = 4 are assumed. Furthermore, it
   is assumed that the output signal of the core decoder is not up-sampled. Then the
   transposer decimates the third order time-stretched signal by a factor 3/2, and the
   fourth order time-stretched signal by a factor 2. The second order time-stretched
   signal, i.e. T = 2, will just be interpreted as having a higher sampling frequency

                                                   - 39
     compared to the input signal, i.e. a factor 2 higher sampling frequency, effectively
     making the output signal pitch-shifted by a factor 2.
     It can be shown that in order to align the transposed and down-sampled signals,
  5  time offsets by (T - 2)L need to be applied to the transposed signals before
                          4
                                                                                   L
     decimation, i.e. for the third and fourth order transpositions, offsets of    -  and
                                                                                    4
      L
     -have    to be applied respectively. To verify this in a concrete example, the zero
      2
    reference for a second order time-stretched signal will be assumed to correspond
    to time instant or sample-        ,i.e. to the zero-reference 710 in Fig. 7. This is so,
                                  2
10  because no decimation is used. For a third order time-stretched signal, the
                                          L2 L                                           3
    reference will translate to -          -    -, due to down-sampling by a factor of - . If
                                   2 3         3                                         2
    the time offset according to the above mentioned rule is added before decimation,
    the reference will translate into        -+-L       -)=- . This means that the reference
                                           (2 4        3    2
    of the down-sampled transposed signal is aligned with the zero-reference 710. In a
15  similar manner, for the fourth order transposition without offset the zero-reference
    corresponds to L      -I) = -, but when using the proposed offset, the reference
                       2 2      4
    translates into     -            -+Q)Jwhich again is aligned with the 2nd order zero
                                    =IL,
                      (2   2    2        2
    reference 710, i.e. the zero-reference for the transposed signal using T = 2.
20  Another aspect to be considered when simultaneously using multiple orders of
    transposition relates to the gains applied to the transposed sequences of different
    transposition factors. In other words, the aspect of combining the output signals of
    transposers of different transposition order may be addressed. There are two
    principles when selecting the gain of the transposed signals, which may be

                                             - 40
     considered under different theoretical approaches. Either, the transposed signals
     are supposed to be energy conserving, meaning that the total energy in the low.
     band signal which subsequently is transposed to constitute a factor-T transposed
     high band signal is preserved. In this case the energy per bandwidth should be
  5  reduced by the transposition factor T since the signal is stretched by the same
     amount T in frequency. However, sinusoids, which have their energy within an
     infinitesimally small bandwidth, will retain their energy after transposition. This is
    due to the fact that in the same way as a Dirac pulse is moved in time by the
    transposer when time-stretching, i.e. in the same way that the duration in time of
10  the pulse is not changed by the time-stretching operation, a sinusoidal is moved in
    frequency when transposing, i.e. the duration in frequency (in other words the
    bandwidth) is not changed by the frequency transposing operation. I.e. even
    though the energy per bandwidth is reduced by T, the sinusoidal has all its energy
    in one point in frequency so that the point-wise energy will be preserved.
15
    The other option when selecting the gain of the transposed signals is to keep the
    energy per bandwidth after transposition. In this case, broadband white noise and
    transients will display a flat frequency response after transposition, while the
    energy of sinusoids will increase by a factor T.
20
    A further aspect of the invention is the choice of analysis and synthesis phase
    vocoder windows when using common analysis windows. It is beneficial to
    carefully choose the analysis and synthesis phase vocoder windows, i.e. v,(n) and
     v, (n). Not only should the synthesis window v, (n) adhere to Formula 2 above, in
25  order to allow for perfect reconstruction. Furthermore, the analysis window va(n)
    should also have adequate rejection of the side lobe levels. Otherwise, unwanted
    "aliasing" terms will typically be audible as interference with the main terms for
    frequency varying sinusoids. Such unwanted "aliasing" terms may also appear for
    stationary sinusoids in the case of even transposition factors as mentioned above.

                                            - 41
   The present invention proposes the use of sine windows because of their good
   side lobe rejection ratio. Hence, the analysis window is proposed to be
                           Va(n)= sin'(n+0.5),0: n <L          (4)
                                      (L
 5
   The synthesis windows v, (n) will be either identical to the analysis window
    Va(n) or given by formula (2) above if the synthesis hop-size At, is not a factor of
   the analysis window length L, i.e. if the analysis window length L is not integer
   dividable by the synthesis hop-size. By way of example, if L= 1024, and At,= 384,
10 then 1024/384 = 2.667 is not an integer. It should be noted that it is also possible
   to select a pair of bi-orthogonal analysis and synthesis windows as outlined above.
   This may be beneficial for the reduction of aliasing in the output signal, notably
   when using even transposition orders T.
15 In the following, reference is made to Fig. 10 and Fig. 11 which illustrate an
   exemplary encoder 1000 and an exemplary decoder 1100, respectively, for unified
   speech and audio coding (USAC). The general structure of the USAC encoder
    1000 and decoder 1100 is described as follows: First there may be a common
   pre/postprocessing consisting of an MPEG Surround (MPEGS) functional unit to
20 handle stereo or multi-channel processing and an enhanced Spectral Band
   Replication (eSBR) unit 1001 and 1101, respectively, which handles the
   parametric representation of the higher audio frequencies in the input signal and
   which may make use of the harmonic transposition methods outlined in the
   present document. Then there are two branches, one consisting of a modified
25 Advanced Audio Coding (AAC) tool path and the other consisting of a linear
   prediction coding (LP or LPC domain) based path, which in turn features either a
   frequency domain representation or a time domain representation of the LPC
   residual. All transmitted spectra for both, AAC and LPC, may be represented in

                                           - 42
   MDCT domain followed by quantization and arithmetic coding. The time domain
   representation may use an ACELP excitation coding scheme.
   The enhanced Spectral Band Replication (eSBR) unit 1001 of the encoder 1000
 5 may comprise high frequency reconstruction components outlined in the present
   document. In some embodiments, the eSBR unit 1001 may comprise a
   transposition unit outlined in the context of Fig. 4, 5 and 6. Encoded data related
   to harmonic transposition, e.g. the order of transposition used, the amount of
   frequency domain oversampling needed, or the gains employed, may be derived
10 in the encoder 1000 and merged with the other encoded information in a bitstream
   multiplexer and forwarded as an encoded audio stream to a corresponding decoder
   1100.
   The decoder 1100 shown in Fig. 11 also comprises an enhanced Spectral
15 Bandwidth Replication (eSBR) unit 1101. This eSBR unit 1101 receives the
   encoded audio bitstream or the encoded signal from the encoder 1000 and uses the
   methods outlined in the present document to generate a high frequency
   component or high band of the signal, which is merged with the decoded low
   frequency component or low band to yield a decoded signal. The eSBR unit 1101
20 may comprise the different components outlined in the present document. In
   particular, it may comprise the transposition unit outlined in the context of Figs. 4,
   5 and 6. The eSBR unit 1101 may use information on the high frequency
   component provided by the encoder 1000 via the bitstream in order to perform the
   high frequency reconstruction. Such information may be the spectral envelope of
25 the original high frequency component to generate the synthesis subband signals
   and ultimately the high frequency component of the decoded signal, as well as the
   order of transposition used, the amount of frequency domain oversampling
   needed, or the gains employed.
30 Furthermore, Figs. 10 and 11 illustrate possible additional components of a USAC
   encoder/decoder, such as:

                                       - 43
   0 a bitstream payload demultiplexer tool, which separates the bitstream
     payload into the parts for each tool, and provides each of the tools with the
     bitstream payload information related to that tool;
   0 a scalefactor noiseless decoding tool, which takes information from the
 5   bitstream payload demultiplexer, parses that information, and decodes the
     Huffman and DPCM coded scalefactors;
   e a spectral noiseless decoding tool, which takes information from the
     bitstream payload demultiplexer, parses that information, decodes the
     arithmetically coded data, and reconstructs the quantized spectra;
10 0 an inverse quantizer tool, which takes the quantized values for the spectra,
     and converts the integer values to the non-scaled, reconstructed spectra;
     this quantizer is preferably a companding quantizer, whose companding
     factor depends on the chosen core coding mode;
   e a noise filling tool, which is used to fill spectral gaps in the decoded
15   spectra, which occur when spectral values are quantized to zero e.g. due to
     a strong restriction on bit demand in the encoder;
   0 a rescaling tool, which converts the integer representation of the
     scalefactors to the actual values, and multiplies the un-scaled inversely
     quantized spectra by the relevant scalefactors;
20 0 a M/S tool, as described in ISO/lEC 14496-3;
   0 a temporal noise shaping (TNS) tool, as described in ISO/lEC 14496-3;
   0 a filter bank / block switching tool, which applies the inverse of the
     frequency mapping that was carried out in the encoder; an inverse
     modified discrete cosine transform (IMDCT) is preferably used for the
25   filter bank tool;
   0 a time-warped filter bank / block switching tool, which replaces the normal
     filter bank / block switching tool when the time warping mode is enabled;
     the filter bank preferably is the same (IMDCT) as for the normal filter
     bank, additionally the windowed time domain samples are mapped from

                                             - 44
            the warped time domain to the linear time domain by time-varying
           resampling;
       e   an MPEG Surround (MPEGS) tool, which produces multiple signals from
            one or more input signals by applying a sophisticated upmix procedure to
 5         the input signal(s) controlled by appropriate spatial parameters; in the
           USAC context, MPEGS is preferably used for coding a multichannel
           signal, by transmitting parametric side information alongside a transmitted
           downmixed signal;
       " a signal classifier tool, which analyses the original input signal and
10         generates from it control information which triggers the selection of the
           different coding modes; the analysis of the input signal is typically
           implementation dependent and will try to choose the optimal core coding
           mode for a given input signal frame; the output of the signal classifier may
           optionally also be used to influence the behaviour of other tools, for
15         example MPEG Surround, enhanced SBR, time-warped filterbank and
           others;
       e   an LPC filter tool, which produces a time domain signal from an excitation
           domain signal by filtering the reconstructed excitation signal through a
           linear prediction synthesis filter; and
20     e   an ACELP tool, which provides a way to efficiently represent a time
           domain excitation signal by combining a long term predictor (adaptive
           codeword) with a pulse-like sequence (innovation codeword).
   Fig. 12 illustrates an embodiment of the eSBR units shown in Figs. 10 and 11.
25 The eSBR unit 1200 will be described in the following in the context of a decoder,
   where the input to the eSBR unit 1200 is the low frequency component, also
   known as the low band, of a signal.
   In Fig. 12 the low frequency component 1213 is fed into a QMF filter bank, in
30 order to generate QMF frequency bands. These QMF frequency bands are not to
   be mistaken with the analysis subbands outlined in this document. The QMF

                                            - 45
   frequency bands are used for the purpose of manipulating and merging the low
   and high frequency component of the signal in the frequency domain, rather than
   in the time domain. The low frequency component 1214 is fed into the
   transposition unit 1204 which corresponds to the systems for high frequency
 5 reconstruction outlined in the present document. The transposition unit 1204
   generates a high frequency component 1212, also known as highband, of the
   signal, which is transformed into the frequency domain by a QMF filter bank
    1203. Both, the QMF transformed low frequency component and the QMF
   transformed high frequency component are fed into a manipulation and merging
10 unit 1205. This unit 1205 may perform an envelope adjustment of the high
   frequency component and combines the adjusted high frequency component and
   the low frequency component. The combined output signal is re-transformed into
   the time domain by an inverse QMF filter bank 1201.
15 Typically the QMF filter bank 1202 comprise 32 QMF frequency bands. In such
   cases, the low frequency component 1213 has a bandwidth of       f, /4, where  f, /2
   is the sampling frequency of the signal 1213. The high frequency component 1212
   typically has a bandwidth of f, /2 and is filtered through the QMF bank 1203
   comprising 64 QMF frequency bands.
20
   In the present document, a method for harmonic transposition has been outlined.
   This method of harmonic transposition is particularly well suited for the
   transposition of transient signals. It comprises the combination of frequency
   domain oversampling with harmonic transposition using vocoders. The
25 transposition operation depends on the combination of analysis window, analysis
   window stride, transform size, synthesis window, synthesis window stride, as well
   as on phase adjustments of the analysed signal.Through the use of this method
   undesired effects, such as pre- and post-echoes, may be avoided. Furthermore, the
   method does not make use of signal analysis measures, such as transient detection,
30 which typically introduce signal distortions due to discontinuities in the signal

                                            - 46
   processing. In addition, the proposed method only has reduced computational
   complexity. The harmonic transposition method according to the invention may
   be further improved by an appropriate selection of analysis/synthesis windows,
   gain values and/or time alignment.
 5
   Particular aspects of the present document are:
   Aspect 1.        A system for generating an output signal from an input signal (312)
       using a transposition factor T, comprising:
10        -an analysis window unit (602) applying an analysis window (311) of
              length La, thereby extracting a frame of the input signal (312);
          -an analysis transformation unit (603) of order M (301), transforming the
              samples into M complex coefficients;
          -a nonlinear processing unit (604), altering the phase of the complex
15            coefficients by using the transposition factor T;
          -a synthesis transformation unit (605) of order M, transforming the altered
              coefficients into M altered samples; and
          -a synthesis window unit (606) applying a synthesis window (321) of
              length Ls to the M altered samples, thereby generating a frame of the
20            output signal;
       wherein M is based on the transposition factor T.
   Aspect 2.       The system of aspect 1, wherein the difference between M and the
       average length of the analysis window (311) and the synthesis window (321)
25     is proportional to (T-1).
   Aspect 3.       The system of aspect 2, wherein M is greater or equal to
       (TLa+Ls)/2.
30 Aspect 4.       The system of any previous aspect, wherein

                                              - 47
         -the analysis transformation unit (603) performs one of a Fourier
              Transform, a Fast Fourier Transform, a Discrete Fourier Transform, a
              Wavelet Transform; and
         -the synthesis transformation unit (605) performs the corresponding inverse
 5            transform.
   Aspect 5.        The system of any previous aspect, further comprising:
         -an analysis stride unit (601), shifting the analysis window by an analysis
              stride of Sa samples along the input signal, thereby generating a
10            succession of frames of the input signal;
         -a synthesis stride unit (607), shifting successive frames of the output signal
              by a synthesis stride of Ss samples; and
         -an overlap-add unit (608), overlapping and adding the successive shifted
              frames of the output signals, thereby generating the output signal.
15
   Aspect 6.        The system of aspect 5, wherein
         -the synthesis stride is T times the analysis stride; and
         -the output signal corresponds to the input signal, time-stretched by the
              transposition factor T.
20
   Aspect 7.        The system of any previous aspect, wherein the synthesis window
      is derived from the analysis window, and the analysis stride.
   Aspect 8.        The system of aspect 7, wherein the synthesis window is given by
25    the formula:
       v,(n) = v,(n)      (a(n   - k - At)) 2    , with
         - v, (n) being the synthesis window;
         - V, (n) being the analysis window; and

                                             -48
          - At being the analysis stride.
    Aspect 9.       The system of any previous aspect, wherein the analysis and/or
        synthesis window is one of:
  5       -Gaussian window;
          -cosine window;
          -Hamming window;
          -Hann window;
          -rectangular window;
10        -Bartlett windows;
          -Blackman windows;
          - a window having the function v(n)= sin< (n + 0.5)j,0         n < L , wherein
                                                       (L
              L is the length of the analysis window La and/or synthesis window Ls.
15  Aspect 10.      The system of aspect 5, further comprising a contraction unit (609),
          -increasing the sampling rate of the output signal by the transposition order
              T; and/or
          -downsampling the output signal by the transposition order T, while
              keeping the sampling rate unchanged;
20     thereby yielding a transposed output signal.
    Aspect 11.      The system of aspect 10, wherein
          -the synthesis stride is T times the analysis stride; and
          -the transposed output signal corresponds to the input signal, frequency
25            shifted by the transposition factor T.
    Aspect 12.      The system of aspect 1, wherein the altering of the phase comprises
       multiplying the phase by the transposition factor T.

                                          - 49
   Aspect 13.    The system of aspect 10, further comprising:
        -a second nonlinear processing unit (604), altering the phase of the complex
            coefficients by using a second transposition factor T2, thereby yielding a
            frame of a second output signal; and
 5      -a second synthesis stride unit (607), shifting successive frames of the
            second output signal by a second synthesis stride, thereby generating the
            second output signal in the overlap-add unit (608).
   Aspect 14.    The system of aspect 13, further comprising
10      -a second contraction unit (609), using the second transposition order T2 ,
            thereby yielding a second transposed output signal; and
        -a combining unit (502), merging the first and second transposed output
            signals.
15 Aspect 15.     The system of aspect 14, wherein the merging of the first and
      second transposed output signals comprises adding the samples of the first and
      second transposed output signals.
   Aspect 16.     The system of aspect 14, wherein
20      -the combining unit (502) weights the first and second transposed output
            signals prior to merging; and
        -weighting is performed such that the energy or the energy per bandwidth
            of the first and second transposed output signals corresponds to the
            energy or energy per bandwidth of the input signal, respectively.
25
   Aspect 17.     The system of aspect 14, further comprising:
        -an alignment unit, time offsetting the first and second transposed output
            signals prior to entering the combining unit.

                                            - 50
   Aspect 18.      The system of aspect 17, wherein the time offset is a function of the
      transposition order T and/or the length of the windows L, with L = La= Ls.
   Aspect 19.      The system of aspect 18, wherein the time offset is determined as
       (T -2)L
           4
   Aspect 20.      The system of any previous aspect, wherein the analysis window
      (311) and the synthesis window (321) are different from each other and bi
      orthogonal with respect to one another.
10
   Aspect 21.     The system of aspect 20, wherein the z transform of the analysis
      window (311) has dual zeros on the unit circle.
   Aspect 22.     A system for generating an output signal from an input signal (312)
15    using a transposition factor T, comprising:
         -an analysis window unit (602) applying an analysis window (311) of
             length L, thereby extracting a frame of the input signal (312);
        -an analysis transformation unit (603) of order M (301), transforming the
             samples into M complex coefficients;
20      -a nonlinear processing unit (604), altering the phase of the complex
             coefficients by using the transposition factor T;
        -a synthesis transformation unit (605) of order M, transforming the altered
             coefficients into M altered samples; and
        -a synthesis window unit (606) applying a synthesis window (321) of
25           length L to the M altered samples, thereby generating a frame of the
             output signal;
      wherein the analysis window (311) and the synthesis window (321) are
      different from each other and bi-orthogonal with respect to one another.

                                            - 51
    Aspect 23.      A system for decoding a received multimedia signal, comprising an
        audio signal; the system comprising a transposition unit (402) according to
        any one of the aspects 1 to 22, wherein the input signal is a low frequency
       component of the audio signal and the output signal is a high frequency
  5     component of the audio signal.
    Aspect 24.      The system of aspect 23, further comprising a core decoder (401)
       for decoding the low frequency component of the audio signal.
10  Aspect 25.      The system of aspect 24, wherein the core decoder (401) is based
       on a coding scheme being one of: Dolby E, Dolby Digital, AAC.
    Aspect 26.      A set-top box for decoding a received multimedia signal,
       comprising an audio signal; the set-top box comprising a transposition unit
15     (402) according to any one of the aspects 1 to 22 for generating a transposed
       output signal from the audio signal.
    Aspect 27.      A method for transposing an input signal (312) by a transposition
       factor T, comprising the steps of
20        -extracting a frame of samples of the input signal (312) using an analysis
              window (311) of length La;
          -transforming the frame of the input signal from the time domain into the
              frequency domain yielding M complex coefficients;
          -altering the phase of the complex coefficients with the transposition factor
25            T;
          -transforming the M altered complex coefficients into the time domain
              yielding M altered samples; and
          -generating a frame of an output signal using a synthesis window (321) of
              length Ls;
30     wherein M is based on the transposition factor T.

                                             -52
   Aspect 28.       The method of aspect 27, further comprising the steps of:
         -shifting the analysis window by an analysis stride of Sa samples along the
              input signal, thereby yielding a succession of frame of the input signal;
         -shifting successive frames of the output signal by a synthesis stride of Ss
 5            samples; and
         -overlapping and adding the successive shifted frames of the output signals,
              thereby generating the output signal.
   Aspect 29.      The method of aspect 28, wherein the synthesis stride is T times the
10    analysis stride.
   Aspect 30.      The method of aspect 29, further comprising the step of:
         -performing a rate conversion of the output signal by the transposition order
              T, thereby yielding a transposed output signal.
15
   Aspect 31.      The method of aspect 29, further comprising the step of:
         -performing a downsampling of the output signal by the transposition order
              T while keeping the sampling rate unchanged, thereby yielding a
             transposed output signal.
20
   Aspect 32.      The method of any one of aspects 28 to 31, further comprising the
      steps of:
         -altering the phase of the complex coefficients by using a second
             transposition factor T2 , thereby generating a frame of a second output
25            signal;
         -shifting successive frames of the second output signal by a second
              synthesis stride, thereby generating a second output signal by
              overlapping and adding the shifted frames of the second output signal.
30 Aspect 33.      The method of aspect 32, further comprising the steps of:

                                              - 53
         -performing a rate conversion of the second output signal by the second
              transposition order T2 , thereby yielding a second transposed output
              signal; and
         -merging the first and second transposed output signals to yield a merged
 5            output signal.
   Aspect 34.         A method for transposing an input signal (312) by a transposition
      factor T, comprising the steps of
         -extracting a frame of samples of the input signal (312) using an analysis
10            window (311) of length L;
         -transforming the frame of the input signal from the time domain into the
             frequency domain yielding M complex coefficients;
         -altering the phase of the complex coefficients with the transposition factor
             T;
15       -transforming the M altered complex coefficients into the time domain
             yielding M altered samples; and
         -generating a frame of an output signal using a synthesis window (321) of
             length L;
      wherein the analysis window (311) and the synthesis window (321) are
20    different from each other and bi-orthogonal with respect to one another.
   Aspect 35.         The method of aspect 34, wherein the synthesis window (321) vs(n)
      is given by:
       VS(n) = c         v"       ,n) 0  n < L,
                   s(n(mod At,))
25    with c being a constant, va(n) being the analysis window (311), At, being a
      time stride of the synthesis window (321) and s(n) being given by:
                L/(At-1)
       s(m)       YE     va(m±Atsi),    O<m < At,.
                   1=0

                                             - 54
     Aspect 36.       The method of aspects 34 to 35, wherein the z transform of the
         analysis window (311) has dual zeros on the unit circle.
     Aspect 37.       The method of aspect 36, wherein the analysis window is a squared
   5     sine window.
     Aspect 38.       The method of aspect 36, wherein the analysis window of length L
         is determined by
            -convolving two sine windows of length L, yielding a squared sine window
 10             of length 2L-1;
            -appending a zero to the squared sine window, yielding a base window of
                length 2L; and
            -resampling the base window using linear interpolation, yielding an even
                symmetric window of length L as the analysis window.
 15
     Aspect 39.      A software program adapted for execution on a processor and for
        performing the method steps of either one of aspects 27 to 38 when carried out
        on a computing device.
20   Aspect 40.      A storage medium comprising a software program adapted for
        execution on a processor and for performing the method steps of either one of
        aspects 27 to 38 when carried out on a computing device.
     Aspect 41.      A computer program product comprising executable instructions
25      for performing the method of either one of aspects 27 to 38 when executed on
        a computer.

                                              - 55
                                           CLAIMS
     1.     A system for transposing an input audio signal by a transposition factor T,
  5 the system comprising:
          -means for extracting a frame of L time-domain samples of the input signal
               using an analysis window of length L,
          -means for transforming the L time-domain samples into M complex
               frequency-domain coefficients;
 10       -a nonlinear processing unit for altering a phase of the complex frequency
               domain coefficients using the transposition factor T;
          -means for transforming the M altered complex frequency-domain
               coefficients into M altered time-domain samples; and
          -a means for generating a frame of L time-domain output samples from the
15             M altered time-domain samples using a synthesis window;
        wherein M=F*L, with F being a frequency domain oversampling factor
        determined in response to frequency domain oversampling information
        received in an encoded bitstream.
20  2.      The system of claim 1, wherein transforming the L time-domain samples
    into M complex frequency-domain coefficients comprises zero padding the L
    time-domain samples by an additional (F-1)*L zeros.
    3.      The system of claim 1 or claim 2, wherein an analysis transformation size
25  M is chosen larger than the length of the analysis window L by a factor F.
    4.      The system of any previous claim, further comprising:
          -an analysis stride unit for shifting the analysis window by an analysis
30            stride along the input signal, thereby generating successive frames of the
              input signal;

                                                  - 56
              -a synthesis stride unit for shifting successive frames of L time-domain
                  output samples by a synthesis stride; and
              -an overlap-add unit for overlapping and adding the successive shifted
                  frames of L time-domain output samples, thereby generating an output
  5               signal.
     5.        The system of claim 4, further comprising a contraction unit for increasing
     the sampling rate of the output signal by the transposition order T; thereby
     yielding a transposed output signal.
 10
     6.        The system of claim 5, wherein the synthesis stride is T times the analysis
     stride.
     7.        A method for transposing an input audio signal by a transposition factor T,
15  the method comprising:
             -extracting a frame of L time-domain samples of the input signal using an
                  analysis window of length L,
            -transforming the L time-domain samples into M complex frequency
                 domain coefficients,
20          -altering a phase of the complex frequency-domain coefficients using the
                 transposition factor T;
            -transforming the M altered complex frequency-domain coefficients into M
                 altered time-domain samples; and
            -generating a frame of L time-domain output samples from the M altered
25               time-domain samples using a synthesis window; wherein M=F*L, with
                 F being a frequency domain oversampling factor determined in response
                 to frequency domain oversampling information received in an encoded
                 bitstream.
30  8.         The method of claim 7, wherein transforming the L time-domain samples
    into M complex frequency-domain coefficients is performing one of a Fourier

                                        - 57
  Transform, a Fast Fourier Transform, a Discrete Fourier Transform, a Wavelet
  Transform.
  9.      A storage medium comprising a software program adapted for execution
5 on a processor and for performing the method steps of claim 7 or claim 8 when
  carried out on a computing device

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
