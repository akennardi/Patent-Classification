                                            ABSTRACT
           Described embodiments          include an apparatus          that   includes    an
  electrical          interface      and    a    processor.          The    processor      is
5 configured          to    receive,       via     the    electrical        interface,       a
  temperature sensed by a temperature                  sensor at     a distal end of an
  intrabody         probe,    to    estimate      a   temperature       of   tissue   of     a
  subject,       based    on   the   sensed    temperature       and  a  parameter   of    an
  ablating       current     driven,    by   an  ablation      electrode    at  the distal
0 end of       the   intrabody     probe,    into   the  tissue,     and   to generate     an
  output        in    response      to    the    estimated        temperature.        Other
  embodiments are also described.
           3447024v1

           1/4
     1LLn
             -nl
       I~Q
LL-J

                          ESTIMATING A TEMPERATURE DURING ABLATION
                           CROSS-REFERENCE TO RELATED APPLICATIONS
             The    present         application            is    a    continuation-in-part                 of,     and
   claims        the      benefit         of,     US     Patent        Application           No.       14/998,204,
 5 filed       December        24,    2015,       whose       disclosure          is   incorporated          herein
   by reference.
                                           FIELD OF THE INVENTION
             The present           invention         relates         generally         to invasive         medical
   devices,         and      particularly              to      probes       used       in    ablating        tissue
 0 within the body.
                                                     BACKGROUND
             Minimally-invasive                  intracardiac             ablation         is    the     treatment
   of     choice       for      various         types       of   arrhythmias.                To     perform      such
   treatment,           the      physician          typically           inserts        a    catheter        through
 5 the vascular system into the heart, brings                                       the distal end of the
   catheter          into        contact          with        myocardial            tissue        in     areas      of
   abnormal         electrical            activity,            and     then      energizes          one    or    more
   electrodes          at     or    near      the    distal        end     in    order      to    create     tissue
   necrosis.
20           U.S.      Patent         Application              Publication            2010/0030209,            whose
   disclosure            is     incorporated             herein         by      reference,           describes       a
   catheter         with        a    perforated           tip,       which        includes         an    insertion
   tube,        having        a    distal         end     for       insertion          into       a    body     of   a
   subject.             A    distal         tip     is      fixed       to      the    distal         end   of     the
25 insertion         tube       and    is     coupled         to   apply        energy      to    tissue     inside
   the body.            The     distal       tip has         an    outer surface with a plurality
   of perforations               through the           outer surface, which are distributed
   circumferentially                 and      longitudinally               over      the     distal       tip.       A
   lumen        passes         through         the     insertion            tube      and      is      coupled      to
30 deliver a fluid to the tissue via the perforations.
                                                               1
             3447024v1

            U.S.        Patent         5,957,961,           whose      disclosure           is     incorporated
   herein        by       reference,             describes         a     catheter         having        a     distal
   segment        carrying             at     least       one    electrode          extending          along      the
   segment        and        having         a    number       of    temperature            sensors        arranged
 5 along      the      distal        segment        adjacent       the       electrode,       each      providing
   an output indicative of temperature.                                   The    catheter       is     coupled to
   a power source,                 which provides radiofrequency                       (RF) energy to the
   electrode.               Temperature            processing         circuitry        is    coupled         to   the
   temperature             sensors          and     the     power      source,       and     controls          power
 0 output from the power source as                             a function of the               outputs of the
   temperature sensors.
            U.S.        Patent         6,312,425,           whose      disclosure           is     incorporated
   herein        by       reference,            describes         an      RF     ablation        catheter         tip
   electrode with multiple thermal                             sensors. A          tip thermal          sensor is
 5 located at or near the apex of the distal-end region, and one or
   more      side       thermal         sensors         are   located         near   the     surface         of   the
   proximal-end               region.           The     electrode         is    preferably          an    assembly
   formed        from        a    hollow        dome-shaped           shell       with     a   core       disposed
   within         the         shell.              The       side      thermal         sensor          wires       are
 0 electrically               connected           inside       the     shell       and     the      core      has   a
   longitudinal             channel for the                side thermal          sensor wires welded to
   the     shell.          The      shell      also      preferably          has   a  pocket        in    the    apex
   of    the    shell,         and     the end         thermal     sensor wires            pass      through      the
   core to the apex of the shell.
25          U.S.        Patent         6,217,574,           whose      disclosure           is     incorporated
   herein      by reference,                 describes        an   irrigated         split      tip     electrode
   catheter.            A      signal        processor          activates          an     RF     generator         to
   transmit        a     low     level       RF current         to each         electrode       member        of the
   split       tip        electrode.             The      signal       processor          receives          signals
30 indicative            of     the      impedance         between        each     electrode          member      and
   one     or more          surface        indifferent          electrodes          and    determines          which
   electrode           members           are     associated         with        the   highest          impedance.
   Such       electrode            members          are     stated        to     be   those        in     greatest
   contact with the myocardium.
                                                              2
            3447024v1

             U.S.       Patent          6,391,024,              whose         disclosure               is      incorporated
   herein           by     reference,              describes               a     method           of      assessing             the
   adequacy of contact between an                                 ablation electrode and biological
   tissue.          The     method         measures            the      impedance             between           an    ablation
 5 electrode            and       a     reference             electrode              at      a     first         and      second
   frequencies.             A percentage               difference              between           the    first-frequency
   impedance             and       the        second-frequency                     impedance              is      stated         to
   provide an indication of the state of electrode/tissue contact.
             U.S.       Patent          6,730,077,              whose         disclosure               is      incorporated
 0 herein          by   reference,             describes            a    cryocatheter               for       treatment          of
   tissue.          A   signal        conductor            extends           through          the      catheter          to     the
   catheter            tip       and       connects            to      a      thermally             and        electrically
   conductive shell                 or cap that               applies an RF current                         to the region
   of    tissue         contacted by              the     tip.       A tissue            impedance            path between
 5 the     signal        lead and a surface electrode mounted on the patient's
   skin       is     monitored            to    develop          a    quantitative                measure          of     tissue
   contact at the distal tip.
             U.S.      Patent Application Publication                                   2014/0171936 to                 Govari,
   which         is    incorporated              herein         by      reference,             describes            apparatus
 0 that       includes          an     insertion           tube       having          a    distal        end      configured
   for     insertion           into       proximity with                 tissue         in     a   body       of    a   patient
   and       containing             a      lumen        having           an       electrical              conductor             for
   conveying             electrical              energy          to      the        tissue.               The       apparatus
   further          includes         a    conductive            cap      attached            to    the     distal        end     of
25 the      insertion            tube      and      coupled           electrically                to     the      electrical
   conductor,            wherein          the     conductive             cap      has      an     outer       surface.           In
   addition           there       are      a     multiplicity                of     optical          fibers         contained
   within          the    insertion            tube,       each        fiber        terminating               in    proximity
   to    the       outer      surface         of    the     cap,        and      being        configured            to    convey
30 optical          radiation            to    and      from       the       tissue         while        the      electrical
   energy is being conveyed to the tissue.
                                                                   3
             3447024v1

                                       SUMMARY OF THE INVENTION
          There        is    provided,         in     accordance           with     some      embodiments           of
   the   present          invention,         an    apparatus          that      includes         an     electrical
   interface          and     a    processor.               The     processor           is     configured           to
 5 receive, via the electrical                        interface, a             temperature sensed by a
   temperature            sensor      at     a   distal        end     of     an   intrabody             probe,     to
   estimate         a    temperature           of     tissue       of      a    subject,         based         on  the
   sensed       temperature             and      a     parameter            of    an     ablating             current
   driven,        by      an    ablation         electrode           at      the     distal         end       of   the
 0 intrabody         probe,       into      the    tissue,        and      to    generate         an     output     in
   response to the estimated temperature.
          In     some embodiments,                the      parameter          includes       a    power         of the
   ablating current.
          In some embodiments,                    the parameter              includes an amplitude                  of
 5 the ablating current.
          In       some       embodiments,              the       processor            is     configured            to
   estimate           the      temperature              of      the        tissue        by       selecting           a
   coefficient            in    response         to     the     parameter,           and     estimating            the
   temperature           of   the    tissue        by multiplying,               by    the    coefficient,            a
 0 value that          is based on the sensed temperature.
          In       some       embodiments,              the       processor            is     configured            to
   estimate        the      temperature          of     the    tissue         as   To    +   a(T    1    -    TO),   TI
   being     the      sensed       temperature,             a   being        the    coefficient,               and   To
   being     a   quantity         based       on    a   temperature            T_0    that     was        sensed    by
25 the   temperature             sensor        prior        to    the      driving         of     the       ablating
   current.
          In some embodiments,                    the processor              is   further configured to
   compute      T0     as    T_0   -      ,      being       a  correction           factor        that       depends
   on  a   stability           of   temperatures            sensed        by    the    temperature              sensor
30 prior to the driving of the ablating current.
                                                            4
          3447 024vl

             In   some     embodiments,             the   processor           is   configured           to     select
   the coefficient by computing the coefficient.
             In some embodiments,                  the processor            is    configured to compute
   the      coefficient by            substituting the parameter into                             a closed-form
 5 expression for the coefficient.
             There       is       further          provided,           in       accordance             with       some
   embodiments           of     the      present        invention,            a   method         that      includes
   receiving, by a processor, a temperature                                    sensed by a temperature
   sensor        at    a    distal         end      of   an     intrabody          probe.             The      method
 0 further        includes         estimating, by             the     processor,            a   temperature          of
   tissue        of    a    subject,          based       on    the      sensed         temperature            and     a
   parameter           of      an     ablating           current          driven,          by       an     ablation
   electrode          at    the     distal         end    of    the     intrabody            probe,       into      the
   tissue,        and     generating           an     output      in     response          to    the    estimated
 5 temperature.
             There       is       further          provided,           in       accordance             with       some
   embodiments           of     the     present        invention,           a    method        that      includes,
   using       a  probe      that      includes        an   ablation          electrode,            at  least       one
   internal         temperature            sensor       inside       the      ablation         electrode,           and
 0 at      least     one      surface        temperature            sensor        at     a    surface         of    the
   ablation          electrode,            performing           a    plurality             of     ablations          of
   tissue        with      different            respective           amplitudes              of      an    ablating
   current.            The       method        further         includes,           during         each       of     the
   ablations,          sensing         an    internal        temperature,             using         the    internal
25 temperature           sensor,        and a       surface      temperature,             using the          surface
   temperature             sensor,           and,       using         a     processor,               learning          a
   relationship            between          the      sensed       internal         temperature              and     the
   sensed surface temperatures.
             In   some     embodiments,              the    relationship             is      expressed          by   an
30 equation         TS   =   To    +   a(T1      -   TO),    a    being       a  coefficient,             TS     being
   the       sensed      surface         temperature,            T1    being       the        sensed       internal
   temperature,            and     To    being       a   baseline         temperature,              and    learning
                                                            5
             3447024v1

    the     relationship              includes        learning         the    relationship             by   learning
    a dependency of a                   on the amplitude of the ablating current.
              In    some       embodiments,            learning         the     dependency           of   a    on    the
    amplitude             of       the       ablating          current          includes            learning         the
  5 dependency           by regressing              (TS-T0)/(T1-T0)             on     the    amplitude        of    the
    ablating current.
              In     some         embodiments,            regressing             (TS-T0)/(T1-T0)              on     the
    amplitude             of       the       ablating          current          includes            quadratically
    regressing             (TS-T0)/(Tj-T0)              on      the      amplitude           of     the     ablating
  0 current.
             The      present           invention       will        be   more      fully        understood         from
    the     following detailed description                            of embodiments               thereof,       taken
    together with the drawings, in which:
                                   BRIEF DESCRIPTION OF THE DRAWINGS
  5          Fig.       1   is      a    schematic        pictorial         illustration              of   a    system
    for        cardiac           ablation          treatment,            in      accordance             with       some
    embodiments of the present invention;
             Fig.       2    shows         experimental             data    acquired            by    the     present
    inventors;
,:0          Fig.       3A      is     a    flow    diagram          for    a    method         for     learning        a
    coefficient,             in     accordance         with       some    embodiments             of   the    present
    invention;           and
             Fig.       3B     is     a    flow    diagram          for   a    method        for     estimating         a
    temperature            of      tissue,       in     accordance          with        some      embodiments         of
25  the present invention.
                                 DETAILED DESCRIPTION OF EMBODIMENTS
                                                         OVERVIEW
              It    has    been         found    that      cooling        (or     "irrigating")             the    area
    of    the      ablation           site     reduces        thrombus          (blood        clot)      formation.
                                                                6
             3447024v1

   For      this       purpose,          for      example,            Biosense           Webster          Inc.      offers       the
   ThermoCool@                 irrigated-tip                 catheter             for        use       with        its       CARTO@
   integrated mapping and ablation                                     system.           The metal             catheter tip,
   which          is   energized            with       radio-frequency                    (RF)      electrical             current
 5 to       ablate           the       tissue,           has         a     number           of      peripheral               holes,
   distributed               circumferentially                    around          the      tip,      for      irrigation          of
   the      treatment site.                     During the procedure, a pump                                coupled to the
   catheter            delivers          an     irrigating              saline         solution           to    the      catheter
   tip,        and      the       solution           flows       out       through           the      holes.             (In    some
 0 embodiments, even while                            no ablating current is                          being passed into
   the      tissue, the flow of irrigating fluid is maintained, e.g.,                                                             at
   a reduced flow rate.)
              When          performing               an      ablation              procedure,                it       is       often
   advantageous                to     position            one      or     more         temperature              sensors         near
 5 the       tissue         that      is     being        ablated,             to     help      provide           feedback        to
   the        operating              physician.                  For        example,            if       the       temperature
   sensors           sense that            the tissue             is     being        overheated,              the     operating
   physician             may        stop       the      ablation            procedure             or     modify          ablation
   parameters.
 0            At     least        in    some       cases,        to      measure           the     temperature               at  the
   tissue-electrode                      interface             as         accurately               as       possible,            the
   temperature                sensors         would        ideally           be     positioned             such       that      they
   contact           the tissue.                However, due               to regulatory concerns,                           and/or
   for       other         reasons,          contacting               the      tissue          with       the      temperature
25 sensors           may       not     be      feasible.                Hence,          a     particular             challenge,
   when         sensing          the     temperature               of      the      tissue,           is    that        a    sensor
   that        is    not      in     contact         with      the       tissue         may       sense       a    temperature
   that        is     lower        than     the       actual         temperature               of    the     tissue          at  the
   tissue-electrode                    interface.                Furthermore,                 regardless            of     whether
30 the        sensors            are      in       contact           with         the        tissue,           the       flow     of
   irrigating              fluid        (e.g.,        saline)           from the            ablation          electrode          may
   cause the sensors                     to sense           a temperature that is                          lower than that
   which the sensors would have otherwise sensed.                                                      For example, the
                                                                      7
              3447024v1

   irrigating            fluid       may      function        as    a   heat    sink,      transferring               heat
   away from the temperature sensors.
              Embodiments              of        the      present          invention             address            these
   challenges,             by providing             methods         and    apparatus         for      estimating           a
 5 temperature               of     the      tissue,        at      least      at   the       tissue-electrode
   interface,            based        at    least     on     the      sensed     temperature              and     on    the
   flow rate of the irrigating fluid.
              In some embodiments, the                       estimation is based on a parameter
   of     the      ablating          current,         alternatively             or    additionally               to     the
 0 fluid        flow      rate.          For      example,        some     embodiments           take        advantage
   of     the     fact       that,       typically,          the      ablation       system        is      configured
   to    operate          in    accordance           with     the      relevant      Instructions               for Use
    (IFU),        which         specify         a   particular            fluid     flow       rate         that,       for
   safety        reasons,           must      be    maintained          for    any   particular              amplitude
 5 of     the     ablating          current.            (As    the      amplitude        increases,             so    does
   the       required flow              rate.)        Given        this    deterministic               relationship
   between          the     ablating-current               amplitude          and   the      fluid         flow     rate,
   it     is    possible           to   estimate         the     temperature          of    the       tissue        based
   on       the      ablating-current                  amplitude,            even       without            explicitly
 0 ascertaining the                  flow rate.            An advantage           of    such embodiments is
   that        the       ablating-current                 amplitude           is    typically              easier         to
   ascertain than is                  the flow rate.
              For    example,          during       the ablation           procedure,           a processor             may
   receive           (e.g.,         from       a    dongle         that      is    connected             to      the      RF
25 generator that supplies the ablating current) the amplitude                                                       Ic of
   the        ablating           current.              The      processor          may        then         compute         a
   coefficient a,                by substituting Ic into a formula that expresses a
   as a function of IC.                       The processor may then use this coefficient
   a    to      estimate           the     temperature           of      the    tissue        from        the     sensed
30 temperature             that      was      received        from      the   temperature            sensor.            For
   example, the processor may estimate the temperature of the
                                                                8
              3447024v1

   tissue        as To       + a(T    1   -   T 0 ), where        T1     is   the      sensed temperature                  and
   T 0 is a baseline temperature.
              Embodiments               of      the      present            invention             further           include
   systems         and      methods          for     learning          a     as    a    function         of      Ic.       For
 5 example,          in    some       embodiments,             an    ablation           catheter         is     specially
   fitted         with      temperature             sensors        at      the     surface          of   the      ablation
   electrode,             referred           to    herein        as      surface         temperature              sensors.
   This         specially-fitted                   catheter          is       then        used        to      perform         a
   plurality           of     test       ablations          (typically            on     ex    vivo      tissue)         with
 0 varying         ablating-current                  amplitudes.               During each             of     these test
   ablations,              the       internal           temperature               sensors           inside          of     the
   ablation           electrode            measure        the      internal            temperature             inside       of
   the       ablation           catheter,           while       the        surface         temperature              sensors
   measure         the      temperature             at    the     interface            between         the      electrode
 5 and the tissue.                   The     sensed temperatures and actual temperatures
   are then used to learn the formula for a.
                                                 SYSTEM DESCRIPTION
              Reference is             initially made to                   Fig.      1, which is            a   schematic
   pictorial            illustration                of    a     system          20      for      cardiac          ablation
 0 treatment,             in       accordance           with       an       embodiment             of     the       present
   invention.              An operating physician                       28     (such as an            interventional
   cardiologist)                inserts         an     intra-body            probe,         such      as     a    catheter
   22,      via    the      vascular           system      of    a   patient           26,     into      a    chamber       of
   the        patient's             heart         24.           For         example,           to      treat          atrial
25 fibrillation,                the      operating         physician             may     advance         the      catheter
   into       the    left       atrium         and    bring      a    distal         end     30     of   the      catheter
   into        contact         with       myocardial            tissue          that       is     to    be      monitored
   and/or ablated.
              Catheter           22     is      connected          at        its      proximal          end,        via     an
30 electrical            interface           50,     to   a    console          32.       Console        32     comprises
   an     RF     energy        generator           34,    which       supplies           electrical            power       via
   catheter           22     to     distal         end     30     in      order        to     ablate         the      target
                                                                 9
              3447024v1

   tissue.          A processor        52   tracks     the temperature         of the tissue        at
   distal        end 30      by processing         the    outputs    of   temperature        sensors
   in     the    distal      end,    as   described       below.      An   irrigation       pump    38
   supplies         an    irrigating       fluid,     such    as   saline     solution,      through
 5 catheter 22 to distal end 30.                       In addition, in some embodiments,
   an optical module 40 provides optical                         radiation,      typically from,
   but not limited to,               a laser,       an incandescent         lamp,    an arc     lamp,
   or     a   light      emitting      diode     (LED),     for   transmission        from     distal
   end 30        to    the target       tissue.        The module      receives      and   analyzes
 0 optical        radiation       returning       from the target        tissue      and   acquired
   at the distal end.
             On    the     basis    of    information        provided     by    the    temperature
   sensors        and/or       optical     module     40,   processor      52   may   control      the
   power applied by RF energy generator 34 and/or the flow of fluid
 5 provided         by     pump    38,    either      automatically        or    in   response      to
   inputs          (e.g.,       from      the     operating       physician),         as     further
   described hereinbelow.
             System 20 may be based on the above-mentioned CARTO system,
   for       example,        which    provides        extensive      facilities        to    support
 0 navigation and control of catheter 22.
             Distal end 30 of catheter 22                  includes an ablation electrode
   46, which includes a distal face 58.                          Typically, when performing
   the      ablation,        a portion       of  ablation      electrode       46   (e.g.,     distal
   face       58)    is    brought     into     contact     with    (e.g.,     pressed     against)
25 the        tissue        that      is      to     be     ablated,       and      subsequently,
   radiofrequency             energy,      supplied      by   RF   energy     generator       34,   is
   applied        to    the    tissue     by   the    ablation     electrode.         As   shown    in
   Fig.        1,    ablation       electrode        46    may    be    shaped      to    define      a
   plurality of perforations                   60.      During the procedure,            irrigating
30 fluid,         supplied         by     irrigation        pump     38,      is     passed       from
   perforations            60.     The passing        of the     irrigating       fluid may help
   prevent        blood      clots    from     forming,      by   cooling     and    diluting      the
   blood in the vicinity of the ablation site.
                                                      10
             3447024v1

             As    shown      in     the      figure,      a   plurality             of     temperature               sensors
   48      (e.g.,        thermocouples)               are      disposed             at      various            respective
   positions           within         ablation         electrode              46.          In     particular,                the
   "head-on"          view       of    distal       face      58    shows        three        circumferentially
 5 arranged          temperature             sensors      48     near        the     distal          face       58     of    the
   electrode,             each       of       the    temperature               sensors            being          contained
   within a lumen in the wall                         of the electrode.                      The isometric view
   of distal end 30,                  which "cuts away" the outer wall of one of the
   lumens,         shows      two       temperature           sensors         within          the      lumen        -    (i)    a
 0 distal temperature sensor 48a, which is                                      one of the              three sensors
   shown        in    the     distal-end            view,      and       (ii)       a   proximal             temperature
   sensor        48b,     which        is    one    of  three        proximal            sensors          that       are     not
   shown       in    the    distal-end             view.        Distal         end      30,      as     shown        in     Fig.
   1,       thus        comprises              a    total         of        six       temperature                  sensors.
 5  (Notwithstanding                the       above,    it      is     noted        that        the      scope         of    the
   present         disclosure             includes      the      use       of    any      suitable             number        and
   arrangement of temperature sensors.)
             While       the     ablation          electrode         is      used      to      drive        an     ablating
   current          into      the        tissue,       and      while          the       irrigating              fluid        is
 0 passed          from      the       distal        end      of     the        catheter             (e.g.,           through
   perforations             60),        one      or   more      of      the      temperature                sensors          are
   used to sense respective temperatures.
             In     general,           it      is   advantageous               to     have         a     plurality            of
   temperature             sensors          disposed       at      various          locations            with         respect
25 to       the       tissue,           e.g.,        in      that         information                 regarding              the
   orientation             of    the       ablation      electrode              may      be     deduced           from       the
   various          temperature               readings        provided            by      the        sensors.                For
   example,             if      each          of     the        three           distal            sensors               senses
   approximately              the       same      temperature              (indicating              that        the      three
30 distal         sensors        are       approximately            equidistant               from        the      tissue),
   and/or           if      each           of      the       three           proximal             sensors               senses
   approximately              the       same      temperature              (indicating              that        the      three
   proximal sensors                 are      approximately equidistant from the                                    tissue),
   it may be deduced that                        the electrode             is    oriented perpendicularly
                                                              11
             3447024v1

   with       respect         to    tissue,           as     is      typically           desired.                Conversely,
   if,        for      example,             one        of       the         proximal            sensors              senses            a
   temperature             that       is     higher         than         that       sensed        by       the      other         two
   proximal         sensors,           it     may     be    deduced            that     the     ablation             electrode
 5 is   not     oriented perpendicularly with respect to                                             the tissue,                such
   that       one    of     the     proximal            sensors           is     closer        to     the       tissue          than
   the other proximal sensors.
            Aside       from providing                  information              concerning             the      orientation
   of     the      catheter,             the       temperature                sensors         may        facilitate               the
 0 performance of                the ablation, by indicating whether the                                             tissue at
   the    tissue-electrode                   interface            is     at     the desired             temperature               for
   ablation.            However, as noted above, a temperature                                            sensor that               is
   not     in    contact         with       the      tissue          may      sense      a    temperature               that        is
   lower       than      the      actual         temperature               of     the    tissue          at     the      tissue
 5 electrode           interface.                  For      example,             distal        sensor           48a       may       be
   disposed somewhat proximally to distal                                           face 58,         such that              distal
   sensor        48a     is     generally             not      in     contact          with      the        tissue          during
   the    ablation procedure.                        Consequently, the                     temperature sensed by
   distal       sensor 48a             is    typically lower than the                            actual temperature
 0 of    the      tissue          at      the      interface.                 The      difference               between           the
   actual       temperature               and     the     sensed          temperature             is      typically             even
   greater         for       proximal            sensor           48b,        which       is      farther             from        the
   tissue than distal sensor 48a.
            Furthermore,               as     noted       above,           the      flow     of      irrigating               fluid
25 from      perforations               60     causes         the       respective            sensed           temperatures
   from       at    least         some        of     the        temperature              sensors            to      be      lower,
   relative            to        if        no      irrigating                 fluid         were            flowing             from
   perforations              60.         To    address           the      above       challenges,                embodiments
   of     the      present           invention             provide             apparatus            and        methods            for
30 estimating the actual temperature of                                        the tissue,              at least            at the
   tissue-electrode interface, as described hereinbelow.
             In    general,             processor             52       may       be     embodied              as     a      single
   processor,           or      as    a    cooperatively                 networked           or     clustered              set      of
                                                                  12
            3447024v1

   processors.               Processor            52      is       typically             a    programmed              digital
   computing          device         comprising              a     central            processing              unit       (CPU),
   random access memory                     (RAM),      non-volatile                  secondary storage,                    such
   as      a   hard    drive         or     CD    ROM       drive,            network          interfaces,              and/or
 5 peripheral          devices.             Program code,                  including            software           programs,
   and/or data are loaded into                          the RAM for execution and processing
   by      the     CPU      and      results           are        generated             for        display,           output,
   transmittal,            or     storage,         as     is      known         in    the     art.          Such program
   code       and/or       data,        when      provided               to      the     processor,              produce          a
 0 machine        or    special-purpose                 computer,               configured             to     perform         the
   tasks described herein.
    LEARNING THE RELATIONSHIP BETWEEN THE SENSED TEMPERATURE AND THE
                                              ACTUAL TEMPERATURE
             Reference         is     now    made       to      Fig.         2,    which        shows        experimental
 5 data       acquired        by     the     present           inventors.                 As      further          described
   below,        the    experimental              data        of       Fig.       2    shows        the      relationship
   between        the     temperature             sensed           by      the       temperature              sensors         and
   the      "actual" measured temperature of the tissue.
             To   acquire         the data,          distal           end 30         was    used        to     "ablate"         ex
 0 vivo tissue multiple times.                             During each of the                        trial ablations,
   irrigating          fluid         was     pumped           out        of      the     distal          end,        multiple
   temperature          sensors          in    the     distal           end of         the      catheter          were      used
   for      sensing,       and     additionally,               a     thermometer             was      used to measure
   the       actual     temperature              of     the         tissue          at     the       tissue-electrode
25 interface.            Two      sets      of   trial         ablations             were       conducted;            a   first
   set with an           irrigating-fluid flow rate                               of 8 mL/min, and a                    second
   set      with an      irrigating-fluid                   flow        rate       of    15 mL/min.                The    trial
   ablations         of     each       set    were       conducted               with      different             respective
   ablation         powers,         and/or        different               respective             forces         of    contact
30 between        the     electrode           and      the       tissue.               (Each       of     these       factors
   affects        the     temperature             at     the        tissue-electrode                    interface;            for
   example,         increasing             the    power,           and/or           increasing             the      force       of
   contact, increases the temperature.)
                                                                13
             3447024v1

              The      sensed          temperature             values,        which        are    also         referred            to
   herein          as      "internal            temperature"              values,          are    indicated              by      the
   notation T 1 .                 These        values,         minus       a  normalizing             temperature                T_0
    (described below),                     are plotted along the horizontal axis                                       of Fig.
 5 2.          (In     this        particular             case,      each       of     the     sensed           temperature
   values T 1            is    the average              of the temperatures                   sensed by the                  three
   distal          temperature               sensors          shown       in    Fig.       1.)        The       thermometer
   readings            indicate            the      "surface         temperature"              at      the       surface           of
   the       ablation           electrode,              and      are     indicated          by    the       notation             TS.
 0 These         readings,            minus       T_0,       are plotted            along      the      vertical             axis.
   Each point              in Fig. 2 thus                 represents a pair of values                             (T1     -    T_0,
   Ts     -    T_0)       for a       particular             flow     rate,       ablation         power,          and       force
   of     contact.               (Typically,             a    flow     rate      of    15    mL/min         is     used        only
   for       a    relatively             high       ablation         power        and/or        force          of    contact;
 5 hence,           the      data        for      15     mL/min         includes           only      relatively                high
   temperatures.)
              As     shown         in    Fig.      2,      for    each       of   the      flow      rates,          a     linear
   regression               function           was      fit      to    the     acquired          data        with        a     high
   goodness            of     fit,       as     evidenced           by      the    high       "R-squared"              values.
 0 This        regression function may be expressed in the                                            form TS          -     T_0 =
   a(TI       -    T_0),       where        T_0,      T 1 , and TS are            as described above, and a
   is      a    coefficient               that       is     a    function         of     the     flow        rate        of      the
   irrigating              fluid.            In    particular,             for    a    flow     rate        of     8   mL/min,
   Fig.        2    shows        a    coefficient              a   of     around        1.6,     while          for      a     flow
25 rate of 15 mL/min, Fig. 2 shows a coefficient aY of around 2.
              Typically,              T_0     is    the     value       of    T1    immediately             prior         to     the
   start         of the        ablation, e.g.,                  the    average temperature                      sensed over
   the       one second prior to the                          start of the             ablation.             Prior to the
   start         of the        ablation,            the catheter begins                    to deliver irrigating
30 fluid         to     the      subject's            blood.          If     the     fluid      flows          through           the
   ablation             electrode              for      long      enough         before        the       start          of       the
                                                                   14
              3447024v1

   ablation, a "steady state"                              is attained, whereby TS is the same as
   T1 , such that               T, = TS = T_0.                      Hence, the         subtraction of T_0                from
   each of T 1            and TS,          prior to performing                      the regression,            typically
   simplifies              the       regression,                by      causing        each       of    the    regressed
 5 lines        to      pass         through            the       origin.            Stated        differently,            the
   regression               is       simplified,                 in      that       the      regression          function
   includes          only one variable                       (i.e.,       a),    rather        than    two variables.
   Notwithstanding                    the       above,          it      is    noted        that      the     regressions
   depicted           in      Fig.       2    may       be    performed          even       without       measuring           or
 0 using        T_0;         the      measurement                and      use     of      T_0     is    generally          for
   convenience only.
             In    any       case,        the       independent            variable         in    the    regression           is
   typically            a     variable            that       is      based      on    T1 .       For    example,         this
   variable           may       be      T1     itself,           or     T1    -   T_0,       as     described       above.
 5 Similarly,             the      dependent            variable          in    the regression            is   typically
   a   variable           that       is    based         on     TS.       For    example,         this    variable may
   be TS itself, or TS                      -    T_0, as described above.
             As    further            described             hereinbelow,              the      regression        function
   illustrated in Fig.                       2 may be used to estimate                           the temperature of
 0 the     tissue, at              least at            the tissue-electrode                     interface, during a
   live ablation procedure.
             As      noted           above,            the       trials         depicted          in     Fig.     2      were
   conducted with TS measured at the electrode-tissue interface.                                                              In
   some      cases,          during         a     live      procedure,           it     may     be   advantageous             to
25 estimate            the       temperature                of       the      tissue        at     deeper      locations
   within        the       tissue,          e.g.,         5    mm beneath            the     tissue.          Hence,       the
   scope       of the          present          invention             includes        (i)    performing        ablations
    (e.g.,      trial          ablations)              with the          temperature           TS measured        at     such
   deeper        locations,               thus        allowing          respective           regression        functions
30 to be determined for these locations, and                                             (ii) during a live
                                                                     15
             3447024v1

   procedure,              using        the       regression                 functions              to       estimate               the
   temperature of the tissue at these locations.
            In     some        embodiments,             the       flow       of      irrigation              fluid         roughly
   affects         a    subset        of,     or      all      of,        the       temperature               sensors            in     a
 5 similar         way,       such    that      a    may be           learned by              averaging             the      sensed
   temperatures               over     the    subset           of,      or      all        of,    the        sensors.               For
   example,          as noted above, the sensed temperatures                                             shown in Fig.                  2
   are     averages            for    the     three         distal           sensors,            and       a     single          a   is
   learned         for      the     three      distal          sensors.                In     other        embodiments,                 a
 0 may     be      learned           separately             for        each         of       one       or     more          of      the
   sensors.             Fig.      3A,    described             immediately                 hereinbelow,                describes
   such an embodiment.
            Reference            is   now made            to      Fig.       3A,      which        is     a     flow       diagram
   for      a     method           62    for       learning               a,      in        accordance              with          some
 5 embodiments               of     the     present           invention.                     In     method            62,       a    is
   learned         for       one     or    more       flow         rates,          for       each       of      one       or      more
   temperature               sensors.            For        each          sensor            and     flow         rate,          a    is
   learned,          at      a   learning         step        64,       using          the      technique              described
   above       with        reference         to      Fig.        2.         In      other        words,           at     learning
 0 step     64,      distal         end 30      is     used        to      "ablate"           ex    vivo        tissue         using
   various         ablation          powers        and/or          contact           forces,           while         irrigating
   fluid      is     pumped         out    of   the       distal          end.          Sensed temperatures                         and
   actual        temperatures             are     acquired,               and     processor             52      then       applies
   regression            (e.g., linear regression) to learn a.
25          In general,              since the flow rate of                           the irrigation fluid may
   vary     over       different           ablation          procedures,                  and/or        may       vary       during
   a    single       ablation          procedure,             it      may      be      advantageous                to      learn        a
   for     more       than      one     flow      rate.             For      example,            various            flow       rates
   within         the       range      of     8-15        mL/min            may       be      of      interest,              since,
30 during        a    live      procedure,            the        flow       rate         is    typically              between           8
   mL/min and 15 mL/min.
            For      example,         a    may     first          be    learned,             at    learning              step       64,
   for      sensor            48a      (Fig.         1)      and          a     flow          rate         of       8      mL/min.
                                                                  16
            3447024v1

   Subsequently,                at a       first       decision            step      66,      a   decision         is    made     as
   to whether              to change             the     current          flow      rate.           If the       decision is
   made       to     change        the       current         flow        rate       (e.g.,         to   15    mL/min),           the
   current           flow     rate        is      changed,          at      a    flow-rate-changing                    step      67.
 5 Subsequently,                at     learning           step        64,      a   is      learned        for     the      second
   flow rate.
              Once       a    has       been         learned           for       all       of     the     flow        rates       of
   interest,            method         62      proceeds           to      a    second         decision          step       68,    at
   which         a    decision          is       made      as     to      whether           to     change       the       current
 0 sensor.              If    a     decision            is     made         to    change           the    current          sensor
    (e.g.,          to    sensor         48b         (Fig.       1)),         the      sensor         is    changed           at    a
   sensor-changing                   step        69.       Subsequently,                  at     learning         step       64,    a
   is      learned         for     the       second        sensor,           for      all     of     the    flow       rates      of
   interest.
 5            Method         62     ends         once      a     has        been       learned          for      all      of     the
   sensors           and flow rates of interest.
              Several          alternate              embodiments                of     method         62     will        now     be
   described.
               (i)      In       some         embodiments,                  as      described             above          in      the
 0 Overview, the estimation of the                                    tissue temperature is based on a
   parameter             of     the       ablating            current,            such        as      the    amplitude            or
   power         of    the     ablating            current,           alternatively                 or   additionally             to
   being         based        on      the        flow      rate.               (The       power        of    the        ablating
   current           may     be     referred            to    as     the       "ablation            power".)             In    such
25 embodiments,                a     is      dependent            on       an     ablating-current                    parameter
    (e.g.,         the     amplitude             Ic    of    the      ablating            current),          alternatively
   or      additionally              to      the      flow      rate.            Method          62   may     therefore           be
   adapted            to    learn        the       dependency               of    a     on      the    ablating-current
   parameter.               For example,                in    some embodiments, as                       described above
30 in the Overview, the flow rate                                  is a deterministic function of Ic,
   such        that      a   is     a    function           only        of     IC.         In     such    embodiments,              a
   plurality of trial ablations at different respective values of Ic
                                                                    17
              3447024v1

   may     be    performed,             and    a    may      then      be      learned       by     regressing         the
   quantity          (Ts    -    T_0) / (T1       -   T_0)      on      IC.         This    yields      an    equation
   that expresses a                 as a function of                 Ic.
              (ii)      In      some        embodiments,               as       described           above       in     the
 5 Overview,          a   "test        probe, " which             comprises             an   ablation       electrode
   46      (Fig.       1)     outfitted           with        one      or       more      surface        temperature
   sensors       at     its surface,             is manufactured.                     This     probe may be used
   to    perform        a    plurality           of    trial        ablations,            during      which      one    or
   more      parameters,              such     as    Ic      and/or        the      flow     rate,      are     varied.
 0 During         each         of       these        trial          ablations,              both       the      surface
   temperature           TS,      measured by            the surface               temperature         sensors,        and
   the internal temperature T 1 , measured by the                                         internal temperature
   sensors        within        the       ablation         electrode,             may be       recorded.           a   may
   then be learned from the values of TS and T 1 , as described above.
 5           It   is    noted         that     the     surface          temperature             sensors      need      not
   necessarily be exposed.                         For example, a thin layer of the distal
   face      of    the     ablation           electrode         may       cover        these     sensors.            (Such
   covered        sensors         are nevertheless                 referred           to herein        as   "surface"
   sensors,          given       that      the     temperature              sensed        by    these     sensors       is
 0 effectively            the      temperature            at    the       distal         face    of    the    ablation
   electrode.)
              (iii)     In      some       embodiments,              an     adjustment           is    made      to    the
   normalizing            temperature             T_0.         This       adjustment            accounts       for     the
   fact       that      the      above-described                 steady          state,        during      which       the
25 surface        temperature              is    the      same       as     the      sensed       temperature,          is
   not     necessarily            reached        prior        to    the      start       of   an    ablation.          The
   adjusted           normalizing              temperature               may        be     referred         to      as     a
   baseline temperature T 0 .
             In    some        embodiments,               for      example,            To     is     calculated         by
30 subtracting a correction                         factor       P    from T_0,           i.e.,     To   is   computed
                                                               18
            3447024v1

   as     T_0       -    P,    where        P     depends          on      the       stability              of     temperatures
   sensed         by      the     temperature                 sensor         prior         to     the        driving          of     the
   ablating current.                       For example,              P    may depend on the difference D
   =    M2    -     M1,      where        M2     is     the      average           of     the       last         K    temperature
 5 readings            prior         to     the       start        of      the        ablation,               and      M1     is     the
   average of the                 last L         temperature readings prior to the start                                               of
   the      ablation,            where       L     <    K.        (For       example,           K     may       be     between         30
   and      40,       with     L between             5     and     15.)          If      D is       below          a    particular
   threshold,             P   is      assigned a             value      of      0,      since        the       low value            of    D
 0 indicates            that      the      steady          state       has      been        reached.               Otherwise,             P
   is assigned a value greater than 0.                                           For example,                   P  may increase
   linearly as a function of D,                                from 0 up to a particular cap.
             Advantageously, any one of                              embodiments                 (i),         (ii),       and      (iii)
   may      be    combined             with      any       other       one       of      these        embodiments.                   For
 5 example,            the     following             is      a   description                 of     an      embodiment              that
   combines all of                   (i),     (ii),         and    (iii).
             First,          as     described             above,         a     test       probe          is       manufactured,
   this       probe         having         an     ablation           electrode               outfitted             with        one     or
   more       surface          temperature               sensors         at      its       surface.                For     example,
 0 one      or    more        (e.g.,        three)          holes       may      be      drilled            in     the      ablation
   electrode,              and       a   surface            temperature               sensor          may        be      placed        in
   each        of       these          holes.              Aside         from          the       surface              temperature
   sensors,             this       probe          is      typically              similar,             or        identical,             to
   catheter            22.       For      example,            the     test       probe         typically               has     one     or
25 more         internal              temperature                sensors             48       inside             the        ablation
   electrode, e.g.,                    as described above with respect to Fig. 1.
             Next,        using         the    test        probe,        a    plurality              of      trial        ablations
   of      tissue            (typically,               ex      vivo         tissue)            are        performed,                with
   different             respective             ablating-current                      amplitudes.                    During         each
30 of     the        ablations,             the       internal           temperature                  sensors            sense       the
   internal           temperature             T 1 within           the       ablation           electrode,               while       the
   surface           temperature             sensors           sense        the       surface          temperature               TS    at
   the       surface             of      the        ablation             electrode                 (which            is      at      the
                                                                    19
             3447024v1

   electrode-tissue                interface).                 Then,       the     relationship between the
   sensed      internal         temperature                 and      the      sensed      surface        temperature,
   which may be            expressed            by     the       equation         Ts   =   To   +    a(Ti     -    TO),   is
   learned.              (As       described               above,          Ts      is     the      sensed          surface
 5 temperature,            T1     is     the      sensed           internal         temperature,             To     is   the
   baseline temperature, and a                            is a coefficient.)
           Effectively,               the      relationship                 is    learned       by     learning          the
   dependency           of    a      on     the      relevant            parameter(s).                 For      example,
   assuming         that      a       is     a    function             of      only      the     ablating-current
 0 amplitude          Ic,     the       relationship                 may       be    learned        by     learning         a
   dependency of a              on     Ic.       Typically, this                   dependency is            learned by
   processor         52,    by       regressing              the      quantity         (Ts-Tc)/(TI-T)                on  Ic,
   which,      as    described            above,          varies         between         the    trial        ablations.
   Typically,          the     regression              is      quadratic,           such     that      a   is      learned
                                            2
 5 to be a function of Ic
           For     example,          the     following             table       shows      data     acquired          from a
   set of trial ablations:
                                                            Table 1
     Trial     Ablation         #                     Ic      (A)                     (Ts-Tc) / (T 1 -T       )
                                                                                                            0
                  1                                     0.42                                   1.4
                  2                                     0.56                                  1.48
                  3                                     0.61                                  1.59
                  4                                     0.66                                  1.79
                  5                                       0.7                                 1.74
                  6                                     0.78                                  1.75
           Performing           a     quadratic            regression             on   these      data      yields       the
                                                                0
20 equation a =           (Ts-Tc)/(T1-Tc)                  =      .9 8 3 8 1 c2 + 1.2277.
                                                                  20
           3447024v1

              For        cases        in      which         there         is      more         than       one       internal
   temperature               sensor,        T 1 -T0    may be         calculated            as     a  function         of the
   set     of values             {T 1 -T 0 },        where T1            is   the temperature measured by
   the     i         internal temperature sensor, and To                                    is     the corresponding
 5 baseline             temperature.               For      example,          T 1 -T 0    may       be    calculated          as
   the     average           or maximum of              {T 1 1 -TO 1 }.        Similarly, in the                    event of
   multiple surface                   temperature sensors,                     TS-TC        may be        calculated as
   an average or maximum of the set of values                                            {TS'-TO'}.
                                    ESTIMATING THE TISSUE TEMPERATURE
 0            Reference is              again made to               Fig.      1,    and is         additionally made
   to     Fig.           3B,     which        is     a     flow        diagram          for       a    method         49     for
   estimating               a    temperature             of      tissue,          in      accordance            with        some
   embodiments                of     the     present           invention.                Whereas          method        62    is
   typically              (but not necessarily) practiced ex vivo and "offline,"
 5 method            49      is      practiced             in      vivo,         during           a      live       ablation
   procedure.                Method        49     uses       the     information              learned         from method
   62 to estimate the tissue temperature.
              Method         49    begins       with       an    initial-sensing                  step      70,    at    which
   T_0       is       sensed.             (Typically,             an      average          over       several         of     the
_0 sensors           is    used      for     T_0.)           In    some      embodiments,               at    a   baseline
   calculating step 71,                      a baseline temperature To is calculated from
   T_0,        e.g.,        by     subtracting             a    correction             factor         P    from      T_0,     as
   described              above.           Subsequently,                at    an     ablation-beginning                     step
   74,    the operating physician begins to perform the ablation.
25            As      shown       in    Fig.       1    and     noted         above,         system         20    typically
   comprises              an   electrical            interface            50     (e.g.,         a    connector,          port,
   or    dongle),             which       connects           the     proximal           end      of    catheter          22   to
   processor              52.         Signals         received            from       the       distal         end     of     the
   catheter               (e.g.,       via       one      or      more       wires         running           through         the
30 catheter)              are     passed         to    the      processor            via       interface           50,      and,
                                                                  21
              3447024v1

   conversely,             signals        from      the processor                  are     passed        to    the     distal
   end     of    the     catheter          via     interface           50.           Thus,      via      interface            50,
   processor 52 may receive,                         at a receiving step 51,                           the respective
   temperatures             sensed by sensors                  48   during the                ablation procedure.
 5 The     processor          may     then     average          these         temperatures               over      a   subset
   of     the      sensors         or      over      all      of     the          sensors,           or     may      instead
   compute          the      maximum         of      the       temperatures.                      This        average          or
   maximum          is     used       as     the      T1     value          for        estimating             the      tissue
   temperature, as described below.
 0          In some embodiments,                     interface           50 performs               the averaging or
   computation             of     the      maximum,          and      then,            at    receiving            step        51,
   communicates              the    average          or    maximum             to      the     processor,            without
   necessarily             communicating             all     of    the        sensed         temperatures             to      the
   processor.
 5          In     some       embodiments,               the     processor                further         receives,            at
   receiving          step      51,     the    fluid        flow     rate          of     the    irrigating            fluid,
   e.g.,       by    receiving           the     fluid        flow       rate         directly          from      pump        38.
   Alternatively               or     additionally,              the         processor            may       receive,           at
   receiving          step      51,     a   parameter           of,      such         as    the    amplitude           and/or
 0 power       of,      the     ablating          current         that          is      output        from      RF     energy
   generator           34.        (This      parameter           may        be       received          from      interface
   50.)         In    other       embodiments,              as    described                below,        the     processor
   controls           the      pump        and/or         the      RF         generator,              such       that         the
   processor           generally            "knows"          the       fluid            flow      rate        and/or          the
25 ablating-current                  parameter            even        without               the      performance               of
   receiving step 51.
            Subsequently,                at     a      coefficient-selecting                           step        76,        the
   processor           selects          (i.e.,         computes,              or      selects          from       a    lookup
   table)        the      appropriate           coefficient               ay,      in     response          to     the     flow
30 rate     and/or         ablating-current parameter.                                 Then,       at    an    estimation
   step      53,     the      processor         estimates           the         temperature             of     the     tissue
   in     the     vicinity         of      electrode          46     (e.g.,            at    the      surface         of      the
   electrode,            i.e.,       at     the      tissue-electrode                      interface),            based        at
                                                               22
            3447024v1

   least      on     the      sensed     temperature            T1    and    the     selected         coefficient
   a,    which       is    a   function      of     the    fluid       flow     rate      of    the     irrigating
   fluid        and/or          the    parameter           of      the       ablating          current.              For
   example,          the processor           may compute            the estimated              temperature           TS'
 5 of    the     tissue,         by   applying        the     equation         TS'     =    a(T-          TO)     +  T0 .
   In     other         words,       the    processor            may     multiply           T1    -    To     by     the
   selected            a,     and     then      add      To,       to     arrive         at     the       estimated
   temperature.                (If TS'     is    less than T 1 , such as in                     the event that
   T1    is   less        than T 0     due    to    a  significant             cooling        effect        from the
 0 irrigating             fluid,       the    processor            typically           returns         T1     as     the
   estimated temperature.)
            In     some embodiments,               a   model       is    fit    to     the     experimentally
   derived values of                 a.     In    such embodiments,                 a coefficient               a   that
   is    interpolated             from the experimentally-derived coefficients may
 5 be    selected          for     the  temperature             estimation.              For    example,          using
   linear         interpolation,              for     the       values         shown        in      Fig.      2,     the
   selected           a    would     be    approximately              1.7     for      a    flow      rate       of   10
   mL/min.            Alternatively,            extrapolation              may    be     used       to   select       a.
   In yet       other embodiments,                as described above, method                          62 yields a
 0 closed-form             expression        for a       (e.g.,        of    the    form a        =   a*Ic2       + b),
   such that a             may be      readily computed by substituting the                                 relevant
   parameter(s)              (such as IC)         into the closed-form expression.
            In      some        embodiments,           the       processor           performs           respective
   estimates           for a plurality of               subsets         of the       temperature sensors,
25 and      then         averages       the      respective            estimates            to     arrive         at    a
   "combined" estimate.                    For    example, with reference to Fig.                               1, the
   processor            may     perform       a    first        estimate         for      the       three       distal
   sensors         and      a   second      estimate         for      the     three       proximal          sensors,
   and      then        compute       the    combined           estimate         by      averaging           the     two
30 separate estimates.
                                                            23
            3447024v1

             Subsequently,                 in       response             to     the       estimated              temperature
    (e.g.,        the      combined         estimate),              at     an    output-generating                    step    55,
   the      processor            generates            an      output,         such       as     a    visual          output    57
   that       indicates           the estimated temperature.                                (Visual output                57 may
 5 be shown on                a user       interface             56,     which includes,                   for     example,      a
   touch         screen.)             In   response             to    the      output,          operating            physician
   28     may     adjust         the     power        of      the     ablating          current            supplied        by  RF
   energy         generator            34,    e.g.,         by    stopping           the     ablating           current,       or
   by otherwise decreasing the power of the current.                                                         Alternatively
 0 or       additionally,                in     response              to      the       output,             the      operating
   physician             may       change         the        rate         of     flow        of      irrigating            fluid
   supplied          by pump           38,    or     change         the      contact         force         with      which    the
   electrode is pressed against the tissue.
              In    some        embodiments,                the     operating            physician             controls        RF
 5 energy         generator            34    and/or          pump       38    via      processor             52.        In   such
   embodiments,                the operating physician typically provides                                             input    to
   the      processor,            such      as    by using             user      interface            56.       In     response
   to      the     input,        the     processor             generates            a   control            signal       59   that
   controls           the       RF     energy         generator             and/or         the       pump.            In   other
 0 embodiments,                processor           52      automatically                controls            the     RF    energy
   generator             and/or         pump,        i.e.,         the      output         that        is     generated        in
   output-generating step 55                            includes control signal 59.
             Typically,             method          49       is     repeatedly             performed             during       the
   ablation            procedure,               i.e.,           steps         51,       76,        53,        and       55    are
25 repeatedly               performed            in        sequence,            such        that          patient         26   is
   continually monitored during the procedure.
              It    will       be    appreciated               by    persons          skilled          in     the     art    that
   the        present            invention              is       not        limited           to        what         has     been
   particularly shown and described hereinabove.                                                    Rather, the            scope
30 of       the       present             invention               includes            both         combinations               and
   subcombinations                  of     the      various            features          described             hereinabove,
   as    well       as     variations           and modifications                      thereof          that      are not      in
   the      prior        art,      which      would          occur        to    persons          skilled          in    the   art
                                                                   24
             3447024v1

  upon   reading         the      foregoing         description.                Documents        incorporated
  by    reference           in      the     present          patent          application           are      to   be
  considered          an    integral         part      of     the     application          except        that    to
  the   extent any terms                are defined in these incorporated documents
5 in  a   manner       that       conflicts         with      the     definitions         made      explicitly
  or  implicitly           in    the present           specification,               only the definitions
  in the present specification should be considered.
         In     this      specification,               the     terms        "comprise",          "comprises",
  "comprising"            or      similar         terms       are      intended         to     mean       a    non
0 exclusive          inclusion,           such      that      a     system,         method      or    apparatus
  that     comprises            a     list      of      elements          does       not    include           those
  elements solely, but may well include other elements not listed.
         The      reference           to    any     prior        art     in     this    specification            is
  not,   and      should       not be       taken       as,    an     acknowledgement             or any       form
5 of    suggestion            that      the     prior        art      forms        part    of      the      common
  general knowledge.
                                                          25
         3447024v1

                                                    CLAIMS
   1.       Apparatus, comprising:
            an electrical interface;                 and
            a processor, configured:
 5                    to      receive,        via        the     electrical             interface,                a
            temperature          sensed     by   a   temperature         sensor      at     a    distal         end
            of an intrabody probe,
                      to    estimate      a    temperature         of     tissue       of       a    subject,
            based        on    the   sensed       temperature          and    a    parameter              of     an
 0          ablating         current     driven,        by   an   ablation        electrode              at     the
            distal end of the intrabody probe, into the tissue, and
                      to    generate     an     output      in   response        to      the       estimated
            temperature.
   2.       The     apparatus       according         to   claim     1,   wherein        the       parameter
 5 includes a power of the ablating current.
   3.       The     apparatus       according         to   claim     1,   wherein        the       parameter
   includes an amplitude of the ablating current.
   4.       The     apparatus       according         to   claim     1,   wherein         the      processor
   is    configured to estimate the temperature of the tissue by:
 0          selecting a coefficient in response to the parameter, and
            multiplying,          by   the    coefficient,         a    value     that        is    based        on
   the sensed temperature.
   5.       The     apparatus       according         to   claim    4,    wherein         the      processor
   is    configured          to  estimate       the    temperature        of the       tissue          as    To   +
25 a(T  1     -    TO),      T1   being      the      sensed     temperature,              a     being          the
   coefficient,            and   To  being     a   quantity      based      on   a   temperature               T_0
   that     was      sensed     by   the    temperature         sensor     prior       to      the      driving
   of the ablating current.
                                                        26
            3447024v1

   6.       The    apparatus         according       to    claim       5,     wherein     the     processor
   is     further        configured         to   compute        T0     as     T_0   -    P,     P   being       a
   correction          factor       that     depends      on    a    stability        of    temperatures
   sensed       by    the     temperature         sensor     prior         to   the    driving       of     the
 5 ablating current.
   7.       The    apparatus         according       to    claim       4,     wherein     the     processor
   is      configured          to      select     the      coefficient            by     computing           the
   coefficient.
   8.       The    apparatus         according       to    claim       7,    wherein      the     processor
 0 is     configured          to   compute       the    coefficient            by   substituting             the
   parameter into a closed-form expression for the coefficient.
   9.       A method, comprising:
            receiving,          by      a   processor,         a     temperature           sensed       by      a
   temperature sensor at a distal end of an intrabody probe;
 5          estimating,          by    the   processor,       a    temperature         of    tissue      of     a
   subject,       based       on   the     sensed    temperature             and  a   parameter        of     an
   ablating       current        driven,      by   an   ablation          electrode       at    the   distal
   end of the intrabody probe, into the tissue;                                 and
            generating           an       output      in     response            to     the       estimated
 0 temperature.
   10.      The    method        according        to    claim        9,     wherein      the      parameter
   includes a power of the ablating current.
   11.      The    method        according        to    claim        9,     wherein      the      parameter
   includes an amplitude of the ablating current.
25 12.      The    method        according       to    claim       9,     wherein      estimating            the
   temperature of the tissue comprises:
            selecting a coefficient in response to the parameter, and
            estimating         the     temperature      of    the tissue          by multiplying,             by
   the       coefficient,             a    value      that        is      based       on     the      sensed
30 temperature.
                                                       27
            3447024v1

   13.       The       method      according          to     claim      12,      wherein       estimating          the
   temperature               of   the     tissue      comprises          estimating          the    temperature
   of      the        tissue        as      To    +    a (TI       -   TO),        TI    being      the      sensed
   temperature,               a   being       the    coefficient,             and     To   being     a    quantity
 5 based        on      a   temperature          T_0     that       was    sensed       by   the    temperature
   sensor prior to the driving of the ablating current.
   14.       The        method        according           to      claim       13,       further       comprising
   computing T 0 as T_0                  -    P, P being a correction factor that depends
   on    a    stability           of   temperatures            sensed       by    the    temperature         sensor
 0 prior to the driving of the ablating current.
   15.       The       method       according          to     claim       12,     wherein       selecting          the
   coefficient              comprises         selecting the           coefficient by computing the
   coefficient.
   16.       The       method       according          to     claim       15,     wherein       computing          the
 5 coefficient               comprises         computing        the     coefficient          by   substituting
   the parameter into a closed-form expression for the coefficient.
   17.       A method, comprising:
             using a probe              that     includes an          ablation electrode, at                   least
   one      internal           temperature          sensor        inside       the     ablation       electrode,
 0 and     at     least       one    surface       temperature           sensor        at a    surface       of    the
   ablation             electrode,            performing           a   plurality           of    ablations          of
   tissue          with        different          respective           amplitudes           of    an      ablating
   current;
             during           each       of      the       ablations,             sensing        an       internal
25 temperature,                 using       the     internal          temperature             sensor,        and     a
   surface temperature, using the surface temperature sensor;                                                and
             using         a    processor,          learning          a     relationship          between          the
   sensed internal temperature and the sensed surface temperatures.
                                                              28
             3447024v1

  18.      The method according to claim 17,
           wherein the relationship is expressed by an equation Ts                       - To
  + a(TI       - TO),   a being    a coefficient, TS being the              sensed surface
  temperature,         T1   being    the    sensed    internal       temperature,    and   To
5 being a baseline temperature, and
           wherein      learning    the     relationship        comprises     learning    the
  relationship         by   learning    a   dependency       of  a   on  the  amplitude    of
  the ablating current.
  19.      The    method     according      to    claim     18,    wherein    learning    the
0 dependency         of   a    on   the     amplitude       of    the   ablating    current
  comprises        learning     the   dependency      by    regressing      (TS-To)/(TI-TO)
  on the amplitude of the ablating current.
  20.      The     method     according       to    claim      19,    wherein    regressing
   (TS-T0)/(TI-T0)          on    the     amplitude        of    the    ablating    current
5 comprises          quadratically         regressing          (TS-T0)/(TI-T0)     on     the
  amplitude of the ablating current.
                                                 29
           3447024v1

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
