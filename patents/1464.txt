                                  ABSTRACT
           A  method   includes   receiving    an    anatomical   mapping
   that     includes  multiple   measurements     acquired   at  multiple
   respective      locations  within   an    organ    of  a  patient.   An
 5 estimated     surface  of  the  organ   is   computed    based  on  the
   measurements.       A  three-dimensional        (3D)   shell   of   the
   organ,     which  extends   inwards  from    the   estimated   surface
   of    the  organ  and has  a  predefined    thickness,     is defined.
   A    quality of the anatomical mapping        is estimated based on
10 the     measurements    whose   locations     fall    within   the   3D
   shell.

                            1/4
                                     Nt  Nt 0)   00
                                     C14 co co   CV)
d ft
 ULft
                                C14
                                C'14
                         A
                       A)
              cn    N
                    cn
             Q)
      N
      C14
04               co                                 04
C14
                        C14
                        ON
                                            00
                                            C14
                                                       cn
          cn
                                              CO
                                              cn

            INTERACTIVE ANATOMICAL MAPPING AND ESTIMATION OF
                             ANATOMICAL MAPPING QUALITY
                                FIELD OF THE INVENTION
            The      present         invention               relates          generally          to
 5 anatomical          mapping,        and       particularly             to     methods        and
   systems       for interactive anatomical mapping and estimation
   of anatomical mapping quality.
                            BACKGROUND OF THE INVENTION
            Anatomical         mapping          may        be    used       for      diagnosing
10 various        types      of   medical          conditions,            such      as     cardiac
   arrhythmia.           Various         techniques             may      be     applied         for
   deriving        an    anatomical         mapping          and    for    controlling          the
   mapping procedure.
             For example,       U.S.       Patent       8,744,566, whose             disclosure
15 is     incorporated         herein       by      reference,          describes          methods
   and     systems      for    the    determination              and    representation           of
   anatomical         information.           The     methods        and    systems         include
   generating         anatomical        information            of    the   heart,       based    on
   positions        of    the   catheter          electrodes          and    the     electrical
20 signals       from     the   electrodes           at     the    determined          subset    of
   electrode positions.
            U.S.       Patent        8,457,371,               whose         disclosure           is
   incorporated          herein      by      reference,           describes         method      and
   apparatus        for mapping          a   structure.          The    mapping        apparatus
25 may      include      one    or    more        electrodes           that     can      sense     a
   voltage       that      can   be     correlated            to    a   three       dimensional
   location       of    the   electrode          at     the    time    of    the     sensing     or
   measurement. A map of an area or volume                               can be determined
   based upon the           sensing of          the plurality of points without
30 the     use     of    an   imaging         device.         An     implantable           medical
   device       can    then     be    navigated             relative       to     the      mapping
   data.
                                                         1

            U.S.           Patent       8,900,225,              whose         disclosure           is
   incorporated              herein    by    reference,          describes        a   method      for
   performing            a   medical      procedure         that      includes        bringing      a
   probe      into      contact      with     an    organ      in    a body      of   a  patient.
 5 A   map of        the     organ is      displayed,          and the        location       of the
   probe relative to the map is                       tracked.
            U.S.        Patent      Application            Publication           2009/0099468,
   whose       disclosure           is    incorporated             herein       by    reference,
   describes          a    method,     an    apparatus,           and   a    computer      program
10 product           for        automated          processing            of      intra-cardiac
   electrophysiological                 data.       The    method       includes        recording
   electro-gram               data,     defining           at       least      one      reference
   channel          containing          a     reference           beat       for     determining
   temporal          locations,         creating         an      index      of    the     temporal
15 locations,               analyzing          in      real-time             at      least        one
   electrophysiological                  feature,         and       providing        an    updated
   index and results of the analysis.
                                  SUMMARY OF THE INVENTION
            An      embodiment         of      the     present         invention          that     is
20 described herein provides a method                              including receiving an
   anatomical            mapping       that      includes          multiple        measurements
   acquired at multiple respective locations within an organ
   of     a    patient.          An    estimated          surface         of    the     organ      is
   computed          based      on   the     measurements.            A    three-dimensional
25  (3D)     shell       of    the   organ,      which       extends        inwards      from     the
   estimated            surface      of      the     organ        and    has      a   predefined
   thickness,              is    defined.        A    quality          of     the     anatomical
   mapping          is      estimated       based       on     the     measurements            whose
   locations fall within the 3D shell.
30          In     some      embodiments,         defining         the    3D   shell      includes
   forming,           at      a   predefined          distance          inwards         from      the
   estimated          surface,       a   virtual       surface        confining         the    shell
   between the estimated surface and the virtual surface.                                          In
                                                         2

   other          embodiments,                  estimating            the        quality              of       the
   anatomical             mapping            includes         counting          a      number          of      the
   measurements whose                     locations        fall within at                  least part of
   the     shell.         In      yet     other      embodiments,             the       shell        includes
 5 multiple            volume           pixels         (voxels),          and        estimating                the
   quality is based on a number of the voxels, within the                                                       at
   least part of the shell, in which the measurements fall.
             In      an      embodiment,              the     shell        includes              a     surface
   including            multiple          pixels,        and     estimating            the     quality          is
10 based on a number of the pixels, within the at least part
   of    the      shell,         in    which       the measurements                fall.        In     another
   embodiment, the organ includes a cavity of a heart.
            There         is      additionally            provided,          in      accordance             with
   another           embodiment             of     the    present         invention,                a   method
15 including             receiving             a   partial        anatomical               mapping          that
   includes             multiple            measurements              acquired              at       multiple
   respective             locations             within      an     organ        of       a    patient.          An
   estimated            partial          surface       of    the    organ       is       computed         based
   on      the       measurements.                 Based        on     the       measurements,                  an
20 unvisited            region         of    the     organ,      which      was        not     yet      mapped
   by     the       partial          anatomical           mapping,          is       identified.               The
   unvisited            region        is    indicated         to    a   user,        so as        to    assist
   the     user        in     mapping          the    unvisited          region           and      extending
   the estimated partial surface.
25           In     some        embodiments,            the     multiple          measurements                 are
   acquired using a distal end of                               a catheter,              and indicating
   the      unvisited               region         includes        displaying               a      graphical
   indication indicative of a direction to which the user is
   to     move       the       distal         end     in   order        to     map        the      unvisited
30 region.            In        other         embodiments,             the        method             includes
   overlaying             a     grid       of     volume      pixels         (voxels)            within         at
   least        part       of      the     organ,       and     identifying               the      unvisited
   region          includes           identifying           one      or    more          voxels        of      the
                                                              3

   grid      that      were       not      yet    mapped       by     the      partial        anatomical
   mapping.          In      yet     other       embodiments,              the      method        includes
   defining          a     given         volume       that       extends          outwards          from          a
   catheter           distal          end      that       is     used        for        acquiring           the
 5 measurements,                 and        identifying              the        unvisited             region
   includes         identifying,              within        the     given        volume,        locations
   that were not              yet visited by the distal end.
            There        is     additionally             provided,           in      accordance          with
   an     embodiment             of      the      present         invention,              an    apparatus
10 including          an     interface          and     a   processor.            The      processor           is
   configured            to     receive         from      the      interface            an    anatomical
   mapping,           including             multiple           measurements                acquired            at
   multiple           respective              locations           within           an      organ       of         a
   patient,          to      compute         an     estimated           surface          of    the     organ
15 based       on   the       measurements,             to    define         a   three-dimensional
    (3D)     shell       of     the      organ,       which      extends          inwards        from       the
   estimated            surface           of    the      organ        and       has       a   predefined
   thickness,            and      to     estimate         a   quality           of     the    anatomical
   mapping,         based        on      the   measurements              whose         locations          fall
20 within the 3D shell.
            There        is      further         provided,           in     accordance            with         an
   embodiment              of       the       present           invention,              an      apparatus
   including an              interface          and     a   processor.            The      processor           is
   configured             to       receive          a    partial          anatomical              mapping,
25 including            multiple            measurements               acquired            at     multiple
   respective            locations           within         an    organ         of     a    patient,           to
   compute         an    estimated           partial         surface         of     the     organ      based
   on       the       measurements,                  to      identify,               based        on        the
   measurements,               an    unvisited          region        of     the       organ     that       was
30 not     yet mapped            by    the partial            anatomical             mapping,         and      to
   indicate         on      the     output        device       the     unvisited            region      to        a
   user,       so   as      to    assist       the     user      in     mapping          the    unvisited
   region and extending the estimated partial surface.
                                                              4

             The   present          invention          will     be     more      fully        understood
   from         the        following              detailed             description               of      the
   embodiments           thereof,          taken       together         with      the      drawings       in
   which:
 5                       BRIEF DESCRIPTION OF THE DRAWINGS
             Fig.    1    is     a    schematic,          pictorial          illustration              of   a
   catheter-based              tracking           and    ablation         system         that      employs
   anatomical          mapping,          in      accordance           with     an      embodiment         of
   the present invention;
10           Fig.    2   is     a    schematic,          pictorial         illustration              of   an
   anatomical           map      of     an     inner        surface       of      a    heart,        and    a
   visualization             scheme        that      directs         a   user      toward        unmapped
   areas       of the surface,               in accordance with an embodiment of
   the present invention;
15           Fig.    3   is     a    schematic,          pictorial         illustration              of   an
   estimated         anatomical           map      of    an    inner      surface          of    a  heart,
   in       accordance             with         an      embodiment             of        the       present
   invention;          and
             Fig.    4    is     a    schematic,          pictorial          illustration              of   a
20 scheme        for    estimating            the     quality          of  an      anatomical          map,
   in       accordance             with         an      embodiment             of        the       present
   invention.
                       DETAILED DESCRIPTION OF EMBODIMENTS
                                                  OVERVIEW
25           In    some          medical           procedures,              such          as       cardiac
   ablation,          a    medical         probe        is     navigated           into        a   patient
   heart       based     on     an estimated             anatomical          map       of     the heart.
   Estimating           the        anatomical           map      may      be      carried          out    by
   inserting         a     catheter         having          sensing       electrodes             disposed
30 on      its    distal          end,       and      measuring           certain           signals       at
   multiple        locations           of     tissue        on     the    heart        inner       surface
   using       the    electrodes.             Mapping         algorithms            that       are    based
                                                             5

   on     such      measurements,              such     as      fast       anatomical             mapping
    (FAM),       are known in the art. The                      FAM method may provide a
   physician          with       additional         mapping         capabilities,                such    as
   electro-physiological                     (EP)    mapping         that      may      be     used     for
 5 the cardiac ablation.
             During      the      FAM procedure,            a    physician            navigates         the
   distal          end       of       the      catheter           to       desired            locations
   distributed             across         the     tissue         in     question            so      as   to
   collect         anatomical           signals       therefrom.            In     principle,           the
10 FAM may provide the physician with a surface representing
   an       estimated           anatomical           mapping            of      the        tissue        in
   question.          This        surface       will      be      used        by     the      physician
   during        the    EP mapping           and    ablation          procedures,             therefore
   it    is     important         to monitor         the     quality          of    the    anatomical
15 mapping before starting the EP procedure.
             Embodiments             of      the     present           invention             that       are
   described           hereinbelow            provide          improved           techniques            for
   interactive            anatomical          mapping.         The     disclosed           techniques
   may      be    used        for      indicating         to     the      physician             unmapped
20  ("unvisited")               regions        of      the       heart         surface.            In    an
   embodiment,            after        receiving       partial          measurements               of   the
   anatomical            mapping,           the    processor            computes            a     partial
   surface         of      the      tissue        and     identifies,               based         on    the
   partial         surface,          one     or   more      unvisited             regions          in   the
25 tissue for further anatomical mapping.
             In    an    embodiment,            the     processor             is     configured          to
   display a graphical                   indication that directs                      the physician
   to    the     unvisited          regions,        so   as     to     assist        the      physician
   in      mapping         the      entire        surface.          After         concluding            the
30 anatomical           mapping,         the    processor          displays          the      estimated
   anatomical mapping of the entire surface.
             In    another         embodiment,          the     processor            is    configured
   to     estimate          the      quality       of     the      anatomical             mapping        by
                                                          6

   defining         a     three-dimensional                  (3D)      shell       which      extends
   inwards         from         the      estimated            anatomical             surface.       For
   example,         the        processor         may       define        a     virtual        surface
   parallel to the estimated surface so that the                                        3D shell     is
 5 the     volume        confined          between        the      two     surfaces.         In   some
   embodiments,             the     processor         estimates          the     quality       of   the
   anatomical            mapping           based        on     the      number          of    mapping
   measurements             whose       locations         fall      within        the    predefined
   volume.
10           The        disclosed               techniques              provide            real-time
   visualization               of     the       ongoing         mapping         procedure,          and
   provides        feedback          regarding          the    quality        of     the   estimated
   anatomical             surface,            thereby          obtaining           high       quality
   mapping and shortening the procedure cycle time.
15                                      SYSTEM DESCRIPTION
             Fig.     1   is    a    schematic,          pictorial         illustration           of  a
   catheter-based                tracking          and       ablation          system         20,    in
   accordance           with      an    embodiment           of    the    present         invention.
   System 20         comprises a             catheter 22,           in the present example
20 a    cardiac         catheter,          and     a     control        console         24.    In   the
   embodiment           described          herein,       catheter         22   may be       used    for
   any suitable therapeutic and/or diagnostic purposes,                                           such
   as anatomical mapping of a cavity 37 in a heart 26.
             Console         24    comprises          a    processor          39,      typically      a
25 general-purpose                computer,          with       suitable          front      end    and
   interface         circuits          38    for    receiving          signals        via   catheter
   22    and    for     controlling            the    other       components          of   system    20
   described          herein.          Console        24     further        comprises          a  user
   display        35,     also      referred        to    as     an    output       device,      which
30 is      configured              to      display          tools        for        assisting        in
   anatomical mapping as shown in Figs. 2-4 below.
                                                           7

           The       procedure        of     anatomical           mapping         is     carried          out
   using       distal       end    40     that     collects          multiple          measurements
   at     respective             locations           of        the      heart          tissue,            the
   measurements             outcomes           are     referred            to     herein          as     map
 5 points.        Each map point comprises                       a three-dimensional                    (3D)
   coordinate           on    the    tissue        of    cavity         37    and      a   respective
   measurement             of     some         physiological                property           that         is
   measured at this coordinate.
            In     some     embodiments,           processor            39    is     configured             to
10 construct,           based     on      the    measurements               or    map     points,           an
   estimated          anatomical           surface        (shown         in    Figs.        3    and      4),
   and present the estimated anatomical                                 surface to physician
   30      on       display         35.        In     constructing                 the        estimated
   anatomical            surface,           processor            39      may       apply          to      the
15 measurements             a   procedure           such        as     the      Fast       Anatomical
   Mapping         (FAM)    procedure,          which       is    described,           for example,
   in     U.S.        Patent       Application              Publication              2011/0152684,
   whose disclosure is                 incorporated herein by reference.
            In      some     medical         procedures,             such        as     ablation            of
20 tissue,         physician         30     creates         an     anatomical            map       of     the
   tissue          to    be      ablated          in      advance.            To       perform            the
   anatomical           mapping,           physician           30     inserts           catheter            22
   through         the   vascular          system       of     a   patient          28    lying        on     a
   table       29.     Catheter         22     comprises          one      or    more      electrodes
25  (not     shown)        typically           fitted       at     a    distal         end      40.      The
   electrodes          are     configured          to    sense        the     tissue         of     cavity
   37    of heart        26.    Physician 30 navigates distal end 40                                    into
   cavity       37    by manipulating              catheter          22     with     a   manipulator
   32    near      the   proximal          end    of    the      catheter         as     shown       in     an
30 inset 23.          The proximal end of catheter 22                            is    connected to
   interface circuitry in processor 39.
            In    some     embodiments,           the     position           of    the     distal        end
   in cavity 37            is measured by a position sensor                               (not shown)
                                                          8

   of      a    magnetic         position             tracking          system.          The     measured
   position          serves       as     the      coordinate           of    the      respective            map
   point.
             For      example,           the       anatomical            measurements               may      be
 5 acquired          using      the     fast       anatomic          mapping         (FAM)      functions
   of      the      CARTO@       3      System         cooperatively               with       a    mapping
   catheter          such as       the Navistar                  Thermocool            catheter, both
   available            from       Biosense            Webster,           Inc.,         3333        Diamond
   Canyon Road, Diamond Bar, Calif. 91765.
10           In    this      case,      console          24     comprises         a   driver        circuit
   34,      which       drives       magnetic           field       generators           36    placed        at
   known positions external to patient 28                                     lying on table 29,
   e.g.,        below       the   patient's             torso.        The   position           sensor        is
   fitted         to     the     distal          end,        and     configured            to     generate
15 position          signals        in    response            to   sensed       external         magnetic
   fields        from field generators 36.                         The position signals                     are
   indicative              of    the         position            the     distal           end      in       the
   coordinate system of the position tracking system.
             This       method       of      position           sensing       is      implemented            in
20 various         medical       applications,                 for    example,         in    the     CARTOTM
   system,         produced         by     Biosense            Webster       Inc.       (Diamond          Bar,
   Calif.)          and       is     described             in     detail         in     U.S.        Patents
   5,391,199,            6,690,963, 6,484,118,                      6,239,724,          6,618,612           and
   6,332,089,            in    PCT     Patent        Publication           WO     96/05768,           and    in
25 U.S.        Patent         Application              Publications              2002/0065455               Al,
   2003/0120150              Al    and       2004/0068178              Al,    whose         disclosures
   are all incorporated herein by reference.
             In    some      embodiments,             physician          30    may      use     processor
   39     for navigating              distal        end      40    to a    target         location          and
30 for       activating           the        electrodes            so     as     to      sense        and/or
   ablate           the        tissue          at        cavity         37.         In      alternative
   embodiments,              processor          39    may be         used    only for           assisting
                                                               9

   physician        30      in        mapping         unvisited               regions          and     in
   estimating the quality of the anatomical mapping.
          Processor         39,      typically         comprises             a    general-purpose
   computer,      which        is     programmed           in    software            to    carry      out
 5 the    functions          described            herein.         The         software          may    be
   downloaded       to     the       computer         in      electronic             form,       over    a
   network,       for       example,            or     it       may,         alternatively             or
   additionally, be provided and/or                            stored on non-transitory
   tangible      media,       such      as     magnetic,         optical,            or   electronic
10 memory.
      INTERACTIVE ANATOMICAL MAPPING BY INDICATING UNVISITED
                                               REGIONS
          Fig.    2   is    a     schematic,         pictorial            illustration             of  an
   anatomical map 41              of cavity 37            and a visualization scheme
15 that directs physician 30                     toward unmapped areas                      of cavity
   37,    in    accordance            with       an     embodiment              of     the      present
   invention.        In     some        embodiments,             processor             39     receives
   anatomical       data      of heart          26   and      uses     the       anatomical          data
   to  display      an     estimated           volume       42    of    cavity          37   in    heart
20 26.     In    an      embodiment,              volume         42      may         be     displayed
   schematically           as      a   cubical         shape,        or        using       any     other
   suitable shape.
          In   some      embodiments,              processor          39       further        receives
   from distal end 40                partial anatomical mapping, comprising
25 multiple      measurements,               such      as      fast     anatomical              mapping
   (FAM),     acquired        at      multiple         respective              locations         within
   cavity 37.       In an embodiment, based on these measurements,
   processor        39     is        configured           to      compute            an     estimated
   partial surface 46 that was already mapped in cavity 37.
30        In   an   embodiment,             using      estimated            volume        42   and    the
   measurements          already          acquired,          processor             39    is     further
   configured       to    identify          an    unvisited         region           of   cavity      37,
                                                         10

   such as an estimated surface 44,                            which was not              yet mapped
   by    the       partial          anatomical              mapping.          In       the      present
   context, the             term "unvisited region" refers to                             regions of
   the   surface         of cavity          37    that      are   not     yet     represented            by
 5 estimated partial surface 46.
          In       some        embodiments,               processor           39      displays           on
   anatomical           map      41    the       position         of      distal         end      40     as
   received       from       the position             tracking        system,         and    an     arrow
   48  that      indicates          the     direction          of   the      unvisited          region,
10 so  as    to     assist       physician           30    to   complete          the    mapping         of
   the tissue of cavity 37.
          In     other        embodiments,             processor         39    overlays          a   grid
   of   three-dimensional                  (3D)      pixels,        also       known       as     voxels
   (not      shown),           over        volume          42.     In       this        embodiment,
15 processor         39     samples      part       of    the   voxels        within       volume        42
   and   identifies            the    voxels        not      yet   visited          by   distal        end
   40.   Then,        processor         39     displays         arrow       48    that      indicates
   the direction of the unvisited voxels.
          In       some        embodiments,               processor           39      may       display
20 surface         44       of     the       unvisited           region          based         on      the
   measurements             acquired         at     surface       46     and      volume         42.     In
   other embodiments, processor may display only surface                                               46,
   distal       end        40,    and      arrow         48    so     as      to     indicate          the
   direction of             the unvisited region to physician                             30 without
25 extrapolating              the    measurements              acquired          for      estimating
   surface 46.
          In      an       embodiment,           processor           39      defines          a     given
   volume       (not      shown)      that       extends        outward        from      distal        end
   40  and     identifies           locations           within     the      given       volume        that
30 were not yet visited by distal end 40.                                  Then, processor 39
   displays         arrow       48   that        indicates         the       direction           of    the
   unvisited          locations         within          the    given       volume,         so      as    to
                                                           11

   assist physician                30 to     complete the mapping of the tissue
   of cavity 37.
                ESTIMAING THE QUALITY OF THE ANATOMICAL MAPPING
             Fig.     3   is     a   schematic,        pictorial           illustration             of   an
 5 estimated            anatomical           map      43,       in     accordance              with      an
   embodiment           of the present invention.                      In some          embodiments,
   for      generating           anatomical        map      43,    processor              39   receives
   multiple anatomical                  measurements, such as                     fast anatomical
   mapping         (FAM),        acquired       at   multiple         respective              locations
10 within cavity 37.
             Based      on     the    measurements,           processor            39     computes       an
   estimated             surface          45     and       displays             surface           45     in
   anatomical             map        43     on     display          35.         Note         that       the
   computation               of       surface        45       is      based            on      sampling
15 measurements              rather       than     continuous           mapping            of    surface
   45.      In    some       embodiments,          the      computation              of    surface       45
   may      involve         interpolation            of     the     sampling            measurements
   acquired therein,                 therefore, at            least parts of                surface 45
   as displayed in map 43 may be inaccurate. For example,                                                an
20 interpolated               region       between         multiple           measurements              may
   comprise          an    unvisited         anatomical          feature           (e.g.,       bump     or
   crater)         that       may     deviate      from       the     estimated             topography
   made by processor 39.
             In    some       embodiments,          physician          30      may      define        a  3D
25 shell        52   that       extends      inwards        from      estimated            surface       45
   into the         internal volume              of cavity 37.             The      shape of shell
   52    may be        defined        by processor           39 using           various        methods.
   For      example,         processor         39    defines        a     virtual          surface       50
   parallel         to    surface        45   at   a   predefined             distance         (e.g.,      7
30 mm)       set    by     physician          30    or     by    processor              39.     In     this
   embodiment,            the      volume      of    shell       52    is      confined          between
   the      boundaries           of    surfaces       45    and    50.       In    an     embodiment,
                                                          12

   the       volume          of      shell         52     is      used        for        estimating              the
   anatomical            mapping          quality         of      surface         45     as     depicted          in
   Fig. 4 below.
             Fig.      4    is     a    schematic,            pictorial           illustration                of    a
 5 scheme        for     estimating              the     quality           of    anatomical             map      43,
   in     accordance            with      embodiments              of     the    present           invention.
   In     some     embodiments,               processor            39     displays           on    anatomical
   map     43    surfaces           45    and      50,     shell        52,    and measurements                   54
   acquired          by      visiting           selected           locations             at     surface          45,
10 using distal end 40                     as described in Figs.                        1-3 above.
             In   some         embodiments,              processor            39     is     configured            to
   select        within         the volume            of    shell         52   one      or more          slices,
   such       as    slices           56    and       58.     The       slices         may       be     selected
   randomly          by     processor             39,     or      according            to     a    predefined
15 parameter           (e.g.,         specific          locations            within         shell       52)      set
   manually          by      physician            30     or      automatically                by     processor
   39.
             In an embodiment, each slice                                represents            a subsurface
   or      a     sub-volume              within         shell          52     comprising              multiple
20 pixels.         In    the        example         of     Fig.       4,     each       slice        comprises
   nine        pixels           depicted            for       the         sake        of      clarity.            In
   practice,          each        slice       may     comprise            any    suitable            number       of
   pixels.
             In   some        embodiments,              each       slice       may      comprise           pixels
25 55       representing                measurements                 54      falling            within           the
   respective             slice.           In      an     embodiment,               processor              39     is
   configured            to       check        the      portion            of    pixels           55     falling
   within        each       slice        so    as     to     estimate           the      quality          of     the
   anatomical            mapping            represented                by     surface             45.      In     an
30 embodiment,             insets         66     and      68     represent            the      distribution
   of     pixels        55     within         slices         56     and      58,      respectively.               In
   general,           a     highly          populated              slice        represents               a     high
   mapping quality and vice versa.
                                                               13

          In inset         66,   it appears that pixels 55                         represent          the
   majority of pixels              (e.g., eight out of nine)                         of slice         56,
   therefore,         slice      56    may        get      a    high       score        (e.g.,        89%
   (derived        as     8/9=0.89)         indicating              high       quality        of      the
 5 anatomical       mapping       on    the      left       side      of map      41.    Using        the
   same   methodology,            only      two       pixels         55   fall       within      slice
   58,  and the        score of       slice 58           is   22%      (derived by counting
   2   pixels       out      of    9),       indicating               low     quality         of      the
   anatomical         mapping         in      the         upper         central         region         of
10 anatomical map 41.
          In       some        embodiments,                based          on       the        scoring
   methodology         described         above,         processor           39    is    configured
   to display a quantitative map representing the quality of
   the   anatomical          mapping       for      each      region        of    cavity       37.     In
15 an  embodiment,           physician        30      may     set      one     or    more     quality
   thresholds         so    that     processor             39     provides          physician          30
   with   alerts       in    case    of    lower        than      desired       quality        of     the
   anatomical mapping at specific locations of cavity 37.
          In other embodiments,                   slices        56 and 58 may represent
20 volumetric         elements          rather           than        two-dimensional                (2D)
   surfaces,        so     that    pixels          55     may      represent          voxels        (not
   shown),      rather than 2D pixels.
          Although          the    embodiments               described           herein        mainly
   address       cardiology        applications,               the      methods       and     systems
25 described       herein       can   also       be     used      in    other      applications,
   such as in ear-nose-throat                      (ENT),      and bronchoscopy.
          It      will        be     appreciated                that        the        embodiments
   described above are cited by way of example,                                      and that         the
   present        invention         is     not         limited          to     what       has      been
30 particularly          shown and described hereinabove.                              Rather, the
   scope    of the present invention                       includes both combinations
   and   sub-combinations               of    the        various         features         described
   hereinabove,           as    well      as       variations             and      modifications
                                                         14

   thereof    which     would   occur    to   persons         skilled        in     the    art
   upon  reading      the   foregoing     description           and      which      are    not
   disclosed      in    the  prior     art.     Documents           incorporated            by
   reference      in    the  present     patent        application            are      to   be
 5 considered       an   integral     part     of     the      application            except
   that    to    the     extent   any     terms       are       defined          in      these
   incorporated        documents    in    a   manner        that       conflicts          with
   the   definitions        made   explicitly          or      implicitly            in    the
   present      specification,         only      the       definitions              in     the
10 present specification should be considered.
         In      this      specification,           the       terms          "comprise",
   "comprises",        "comprising"      or   similar         terms        are     intended
   to  mean    a   non-exclusive       inclusion,          such       that      a    system,
   method    or    apparatus     that     comprises         a    list       of     elements
15 does   not     include     those    elements         solely,          but      may     well
   include other elements not listed.
         The   reference      to any prior art            in this         specification
   is  not, and should not be taken as,                   an acknowledgement or
   any  form of      suggestion     that    the     prior       art      forms      part    of
20 the common general knowledge.
                                              15

                                           CLAIMS
   1.    A method, comprising:
         receiving an anatomical mapping, comprising multiple
   measurements        acquired       at     multiple          respective             locations
 5 within an organ of a patient;
         computing an estimated surface of                         the organ based on
   the measurements;
         defining         a    three-dimensional                (3D)      shell           of   the
   organ,     which    extends      inwards        from     the      estimated            surface
10 of the organ and has a predefined thickness;                              and
         estimating          a   quality        of     the      anatomical             mapping,
   based on the measurements                whose locations              fall within the
   3D shell.
   2.    The      method     according        to     claim      1,     wherein          defining
15 the  3D    shell    comprises       forming,         at   a    predefined            distance
   inwards       from    the    estimated        surface,          a    virtual           surface
   confining the        shell between the estimated surface and the
   virtual      surface.
   3.    The      method    according       to    claim      1,    wherein         estimating
20 the  quality       of   the   anatomical          mapping       comprises            counting
   a  number      of  the measurements            whose      locations           fall      within
   at least part of the shell.
   4.    The      method    according        to   claim       3,    wherein          the     shell
   comprises        multiple     volume       pixels        (voxels),           and       wherein
25 estimating        the    quality       is     based       on      a   number           of   the
   voxels,      within     the   at  least      part      of     the    shell,         in    which
   the measurements fall.
   5.    The      method    according        to   claim       3,    wherein          the     shell
   comprises        a   surface       comprising           multiple            pixels,         and
30 wherein      estimating       the   quality         is   based        on    a     number     of
                                                   16

   the    pixels,         within        the     at     least       part      of    the      shell,      in
   which the measurements                    fall.
   6.      The     method        according          to     claim      1,    wherein          the    organ
   comprises a cavity of a heart.
 5 7.      A method, comprising:
           receiving           a   partial          anatomical           mapping,          comprising
   multiple         measurements               acquired           at     multiple          respective
   locations within an organ of a patient;
           computing          an    estimated           partial         surface       of     the    organ
10 based on the measurements;
           identifying,            based on          the measurements,                 an unvisited
   region        of     the      organ       that       was      not      yet     mapped          by   the
   partial anatomical mapping;                        and
           indicating           the     unvisited          region        to a     user,        so   as  to
15 assist        the      user      in     mapping           the     unvisited           region        and
   extending the estimated partial surface.
   8.      The       method         according             to      claim       7,      wherein          the
   multiple        measurements             are     acquired         using      a   distal         end  of
   a  catheter,           and     wherein         indicating            the   unvisited            region
20 comprises displaying                  a graphical             indication indicative                  of
   a  direction           to which         the     user       is   to    move     the      distal      end
   in order to map the unvisited region.
   9.      The      method        according            to       claim      7,     and      comprising
   overlaying           a   grid      of     volume         pixels         (voxels)         within      at
25 least        part        of     the       organ,            wherein        identifying              the
   unvisited region               comprises          identifying one               or more voxels
   of    the      grid      that      were       not      yet      mapped       by      the       partial
   anatomical mapping.
                                                           17

   10.   The   method       according         to   claim     7,    and      comprising
   defining    a    given    volume       that      extends     outwards          from  a
   catheter    distal       end    that        is   used    for     acquiring         the
   measurements,       wherein      identifying          the    unvisited          region
 5 comprises    identifying, within the                given volume,           locations
   that were not      yet visited by the distal end.
   11.   Apparatus, comprising:
         an interface;       and
         a   processor,         configured            to    receive          from     the
10 interface      an    anatomical         mapping,        comprising           multiple
   measurements       acquired      at     multiple       respective           locations
   within   an    organ    of   a   patient,         to   compute       an     estimated
   surface of the organ based on the measurements, to define
   a   three-dimensional           (3D)       shell     of    the     organ,        which
15 extends   inwards      from    the    estimated        surface      of     the   organ
   and has   a predefined thickness,                and to estimate            a quality
   of   the   anatomical       mapping,          based    on    the      measurements
   whose locations fall within the 3D shell.
   12.   The   apparatus       according          to   claim     11,     wherein      the
20 processor    is   configured to         form, at a predefined distance
   inwards    from     the   estimated          surface,     a    virtual        surface
   confining the      shell between the estimated surface and the
   virtual   surface.
   13.   The   apparatus       according          to   claim     11,     wherein      the
25 processor    is   configured       to     estimate     the   quality         based  on
   a  number   of   the measurements            whose    locations        fall     within
   at least part of the shell.
                                                 18

   14.       The      apparatus         according        to   claim         13,      wherein      the
   shell         comprises          multiple       volume       pixels           (voxels),        and
   wherein          the     processor          is   configured            to      estimate        the
   quality        based       on     a  number     of    the    voxels,          within       the   at
 5 least part of the shell, in which the measurements fall.
   15.       The      apparatus         according        to   claim         13,      wherein      the
   shell       comprises a           surface comprising multiple pixels,                          and
   wherein          the     processor          is   configured            to      estimate        the
   quality        based       on     a  number     of    the    pixels,          within       the   at
10 least part of the shell, in which the measurements fall.
   16.       The      apparatus         according        to    claim        11,      wherein      the
   organ comprises a cavity of a heart.
   17.       Apparatus, comprising:
             an output device;              and
15           a     processor,            configured         to      receive             a    partial
   anatomical             mapping,          comprising         multiple             measurements
   acquired at multiple respective locations within an organ
   of    a   patient,        to     compute     an   estimated          partial         surface     of
   the     organ        based     on    the    measurements,           to     identify,         based
20 on     the     measurements,             an   unvisited         region         of      the   organ
   that        was       not     yet      mapped     by     the       partial            anatomical
   mapping,           and      to      indicate      on     the       output          device      the
   unvisited           region       to   a  user,    so    as   to    assist         the     user   in
   mapping        the     unvisited        region      and    extending           the      estimated
25 partial surface.
   18.       The      apparatus         according        to   claim         17,      wherein      the
   multiple         measurements           are    acquired      using         a  distal       end   of
   a    catheter,          and     wherein      the    processor           is    configured         to
   display        on     the   output      device      a  graphical           indication         of   a
30 direction           to which        the user     is    to move the            distal        end in
   order to map the unvisited region.
                                                        19

                                                         <U+2704><U+260E><U+2706><U+271D><U+271E><U+271F><U+260E><U+2720><U+260E><U+2721><U+261B> <U+261E><U+270C><U+260E><U+260E><U+261B>
                                                                        <U+2701><U+2702>
<removed-date>
                                                                                             <U+2725>                <U+2722>
                       <U+272A>                                                         <U+271C>
                                                                                     <U+2725>   <U+271A>           <U+271A><U+2723>       <U+271A>
                       <U+2729>
                       <U+2605><U+2727>
                       <U+2726>
                                    <U+2724><U+271C>
<removed-apn>
                                                                             <U+271C>
                                                                             <U+271C>
              <U+2719><U+270D>                                                                                                              <U+2719><U+270D>
              <U+270E><U+2718>                                                                                                              <U+270E><U+2718>
              <U+270F><U+2717>                                                                                                              <U+270F><U+2717>
              <U+2712>                                                                                                               <U+2712>
              <U+270E><U+270D>                                                                                                              <U+270E><U+270D>
              <U+2717><U+2716>                                 <U+2724>              <U+271C>                                                             <U+2717><U+2716>
              <U+2711><U+2715>                                 <U+271A>              <U+271A>                                                             <U+2711><U+2715>
              <U+2714><U+270D>                         <U+2724>           <U+271B>                                                                        <U+2714><U+270D>
              <U+270E><U+2713>            <U+271C>                <U+2725>       <U+271C>                                                                        <U+270E><U+2713>
              <U+2712><U+2711>            <U+271C>                              <U+272B><U+271A>                                                         <U+2723>       <U+2712><U+2711>
                   <U+271C>                                                                                              <U+271C>
              <U+270F>    <U+271C>                                                <U+271C>                                                         <U+270F>
              <U+270E><U+270D>                                                    <U+271C>                                                         <U+270E><U+270D>
                                                                                                 <U+2722>
                                                                                                 <U+271C>
                                                                                                                          <U+271B>
                                                                                                                          <U+271A>
                                <U+271A>
                                <U+271C>
                                                                                                          <U+271B>
                                                                                                          <U+271A>

                         <U+270D><U+270E><U+270F><U+2711><U+2712><U+2713><U+270E><U+270D><U+2714> <U+2715><U+2711><U+2716><U+2717><U+270D><U+270E> <U+2712><U+2717><U+270F><U+2718><U+270E><U+270D><U+2719>
                         <U+2704><U+260E><U+2706><U+271D><U+271E><U+271F><U+260E><U+2720><U+260E><U+2721><U+261B> <U+261E><U+270C><U+260E><U+260E><U+261B>
                                    <U+2701><U+2702>
<removed-date>
                   <U+2724><U+2729>
                                         <U+2724><U+2725>
                                              <U+2724><U+2726>
<removed-apn>    <U+2724><U+2605>
                                                    <U+2724><U+2724>
                    <U+2724><U+2727>
               <U+271A><U+271B><U+271C><U+2722> <U+2723>
                         <U+270D><U+270E><U+270F><U+2711><U+2712><U+2713><U+270E><U+270D><U+2714> <U+2715><U+2711><U+2716><U+2717><U+270D><U+270E> <U+2712><U+2717><U+270F><U+2718><U+270E><U+270D><U+2719>

                            <U+2704><U+260E><U+2706><U+271D><U+271E><U+271F><U+260E><U+2720><U+260E><U+2721><U+261B> <U+261E><U+270C><U+260E><U+260E><U+261B>
                                    <U+2701><U+2702>
<removed-date>
<removed-apn>                          <U+2724>
                                        <U+2702>
                                                    <U+2702><U+2725>
              <U+2719>                                                      <U+2719>
              <U+270D>                                                      <U+270D>
              <U+270E>                                                      <U+270E>
              <U+2718>                                                      <U+2718>
              <U+270F>                                                      <U+270F>
              <U+2717>                                                      <U+2717>
              <U+2712>                                                      <U+2712>
              <U+270E>                                                      <U+270E>
              <U+270D>                                                      <U+270D>
              <U+2717>                                                      <U+2717>
              <U+2711><U+2716><U+2715>                                                    <U+2711><U+2716><U+2715>
              <U+2714>                                                      <U+2714>
              <U+270D>                                                      <U+270D>
              <U+270E>                                                      <U+270E>
              <U+2713>                                                      <U+2713>
              <U+2712><U+2711>                                                     <U+2712><U+2711>
              <U+270F>                                                      <U+270F>
              <U+270E>                                                      <U+270E>
              <U+270D>                                                      <U+270D>
                                                         <U+271C>
                                                             <U+2702>
                                            <U+271C>
                                                <U+2702>
                    <U+271A>
                        <U+2725>                                        <U+2701>
                                                                 <U+2729>
                                                                 <U+2605>
                                                                 <U+2727>
                                                                 <U+2726>

                                            <U+2704><U+260E><U+2706><U+271D><U+271E><U+271F><U+260E><U+2720><U+260E><U+2721><U+261B> <U+261E><U+270C><U+260E><U+260E><U+261B>
                                <U+2722>                          <U+2702><U+2701><U+2702>
<removed-date>
                                <U+271B>
                                               <U+2702>
                                               <U+2702>
<removed-apn>                                                                                                 <U+2729>
                                                                                                           <U+2605>
                                                                                                           <U+2727>
                                                                                                           <U+2726>
                                                           <U+2724>               <U+2724>
                                                               <U+2702>
                                                                               <U+2702>
              <U+2719>                                                                                                    <U+2719>
              <U+270D>                                                                                                    <U+270D>
              <U+270E>                                                                                                    <U+270E>
              <U+2718>                                                                                                    <U+2718>
              <U+270F>                                                                                                    <U+270F>
              <U+2717>                                                                                                    <U+2717>
              <U+2712>                                                        <U+2725>                                           <U+2712>
              <U+270E>                                                        <U+2702>
                                                                                                                   <U+270E>
              <U+270D>                                                                                                    <U+270D>
              <U+2717>                                                                                                    <U+2717>
              <U+2711><U+2716><U+2715>                                              <U+2725>                                                   <U+2711><U+2716><U+2715>
                                                               <U+2702>
              <U+2714>                                                                                                    <U+2714>
              <U+270D>                                                                                                    <U+270D>
              <U+270E>                                                                                                    <U+270E>
              <U+2713>                     <U+2722>                                                                              <U+2713>
              <U+2712><U+2711>                                                                                                   <U+2712><U+2711>
                                                               <U+2725>
                                        <U+2702>
              <U+270F>                                                <U+2702>
                                                                                                                   <U+270F>
              <U+270E>                                                                                                    <U+270E>
              <U+270D>                                                                                                    <U+270D>
                                                                                           <U+271C>
                                                                   <U+2725>                           <U+2702>
                                                                   <U+2702>
                    <U+2702>
                    <U+2725>
                                                               <U+2725>
                                                               <U+2702>
                                                                                                   <U+271B>
                                                                                                   <U+271B>
                                                                                   <U+271C>
                                                   <U+271B>                                   <U+2702>
                                                       <U+2702>
                                                                                                               <U+2702>
                                                                                                               <U+2702>
                        <U+271A>
                            <U+2725>
                                                                                                       <U+2702>
                                                                                                       <U+2702>

