                                         ABSTRACT
        Embodiments of the present invention provide a signal processing method and
   device. The method includes: selecting M sub-bands from N sub-bands, where the N
   sub-bands are obtained by dividing a spectral coefficient of a current frame of a signal,
 5 and a frequency band of the M sub-bands is lower than a frequency band of K
   sub-bands in the N sub-bands except the M sub-bands; determining, according to
   performance information of the M sub-bands, to perform a modification operation on
   original envelope values of the M sub-bands, where the performance information is
   used to indicate an energy characteristic and a spectral characteristic that are of the M
10 sub-bands; performing modification separately on the original envelope values of the
   M sub-bands, so as to acquire modified envelope values of the M sub-bands; and
   performing first bit allocation on the N sub-bands according to the modified envelope
   values of the M sub-bands and original envelope values of the K sub-bands. In the
   embodiments of the present invention, bit allocation better meets a bit requirement of
15 each sub-band, and therefore, signal encoding and decoding performance can be
   improved.

                                       1/3
                 Select M sub-bands from N sub-bands                    110
Determine, according to performance information of the M sub-bands,    120
to perform a modification operation on original envelope values of the
                              M sub-bands
Perform modification separately on the original envelope values of the
M sub-bands, so as to acquire modified envelope values of the M sub-   130
                                  bands
 Perform first-time bit allocation on the N sub-bands according to the
  modified envelope values of the M sub-bands and original envelope    140
                         values of K sub-bands
                                     FIG. 1

              SIGNAL PROCESSING METHOD AND DEVICE
                                     TECHNICAL FIELD
   [0001]      The present invention relates to the        signal processing field, and
   specifically, to a signal processing method and device.
 5                                     BACKGROUND
   [0002]      In current communication transmission, increasing attention is paid to
   quality of a voice signal or an audio signal; therefore, a requirement for signal
   encoding and decoding is increasingly high. In an existing frequency domain
   encoding algorithm, bit allocation is generally performed on each sub-band of a signal
10 directly according to a size of a frequency envelope, and then each sub-band is
   encoded by using a quantity of allocated bits. However, practice shows that, in these
   existing encoding algorithms, a sub-band of a low frequency band has relatively large
   impact on signal encoding quality; therefore, the sub-band of the low frequency band
   generally becomes a bottleneck of signal encoding performance. In addition, the
15 foregoing bit allocation manner cannot well adapt to a bit requirement of each
   sub-band, especially that of a sub-band of a low frequency band, which leads to
   relatively poor signal encoding performance. Correspondingly, signal decoding
   performance is also relatively poor.
                                         SUMMARY
20 [0003]      Embodiments of the present invention provide a signal processing method
   and device, which can improve signal encoding and decoding performance.
   [0004]      According to a first aspect, a signal processing method is provided,
   including: selecting M sub-bands from N sub-bands, where the N sub-bands are
   obtained by dividing a spectral coefficient of a current frame of a signal, a frequency
25 band of the M sub-bands is lower than a frequency band of K sub-bands in the N
   sub-bands except the M sub-bands, N is a positive integer greater than 1, both M and

   K are positive integers, and the sum of M and K is N; determining, according to
   performance information of the M sub-bands, to perform a modification operation on
   original envelope values of the M sub-bands, where the performance information is
   used to indicate an energy characteristic and a spectral characteristic that are of the M
 5 sub-bands; performing modification separately on the original envelope values of the
   M sub-bands, so as to acquire modified envelope values of the M sub-bands; and
   performing first bit allocation on the N sub-bands according to the modified envelope
   values of the M sub-bands and original envelope values of the K sub-bands.
   [0005]      With reference to the first aspect, in a first possible implementation
10 manner, the determining, according to performance information of the M sub-bands,
   to perform a modification operation on original envelope values of the M sub-bands
   includes:
               determining a first parameter according to original envelope values of the
   N sub-bands, where the first parameter indicates a concentration degree that is of
15 spectral energy of the signal and that is on the M sub-bands;
               determining a second parameter according to the original envelope values
   of the M sub-bands, where the second parameter indicates a degree of spectral
   fluctuation of the M sub-bands; and
               determining, in a case in which the first parameter falls within a first range
20 and the second parameter falls within a second range, to perform the modification
   operation on the original envelope values of the M sub-bands.
   [0006]      With reference to the first possible implementation manner of the first
   aspect, in a second possible implementation manner, the determining a first parameter
   according to original envelope values of the N sub-bands includes: determining total
25 energy of the M sub-bands according to the original envelope values of the M
   sub-bands; determining total energy of the K sub-bands according to the original
   envelope values of the K sub-bands; and determining a ratio of the total energy of the
   M sub-bands to the total energy of the K sub-bands as the first parameter.
   [0007]      With reference to the first possible implementation manner or the second
30 possible implementation manner of the first aspect, in a third possible implementation
   manner, the determining a second parameter according to the original envelope values
   of the M sub-bands includes: determining the total energy of the M sub-bands and
   energy of a first sub-band according to the original envelope values of the M
   sub-bands, where the energy of the first sub-band is the largest in that of the M
                                                2

   sub-bands; and determining a ratio of the energy of the first sub-band to the total
   energy of the M sub-bands as the second parameter.
   [0008]      With reference to the first aspect or any one of the foregoing
   implementation manners, in a fourth possible implementation manner, the performing
 5 modification separately on the original envelope values of the M sub-bands, so as to
   acquire modified envelope values of the M sub-bands includes: determining the total
   energy of the M sub-bands and the energy of the first sub-band according to the
   original envelope values of the M sub-bands, where the energy of the first sub-band is
   the largest in that of the M sub-bands; determining a modification factor according to
10 the total energy of the M sub-bands and the energy of the first sub-band; and
   performing modification separately on the original envelope values of the M
   sub-bands by using the modification factor, so as to acquire the modified envelope
   values of the M sub-bands.
   [0009]      With reference to the first aspect or any one of the foregoing
15 implementation manners, in a fifth possible implementation manner, a modified
   envelope value of each sub-band in the M sub-bands is greater than an original
   envelope value of the same sub-band.
   [0010]      With reference to the first aspect or any one of the foregoing
   implementation manners, in a sixth possible implementation manner, the method
20 further includes: determining a quantity of redundant bits of each sub-band in the N
   sub-bands according to quantities of bits respectively allocated to the N sub-bands
   during the first bit allocation, where the quantity of redundant bits of each sub-band in
   the N sub-bands is less than a quantity of bits required for encoding a single
   information unit in the same sub-band; determining a total quantity of redundant bits
25 according to the quantity of redundant bits of each sub-band in the N sub-bands; and
   performing second bit allocation on the N sub-bands according to the modified
   envelope values of the M sub-bands, the original envelope values of the K sub-bands,
   and the total quantity of redundant bits.
   [0011]      According to a second aspect, a signal processing device is provided,
30 including: a selection unit, configured to select M sub-bands from N sub-bands, where
   the N sub-bands are obtained by dividing a spectral coefficient of a current frame of a
   signal, a frequency band of the M sub-bands is lower than a frequency band of K
   sub-bands in the N sub-bands except the M sub-bands, N is a positive integer greater
   than 1, both M and K are positive integers, and the sum of M and K is N; a
                                                3

   determining unit, configured to determine, according to performance information of
   the M sub-bands, to perform a modification operation on original envelope values of
   the M sub-bands, where the performance information is used to indicate an energy
   characteristic and a spectral characteristic that are of the M sub-bands; a modification
 5 unit, configured to perform modification separately on the original envelope values of
   the M sub-bands, so as to acquire modified envelope values of the M sub-bands; and
   an allocation unit, configured to perform first bit allocation on the N sub-bands
   according to the modified envelope values of the M sub-bands and original envelope
   values of the K sub-bands.
10 [0012]      With reference to the second aspect, in a first possible implementation
   manner, the determining unit is specifically configured to: determine a first parameter
   according to original envelope values of the N sub-bands, where the first parameter
   indicates a concentration degree that is of spectral energy of the signal and that is on
   the M sub-bands; determine a second parameter according to the original envelope
15 values of the M sub-bands, where the second parameter indicates a degree of spectral
   fluctuation of the M sub-bands; and determine, in a case in which the first parameter
   falls within a first range and the second parameter falls within a second range, to
   perform the modification operation on the original envelope values of the M
   sub-bands.
20 [0013]      With reference to the first possible implementation manner of the second
   aspect, in a second possible implementation manner, the determining unit is
   specifically configured to: determine total energy of the M sub-bands according to the
   original envelope values of the M sub-bands; determine total energy of the K
   sub-bands according to the original envelope values of the K sub-bands; and
25 determine a ratio of the total energy of the M sub-bands to the total energy of the K
   sub-bands as the first parameter.
   [0014]      With reference to the first possible implementation manner or the second
   possible implementation manner of the second aspect, in a third possible
   implementation manner, the determining unit is specifically configured to: determine
30 the total energy of the M sub-bands and energy of a first sub-band according to the
   original envelope values of the M sub-bands, where the energy of the first sub-band is
   the largest in that of the M sub-bands; and determine a ratio of the energy of the first
   sub-band to the total energy of the M sub-bands as the second parameter.
   [0015]      With reference to the second aspect or any one of the foregoing
                                                4

   implementation     manners,    in a   fourth   possible  implementation   manner,    the
   modification unit is specifically configured to: determine the total energy of the M
   sub-bands and the energy of the first sub-band according to the original envelope
   values of the M sub-bands, where the energy of the first sub-band is the largest in that
 5 of the M sub-bands; determine a modification factor according to the total energy of
   the M sub-bands and the energy of the first sub-band; and perform modification
   separately on the original envelope values of the M sub-bands by using the
   modification factor, so as to acquire the modified envelope values of the M sub-bands.
   [0016]      With reference to the second aspect or any one of the foregoing
10 implementation manners, in a fifth possible implementation manner, a modified
   envelope value of each sub-band in the M sub-bands is greater than an original
   envelope value of the same sub-band.
   [0017]      With reference to the second aspect or any one of the foregoing
   implementation manners, in a sixth possible implementation manner, the determining
15 unit is further configured to determine a quantity of redundant bits of each sub-band
   in the N sub-bands according to quantities of bits respectively allocated to the N
   sub-bands during the first bit allocation, where the quantity of redundant bits of each
   sub-band in the N sub-bands is less than a quantity of bits required for encoding a
   single information unit in the same sub-band; the determining unit is further
20 configured to determine a total quantity of redundant bits according to the quantity of
   redundant bits of each sub-band in the N sub-bands; and the allocation unit is further
   configured to perform second bit allocation on the N sub-bands according to the
   modified envelope values of the M sub-bands, the original envelope values of the K
   sub-bands, and the total quantity of redundant bits.
25 [0018]      In the embodiments of the present invention, bit allocation is not directly
   performed according to original envelope values of N sub-bands; instead, M
   sub-bands of a low frequency band are selected from the N sub-bands, it is
   determined, according to an energy characteristic and a spectral characteristic that are
   of the M sub-bands, to perform a modification operation on original envelope values
30 of the M sub-bands, modification is performed separately on the original envelope
   values of the M sub-bands according to the original envelope values of the M
   sub-bands, and first bit allocation is performed on the N sub-bands according to
   modified envelope values of the M sub-bands and original envelope values of K
   sub-bands, so that bit allocation better meets a bit requirement of each sub-band, and
                                                5

   therefore, signal encoding and decoding performance can be improved.
                          BRIEF DESCRIPTION OF DRAWINGS
   [0019]      To describe the technical solutions in the embodiments of the present
   invention more clearly, the following briefly describes the accompanying drawings
 5 required for describing the embodiments of the present invention. Apparently, the
   accompanying drawings in the following description show merely some embodiments
   of the present invention, and persons of ordinary skill in the art may still derive other
   drawings from these accompanying drawings without creative efforts.
   [0020]      FIG. 1 is a schematic flowchart of a signal processing method according to
10 an embodiment of the present invention;
   [0021]      FIG. 2 is a schematic flowchart of a process of a signal processing method
   according to an embodiment of the present invention;
   [0022]      FIG. 3 is a schematic block diagram of a signal processing device
   according to an embodiment of the present invention; and
15 [0023]      FIG. 4 is a schematic block diagram of a signal processing device
   according to another embodiment of the present invention.
                           DESCRIPTION OF EMBODIMENTS
   [0024]      The following clearly describes the technical solutions in the embodiments
   of the present invention with reference to the accompanying drawings in the
20 embodiments of the present invention. Apparently, the described embodiments are
   some but not all of the embodiments of the present invention. All other embodiments
   obtained by persons of ordinary skill in the art based on the embodiments of the
   present invention without creative efforts shall fall within the protection scope of the
   present invention.
25 [0025]      A signal encoding technology and a signal decoding technology are widely
   applied to various electronic devices, such as a mobile phone, a wireless apparatus, a
   personal data assistant (Personal Data Assistant, PDA), a handheld or portable
   computer,    a Global Positioning      System (Global Positioning        System, GPS)
   receiver/navigation assistant, a camera, an audio/video player, a video camera, a video
30 recorder, and a monitoring device. Generally, such electronic devices include a voice
                                               6

   encoder or an audio encoder, and may further include a voice decoder or an audio
   decoder. The voice encoder or the audio encoder and the voice decoder or the audio
   decoder may be directly implemented by a digital circuit or a chip, such as a digital
   signal processor (Digital Signal Processor, DSP) chip, or may be implemented by a
 5 software code-driven processor by executing a procedure in software code.
   [0026]      FIG. 1 is a schematic flowchart of a signal processing method according to
   an embodiment of the present invention. The method in FIG. 1 is executed by an
   encoder side, such as the foregoing voice encoder or the foregoing audio encoder. The
   method in FIG. 1 may also be executed by a decoder side, such as the foregoing voice
10 decoder or the foregoing audio decoder.
   [0027]      In an encoding process, the encoder side may first transform a
   time-domain signal into a frequency-domain signal. For example, time-frequency
   transformation may be performed by using an algorithm such as fast Fourier
   transform (Fast Fourier Transform, FFT) or modified discrete cosine transform
15 (Modified Discrete Cosine Transform, MDCT). Then, a global gain may be used to
   perform normalization on a spectral coefficient of the frequency-domain signal, and
   division is performed on a normalized spectral coefficient so as to obtain multiple
   sub-bands.
   [0028]      In a decoding process, the decoder side may decode a bitstream received
20 from the encoder side to obtain a normalized spectral coefficient, and division is
   performed on the normalized spectral coefficient so as to obtain multiple sub-bands.
   [0029]       110. Select M sub-bands from N sub-bands, where the N sub-bands are
   obtained by dividing a spectral coefficient of a current frame of a signal, a frequency
   band of the M sub-bands is lower than a frequency band of K sub-bands in the N
25 sub-bands except the M sub-bands, N is a positive integer greater than 1, both M and
   K are positive integers, and the sum of M and K is N.
   [0030]      In this embodiment of the present invention, the signal may be a voice
   signal, or may be an audio signal. The foregoing K sub-bands are all sub-bands in the
   N sub-bands except the M sub-bands.
30 [0031]       120. Determine, according to performance information of the M
   sub-bands, to perform a modification operation on original envelope values of the M
   sub-bands, where the performance information is used to indicate an energy
   characteristic and a spectral characteristic that are of the M sub-bands.
   [0032]       130. Perform modification separately on the original envelope values of
                                                 7

   the M sub-bands, so as to acquire modified envelope values of the M sub-bands.
   [0033]       140. Perform first bit allocation on the N sub-bands according to the
   modified envelope values of the M sub-bands and original envelope values of the K
   sub-bands.
 5 [0034]      In this embodiment of the present invention, bit allocation is not directly
   performed according to original envelope values of N sub-bands; instead, M
   sub-bands of a low frequency band are selected from the N sub-bands, it is
   determined, according to an energy characteristic and a spectral characteristic that are
   of the M sub-bands, to perform a modification operation on original envelope values
10 of the M sub-bands, modification is performed separately on the original envelope
   values of the M sub-bands according to the original envelope values of the M
   sub-bands, and first bit allocation is performed on the N sub-bands according to
   modified envelope values of the M sub-bands and original envelope values of K
   sub-bands, so that bit allocation better meets a bit requirement of each sub-band, and
15 therefore, signal encoding and decoding performance can be improved.
   [0035]      Specifically, in an existing frequency domain encoding algorithm, bit
   allocation is performed on each sub-band of a signal directly according to a size of a
   frequency envelope. As a result, a quantity of allocated bits cannot well meet a bit
   requirement of some sub-bands of a low frequency band. However, in this
20 embodiment of the present invention, the M sub-bands of the low frequency band are
   first selected from the N sub-bands, it is determined, according to the energy
   characteristic and the spectral characteristic that are of the M sub-bands, to perform a
   modification operation on the original envelope values of the M sub-bands,
   modification is performed on the original envelope values of the M sub-bands
25 according to the original envelope values of the M sub-bands, and then the first bit
   allocation is performed on the N sub-bands according to the modified envelope values
   of the M sub-bands and the original envelope values of the K sub-bands. It may be
   learned that, in this embodiment of the present invention, bit allocation is not directly
   performed on the N sub-bands according to the original envelope values of the N
30 sub-bands. Instead, the energy characteristic and the spectral characteristic that are of
   the M sub-bands are used as considerations to determine that modification needs to be
   performed on the M sub-bands, so as to obtain the respective modified envelope
   values of the M sub-bands, and bit allocation is performed according to the modified
   envelope values of the sub-bands of the low frequency band and original envelope
                                                8

   values of other sub-bands, so that bit allocation performed on each sub-band is more
   proper, especially that performed on the M sub-bands of the low frequency band, and
   therefore, signal encoding and decoding performance can be improved.
   [0036]      After the spectral coefficient is divided to obtain the N sub-bands, an
 5 envelope of each sub-band may be calculated and quantized. Therefore, each
   sub-band has a quantized envelope value. It should be understood that an original
   envelope value is relative to a modified envelope value, and the original envelope
   value may refer to an initial envelope value of a sub-band, that is, a quantized
   envelope value obtained by calculation after sub-band division. An envelope value
10 obtained after the initial envelope value of the sub-band is modified is referred to as
   the modified envelope value. Therefore, in this embodiment of the present invention,
   both the mentioned original envelope value and modified envelope value refer to
   quantized envelope values.
   [0037]      Optionally, as an embodiment, in step 110, the M sub-bands may be
15 selected from the N sub-bands according to a harmonic characteristic of a sub-band
   and energy of a sub-band. For example, for the M sub-bands, harmonic strength of
   each sub-band may be greater than a preset strength threshold, and a ratio of energy of
   the sub-band to total energy of the N sub-bands is greater than a preset energy
   threshold. As mentioned above, sub-bands of a low frequency band are generally a
20 bottleneck of signal encoding performance. In these sub-bands, a sub-band that has a
   relatively strong harmonic characteristic and whose energy accounts for a specific
   proportion of total energy of all sub-bands is particularly a bottleneck of encoding
   performance. Therefore, after the M sub-bands are selected from the N sub-bands
   according to the harmonic characteristic of the sub-band and the energy of the
25 sub-band, and the original envelope values of the M sub-bands are modified, bit
   allocation performed on the M sub-bands is more proper, and therefore, signal
   encoding and decoding performance can be efficiently improved.
   [0038]      Optionally, as another embodiment, the N sub-bands may be arranged in
   ascending order of frequency bands. In this way, in step 110, the first M sub-bands
30 may be selected from the N sub-bands. In this embodiment, the M sub-bands are
   selected in ascending order of frequency bands, which can simplify an operation and
   improve signal processing efficiency.
   [0039]      Optionally, as another embodiment, in step 120, a first parameter may be
   determined according to the original envelope values of the N sub-bands, where the
                                               9

   first parameter may indicate a concentration degree that is of spectral energy of the
   signal and that is on the M sub-bands. A second parameter may be determined
   according to the original envelope values of the M sub-bands, where the second
   parameter indicates a degree of spectral fluctuation of the M sub-bands. In a case in
 5 which the first parameter falls within a first range and the second parameter falls
   within a second range, it may be determined to perform a modification operation on
   the original envelope values of the M sub-bands.
   [0040]      Specifically, the energy characteristic of the M sub-bands may be the
   concentration degree that is of the spectral energy of the signal and that is on the M
10 sub-bands, and the spectral characteristic of the M sub-bands may be the degree of
   spectral fluctuation of the M sub-bands.
   [0041]      The first range is related to energy of a sub-band, and may be preset. When
   the concentration degree that is of the spectral energy of the signal and that is on the
   M sub-bands is relatively low, it may indicate that a ratio of the M sub-bands to the N
15 sub-bands is small, and the encoding performance is not greatly affected. Therefore,
   there is no need to modify the original envelope values of the M sub-bands. When the
   concentration degree that is of the spectral energy of the signal and that is on the M
   sub-bands is relatively high, it indicates that the original envelope values of the M
   sub-bands are also relatively large. Therefore, a quantity of bits allocated to the M
20 sub-bands is enough for encoding, and there is also no need to modify the original
   envelope values of the M sub-bands. The first range may be predetermined by means
   of experimental simulation. For example, the first range may be preset to [1/6, 2/3].
   [0042]      The second range is related to a degree of spectral fluctuation of a
   sub-band, and may be preset. If the degree of spectral fluctuation of the M sub-bands
25 is low, the encoding performance is not greatly affected even if the quantity of bits
   allocated to the M sub-band is small. In this way, there is no need to modify the
   original envelope values of the M sub-bands. Therefore, the second range indicates
   that the degree of spectral fluctuation of the sub-bands is relatively high. The second
   range may be predetermined by means of experimental simulation. For example, the
                                              1                   1
30 second range may be preset to [0.575 *M'           o) or [ 0.5 *M ' oc). Generally, if in a
   signal, bandwidth that can be used for encoding is 0 to 4 KHz, the second range may
                       1
   be preset to [ 0.575 *M'     mo); if in a signal, bandwidth that can be used for encoding
                                                  10

                                                            1
   is 0 to 8 KHz, the second range may be preset to [ 0.5* M'      oo).
   [0043]       When the first parameter falls within the first range and the second
   parameter falls within the second range, it means that the concentration degree that is
   of the spectral energy of the signal and that is on the M sub-bands is neither extremely
 5 high nor extremely low, and that the degree of spectral fluctuation of the M sub-bands
   is relatively high, and modification may be performed on the original envelope values
   of the M sub-bands, so that bits allocated to the M sub-bands during the first bit
   allocation of the M sub-bands better meet a bit requirement of the M sub-bands. For
   example, for each sub-band in the M sub-bands, a modified envelope value is greater
10 than an original envelope value. Then, compared with performing first bit allocation
   according to the original envelope values of the M sub-bands, performing first bit
   allocation according to the modified envelope values of the M sub-bands makes a
   quantity of bits allocated to the M sub-bands be larger, and therefore, encoding
   performance of the M sub-bands can be improved.
15 [0044]       It may be learned that, in this embodiment, the first parameter and the
   second parameter that are determined according to the original envelope values of the
   N sub-bands may reflect a characteristic of each frequency band. Therefore, in a case
   in which the first parameter falls within the first range and the second parameter falls
   within the second range, it is determined to perform a modification operation on the
20 original envelope values of the M sub-bands, so that when bit allocation is
   subsequently performed according to the modified envelope values of the M
   sub-bands, a quantity of bits allocated to the M sub-bands better meets a bit
   requirement of the M sub-bands, and therefore, signal encoding and decoding
   performance can be improved.
25 [0045]       Optionally, as another embodiment, in step 120, total energy of the M
   sub-bands may be determined according to the original envelope values of the M
   sub-bands. Total energy of the K sub-bands may be determined according to the
   original envelope values of the K sub-bands. A ratio of the total energy of the M
   sub-bands to the total energy of the K sub-bands may be determined as the first
30 parameter.
   [0046]       Specifically, the ratio of the total energy of the M sub-bands to the total
   energy of the K sub-bands may be determined as the first parameter.
   [0047]       For example, the first parameter may be obtained by calculation according
                                                 11

   to the following equations, where the first parameter may be represented by a:
                a =
                       EPK
                            M-1                N-M-1
                EP,      =  XJEp, ,l    EK         Ep    I
                                     E,
                                bandP wit                  band energy,
                   E,,,,        Kbnd _width,         E, = 2"
                                             , and     "                , where
 5                Pm may represent the total energy of the M sub-bands, EPK             may
   represent the total energy of the K sub-bands, bandwidthmay represent bandwidth
   of the ith sub-band, and band energy, may represent energy of the ith sub-band.
   band energy may represent an original envelope value of the ith sub-band. For
   example, the original envelope value bandenergyj of the ith sub-band may be
10 obtained according to a spectral coefficient of the ith sub-band. For example,
   band energy, may be obtained according to the following equations:
                band_ energy = log E, and
                                        2
                         bandwidth,
                Ei =            taudi4j]*taudi4j]
   [0048]      It should be understood that persons skilled in the art can apparently make
15 various equivalent modifications or changes according to the foregoing equations, to
   obtain the first parameter, and such modifications or changes also fall within a scope
   of this embodiment of the present invention.
   [0049]      Optionally, as another embodiment, in step 120, according to the original
   envelope values of the M sub-bands, total energy of the M sub-bands may be
20 determined, and energy of a first sub-band may be determined, where the energy of
   the first sub-band is the largest in that of the M sub-bands. A ratio of the energy of the
   first sub-band to the total energy of the M sub-bands may be determined as the second
   parameter.
   [0050]      Specifically, the degree of spectral fluctuation of the M sub-bands may be
25 indicated by using a fluctuation degree of the original envelope values of the M
   sub-bands. For example, the second parameter may be obtained by calculation
   according to the following equations, where the second parameter may be represented
                                                   12

   by '8:
                      13P =ea EmPapea
                       E      , and E, ,eak = max(Ep     te, 0  ,                   , where
                for calculation manners of EP-""Pi and EPm , reference may be made to
   the foregoing equations.
 5 [0051]       It should be understood that persons skilled in the art can apparently make
   various equivalent modifications or changes according to the foregoing equations, to
   obtain the second parameter, and such modifications or changes also fall within a
   scope of this embodiment of the present invention.
   [0052]       Optionally, as another embodiment, in step 130, total energy of the M
10 sub-bands and energy of a first sub-band may be determined according to the original
   envelope values of the M sub-bands, where the energy of the first sub-band is the
   largest in that of the M sub-bands. A modification factor may be determined according
   to the total energy of the M sub-bands and the energy of the first sub-band. Then,
   modification may be performed separately on the original envelope values of the M
15 sub-bands by using the modification factor, so as to acquire the modified envelope
   values of the M sub-bands.
   [0053]       For example, the modification factor may be determined according to the
   following equations, where the modification factor may be represented by 7:
                 y= min(1.2,7 0 *   P-peakM  )
                                       E P14   , and 70 =0.575, where
20              for calculation manners of EP-""Pi and EP- , reference may be made to
   the foregoing equations.
   [0054]       Modification may be performed on an original envelope value of each
   sub-band in the M sub-bands according to the modification factor 7. For example,
   the original envelope value of each sub-band may be multiplied by the modification
25 factor, so as to obtain a modified envelope value of the sub-band.
   [0055]       It should be understood that persons skilled in the art can apparently make
   various equivalent modifications or changes according to the foregoing equations, to
   obtain the modification factor, and such modifications or changes also fall within a
   scope of this embodiment of the present invention.
30 [0056]       Optionally, as another embodiment, in step 130, a modified envelope value
                                                 13

   of each sub-band in the M sub-bands may be greater than an original envelope value
   of the sub-band.
   [0057]      Specifically, the modified envelope value of each sub-band in the M
   sub-bands is obtained by performing modification on the original envelope value of
 5 each sub-band in the M sub-bands. The modified envelope value of each sub-band
   may be greater than the original envelope value of the sub-band. If the modified
   envelope value of each sub-band in the M sub-bands is greater than the original
   envelope value of the sub-band, in step 140, bit allocation is performed according to
   the modified envelope values of the M sub-bands. In this way, a quantity of bits
10 allocated to each sub-band in the M sub-bands increases, so that the bit allocation
   better meets a bit requirement of each sub-band, and therefore, signal encoding and
   decoding performance can be improved.
   [0058]      Optionally, as another embodiment, in step 130, a modified envelope value
   of each sub-band in the M sub-bands may be less than an original envelope value of
15 the sub-band.
   [0059]      Specifically, if the modified envelope value of each sub-band in the M
   sub-bands is less than the original envelope value of the sub-band, in step 140, bit
   allocation is performed according to the modified envelope values of the M sub-bands
   and original envelope values of the K sub-bands. In this way, a quantity of bits
20 allocated to each sub-band in the M sub-bands is relatively small, and accordingly,
   quantities of bits respectively allocated to the K sub-bands increase, so that the bit
   allocation better meets a bit requirement of each sub-band, and therefore, signal
   encoding and decoding performance can be improved.
   [0060]      Optionally, as another embodiment, in step 130, first bit allocation may be
25 performed on the N sub-bands in descending order of envelope values.
   [0061]      Optionally, as another embodiment, in step 130, a modification factor may
   be determined according to the second parameter. Then, modification may be
   performed separately on the original envelope values of the M sub-bands by using the
   modification factor, so as to acquire the modified envelope values of the M sub-bands.
30 [0062]      Specifically, the modification factor may be determined according to the
   second parameter. Modification may be performed on an original envelope value of
   each sub-band in the M sub-bands according to the modification factor. For example,
   the original envelope value of each sub-band may be multiplied by the modification
   factor to obtain a modified envelope value of the sub-band, so that a quantity of bits
                                               14

   allocated to the M sub-bands better meets a bit requirement of the M sub-bands, and
   therefore, signal encoding and decoding performance can be improved.
   [0063]      After the first bit allocation is performed, generally, there are redundant
   bits in bits allocated to each sub-band. Redundant bits of each sub-band are not
 5 enough for encoding one information unit of the sub-band. Therefore, quantities of
   redundant bits of all sub-bands may be counted to obtain a total quantity of redundant
   bits, and then second bit allocation is performed.
   [0064]      Optionally, as another embodiment, after step 140, a quantity of redundant
   bits of each sub-band in the N sub-bands may be determined according to quantities
10 of bits respectively allocated to the N sub-bands during the first bit allocation, where
   the quantity of redundant bits of each sub-band in the N sub-bands is less than a
   quantity of bits required for encoding in the same sub-band. A total quantity of
   redundant bits may be determined according to the quantity of redundant bits of each
   sub-band in the N sub-bands. Then, second bit allocation may be performed on the N
15 sub-bands according to the total quantity of redundant bits.
   [0065]      Specifically, total redundant bits may be equally allocated to the N
   sub-bands. In this way, redundant bits may be reused, so as to avoid a waste of bits
   and further improve signal encoding and decoding performance.
   [0066]      The foregoing describes a process of first bit allocation and second bit
20 allocation. If the foregoing method in FIG. 1 is executed by an encoder side, after the
   second bit allocation, the encoder side may quantize a spectral coefficient of each
   sub-band by using a quantity of bits allocated to each sub-band in a process of the two
   times bit allocation, write an index of a quantized spectral coefficient and an index of
   an original envelope value of each sub-band into a bitstream, and then send the
25 bitstream to a decoder side.
   [0067]      If the foregoing method in FIG. 1 is executed by a decoder side, after the
   second bit allocation, the decoder side may decode a quantized spectral coefficient by
   using a quantity of bits allocated to each sub-band in a process of the two times bit
   allocation, so as to obtain a recovered signal.
30 [0068]      The following describes embodiments of the present invention in detail
   with reference to specific examples. It should be understood that, these examples are
   merely intended to help persons skilled in the art better understand the embodiments
   of the present invention, but are not intended to limit the scope of the embodiments of
   the present invention.
                                                15

   [0069]       In the following examples, an encoder side is used as an example for
   description.
   [0070]       FIG. 2 is a schematic flowchart of a process of a signal processing method
   according to an embodiment of the present invention.
 5 [0071]       201. An encoder side performs time-frequency transformation on a
   time-domain signal.
   [0072]       202. The encoder side divides a spectral coefficient of a frequency-domain
   signal into N sub-bands, where N is a positive integer greater than 1.
   [0073]       Specifically, the encoder side may calculate a global gain; the global gain
10 is used to perform normalization on an original spectral coefficient; then, division is
   performed on a normalized spectral coefficient so as to obtain all sub-bands.
   [0074]       203. The encoder side obtains an original envelope value of each sub-band
   by means of a calculation operation and a quantization operation.
   [0075]       204. The encoder side selects M sub-bands from the N sub-bands, where
15 M is a positive integer.
   [0076]       A frequency band of the M sub-bands is lower than a frequency band of K
   sub-bands in the N sub-bands except the M sub-bands, where K is a positive integer,
   and the sum of K and M is N.
   [0077]       205. The encoder side determines a first parameter according to original
20 envelope values of the M sub-bands and original envelope values of K sub-bands.
   [0078]       The first parameter may indicate a concentration degree that is of spectral
   energy of the signal and that is on the M sub-bands. For example, a ratio of total
   energy of the M sub-bands to total energy of the K sub-bands may be used to indicate
   the first parameter. For a calculation manner of the first parameter, reference may be
25 made to the calculation manner of the first parameter in the embodiment of FIG. 1,
   and details are not described again.
   [0079]       206. The encoder side determines a second parameter according to the
   original envelope values of the M sub-bands.
   [0080]       The second parameter may indicate a degree of spectral fluctuation of the
30 M sub-bands. For example, a ratio of energy of a first sub-band to the total energy of
   the M sub-bands may be used to indicate the second parameter, where the energy of
   the first sub-band is the largest in that of the M sub-bands. For a calculation manner of
   the second parameter, reference may be made to the calculation manner of the second
   parameter in the embodiment of FIG. 1, and details are not described again.
                                                  16

   [0081]      207. The encoder side determines whether the first parameter falls within a
   first range and the second parameter falls within a second range.
   [0082]      The first range and the second range may be preset. For example, the first
                                                                                  1
   range may be preset to [1/6, 2/3]. The second range may be preset to [ 0.575 *M'       Go)
            1
 5 or[0.5*M 'm)
   [0083]      208. If the encoder side determines that the first parameter falls within the
   first range and the second parameter falls within the second range in step 207, modify
   the original envelope values of the M sub-bands according to the original envelope
   values of the M sub-bands, so as to obtain modified envelope values of the M
10 sub-bands.
   [0084]      Specifically, the encoder side may determine a modification factor
   according to the original envelope values of the M sub-bands. For a calculation
   manner of the modification factor, reference may be made to the process in the
   embodiment of FIG. 1, and details are not described again. The encoder side may
15 perform modification on an original envelope value of each sub-band in the M
   sub-bands by using the modification factor, so as to obtain the modified envelope
   values of the M sub-bands. For example, a modified envelope value of each sub-band
   may be greater than the original envelope value of the sub-band.
   [0085]      209. The encoder side performs first bit allocation on the N sub-bands
20 according to the modified envelope values of the M sub-bands and the original
   envelope values of the K sub-bands.
   [0086]      For example, the encoder side may perform first bit allocation on the N
   sub-bands in descending order of envelope values. For the M sub-bands, because the
   modified envelope value of each sub-band is greater than the original envelope value
25 of the sub-band, compared with a quantity of allocated bits before modification, a
   quantity of bits allocated to each sub-band in the M sub-bands increases, so that bit
   allocation better meets a bit requirement of each sub-band, thereby improving signal
   encoding and decoding performance.
   [0087]      210. The encoder side performs second bit allocation on the N sub-bands.
30 [0088]      Specifically, the encoder side may determine a quantity of redundant bits
   of each sub-band according to a quantity of bits allocated to each sub-band in the N
   sub-bands after the first bit allocation and bandwidth of each sub-band, so as to
                                              17

   determine a total quantity of redundant bits of the N sub-bands. Then, total redundant
   bits are equally allocated to the N sub-bands according to the total quantity of
   redundant bits.
   [0089]      211. The encoder side quantizes a spectral coefficient of each sub-band
 5 according to a quantity of bits allocated to each sub-band in the N sub-bands.
   [0090]      212. The encoder side writes a bitstream according to a quantized spectral
   coefficient obtained in step 211 and an original envelope value of each sub-band.
   [0091]      Specifically, the encoder side may write indexes of the quantized spectral
   coefficient, the original envelope value of each sub-band, and the like into the
10 bitstream. For a specific process, reference may be made to the prior art, and details
   are not described herein again.
   [0092]      213. If the encoder side determines that the first parameter falls outside the
   first range or the second parameter falls outside the second range in step 207, the
   encoder side performs first bit allocation on the N sub-bands according to original
15 envelope values of the N sub-bands.
   [0093]      For example, the encoder side may perform first bit allocation on the N
   sub-bands in descending order of envelope values.
   [0094]      214. The encoder side performs second bit allocation on the N sub-bands.
   [0095]      Specifically, the encoder side may determine a quantity of redundant bits
20 of each sub-band according to a quantity of bits allocated to each sub-band in the N
   sub-bands after the first bit allocation and bandwidth of each sub-band, so as to
   determine a total quantity of redundant bits of the N sub-bands. Then, total redundant
   bits are equally allocated to the N sub-bands according to the total quantity of
   redundant bits.
25 [0096]      215. The encoder side quantizes a spectral coefficient of each sub-band
   according to a quantity of bits allocated to each sub-band in the N sub-bands.
   [0097]      216. The encoder side writes a bitstream according to a quantized spectral
   coefficient obtained in step 215 and an original envelope value of each sub-band.
   [0098]      Specifically, the encoder side may write indexes of the quantized spectral
30 coefficient, the original envelope value of each sub-band, and the like into the
   bitstream. For a specific process, reference may be made to the prior art, and details
   are not described herein again.
   [0099]      In this embodiment of the present invention, in a case in which a first
   parameter falls within a first range and a second parameter falls within a second
                                                18

   range, modification is performed on original envelope values of M sub-bands of a low
   frequency band according to the original envelope values of the M sub-bands, and
   first bit allocation is performed on N sub-bands according to modified envelope
   values of the M sub-bands and original envelope values of K sub-bands, so that bit
 5 allocation better meets a bit requirement of each sub-band, and therefore, signal
   encoding and decoding performance can be improved.
   [0100]       FIG. 3 is a schematic block diagram of a signal processing device
   according to an embodiment of the present invention. A device 300 in FIG. 3 may be
   an encoder side device or a decoder side device. The device 300 in FIG. 3 includes a
10 selection unit 310, a determining unit 320, a modification unit 330, and an allocation
   unit 340.
   [0101]       The selection unit 310 selects M sub-bands from N sub-bands, where the
   N sub-bands are obtained by dividing a spectral coefficient of a current frame of a
   signal, a frequency band of the M sub-bands is lower than a frequency band of K
15 sub-bands in the N sub-bands except the M sub-bands, N is a positive integer greater
   than 1, both M and K are positive integers, and the sum of M and K is N. The
   determining unit 320 determines, according to performance information of the M
   sub-bands, to perform a modification operation on original envelope values of the M
   sub-bands, where the performance information is used to indicate an energy
20 characteristic and a spectral characteristic that are of the M sub-bands. The
   modification unit 330 performs modification separately on the original envelope
   values of the M sub-bands, so as to acquire modified envelope values of the M
   sub-bands. The allocation unit 340 performs first bit allocation on the N sub-bands
   according to the modified envelope values of the M sub-bands and original envelope
25 values of the K sub-bands.
   [0102]       In this embodiment of the present invention, bit allocation is not directly
   performed according to original envelope values of N sub-bands; instead, M
   sub-bands of a low frequency band are selected from the N sub-bands, it is
   determined, according to an energy characteristic and a spectral characteristic that are
30 of the M sub-bands, to perform a modification operation on original envelope values
   of the M sub-bands, modification is performed separately on the original envelope
   values of the M sub-bands according to the original envelope values of the M
   sub-bands, and first bit allocation is performed on the N sub-bands according to
   modified envelope values of the M sub-bands and original envelope values of K
                                               19

   sub-bands, so that bit allocation better meets a bit requirement of each sub-band, and
   therefore, signal encoding and decoding performance can be improved.
   [0103]      Optionally, as an embodiment, the determining unit 320 may determine a
   first parameter according to original envelope values of the N sub-bands, where the
 5 first parameter indicates a concentration degree that is of spectral energy of the signal
   and that is on the M sub-bands. The determining unit 320 may determine a second
   parameter according to the original envelope values of the M sub-bands, where the
   second parameter indicates a degree of spectral fluctuation of the M sub-bands. The
   determining unit 320 may determine, in a case in which the first parameter falls
10 within a first range and the second parameter falls within a second range, to perform
   the modification operation on the original envelope values of the M sub-bands.
   [0104]      Optionally, as another embodiment, the determining unit 320 may
   determine total energy of the M sub-bands according to the original envelope values
   of the M sub-bands, may determine total energy of the K sub-bands according to the
15 original envelope values of the K sub-bands, and may determine a ratio of the total
   energy of the M sub-bands to the total energy of the K sub-bands as the first
   parameter.
   [0105]      Optionally, as another embodiment, the determining unit 320 may
   determine total energy of the M sub-bands and energy of a first sub-band according to
20 the original envelope values of the M sub-bands, where the energy of the first
   sub-band is the largest in that of the M sub-bands. The determining unit 320 may
   determine a ratio of the energy of the first sub-band to the total energy of the M
   sub-bands as the second parameter.
   [0106]      Optionally, as another embodiment, the modification unit 330 may
25 determine total energy of the M sub-bands and energy of a first sub-band according to
   the original envelope values of the M sub-bands, where the energy of the first
   sub-band is the largest in that of the M sub-bands. The modification unit 330 may
   determine a modification factor according to the total energy of the M sub-bands and
   the energy of the first sub-band, and may perform modification separately on the
30 original envelope values of the M sub-bands by using the modification factor, so as to
   acquire the modified envelope values of the M sub-bands.
   [0107]      Optionally, as another embodiment, a modified envelope value of each
   sub-band in the M sub-bands may be greater than an original envelope value of the
   same sub-band.
                                              20

   [0108]      Optionally, as another embodiment, the determining unit 320 may further
   determine a quantity of redundant bits of each sub-band in the N sub-bands according
   to quantities of bits respectively allocated to the N sub-bands during the first bit
   allocation, where the quantity of redundant bits of each sub-band in the N sub-bands
 5 is less than a quantity of bits required for encoding a single information unit in the
   same sub-band. The determining unit 320 may further determine a total quantity of
   redundant bits according to the quantity of redundant bits of each sub-band in the N
   sub-bands. The allocation unit 340 may further perform second bit allocation on the N
   sub-bands according to the modified envelope values of the M sub-bands, the original
10 envelope values of the K sub-bands, and the total quantity of redundant bits.
   [0109]      For other functions and operations of the device 300, reference may be
   made to the processes of the method embodiments in FIG. 1 and FIG. 2. To avoid
   repetition, details are not described herein again.
   [0110]      FIG. 4 is a schematic block diagram of a signal processing device
15 according to another embodiment of the present invention. A device 400 in FIG. 4
   may be an encoder side device or a decoder side device. The device 400 in FIG. 4
   includes a memory 410 and a processor 420.
   [0111]      The memory 410 may include a random access memory, a flash memory, a
   read-only memory, a programmable read-only memory, a non-volatile memory, a
20 register, or the like. The processor 420 may be a central processing unit (Central
   Processing Unit, CPU).
   [0112]      The memory 410 is configured to store an executable instruction. The
   processor 420 may execute the executable instruction stored in the memory 410, so as
   to: select M sub-bands from N sub-bands, where the N sub-bands are obtained by
25 dividing a spectral coefficient of a current frame of a signal, a frequency band of the
   M sub-bands is lower than a frequency band of K sub-bands in the N sub-bands
   except the M sub-bands, N is a positive integer greater than 1, both M and K are
   positive integers, and the sum of M and K is N; determine, according to performance
   information of the M sub-bands, to perform a modification operation on original
30 envelope values of the M sub-bands, where the performance information is used to
   indicate an energy characteristic and a spectral characteristic that are of the M
   sub-bands; perform modification separately on the original envelope values of the M
   sub-bands, so as to acquire modified envelope values of the M sub-bands; and
   perform first bit allocation on the N sub-bands according to the modified envelope
                                                21

   values of the M sub-bands and original envelope values of the K sub-bands.
   [0113]      In this embodiment of the present invention, bit allocation is not directly
   performed according to original envelope values of N sub-bands; instead, M
   sub-bands of a low frequency band are selected from the N sub-bands, it is
 5 determined, according to an energy characteristic and a spectral characteristic that are
   of the M sub-bands, to perform a modification operation on original envelope values
   of the M sub-bands, modification is performed separately on the original envelope
   values of the M sub-bands according to the original envelope values of the M
   sub-bands, and first bit allocation is performed on the N sub-bands according to
10 modified envelope values of the M sub-bands and original envelope values of K
   sub-bands, so that bit allocation better meets a bit requirement of each sub-band, and
   therefore, signal encoding and decoding performance can be improved.
   [0114]      Optionally, as an embodiment, the processor 420 may determine a first
   parameter according to original envelope values of the N sub-bands, where the first
15 parameter indicates a concentration degree that is of spectral energy of the signal and
   that is on the M sub-bands. The processor 420 may determine a second parameter
   according to the original envelope values of the M sub-bands, where the second
   parameter indicates a degree of spectral fluctuation of the M sub-bands. The processor
   420 may determine, in a case in which the first parameter falls within a first range and
20 the second parameter falls within a second range, to perform the modification
   operation on the original envelope values of the M sub-bands.
   [0115]      Optionally, as another embodiment, the processor 420 may determine total
   energy of the M sub-bands according to the original envelope values of the M
   sub-bands, may determine total energy of the K sub-bands according to the original
25 envelope values of the K sub-bands, and may determine a ratio of the total energy of
   the M sub-bands to the total energy of the K sub-bands as the first parameter.
   [0116]      Optionally, as another embodiment, the processor 420 may determine total
   energy of the M sub-bands and energy of a first sub-band according to the original
   envelope values of the M sub-bands, where the energy of the first sub-band is the
30 largest in that of the M sub-bands. The processor 420 may determine a ratio of the
   energy of the first sub-band to the total energy of the M sub-bands as the second
   parameter.
   [0117]      Optionally, as another embodiment, the processor 420 may determine total
   energy of the M sub-bands and energy of a first sub-band according to the original
                                              22

   envelope values of the M sub-bands, where the energy of the first sub-band is the
   largest in that of the M sub-bands. The processor 420 may determine a modification
   factor according to the total energy of the M sub-bands and the energy of the first
   sub-band, and may perform modification separately on the original envelope values of
 5 the M sub-bands by using the modification factor, so as to acquire the modified
   envelope values of the M sub-bands.
   [0118]      Optionally, as another embodiment, a modified envelope value of each
   sub-band in the M sub-bands may be greater than an original envelope value of the
   same sub-band.
10 [0119]      Optionally, as another embodiment, the processor 420 may further
   determine a quantity of redundant bits of each sub-band in the N sub-bands according
   to quantities of bits respectively allocated to the N sub-bands during the first bit
   allocation, where the quantity of redundant bits of each sub-band in the N sub-bands
   is less than a quantity of bits required for encoding a single information unit in the
15 same sub-band. The processor 420 may further determine a total quantity of redundant
   bits according to the quantity of redundant bits of each sub-band in the N sub-bands.
   The processor 420 may further perform second bit allocation on the N sub-bands
   according to the modified envelope values of the M sub-bands, the original envelope
   values of the K sub-bands, and the total quantity of redundant bits.
20 [0120]      For other functions and operations of the device 400, reference may be
   made to the processes of the method embodiments in FIG. 1 and FIG. 2. To avoid
   repetition, details are not described herein again.
   [0121]      Persons of ordinary skill in the art may be aware that, in combination with
   the examples described in the embodiments disclosed in this specification, units and
25 algorithm steps may be implemented by electronic hardware or a combination of
   computer software and electronic hardware. Whether the functions are performed by
   hardware or software depends on particular applications and design constraint
   conditions of the technical solutions. Persons skilled in the art may use different
   methods to implement the described functions for each particular application, but it
30 should not be considered that the implementation goes beyond the scope of the
   present invention.
   [0122]      It may be clearly understood by persons skilled in the art that, for the
   purpose of convenient and brief description, for a detailed working process of the
   foregoing system, apparatus, and unit, reference may be made to a corresponding
                                                23

   process in the foregoing method embodiments, and details are not described herein
   again.
   [0123]      In the several embodiments provided in the present application, it should
   be understood that the disclosed system, apparatus, and method may be implemented
 5 in other manners. For example, the described apparatus embodiment is merely
   exemplary. For example, the unit division is merely logical function division and may
   be other division in actual implementation. For example, a plurality of units or
   components may be combined or integrated into another system, or some features
   may be ignored or not performed. In addition, the displayed or discussed mutual
10 couplings or direct couplings or communication connections may be implemented by
   using some interfaces. The indirect couplings or communication connections between
   the apparatuses or units may be implemented in electronic, mechanical, or other
   forms.
   [0124]      The units described as separate parts may or may not be physically
15 separate, and parts displayed as units may or may not be physical units, may be
   located in one position, or may be distributed on a plurality of network units. Some or
   all of the units may be selected according to actual needs to achieve the objectives of
   the solutions of the embodiments.
   [0125]      In addition, functional units in the embodiments of the present invention
20 may be integrated into one processing unit, or each of the units may exist alone
   physically, or two or more units are integrated into one unit.
   [0126]      When the functions are implemented in the form of a software functional
   unit and sold or used as an independent product, the functions may be stored in a
   computer-readable storage medium. Based on such an understanding, the technical
25 solutions of the present invention essentially, or the part contributing to the prior art,
   or some of the technical solutions may be implemented in a form of a software
   product. The computer software product is stored in a storage medium, and includes
   several instructions for instructing a computer device (which may be a personal
   computer, a server, a network device, or the like) to perform all or some of the steps
30 of the methods described in the embodiments of the present invention. The foregoing
   storage medium includes: any medium that can store program encode, such as a USB
   flash drive, a removable hard disk, a read-only memory (ROM, Read-Only Memory),
   a random access memory (RAM, Random Access Memory), a magnetic disk, or an
   optical disc.
                                               24

  [0127]      The foregoing descriptions are merely specific implementation manners of
  the present invention, but are not intended to limit the protection scope of the present
  invention. Any variation or replacement readily figured out by persons skilled in the
  art within the technical scope disclosed in the present invention shall fall within the
5 protection scope of the present invention. Therefore, the protection scope of the
  present invention shall be subject to the protection scope of the claims.
                                              25

                                           CLAIMS
   1. A method for processing an audio signal, wherein a frame of the audio signal
   comprises N frequency sub-bands, the method comprising:
            determining, according to an energy attribute value and a spectral attribute
 5 value of a first subset of the N sub-bands of a current frame of the audio signal,
   whether to adjust quantized energy envelopes of the sub-bands in the first subset,
   wherein the first subset has M sub-bands and a second subset has K sub-bands, the
   first subset and the second subset have no overlap in frequency, both M and K are
   positive integers, and N=M+K;
10          based on a determination that the quantized energy envelopes of the M
   sub-bands in the first subset need to be adjusted, adjusting the quantized energy
   envelopes of the M sub-bands in the first subset individually to obtain adjusted energy
   envelopes of the M sub-bands;
            based on the adjusted energy envelopes of the M sub-bands in the first subset
15 and energy envelope information of the K sub-bands in the second subset, allocating
   encoding bits for the N sub-bands of the current frame, wherein each of the N
   sub-bands is either having encoding bits allocated or not having any encoding bits
   allocated;
            quantizing spectral coefficients of each sub-band that has encoding bits
20 allocated; and
            writing the quantized spectral coefficients of the sub-bands that have encoding
   bits allocated into a bitstream.
   2. The method according to claim 1, wherein the energy attribute value of the       first
25 subset is determined according to quantized energy envelopes of the N sub-bands.
   3. The method according to claim 2, wherein the energy attribute value of the first
   subset is determining by:
            obtaining a sum of the quantized energy envelopes of the M sub-bands in the
30 first subset;
            obtaining a sum of the quantized energy envelopes of the K sub-bands in the
   second subset; and
                                               26

           calculating a ratio of the sum of the quantized energy envelopes of the M
   sub-bands to the sum of the quantized energy envelopes of the K sub-bands, wherein
   the ratio represents the energy attribute value of the first subset.
 5 4. The method according to claim 1, wherein the spectral attribute value of the first
   subset is determined according to the quantized energy envelopes of the M sub-bands
   in the first subset.
   5. The method according to claim 4, wherein the spectral attribute value of the first
10 subset is determined by:
           obtaining a sum of the quantized energy envelopes of the M sub-bands in the
   first subset; and
           calculating a ratio of a quantized energy envelope of a first sub-band in the
   first subset to the sum of the quantized energy envelopes of the M sub-bands in the
15 first subset, wherein the ratio represents the spectral attribute value of the first subset,
   and wherein the quantized energy envelope of the first sub-band is the largest among
   the M sub-bands in the first subset.
   6. The method according to claim 1, wherein when the energy attribute value of the
20 first subset falls within a first range, and the spectral attribute value of the first subset
   falls within a second range, determining to adjust the quantized energy envelopes of
   the M sub-bands in the first subset.
   7. The method according to claim 6, wherein the energy attribute value of the first
25 subset is represented by a ratio of a sum of the quantized energy envelopes of the M
   sub-bands in the first subset to a sum of the quantized energy envelopes of the K
   sub-bands in the second subset, and the first range is [1/6, 2/3].
   8. The method according to claim 6, wherein when an encoded bandwidth of the
30 audio signal is 0 to 4 KHz, the spectral attribute value of the first subset is represented
   by a ratio of an quantized energy envelope of a first sub-band in the first subset to a
   sum of the quantized energy envelopes of the M sub-bands in the first subset, wherein
   the quantized energy envelope of the first sub-band is the largest among the M
                                                 27

                                                                 1
   sub-bands in the first subset, and the second range is [             , o).
                                                            0.575 *M
   9. The method according to claim 6, wherein when an encoded bandwidth of the
   audio signal is 0 to 8 KHz, the spectral attribute value of the first subset is represented
 5 by a ratio of an quantized energy envelope of a first sub-band in the first subset to a
   sum of the quantized energy envelopes of the M sub-bands in the first subset, wherein
   the quantized energy envelope of the first sub-band is the largest among the M
                                                                1
   sub-bands in the first subset, and the second range is [          , oo).
                                                            0.5*M
10 10. The method according to claim 1, wherein adjusting the quantized energy
   envelopes of the M sub-bands in the first subset individually to obtain adjusted energy
   envelopes of the M sub-bands comprises:
         determining, according to a sum of the quantized energy envelopes of the M
   sub-bands in the first subset and a quantized energy envelope of a first sub-band in the
15 first subset, an adjustment factor for each of the M sub-bands in the first subset,
   wherein the quantized energy envelope of the first sub-band is the largest among the
   M sub-bands in the first subset; and
         adjusting the quantized energy envelopes of the M sub-bands in the first subset
   individually using the adjustment factors, to obtain the adjusted energy envelopes of
20 the M sub-bands in the first subset.
   11. The method according to claim 1, wherein an adjusted energy envelope of each
   sub-band in the first subset is greater than a quantized energy envelope of the same
   sub-band.
25
   12. The method according to claim 1, wherein the energy envelope information of the
   K sub-bands in the second subset comprises energy envelopes of the K sub-bands in
   the second subset, and wherein an energy envelope of a sub-band of the second subset
   is either a quantized energy envelope or an energy envelope that is obtained by
30 adjusting the quantized energy envelope.
   13. A device for processing an audio signal, wherein a frame of the audio signal
                                               28

   comprises N frequency sub-bands, the device comprising:
         a memory for storing program instructions; and
         a processor operatively coupled to the memory,
         wherein, by executing the program instructions, the processor is configured to:
 5          determine, according to an energy attribute value and a spectral attribute value
   of a first subset of the N sub-bands of a current frame of the audio signal, whether to
   adjust quantized energy envelopes of the sub-bands in the first subset, wherein the
   first subset has M sub-bands and a second subset has K sub-bands, the first subset and
   the second subset have no overlap in frequency, both M and K are positive integers,
10 and N=M+K;
            based on a determination that the quantized energy envelopes of the M
   sub-bands in the first subset need to be adjusted, adjust the quantized energy
   envelopes of the M sub-bands in the first subset individually to obtain adjusted energy
   envelopes of the M sub-bands;
15          based on the adjusted energy envelopes of the M sub-bands in the first subset
   and energy envelope information of the K sub-bands in the second subset, allocate
   encoding bits for the N sub-bands of the current frame, wherein each of the N
   sub-bands is either having encoding bits allocated or not having any encoding bits
   allocated;
20          quantize spectral coefficients of each sub-band that has encoding bits allocated;
   and
            write the quantized spectral coefficients of the sub-bands that have encoding
   bits allocated into a bitstream.
25 14. The device according to claim 13, wherein the energy attribute value of the first
   subset is determined according to quantized energy envelopes of the N sub-bands.
   15. The device according to claim 14, wherein in determining the energy attribute
   value of the first subset, the processor, by executing the program instructions, is
30 configured:
            obtain a sum of the quantized energy envelopes of the M sub-bands in the first
   subset;
            obtain a sum of the quantized energy envelopes of the K sub-bands in the
   second subset; and
                                                29

           calculate a ratio of the sum of the quantized energy envelopes of the M
   sub-bands to the sum of the quantized energy envelopes of the K sub-bands, wherein
   the ratio represents the energy attribute value of the in the first subset.
 5 16. The device according to claim 13, wherein the spectral attribute value of the first
   subset is determined according to the quantized energy envelopes of the M sub-bands
   in the first subset.
   17. The device according to claim 16, wherein in determining the spectral attribute
10 value of the first subset, the processor, by executing the program instructions, is
   configured to:
           obtain a sum of the quantized energy envelopes of the M sub-bands in the first
   subset; and
           calculate a ratio of a quantized energy envelope of a first sub-band in the first
15 subset to the sum of the quantized energy envelopes of the M sub-bands in the first
   subset, wherein the ratio represents the spectral attribute value of the first subset, and
   wherein the quantized energy envelope of the first sub-band is the largest among the
   M sub-bands in the first subset.
20 18. The device according to claim 13, wherein when the energy attribute value of the
   first subset falls within a first range, and the spectral attribute value of the first subset
   falls within a second range, the processor determines to adjust the quantized energy
   envelopes of the M sub-bands in the first subset.
25 19. The device according to claim 18, wherein the energy attribute value of the first
   subset is represented by a ratio of a sum of the quantized energy envelopes of the M
   sub-bands in the first subset to a sum of the quantized energy envelopes of the K
   sub-bands in the second subset, and the first range is [1/6, 2/3].
30 20. The device according to claim 18, wherein when an encoded bandwidth of the
   audio signal is 0 to 4 KHz, the spectral attribute value of the first subset is represented
   by a ratio of an quantized energy envelope of a first sub-band in the first subset to a
   sum of the quantized energy envelopes of the M sub-bands in the first subset, wherein
   the quantized energy envelope of the first sub-band is the largest among the M
                                                 30

                                                                 1
   sub-bands in the first subset, and the second range is [             , o).
                                                            0.575 *M
   21. The device according to claim 18, wherein when an encoded bandwidth of the
   audio signal is 0 to 8 KHz, the spectral attribute value of the first subset is represented
 5 by a ratio of an quantized energy envelope of a first sub-band in the first subset to a
   sum of the quantized energy envelopes of the M sub-bands in the first subset, wherein
   the quantized energy envelope of the first sub-band is the largest among the M
                                                                1
   sub-bands in the first subset, and the second range is [          , oo).
                                                            0.5*M
10 22. The device according to claim 13, wherein in adjusting the quantized energy
   envelopes of the M sub-bands in the first subset individually to obtain adjusted energy
   envelopes of the M sub-bands, the processor, by executing the program instructions, is
   configured to:
         determine, according to a sum of the quantized energy envelopes of the M
15 sub-bands in the first subset and a quantized energy envelope of a first sub-band in the
   first subset, an adjustment factor for each of the M sub-bands in the first subset,
   wherein the quantized energy envelope of the first sub-band is the largest among the
   M sub-bands in the first subset; and
         adjust the quantized energy envelopes of the M sub-bands in the first subset
20 individually using the adjustment factors, to obtain the adjusted energy envelopes of
   the M sub-bands in the first subset.
   23. The device according to claim 13, wherein an adjusted energy envelope of each
   sub-band in the first subset is greater than a quantized energy envelope of the same
25 sub-band.
         24. The device according to claim 13, wherein the energy envelope information
   of the K sub-bands in the second subset comprises energy envelope of the K
   sub-bands in the second subset, and wherein an energy envelope of a sub-band of the
30 second subset is either a quantized energy envelope or an energy envelope that is
   obtained by adjusting the quantized energy envelope.
                                               31

                                                  1/3
<removed-date>
                                                                                       110
                             Select M sub-bands from N sub-bands
              Determine, according to performance information of the M sub-bands,      120
              to perform a modification operation on original envelope values of the
                                          M sub-bands
<removed-apn>
              Perform modification separately on the original envelope values of the
              M sub-bands, so as to acquire modified envelope values of the M sub-     130
                                             bands
              Perform first-time bit allocation on the N sub-bands according to the
              modified envelope values of the M sub-bands and original envelope        140
                                      values of K sub-bands
                                                FIG. 1

                                                         2/3
<removed-date>
                            Time-domain signal
                                                               201
                      Time-frequency transformation
                                                               202
                             Divide sub-bands
<removed-apn>
                                                               203
                      Obtain original envelope values
                                                               204
                            Select M sub-bands
                                  205                                 206
              Determine a first                   Determine a
                 parameter                     second parameter
                                      Does the             207
                            first parameter fall within              No
                    a first range and the second parameter
                                fall within a second
                                       range?
                                         Yes                    208                                 213
                   Obtain modified envelope values of the                    First bit allocation
                               M sub-bands
                                                                                                    214
                                                                 209
                             First bit allocation                           Second bit allocation
                                                                                                    215
                                                                 210
                            Second bit allocation                           Quantize a spectral
                                                                               coefficient
                                                                 211                                216
                       Quantize a spectral coefficient
                                                                             Write a bitstream
                                                                 212
                             Write a bit stream
                                                    FIG. 2

                                              3/3
<removed-date>
              Selection unit   Determining      Modification      Allocation   300
                   310          unit 320         unit 330          unit 340
                                             FIG. 3
<removed-apn>
                                                                   400
                               Memory                 Processor
                                410                      420
                                             FIG. 4

