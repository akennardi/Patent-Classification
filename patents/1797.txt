                                          ABSTRACT
Some embodiments relate to a method for quantifying, during pacemapping, a comparison of a
BSPM of interest to a pace site BSPM. The method may include receiving at a computing device
a plurality of ECG signals from an acquisition system. The pace site BSPM may be calculated
using the plurality of ECG signals. The BSPM of interest may be compared to the pace site
BSPM, by: retrieving the BSPM of interest from memory accessible by the computing device;
and, calculating one or more comparison metrics for the BSPM of interest as compared to the
pace site BSPM. An indication of similarity between the BSPM of interest and the pace site
BSPM based on the comparison metric calculated may be displayed on a user interface in
communication with the computing device.

                        Figure 1
                               140_1
                                     110_1
          Patient                    110_2                 Acquisition System                       Computing
                                                                                                        Device
               100                                                     120
                                     110 N                                                                130
                                   140_N
                                  r                        y g
  -1                                            --                             F  ---             -2           -. 1 -0 21
          ----       ~~
                   16 -71    ~         ~   2 5r--   6                                      3    1
-     -                                                      -- -          -3       -,2                -2
                                                4       --                    41
                  Figur                                      2    7-0               -   -  9
    -   -          1         6   43 +9
                                                                      4                   e4
                                                                                 1/12
                      i~ ~ ~ ~~    "DC ~   ~      ~  '   ~ ~ ~ ~ W~ ' 'FE~~ 0                'ML    LK
                                     r "               yig
               Figure                    2
                                IL1/12

    COMPUTER-AIDED LOCALIZATION OF SITE OF ORIGIN OF CARDIAC
                     ACTIVATION WITH DISCRIMINATOR LEADS
This application is a divisional application of Australian Patent Application No 2014210346, the
contents of which are incorporated herein by reference.
Field of the Invention
[0001]    The present invention relates to computer-aided localization of site of origin of cardiac
activation for catheter ablation.
Background of the Invention
[0002]    Ventricular tachycardia (VT) is one of the most difficult management challenges in
clinical cardiac electrophysiology. The spectrum of ventricular arrhythmias spans a wide
range of clinical presentations that include premature ventricular complexes (PVCs), non
sustained ventricular tachycardia (NSVT), sustained ventricular tachycardia (VT) and
ventricular fibrillation (VF). Any of these presentations can occur in patients with or without
structural heart disease. This spectrum applies to any source of
tachycardia originating below the His bundle whether from the bundle branches, Purkinje
fibers or ventricular myocardium.
[0003]    VT most commonly occurs in the setting of structural heart disease, such as
coronary artery disease, heart failure, cardiomyopathy, congenital heart disease or following
cardiac surgery. Prior myocardial infarction (MI) is by far the most common cause of
sustained VT. Ventricular tachyarrhythmia associated with MI occurs in two stages. During
the acute phase of MI, polymorphic ventricular tachycardia that can degenerate into
ventricular fibrillation is most common. On the other hand, sustained monomorphic VT
generally arises from the anatomic substrate of a healed MI that usually develops within 2
weeks after an MI and remains indefinitely. This substrate of healthy and damaged
myocardium interlaced with fibrous tissue is found primarily at the border zone of the scar.
Fibrosis creates areas of conduction block and increases the separation of myocyte bundles,
slowing conduction through myocyte pathways in the border zone of the infarct thus creating
a substrate that supports re-entry when an appropriate trigger occurs. With present
management of MI, the incidence of sustained
                                                -1-

post-infarction VT is low, and fewer than 5% of acute MI survivors have inducible
ventricular tachycardia when studied early after the acute event. VT exits the scar into the
healthy myocardium and depolarizes the myocardium sequentially from this exit site. The
location of the exit is responsible for the morphology of the ECG signal.
[00041   Sustained monomorphic VT occurring in the absence of structural or electrical
heart disease is called idiopathic VT. Idiopathic VT can arise from different sites, but the
right ventricular outflow tract (most commonly within 1-2 cm of the pulmonary valve) is
by far the most common and accounts for approximately 10% of VTs seen by specialized
arrhythmia services. Other potential sites include the left ventricular outflow tract, aortic
sinuses of Valsalva (most commonly left) from a crescent of ventricular epicardium
underlying the base of the sinus at the aortoventricular junction, in the endocardium
adjacent to the mitral annulus and finally from the left ventricular epicardium remote
from the sinuses of Valsalva, at sites adjacent to the coronary vasculature. These
idiopathic VTs usually have a focal origin caused by triggered activity or abnormal
automaticity.
[00051 Suppression of VT may be accomplished with the use of implantable
cardioverter-defibrillators (ICDs), anti-arrhythmic drugs, arrhythmia surgery and catheter
ablation. While antiarrhythmic drugs are considered first line therapy and are commonly
used to complement therapy, they are not completely effective in preventing VT episodes
and may cause significant cardiac and non-cardiac side-effects. ICD is the only treatment
modality that has been demonstrated to offer a significant reduction in mortality in
patients with scar-related VT. Although implantable cardioverter-defibrillators (ICDs)
can improve the prognosis for patients with VT, recurrent VT can still be life-threatening.
Catheter ablation offers a curative treatment for certain types of idiopathic VT and has
been suggested to have a benefit for patients who have suffered prior MI in many case
studies.
[0006J   Cardiac mapping refers to all procedures involving recording of body-surface
electrocardiograms or endocardial/epicardial electrograms generated due to the spread of
the cardiac action potential. This can be recorded from the body surface using either
                                             -2-

conventional 12-lead electrocardiogram (ECG) or multiple leads (such as for body
surface potential mapping (BSPM)), the endocardium or the epicardium. Cardiac
mapping provides a means of visualizing the pathophysiological mechanisms underlying
ventricular tachycardia, which is crucial for directing catheter ablation procedures.
[00071   Several conventional and advanced mapping techniques are frequently utilized to
accomplish a successful catheter ablation. However, many of these mapping techniques
are hampered by either hemodynamic instability or non-sustained nature of some
tachycardias.
[00081 Conventional endocardial mapping techniques with catheters placed
percutaneously into the heart chambers continue to be the most popular cardiac mapping
modality. These catheters are localized and navigated using fluoroscopy. Several
conventional mapping techniques have been developed over the last few decades to help
understanding the mechanisms of arrhythmias and to guide catheter ablation. These
conventional mapping techniques include activation mapping, pacemapping and
entrainment mapping.
[00091 Pacemapping is a commonly used tool for mapping non-sustained or
hemodynamically unstable VT; it is based upon the principle that activation of the heart
from a given site will yield a reproducible body surface electrocardiogram (ECG)
morphology and that pacing from a site very close to the site at which VT activates the
heart (i.e. the site of origin) will result in a matching ECG morphology. However, this
technique has some limitations. Comparison of the 12-lead ECG morphology between a
pace-map and clinical tachycardia is frequently completely subjective or semi
quantitative. Discrepancies in ablation results may result, in part, from subjective
differences in the opinion of a pace-map match to the clinical tachycardia. Another
important limitation is that increasing the strength to pace diseased tissues, as in scar
related VT, can excite tissues more distant to the area of stimulation (even if unipolar
pacing is used) which may lead to a 12/12 match even 1-1.5 cm away from successful
ablation sites. This technique is therefore very time consuming and is limited by
                                                 -3-

imperfect accuracy and spatial resolution, subjectivity of interpretation, and by the need
for an intuitive interpretation of the ECG to direct catheter manipulation.
[00101 BSPM incorporates data from a much larger number of electrodes, but remains
limited by the remote location of the recording site from the cardiac surface resulting in
poor spatial resolution of electrical events. The recent development of
electrocardiographic imaging (ECGI) represents a further refinement of this technique,
combining BSPM and heart torso geometric information to produce detailed electro
anatomical maps of the epicardial surface through application of inverse solution
mathematical algorithms. This methodology has permitted accurate localization of focal
activation sources, as well as detailed activation sequences during re-entrant arrhythmias.
ECGI was recently used to assist in the diagnosis and guiding catheter ablation of focal
idiopathic as well as scar related VT. A number of limitations are still under
investigation, the most important being the accuracy, but also the complexity of the
procedure and the need for a long processing time from electrocardiographic signal
acquisition to 3D display of the derived epicardial potentials.
[00111 There is therefore a need for a system that assists in the localization of the site of
origin.
Brief Description of the Drawings
[00121 In drawings which illustrate by way of example only a preferred embodiment of
the invention,
[00131 Figure 1 is a schematic diagram of a computer-aided localization system.
100141 Figure 2 is a schematic diagram of an arrangement of 120 leads on the torso for
body surface potential mapping. The left half of the grid represents anterior surface and
right half represents the posterior surface of the chest. Transverse levels (labeled 1',
2... 10') are 1-inch apart from neck to waist; potentials at 352 nodes (unlabelled solid
squares) are interpolated from potentials recorded at 120 sites (numbered circles); squares
labelled 'g' indicate sites of precordial leads V1-V6; squares labelled 'y' mark sites
                                              -4-

where electrodes of Mason-Likar substitution for extremity leads are placed; squares
labelled 'r' are sites of the EASI leads.
[00151 Figure 3 is an illustration of a 17-segment model of the left ventricle on a
circumferential polar plot and the nomenclature for assignments of the CARTO points to
anatomical locations. Diagram of vertical long-axis (VLA, 2-chamber view), horizontal
long-axis (HLA, 4-chamber view), and short-axis (SA) planes showing the name,
location, and anatomic landmarks for selection of the basal, mid-cavity, and apical short
axis slices for the recommended 17-segment system.
[00161 Figure 4 is a block diagram for identifying the segment of the heart in which the
activation site of origin is likely located.
100171 Figure 5 is a block diagram for displaying an objective measure of the similarity
between an BSPM of interest and a pace site BSPM.
[00181 Figure 6 shows 12-lead QRS integral templates for 16 endocardial segments. ECG
leads on the abscissa in each of the 16 panels are ordered in Cabrera sequence (aVL, I,
aVR, II, aVF, III) followed by precordial leads (VI to V6). Dark-grey (red) bars indicate
positive QRS integrals while light-grey (green) bars indicate negative QRS integrals.
[00191 Figure 7 shows 12-lead 100 msec QRS integral templates for 16 endocardial
segments. ECG leads on the abscissa in each of the 16 panels are ordered in Cabrera
sequence (aVL, I, -aVR, II, aVF, Ill) followed by precordial leads (VI to V6). Dark-grey
(red) bars indicate positive QRS integrals while light-grey (green) bars indicate negative
QRS integrals.
100201 Figure 8 shows recorded 120-lead QRS integral body surface potential map
templates for 16 endocardial segments. The left side of each map corresponds to the front
and the right side corresponds to the back of the chest. ECG leads V1-V6 are identified
by the black dots. Areas 410 and 400 of the maps represent positive and negative
integrals, respectively, whereas the white line 420 marks the zero integral. The locations
of the positive/negative extremes (maxima/minima) are indicated by white dots in areas
                                             -5-

410 and 400, respectively, and their amplitudes are expressed in mVms in the upper left
and upper right of the map respectively. The isointegral lines are separated by
automatically determined linear incremental steps that depend on the magnitude of the
maxima and the minima and is, for display clarity, restricted to an upper limit of 15
contour lines per map.
[00211 Figure 9 shows recorded 120-lead 100 msec QRS integral body surface potential
map templates for 16 endocardial segments. Note the similar morphology to the QRS
BSPM templates with lower amplitudes of the maxima and minima.
[00221 Figure 10 shows predicted QRS integral BSPM templates from 12-leads ECG by
using regression coefficients for 16 endocardial segments. Note the similar morphology
to the recorded BSPM and the difference in the values of the maxima and minima.
[00231 Figure 11 shows predicted initial 100 msec QRS integral BSPM templates from
12-lead ECG by using regression coefficients for 16 endocardial segments. Note the
similar morphology to the recorded BSPM and the difference in the values of the maxima
and minima.
[00241 Figure 12 shows 12-lead 100 msec QRS integral templates for 16 endocardial
segments with application of initial discriminator leads II and V4. Part A indicates
templates obtained selectively from those patterns that feature a positive QRS integral in
leads II and V4. Part B indicates templates with a positive QRS integral in lead II and
negative in lead V4. Part C indicates templates with a negative QRS integral in lead II
and positive in lead V4. Part D indicates templates with a negative QRS integral in leads
 I and V4.
[00251 Figure 13 depicts a bull's eye display of a left-ventricular endocardium. The
three-dimensional endocardial surface is modelled on a realistic representation of the
human heart and is represented by 238 planar triangles within 16 anatomical segments
and projected onto a polar display. There are six basal segments (1-6), six mid-segments
(7-12), and 4 apical segments denoted as anterior (1 and 7), anteroseptal (2, 8, and 13),
                                            -6-

inferoseptal (3, 9, and 14), inferior (4 and 10), inferolateral (5, 11, and 15), and
anterolateral (6, 12, and 16).
[00261 Figure 14 indicates high-resolution localization of the activation site. Localization
of left ventricular pacing site is illustrated in a 16-segment model (top left and right) with
probable activation site identified by arrow pointing to the white triangle (top-left) and
circle (top right). The initial 120-ms interval of the QRS is identified (bottom left) on
ECG tracings of 8 frontal-plane leads and 6 precordial leads of the standard 12-lead ECG.
Location of the actual pacing site (white dot) as indicated using a CARTOTM
electroanatomical map (bottom right) is also shown.
Detailed Description of the Invention
100271 In one embodiment, there is provided a method for localizing an activation site of
origin to a segment of the heart comprising: comparing a body surface potential map
(BSPM) of interest to each BSPM template of a pre-determined set of B SPM templates,
the set comprising one BSPM template for each pre-defined segment of the heart,
wherein the BSPM of interest is calculated based on a plurality of simultaneously
recorded electrocardiographic (ECG) signals and wherein comparing comprises, for each
BSPM template of the set of BSPM templates: retrieving a BSPM template from
memory; and calculating one or more comparison metrics for the BSPM template
retrieved as compared to the BSPM of interest, wherein each of the BSPM templates was
generated by averaging BSPMs of all pacing sites within the associated segment of the
heart from a collection of BSPMs stored in memory; identifying the BSPM template that
most closely resembles the BSPM of interest using the comparison metrics calculated in
order to identify the segment of the heart in which the activation site of origin is likely to
be located.
[00281 In further aspects of this embodiment, each of the BSPMs stored in memory
represent a pre-determined number of ECG signals; at least one or more estimated
BSPMs of the BSPMs stored in memory were calculated from a different number of ECG
signals than the pre-determined number; and/or calculation of the one or more estimated
BSPMs comprises interpolating between the different number of ECG signals by
                                                -7-

application of coefficients pre-derived from a collection of BSPMs each representing the
pre-determined number of ECG signals.
[00291 In another embodiment, there is provided a method for quantifying, during
pacemapping, a comparison of a BSPM of interest to a pace site BSPM, the method
comprising: receiving at a computing device a plurality of ECG signals from an
acquisition system; calculating the pace site BSPM using the plurality of ECG signals;
comparing the BSPM of interest to the pace site BSPM, wherein comparing comprises:
retrieving the BSPM of interest from memory accessible by the computing device; and
calculating one or more comparison metrics for the BSPM of interest as compared to the
pace site BSPM; and displaying on a user interface in communication with the computing
device an indication of similarity between the BSPM of interest and the pace site BSPM
based on the comparison metric calculated.
[00301 The present invention provides a system and method for localizing activation sites
of origin, such as VT exit site or site of origin. The site of origin may first be localized to
a segment or segments of the heart by comparing a BSPM of interest, such as a BSPM
calculated from a plurality of ECG signals recorded simultaneously during VT, to BSPM
templates, one template for each pre-defined segment of the heart.
[00311 Each BSPM template may be derived from a library collection of BSPMs
calculated from ECG measurements captured from many patients. The BSPM template
for a heart segment may be calculated by computing the mean or average of the
corresponding library BSPMs associated with a pacing site within the corresponding
heart segment.
[0032]  The library BSPMs of the collection may each be calculated directly from a pre
determined number of previously recorded ECG signals from a patient ("recorded
BSPMs"). Where a patient has been measured using a different number of ECG signals,
an "estimated BSPM" may be calculated by interpolating between the different number
of ECG signals recorded from the patient.
                                              - 8-

[0033J  The interpolation may use coefficients, such as regression coefficients, pre
derived from a collection of recorded BSPMs to generate the estimated BSPM from
integrals of ECG signals recorded from a different number of ECG signals than the pre
determined number of ECG signals used to generate the recorded BSPMs. In an aspect,
the different number of ECG signals may comprise a smaller number of ECG signals than
the pre-determined number.
[00341 In an aspect, the BSPM of interest may also be calculated from a smaller number
of ECG signals (i.e., a reduced set of ECG leads) by using either general or patient
specific regression coefficients. Localization of the activation site of origin may be
further facilitated during pacemapping by providing an objective measure of the
similarity of the BSPM of interest to a pace site BSPM. The similarity between these
BSPMs may be quantified by calculating waveform-comparison metrics.
[00351 As illustrated in Figure 1, body surface potentials may be acquired using an
acquisition system 120 such as a BioSemi Tm Mark-6. An array of electrodes
140_1... 140_N (collectively 140) placed on the patient's torso may be connected via
shielded cables or leads 110_1... 110_N to the acquisition system 120. The plurality of
surface electrodes 140 may, for example, comprise one hundred and twenty disposable
radiolucent Ag/AgCl FoxMed       m surface electrodes. Figure 2 illustrates one possible
arrangement of 120 leads on the torso for body surface potential mapping.
Electrocardiographic signals (ECG signals) are simultaneously recorded using Wilson
central terminal as reference. The acquisition system 120 may transmit digitized signals
to computing device 130, such as a general purpose personal computer, for data display
and recording. The signals may be transmitted through a fibre optic cable to the
computing device 130. Data may be recorded to memory such as a hard drive of the
computer. In one embodiment, the acquisition system 120 samples each channel at at
least 250 Hz and preferably at 2000 Hz, and digitizes the ECG signals with at least 16-bit
resolution. The analog ECG signals may be amplified and filtered by an antialiasing
bandpass filter (e.g., 0.025 to 300 Hz). The raw data files may be recorded for 15-30
seconds during abnormal rhythm, sinus rhythm or paced rhythm. Faulty signals (e.g., due
                                             -9-

to poor electrode-skin contact, motion artifacts, inaccessibility of the chest area where the
electrodes were supposed to be placed, etc.) may be rejected by the operator. ECG signals
recorded for BSPMs may include the standard 12 leads and/or the X,Y,Z leads.
[00361 The computing device 130 comprises a memory module and/or has access to
memory in which the recorded ECG signals, collection of BSPMs, set or library of BSPM
templates and/or coefficients for interpolation are stored. The computing device 130 also
comprises and/or is in communication with a user interface, such as a display.
[00371 For activation sites in the left ventricle of the heart, segments of the heart may be
defined using electroanatomical maps of the left ventricle. For example, the left ventricle
may be divided into 16 segments. The left ventricular cavity may be divided along its
longitudinal axis into three equal portions; basal, mid-cavity and apical. The basal and
mid portions can be divided into 6 segments. The circumferential segments in the basal
and mid-cavity may be anterior, anteroseptal, inferoseptal, inferior, inferolateral and
anterolateral. Since the left ventricle tapers as it approaches the apex, the apical segment
can be divided to 4 segments only: e.g. apical anterior, apical septal, apical inferior and
apical lateral or alternatively, apical anteroseptal, apical inferoseptal, apical anterolateral
and apical inferolateral. This 16-segment model is a modification from the 17-segment
model of Cerqueira et al. ["Standardized myocardial segmentation and nomenclature for
topographic imaging of the heart", Circulation 2002; 105:539-42] (shown in Figure 3)
due to the absence of an endocardial representative of segment 17 (myocardial cap at the
LV apex). The location of each endocardial pacing site or VT origin/exit site may be
projected visually from a CARTOTM map to its corresponding location on a polar
projection of the left ventricle.
[00381 In one embodiment, recorded BSPMs are calculated by selecting a beat from
stored recordings of ECG signals and calculating QRS time integrals for each lead. The
QRS time integral is calculated for each lead as the algebraic sum of all potentials from
the time instant of QRS onset to QRS offset multiplied by the sampling interval. In
another embodiment, the time integral may be calculated for a specified duration, such as
the initial 100 msec of the QRS.
                                              - 10 -

[0039J Estimated BSPMs may be calculated from ECG signals collected through a
different number of leads than used for the recorded BSPMs. In an aspect, the different
number corresponds to a reduced set of leads. The coefficients used for this calculation
may be general regression coefficients derived from a collection or database of BSPMs
or, alternatively, patient-specific coefficients derived from BSPMs recorded for the same
patient in a pre-procedure session. In another embodiment, data from a set of 32 leads
may be used. The anatomical sites for these 32 leads may be pragmatically selected based
on accessibility of the sites, coverage of the standard 12-lead and X, Y and Z sites,
configuration of available strips of electrodes, etc. Alternatively, sites for a given number
of electrodes may be selected that are calculated to be optimal using regression analysis
on a collection of BSPMs. As for the recorded BSPMs, the integrals may be calculated
for QRS onset to QRS offset or for a specified duration, such as the initial 100 msec of
the QRS.
100401 The use of estimated BSPMs greatly simplifies ECG data acquisition during
ablation procedure, while maintaining high localization accuracy of BSPMs.
[00411 For patient-specific localization, a regression model may be used. As an example,
data from 12-lead ECG for the patient using a plurality of pacing sites may be captured,
with coordinates of the pacing site known from a electroanatomical map, such as from
CARTOTM . The regression coefficients may then be determined using a least-squares
solution when integrals for each pacing site are determined. More specifically, using
parameters Vi to Vk (where k = 8 for the standard 12-lead ECG and k = 3 for
vectorcardiogram (VCG)) to indicate the QRS-integrals derived from the patient's 12
lead ECG or 3-lead VCG for at least (k+ 1) pacing sites having coordinates Xj, Yj and Zj
forj = 1 to k+1 obtain for example from a CARTOTM system, the least-square regression
can be used to determine patient-specific coefficients, aj,  si and yi, for i = 0 to k to the
equations for multiple regression with intercept as indicated in the following equations.
At least k+1 pacing sites are needed for a non-singular system to solve.
    a. X; = 00 +          aiV ;
                                              - 11 -

    b. Y =fio +Zi=1$jVi ;
    c. Z;=fO+V=1fiVi
[00421 In an aspect, two leads, termed discriminator leads, may be selected as initial
discriminators. The QRS integrals for each of the discriminator leads may be identified as
being either positive or negative. For two discriminator leads, this leads to four possible
conditions or states: positive-positive; positive-negative; negative-positive; and negative
negative. For each condition, 16 templates may be generated, one for each of the 16
segments, resulting in 64 templates in total. The use of these condition-specific templates
improves the accuracy of the matching as the matching is done on a smaller set of
templates.
[00431 The 16 templates associated with each of the conditions are prepared using
averaging integrals from pacing sites within that segment that have the associated states
for the discriminator leads.
[00441 The states of the discriminator leads, defined as one of the four possible
conditions, may then be matched to the BSPM of interest and the BSPM of interest can
be matched to the BSPM templates for that state. The BSPM of interest may be a full set
of body surface potential mapping date, such as 120 ECG signals, or a smaller set of ECG
signals, typically from either 12 or more leads.
[00451 With reference to Figure 12, panels A, B, C and D each show a set of 12 lead
ECG templates for 16 endocardial segments and a particular choice of discriminator
leads. Each panel is associated with one of the four possible conditions. For example,
Part A depicts 12-lead ECG templates obtained selectively from those patterns that
feature a positive QRS integral in both leads II and V4. The templates indicated under
"Apical" show null or minimal values which indicates that if both leads II and V4 are
positive in a BSPM of interest, there is a low probability that the pacing site is in the
apical or apex of the heart.
                                            -  12 -

[0046J   In an aspect, leads II and V4 may be used as discriminator leads. Each
combination of 12-lead ECG pairs was analyzed to identify optimal localization
accuracy. Using leads II and V4 as discriminator leads, the inventors obtained a superior
improvement in the mean accuracy for identification of first, first/second and
first/second/third segments. With reference to Figure 12, 12-lead ECG QRS integral
templates are shown for positive and negative conditions of leads II and V4.
[00471 In an aspect, leads I and aVF may be used as discriminator leads. The positive or
negative values of these leads can be used to determine the quadrant in the frontal plane
of the mean electric axis of the QRS complex.
[00481 BSPM templates or patterns for each segment are calculated by averaging the
integrals of all pacing sites within that segment, i.e. averaging all BSPMs for that
segment, to obtain a mean BSPM map of the selected interval for each segment.
Examples of 120-lead BSPM templates based on recorded BSPMs are shown in Figures 8
and 9, Figure 8 for the interval from QRS onset to QRS offset and Figure 9 for the initial
100 msec of the QRS. Examples of 120-lead BSPM templates based entirely on BSPMs
estimated from the 12-lead ECG by using general regression coefficients are shown in
Figures 10 and 11, Figure 10 for the interval from QRS onset to QRS offset and Figure
11 for the initial 100 msec of the QRS. In the examples of Figures 8 to 11, isointegral
lines or contours in areas 410 and 400 represent positive and negative integrals,
respectively. These areas 410 and 400 are separated by a white line or contour 420
representing the zero integral. In an alternative embodiment, BSPM templates may be
based on a combination of recorded BSPMs and estimated BSPMs.
[00491 Figures 6 and 7 illustrate 12-lead ECG templates calculated in a similar manner.
Although ECG templates for fewer leads such as these may be used to localize activation
sites of origin to a segment, localizations may be less accurate than systems that use
higher lead count BSPMs.
[00501 As illustrated in Figure 4, to localize a site of origin to a segment or group of
segments, a plurality of ECG signals are simultaneous recorded at step 200 and a BSPM
                                             - 13 -

of interest is calculated at step 210. If the number of ECG signals simultaneously
recorded matches the lead count of the BSPM templates, then the BSPM of interest is
calculated as described above for recorded BSPMs. If the number of ECG signals
simultaneously recorded has a different lead count, for instance is a lower lead count,
from the BSPM templates, then the BSPM of interest is calculated as described above for
estimated B SPMs. The B SPM of interest is then compared to each B SPM template of a
set or library of BSPM templates at step 220. The set of BSPM templates comprises one
template for each pre-defined segment of the heart. To quantify the comparison of the
BSPM of interest to each of the BSPM templates, the computing device 130 retrieves the
BSPM templates stored in memory and at least one waveform comparison metric is
calculated for each BSPM template as compared to the BSPM of interest. Examples of
waveform comparison metrics that may be used include correlation coefficients, mean
absolute deviation and root mean square of the difference. The BSPM template that most
closely resembles the BSPM of interest is identified at step 230 using the calculated
comparison metrics, e.g., BSPM template associated with the highest correlation
coefficient, the lowest mean absolute deviation and/or the lowest root mean square of the
difference. As each BSPM template is associated with a particular segment, the site of
origin of the BSPM of interest can be localized if not to the identified segment then to the
identified segment and segments adjacent to or near the localized segment.
[oo5] By localizing the site of origin to a region of the heart, the area to be mapped by
the operator is limited, thereby reducing the time spent in performing catheter mapping
and ablation.
[00521 As illustrated in Figure 5, localization of the activation site of origin may be
further facilitated during pacemapping by providing an objective measure of the
similarity of a pre-recorded BSPM of interest to a pace site BSPM in real-time. In one
embodiment, the computing device 130 receives a plurality of simultaneously recorded
ECG signals at step 300 associated with a pace site. The computing device 130 then
calculates a pace site BSPM at step 310. If the number of ECG signals received matches
the lead count of the BSPM of interest, then the pace site BSPM is calculated as
                                              - 14 -

described above for recorded BSPMs. If the number of ECG signals received is a
different lead count, for instance is a lower lead count, from the BSPM of interest, then
the pace site BSPM is calculated as described above for estimated BSPMs. The pace site
BSPM is then compared to the BSPM of interest at step 320. To quantify the similarity of
the pace site BSPM to the BSPM of interest, the computing device 130 retrieves the
BSPM of interest stored in memory and at least one waveform comparison metric is
calculated. Examples of waveform comparison metrics that may be calculated include
correlation coefficients, mean absolute deviation and root mean square of the difference.
An indication of the similarity between the BSPM of interest and the pace site BSPM
based on the calculated waveform metric(s) is then displayed on the user interface, such
as a computer monitor or screen, in communication with the computing device at step
330.
[00531 In an embodiment, a high-resolution localization may be determined by means of
regression analysis. With the origin of the coordinate system at the center of the left
ventricular (LV) cavity, a linear regression with intercept model may be applied to the k
independent QRS-integral parameters derived from a 12-lead ECG or the VCG. The
independent QRS integral parameters are collected for a patient population along with the
location (X, Y and Z) of the pacing site determined using an electroanatomical map, such
as from CARTO TM, and projected on the prototype left ventricle, such as depicted in
Figure 13. This data may be stored in a database for ease of access and analysis.
[00541 Using a least-squares solution to the prototype model of the heart when applied to
the QRS-integral parameters obtained from the patient dataset may provide general (i.e.
for the population) regression coefficients ai,  si and yi, for i = 0,1,..., k.
[00551 These general regression coefficients relate the three-dimensional left ventricle
(LV) geometry to ECG or VCG parameters. By using these coefficients, the location of
the pacing site on the endocardial surface can be estimated and as confirmation the
estimated location can be compared to the actual location as determined by the
electroanatomical map to determine a location error distance from the actual pacing site
                                             - 15 -

in terms of distance on the endocardial surface. The system is trained using patient data
where there is a known pacing site.
[00561 A three-dimensional prototype model of the left ventricle modelled from a human
heart may be represented using planar triangles and divided into anatomical segments. In
an embodiment illustrated in Figure 13, left-ventricular endocardial surface is tessellated
into 238 planar triangles within 16 anatomical segments and projected onto a polar
display. There are 6 basal segments (1-6), 6 mid-segments (7-12), and 4 apical segments
denoted as anterior (1 and 7), anteroseptal (2, 8, and 13), inferoseptal (3, 9, and 14),
inferior (4 and 10), inferolateral (5, 11, and 15), and anterolateral (6, 12, and 16).
[00571 Using data from 26 patients, pacing data from 589 sites were analyzed for training
of the system and to test the accuracy of the regression analysis. The geodesic distance on
the endocardial surface from the predicted site to the actual pacing site was 13.07 ± 9.88
mm with a median value of 10.67mm.
[00581 Using the general regression coefficients, ECG or VCG data may be collected and
applied to determine a predicted location of the pacing site. This predicted location may
be used to help converge on the likely location of the pacing site for either manual
exploration or for use with electroanatomical mapping. In an embodiment, a computing
device such as a tablet or portable computer may be used to apply the general regression
coefficients to the received ECG or VCG data from a patient to determine the predicted
location of the pacing site. The top-right portion of Figure 14 shows a display of a
representation of the LV indicating the likely location as could be displayed on a display
screen of the tablet or portable computer. A user, such as a clinical electrophysiologist at
the patient, may view the display screen with the indicated position. As would be
understood, the analysis and/or display may be done away from the patient, such as at a
server or other computing system connected to the ECG/VCG data acquisition system
over an electronic network. The data and likely location could be saved for display or
analysis at a later time or displayed in real time to a user, such as a doctor or
electrophysiologist, at the patient.
                                              - 16 -

[0059J With reference to the top-left portion of Figure 14, the location of predicted
pacing site may be indicated with reference to the 16 segments of the left ventricle. The
predicted location may be indicated using the correlation coefficients, produced by
template matching, displayed in percent for each segment. The best fit of the triangular
elements - obtained by means of the regression method - may be highlighted, such as
indicated by the white triangle in Figure 14.
[00601 The top-right portion of Figure 14 indicates the predicted site on a 3D model of
the left ventricle, again with probabilities for each segment.
[00611 With reference to the bottom left portion of Figure 14, the initial 120 ms of the
QRS is indicated. In this case, tracings are indicated for 8 frontal-plane leads and 6
precordial leads of the standard 12-lead ECG, although a different set of leads may be
used. The location of the pacing site derived from the electroanatomic map, such as from
the CARTO TM system, shown in the bottom right of Figure 14 is for comparison and
verification of the predicted location.
[00621 From various embodiments of the present invention having been thus described in
detail by way of example, it will be apparent to those skilled in the art that variations and
modifications may be made without departing from the invention. The invention includes
all such variations and modifications as fall within the scope of the appended claims.
[00631 A portion of the disclosure of this patent document contains material which is
subject to copyright protection. The copyright owner has no objection to the facsimile
reproduction by any one of the patent document or patent disclosure, as it appears in the
Patent and Trademark Office patent file or records, but otherwise reserves all copyrights
whatsoever.
                                              - 17 -

We Claim:
1.      A method for localizing an activation site of origin to a segment of the heart
comprising:
obtaining a body-surface potential map (BSPM) of interest based on a plurality of
simultaneously recorded electrocardiographic (ECG) signals from a plurality of leads;
calculating an integral of the signal recorded from each of a subset of the plurality of
leads and identifying a condition of the integral as positive or negative for each of the
subset of the plurality of leads;
comparing the condition of each of the subset of the plurality of leads with the condition
of the subset of the plurality of leads used for each of a pre-determined set of BSPM
templates, the set comprising one B SPM template for each pre-defined segment of the
heart, to identify a selected set of BSPM templates having matching conditions;
comparing a body surface potential map (BSPM) of interest to each BSPM template of
the selected set of BSPM templates, wherein comparing comprises, for each BSPM
template of the set of BSPM templates:
                 retrieving a BSPM template from memory from the selected set of BSPM
templates; and
                 calculating one or more comparison metrics for the BSPM template
retrieved as compared to the BSPM of interest,
wherein each of the BSPM templates was generated by averaging BSPMs of all pacing
sites within the associated segment of the heart from a collection of BSPMs stored in
memory;
        identifying the BSPM template that most closely resembles the BSPM of interest
using the one or more comparison metrics calculated in order to identify the segment of
the heart in which the activation site of origin is likely to be located.
                                             - 18 -

2.      The method of claim 1 wherein each of the BSPM templates of the set of BSPM
templates represents a pre-determined number of ECG signals.
3.      The method of claim 2 wherein the BSPMs of interest were calculated from a
different number of ECG signals than the pre-determined number.
4.      The method of claim 3 wherein calculation of the BSPM of interest comprises
interpolating between the different number of ECG signals by application of either
general or patient-specific coefficients pre-derived from a collection of BSPMs each
representing the pre-determined number of ECG signals.
5.      The method of claim 1 wherein the subset of the plurality of leads comprises leads
I and aVF of a 12-lead ECG.
6.      The method of claim 1 wherein the subset of the plurality of leads comprises leads
II and V4 of a 12-lead ECG.
7.      A method for localizing an activation site of origin to an area of the heart
comprising:
        retrieving a plurality of general coefficient parameters relating a physical location
of an activation site to integrals of ECG signals obtained by
                i) obtaining a plurality of simultaneously recorded electrocardiographic
        (ECG) signals from a plurality of leads, from each of a plurality of patients;
                ii) calculating an integral of the signal recorded from each of a subset of
        the plurality of leads;
                iii) obtaining the location of the activation site for each of the plurality of
        patients; and
                iv) applying a linear regression with intercept to the integrals and to the
        location of the pacing site to obtain a plurality of general coefficient parameters;
                                              - 19 -

        obtaining a plurality of simultaneously recorded electrocardiographic (ECG)
signals of interest from the same plurality of leads used to obtain the general coefficient
parameters, from a patient;
        calculating an integral of the ECG signal recorded from each of a subset of the
plurality of leads for the patient;
        applying the general coefficient parameters to the integrals for the patient to
obtain an estimated activation site; and
        displaying the location of the estimated activation site on a model of a heart.
8.      A method for localizing an activation site of origin to an area of the heart
comprising:
        generating a plurality of patient-specific coefficient parameters relating a location
of an activation site to integrals of ECG signals during an ablation procedure by
                i) for several pacing sites, the number of pacing sites being more than the
        number of patient-specific coefficient paramters, obtaining a plurality of
        simultaneously recorded ECG signals from a plurality of leads, from a patient;
                ii) calculating an integral of the signal recorded from each of a subset of
        the plurality of leads;
                iii) obtaining the three-dimensional location of the activation site from an
        electroanatomical system; and
                iv) applying a linear regression with intercept to the integrals and to the
        three-dimensional location of the collected pacing sites to obtain the plurality of
        patient-specific coefficient parameters;
                                              - 20 -

        obtaining a plurality of simultaneously recorded ECG signals of interest from a
plurality of leads, corresponding to those used to derive the patient-specific coefficient
parameters, from the patient;
        calculating an integral of the ECG signal recorded from each of a subset of the
plurality of leads for the ECG signals of interest;
        applying the patient-specific coefficient parameters to the integrals for the ECG
signals of interest to obtain an estimated activation site; and
        displaying the estimated activation site as a point on a model of a heart.
                                            - 21 -

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
