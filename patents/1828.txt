                          Abstract
The invention is related to a method and device for
arithmetic decoding of a current spectral coefficient. Said
method for arithmetic decoding of a current spectral
coefficient comprises: processing preceding spectral
coefficients; determining a context state based on the
processed preceding spectral coefficients, wherein the
context state is determined from at least two different
context states, and wherein the context state is based on a
sum of the quantised absolutes of the preceding spectral
coefficients; determing a probability density function
based on the determined context state and a mapping from
the at least two different context states to at least two
different probability density functions; and arithmetic
decoding the current spectral coefficient based on the
determined probability density function.
Fig. 2

 2/9
UU
   0.
      CD

                                  1
     Method and device  for arithmetic encoding or arithmetic
                              decoding
 5 TECHNICAL FIELD
   The disclosure is  related to arithmetic encoding and
   decoding of multimedia data.
   BACKGROUND
   Arithmetic coding is a method for lossless compression of
10 data. Arithmetic coding is based on a probability density
   function  (PDF). For achieving a compression effect, the
   probability density function on which the coding is based
   has to be identical to or at least resemble -the closer the
   better- the actual probability density function which the
15 data actually follows.
   If arithmetic coding is based on a suitable probability
   density function, it may achieve significant compression
   resulting in at least almost optimal code. Therefore,
   arithmetic coding is a frequently used technique in audio,
20 speech or video coding for encoding and decoding of
   coefficient  sequences wherein coefficients are quantized
   time-frequency-transform of video pixels or audio or speech
   signal sample values  in binary representation.
   For even improving compression, arithmetic coding may be
25 based on a set of probability density functions, wherein
   the probability density function used for coding a current
   coefficient depends on a context of  said current
   coefficient. That  is, different probability density
   functions may be used for coding of a same quantization
30 value in dependency on a context in which the coefficient
   having said same quantization value appears. The context of

                                 2
   a coefficient is defined by the quantization values of
   coefficients comprised in a neighbourhood of one or more
   neighbouring coefficients neighbouring the respective
   coefficient, e.g. a subsequence of one or more already
 5 encoded or already decoded coefficients adjacently
   preceding, in a sequence, the respective coefficient to-be
   encoded or to-be-decoded. Each of the different possible
   appearances the neighbourhood may take defines a different
   possible context each being mapped onto an associated
10 probability density function.
   In practice, said compression improvement becomes manifest
   only if the neighbourhood is sufficiently large. This comes
   along with a combinatory explosion of the number of
   different possible contexts as well as a corresponding huge
15 number of possible probability density functions or a
   correspondingly complex mapping.
   An example of an context based arithmetic coding scheme can
   be found in   ISO/IEC JTC1/SC29/WG11 N10847, July 2009,
   London, UK, proposing a reference model for Unified Speech
20 and Audio Coding  (USAC). According to the proposal, vectors
   containing 4 spectral bins are  jointly coded which results
   in a tremendous number of contexts to-be-handled.
   Throughout this specification the word "comprise", or
   variations such as  "comprises" or  "comprising", will be
25 understood to imply the inclusion of a stated element,
   integer or  step, or group of elements, integers or  steps,
   but not the exclusion of any other element, integer or
   step, or group of elements,  integers or steps.
   Any discussion of documents,  acts, materials, devices,
30 articles or the like which has been included in the present
   specification is not to be taken as an admission that any
   or all of these matters form part of the prior art base or
   were common general knowledge in the field relevant to the

                                 3
   present disclosure as it existed before the priority date
   of each claim of this application.
   SUMMARY OF THE INVENTION
   Corresponding to the tremendous number of contexts to-be
 5 handled there are a tremendous number of probability
   density functions which need to be stored, retrieved, and
   handled or at least a correspondingly complex mapping from
   contexts to probability density functions. This increases
   at least one of encoding/decoding latency and memory
10 capacity requirements. There is a need in the art for an
   alternative solution allowing to achieving compression
   similarly well while decreasing at least one of
   encoding/decoding latency and memory capacity requirements.
   One embodiment provides a method for arithmetic decoding of
15 a current spectral coefficient, said method comprising:
        processing preceding spectral coefficients;
        determining a context state based on the processed
   preceding spectral coefficients, wherein the context state
   is determined from at least two different context states,
20 and wherein the context state is based on a sum of the
   quantised absolutes of the preceding spectral coefficients;
        determing a probability density function based on the
   determined context state and a mapping from the at least
   two different context states to at least two different
25 probability density functions;  and
        arithmetic decoding the current spectral coefficient
   based on the determined probability density function.
   One embodiment provides a method for arithmetic encoding of
   a current spectral coefficient, said method comprising:
30      processing preceding spectral coefficients;
        using the processed preceding spectral coefficients
   for determining a context state being one of at least two
   different context states,
        using a sum of the quantised absolutes of the

                                 4
   preceding spectral coefficients for determination of the
   context state;
        using the determined context state and a mapping from
   the at least two different context states to at least two
 5 different probability density functions for determining the
   probability density function;
        and arithmetic encoding the current spectral
   coefficient based on the determined probability density
   function.
10 One embodiment provides a non-transitory storage medium
   carrying arithmetic encoded spectral coefficients
   arithmetic encoded according to the method as herein
   disclosed.
   One embodiment provides a device for arithmetic decoding of
15 a current spectral coefficient, said device comprising:
        a processor configured to process the preceding
   spectral coefficients;
        a context classifier configured to determine a context
   state based on the processed preceding spectral
20 coefficients, wherein the context state is determined from
   at least two different context states, and wherein the
   context state is based on a sum of the quantised absolutes
   of the preceding spectral coefficients, wherein said
   context classifier is configured to use a sum of the
25 quantised absolutes of the preceding spectral coefficients
   in determination of the context state;
        a probability density module configured to determine a
   probability density function, said probability density
   module being adapted to use the determined context state
30 and a mapping from the at least two different context
   states to at least two different probability density
   functions to determine the probability density function;
        and an arithmetic decoder configured to arithmetically
   decode the current spectral coefficient based on the
35 determined probability density function.

                                5
   There is further provided a method for arithmetic decoding
   of a current spectral coefficient using preceding spectral
   coefficients, said preceding spectral coefficients being
   already decoded, wherein said preceding spectral
 5 coefficients and said current spectral coefficient are
   comprised in one or more quantized spectra resulting from
   quantizing time-frequency-transformed video, audio or
   speech signal sample values, said method comprising the
   steps: processing the preceding spectral coefficients;
10 using the processed preceding spectral coefficients for
   determining a context class out of at least two different
   context classes, wherein a sum of the quantised absolute
   values of the preceding spectral coefficients is used for
   determination of the context class; using the determined
15 context class and a mapping from the at least two different
   context classes to at least two different probability
   density functions, for determining one of the at least two
   different probability density function; arithmetic decoding
   the current spectral coefficient based on the determined
20 probability density function, wherein said processing of
   the preceding spectral coefficients comprises non-uniformly
   quantizing absolute values of the preceding spectral
   coefficients for use in determination of the context class,
   receiving at least one of a mode switching signal and a
25 reset signal; using the at least one received signal for
   controlling the step of determining the context class.
   There is further provided a method for arithmetic encoding
   of a current spectral coefficient using preceding spectral
   coefficients, said preceding spectral coefficients being
30 already encoded, wherein said preceding spectral
   coefficients and said current spectral coefficient are
   comprised in one or more quantized spectra resulting from
   quantizing time-frequency-transformed video, audio or
   speech signal sample values, said method comprising the
35 steps: processing the preceding spectral coefficients;
   using the processed preceding spectral coefficients for

                                6
   determining a context class out of at least two different
   context classes, wherein a sum of the quantised absolute
   values of the preceding spectral coefficients is used for
   the determination of the context class; using the
 5 determined context class and a mapping from the at least
   two different context classes to at least two different
   probability density functions, for determining one of the
   at least two different probability density functions;
   arithmetic encoding the current spectral coefficient based
10 on the determined probability density function, wherein
   said processing of the preceding spectral coefficients
   comprises non-uniformly quantizing absolute values of the
   preceding spectral coefficients for use in determination of
   the context class, inserting at least one of a mode
15 switching signal and a reset signal; using the at least one
   inserted signal for controlling the step of determining the
   context class.
   There is further provided a device for arithmetic decoding
   of a current spectral coefficient using preceding spectral
20 coefficients, said preceding spectral coefficients being
   already decoded, wherein said preceding spectral
   coefficients and said current spectral coefficient are
   comprised in one or more quantized spectra resulting from
   quantizing time-frequency-transformed video, audio or
25 speech signal sample values, said device comprising:
   processing means for processing the preceding spectral
   coefficients, first means for determining a context class
   out of at least two different context classes, said first
   means being adapted for using the processed preceding
30 spectral coefficients for determining the context class,
   wherein a sum of the quantised absolute values of the
   preceding spectral coefficients is used for the
   determination of the context class; second means for
   determining a probability density function, said second
35 means being adapted for using the determined context class
   and a mapping from the at least two different context

                                 7
   classes to at least two different probability density
   functions for determining the probability density function;
   an arithmetic decoder for arithmetic decoding the current
   spectral coefficient based on the determined probability
 5 density function, wherein said processing means are adapted
   for non-uniformly quantizing absolute values of the
   preceding spectral coefficients for use in determination of
   the context class, wherein said first means is adapted to
   receive at least one of a mode   switching signal and a reset
10 signal and wherein said first means is adapted to use the
   at least one received signal to control the step of
   determining the context class.
   There is further provided a device for arithmetic encoding
   of a current spectral coefficient using preceding spectral
15 coefficients, said preceding spectral coefficients being
   already encoded, wherein said preceding spectral
   coefficients and current spectral coefficient are comprised
   in one or more quantized spectra resulting from quantizing
   time-frequency-transformed video, audio or speech signal
20 sample values, said device comprising:   processing means for
   processing the preceding spectral coefficients, first means
   for determining a context class out of at least two
   different context classes, said first means being adapted
   for using the processed preceding spectral coefficients for
25 determining the context class, wherein a sum of the
   quantised absolute values of the preceding spectral
   coefficients is used for the determination of the context
   class; second means for determining a probability density
   function, said second means being adapted for using the
30 determined context class and a mapping from the at least
   two different context classes to at least two different
   probability density functions for determining the
   probability density function;   an arithmetic encoder for
   arithmetic encoding the current spectral coefficient based
35 on the determined probability density function, wherein
   said processing means are adapted for non-uniformly

                                8
   quantizing absolute values of the preceding spectral
   coefficients for use in determination of the context class,
   wherein said first means is adapted to insert at least one
   of a mode switching signal and a reset signal and wherein
 5 said first means is adapted to use the at least one
   inserted signal to control the step of determining the
   context class.
   A non-transitory storage medium carries arithmetic encoded
   spectral coefficients wherein a current spectral
10 coefficient is encoded using preceding spectral
   coefficients, said preceding spectral coefficients being
   already encoded, and both, said preceding and current
   spectral coefficients are comprised in one or more
   quantised spectra resulting from quantising time-frequency
15 transform of video, audio or speech signal sample values,
   wherein the preceding spectral coefficients are processed;
   the processed preceding spectral coefficients are used for
   determining a context class being one of at least two
   different context classes, a sum of the quantised absolutes
20 of the preceding spectral coefficients is used for
   determination of the context class, the determined context
   class and a mapping from the at least two different context
   classes to at least two different probability density
   functions are used for determining the probability density
25 function; the current spectral coefficient is
   arithmetically encoded based on the determined probability
   density function, and wherein the preceding spectral
   coefficients are processed comprising non-uniformly
   quantising absolutes of the preceding spectral coefficients
30 for use in determination of the context class, wherein at
   least one of a mode switching signal and a reset signal is
   present for controlling determining of the context class.
   The features of further proposed embodiments are specified
   in the dependent claims.

                                9
   Said method for arithmetic encoding, or decoding,
   respectively, uses preceding spectral coefficients for
   arithmetic encoding or decoding, respectively, of a current
   spectral coefficient, wherein said preceding spectral
 5 coefficients are already encoded, or decoded, respectively.
   Both, said preceding spectral coefficients and said current
   spectral coefficient, are comprised in one or more
   quantized spectra resulting from quantizing time-frequency
   transform of video, audio or speech signal sample values.
10 Said method further comprises processing the preceding
   spectral coefficients, using the processed preceding
   spectral coefficients for determining a context class being
   one of at least two different context classes, using the
   determined context class and a mapping from the at least
15 two different context classes to at least two different
   probability density functions for determining the
   probability density function, and arithmetic encoding, or
   decoding, respectively, the current spectral coefficient
   based on the determined probability density function. It is
20 a feature of the method that processing the preceding
   spectral coefficients comprises non-uniformly quantizing
   the preceding spectral coefficients.
   The use of context classes as alternative to contexts for
   determining the probability density function allows for
25 grouping two or more different contexts which result into
   different but very similar probability density functions
   into a single context class being mapped onto a single
   probability density function. The grouping is achieved by
   using non-uniformly quantized preceding spectral
30 coefficients for determining the context class.
   For instance, there is an embodiment in which processing
   the preceding spectral coefficients comprises determining
   absolutes of the preceding spectral coefficients.
   Similarly, there is an embodiment of the device for
35 arithmetic encoding as well as a corresponding embodiment

                                10
   of the device for arithmetic decoding in which the
   processing means are adapted for determining absolutes of
   the preceding spectral coefficients.
   In said corresponding embodiments of the devices, the
 5 processing means may be adapted such that processing the
   preceding spectral coefficients further comprises a first
   quantization in which the absolutes of the preceding
   spectral coefficients are quantized according a first
   quantization scheme, a variance determination in which
10 variance of the absolutes of the preceding spectral
   coefficients quantized according the first quantization
   scheme is determined, usage of the determined variance for
   selection of one of at least two different non-linear
   second quantization schemes,  and a second quantization in
15 which the absolutes of the preceding spectral coefficients
   quantized according the first quantization scheme are
   further quantized according to the selected non-linear
   second quantization scheme.
   Variance determination may comprise determination of a sum
20 of the absolutes of the preceding spectral coefficients
   quantized according the first quantization scheme and
   comparison of the determined sum with at  least one
   threshold.
   In further embodiments, the processing means of each of the
25 devices may be adapted such that processing either results
   in a first outcome or at least a different  second outcome.
   Then, determination of the context class  further comprises
   determination of a number of those preceding spectral
   coefficients for which processing resulted in the first
30 outcome, and usage of the determined number for
   determination of the context class.
   Each of the devices may comprise means for receiving at
   least one of a mode switching signal and a reset signal
   wherein devices are adapted for using the at least one

                                11
   received signal for controlling the determination of the
   context class.
   The at least two different probability density functions
   may be determined beforehand using a representative set of
 5 data for determining the at least two different probability
   density functions and the mapping may be realized using a
   look-up table or a hash table.
   BRIEF DESCRIPTION OF THE DRAWINGS
   Examples are illustrated in the drawings and are explained
10 in more detail in the following description. The examples
   are explained only for elucidating the invention, but not
   limiting the invention's scope and spirit defined in the
   claims.
   In the figures:
15 Fig. 1    exemplarily depicts an embodiment of the
             inventive encoder,
   Fig. 2    exemplarily depicts an embodiment of the
             inventive decoder,
   Fig. 3    exemplarily depicts a first embodiment of a
20           context classifier for determining a context
             class,
   Fig. 4    exemplarily depicts a second embodiment of a
             context classifier for determining a context
             class,
25 Fig. 5a   exemplarily depicts a first neighbourhood of
             preceding spectral bins preceding a current
             spectral bin to-be-encoded or to-be-decoded in
             frequency domain mode,
   Fig. 5b   exemplarily depicts a second neighbourhood of
30           preceding spectral bins preceding a current

                              12
           spectral bin to-be-encoded or to-be-decoded in
           weighted linear prediction transform mode,
   Fig. 6a exemplarily depicts a third neighbourhood of
           preceding spectral bins preceding a current
 5         lowest frequency spectral bin to-be-encoded or
           to-be-decoded in frequency domain mode,
   Fig. 6b exemplarily depicts a fourth neighbourhood of
           preceding spectral bins preceding a current
           second lowest frequency spectral bin to-be
10         encoded or to-be-decoded in frequency domain
           mode,
   Fig. 7a exemplarily depicts a fifth neighbourhood of
           preceding spectral bins preceding a current
           lowest frequency spectral bin to-be-encoded or
15         to-be-decoded in weighted linear prediction
           transform mode,
   Fig. 7b exemplarily depicts a sixth neighbourhood of
           preceding spectral bins preceding a current
           second lowest frequency spectral bin to-be
20         encoded or to-be-decoded in weighted linear
           prediction transform mode,
   Fig. 7c exemplarily depicts a seventh neighbourhood of
           preceding spectral bins preceding a current third
           lowest frequency spectral bin to-be-encoded or
25         to-be-decoded in weighted linear prediction
           transform mode,
   Fig. 7d exemplarily depicts an eighth neighbourhood of
           preceding spectral bins preceding a current third
           lowest frequency spectral bin to-be-encoded or
30         to-be-decoded in weighted linear prediction
           transform mode,

                                 13
   Fig. 8     exemplarily depicts neighbourhoods of different
              spectral bins to-be-encoded or to-be-decoded,
              said different spectral bin being comprised in a
              first spectrum to-be-encoded or to-be-decoded
 5            after initiation of encoding/decoding or
              occurrence of a reset signal in frequency domain
              mode, and
   Fig. 9     exemplarily depicts further neighbourhoods of
              different spectral bins to-be-encoded or to-be
10            decoded in weighted linear prediction transform
              mode, said different spectral bin being comprised
              in a second spectrum to-be-encoded or to-be
              decoded after initiation of encoding/decoding or
              occurrence of a reset signal in weighted linear
15            prediction transform mode.
   EXEMPLARY EMBODIMENTS
   The invention may be realized on any electronic device
   comprising a processing device correspondingly adapted. For
   instance, the device for arithmetic decoding may be
20 realized in a television, a mobile phone, or a personal
   computer, an mp3-player, a navigation system or a car audio
   system. The device for arithmetic encoding may be realized
   in a mobile phone, a personal computer, an active car
   navigation system, a digital still camera, a digital video
25 camera or a Dictaphone, to name a few.
   The exemplary embodiments described in the following are
   related to encoding and decoding of quantized spectral bins
   resulting from quantization of time-frequency transform of
   multimedia  samples.
30 The disclosure is based on the way the already transmitted
   quantized spectral bins, e.g. preceding quantized spectral
   bins preceding a current quantized spectral bin BIN in a
   sequence, are used to determine the probability density

                                14
   function PDF to be used for arithmetic encoding and
   decoding, respectively, of the current quantized spectral
   bin BIN.
   The described exemplary embodiments of the methods and
 5 devices for arithmetic encoding or arithmetic decoding
   comprise several steps or means, respectively, for non
   uniform quantization. All steps or means, respectively,
   together offer the highest coding efficiency, but each step
   or means, respectively, alone already realizes the
10 inventive concept and provides advantages regarding
   encoding/decoding latency and/or memory requirements.
   Therefore, the detailed description shall be construed as
   describing exemplary embodiments realizing only one of the
   steps or means, respectively, described as well as
15 describing exemplary embodiments realizing combinations of
   two or more of the steps or means described.
   A first step which may but need not to be comprised in an
   exemplary embodiment of the method is a switching step in
   which it is decided which general transform mode shall be
20 used. For instance, in USAC Noiseless Coding Scheme the
   general transform mode may be either Frequency Domain  (FD)
   mode or weighted Linear Prediction Transform (wLPT) mode.
   Each general mode might use a different neighbourhood, i.e.
   a different selection of already encoded or decoded,
25 respectively, spectral bins for the determination of the
   PDF.
   After that, the context of a current spectral bin BIN may
   be determined in module context generation COCL. From the
   determined context, a context class is determined by
30 classifying the context wherein, prior to classification,
   the context is processed by preferably but not necessarily
   non-uniform quantization NUQ1 of the spectral bins of the
   context. Classification may comprise estimating a variance
   VES of the context and comparing the variance with at least
35 one threshold. Or, the variance estimate is determined

                                 15
   directly from the context. The variance estimate is then
   used for controlling a further quantization NUQ2 which is
   preferably but not necessarily non-linear.
   In the encoding process exemplarily depicted in Fig. 1, a
 5 suited probability Density Function   (PDF) is determined to
   encode the current quantized spectral bin BIN. For this
   purpose only information can be used that is also already
   known at the decoder side. That is,  only preceding encoded
   or decoded quantized spectral bins can be used. This   is
10 done in context classifier block COCL. There, selected
   preceding spectral bins define a neighbourhood NBH which is
   used to determine the actual context class.   The context
   class may be symbolized by a context class number. The
   context class number is used to retrieve the corresponding
15 PDF from a PDF-memory MEM1 via a mapping MAP, e.g. via a
   table look-up or a hash table. The determination of the
   context class may depend on a general mode switch GMS which
   allows to use different neighbourhoods in dependence on the
   selected mode. As mentioned above, for USAC there may be
20 two general modes  (FD mode and wLPT mode).  If a general
   mode switch GMS is realized at the encoder side, a mode
   change signal or a current general signal has to be
   comprised in the bitstream, so that it is also known in the
   decoder. For instance, in the reference model for Unified
25 Speech and Audio Coding  (USAC) proposed by ISO/IEC
   JTC1/SC29/WG11 N10847,  July 2009, London, UK there are WD
   table 4.4 coremode and table 4.5 coremode0/1 proposed for
   transmission of the general mode.
   After determination of a suitable PDF for encoding of the
30 current quantized spectral bin BIN by arithmetic encoder
   AEC, the current quantized spectral bin BIN is fed to
   neighbourhood memory MEM2, i.e. the current bin BIN becomes
   a preceding bin. The preceding spectral bins comprised in
   neighbourhood memory MEM2 may be used by block COCL for
35 coding the next spectral bin BIN. During, before or after

                                16
   memorizing the current spectral bin BIN, said current bin
   BIN is arithmetic encoded by arithmetic encoder AEC. The
   output of arithmetic encoding AEC is stored in bit buffer
   BUF or is written in the bitstream directly.
 5 The bitstream or the content of buffer BUF may be
   transmitted or broadcasted via cable or satellite, for
   instance. Or, the arithmetic encoded spectral bins may be
   written on a storage medium like DVD, hard disc, blue-ray
   disk or the like. PDF-memory MEM1 and neighbourhood memory
10 MEM2 may be realized in a single physical memory.
   Reset switch RS may allow for restarting encoding or
   decoding from time to time at dedicated frames at which the
   encoding and decoding may be started without knowledge of
   the preceding spectra, the dedicated frames being known as
15 decoding entry points. If a rest switch RS is realized at
   the encoder side, a reset signal has to be comprised in the
   bitstream, so that it is also known in the decoder. For
   instance, in the reference model for Unified Speech and
   Audio Coding (USAC) proposed by ISO/IEC JTC1/SC29/WG11
20 N10847, July 2009, London, UK there is a arithresetflag
   in WD table 4.10 and table 4.14.
   The corresponding neighbourhood based decoding scheme is
   exemplarily depicted in Fig. 2. It comprises similar blocks
   as the encoding scheme. The determination of the PDF to be
25 used for the arithmetic decoding is identical with the
   encoding scheme to guarantee that in both, the encoder and
   decoder, the determined PDF is the same. The Arithmetic
   decoding gets the Bits form the bit buffer BUF or the
   bitstream directly and uses the determined PDF to decode
30 the current quantized spectral bin BIN. Afterwards the
   decoded quantized spectral bin is fed to neighbourhood
   memory MEM2 of the Determination of context class number
   block COCL and may be used for decoding the next spectral
   bin.

                                 17
   Fig. 3 exemplarily depicts a first embodiment of context
   classifier COCL for determining a context class   in detail.
   Before storing current  quantized spectral bin BIN in the
   spectra memory MEM2 it may be non-uniformly quantized in
 5 block NUQ1. This has two advantages:  first, it allows a
   more efficient storage of the quantized bins, which are
   usually 16Bit signed integer values. Second, the number of
   values each quantized bin could have is reduced. This
   allows an enormous reduction of possible context classes in
10 the context class  determination process in block CLASS.
   Further more, as in the context class  determination the
   sign of the quantized bins may be discarded, the
   calculation of the absolute values may be included in the
   non-uniform quantization block NUQ1. In Table 1 is shown
15 exemplary non-uniform quantization as it may be performed
   by block NUQ1.  In the example, after non-uniform
   quantization three different values are possible for each
   bin. But in general, the only constraint  for the non
   uniform quantization is that it reduces the number of
20 values a bin may take.
       Absolute     0    1   2     3   4   5    6    7    8  > 8
       value of
      quantized
       spectral
         bins
     Non-uniform    0      1                    2
     quantization
    Table 1 Exemplary non-uniform quantization step including
                the calculation of absolute values
25 The non-uniform quantized /  mapped spectral bins are stored
   in the spectral memory MEM2. According to the selected
   general mode selection GMS,  for the context class
   determination CLASS for each bin to be coded a selected
   neighbourhood NBH of spectral bins is selected.

                                18
   Fig. 5a exemplarily depicts a first exemplary neighbourhood
   NBH of a spectral bin BIN to-be-encoded or to-be-decoded.
   In this example only spectral bins of the actual or current
   spectrum (frame) and spectral bins of one preceding
 5 spectrum (frame) define the neighbourhood NBH. It is, of
   course, possible to use spectral bins from more than one
   preceding spectrum as par of the neighbourhood, which
   results in a higher complexity, but may also offer a higher
   coding efficiency in the end. Note, from the actual
10 spectrum only already transmitted bins may be used to
   define the neighbourhood NBH, as they also have to be
   accessible at the decoder. Here as well as in the following
   examples, the transmission order from low to high
   frequencies for the spectral bins is assumed.
15 The selected neighbourhood NBH is then used as input in the
   context class determination block COCL. In the following,
   first the general idea behind the context class
   determination and a simplified version is explained, before
   a special realization is described.
20 The general idea behind the context class determination is
   to allow a reliable estimation of the variance of the bin
   to be coded. This predicted variance, again, can be used to
   get an estimation of the PDF of the bin to be coded. For
   variance estimation it is not necessary to evaluate the
25 sign of the bins in the neighbourhood. Therefore the sign
   can already be discarded in the quantization step before
   storage in the spectral memory MEM2. A very simple context
   class determination may look like as follows: the
   neighbourhood NBH of spectral bin BIN may look like in Fig.
30 5a and consists of 7 spectral bins. If exemplarily the non
   uniform quantization shown in Table   is used each bin can
   have 3 values. This results in 37 = 2187 possible context
   classes.

                                19
   To further reduce this number of possible context classes
   the relative position of each bin in the neighbourhood NBH
   may be discarded. Therefore, only the number of bins is
   counted, which have the value 0, 1 or 2, respectively,
 5 wherein, the sum of the number of 0-bins, the number of 1
   bins and the number of 2-bins equals the overall number of
   bins in the neighbourhood, of course. In the neighbourhood
   NBH comprising n bins of which each may take one out of
   three different values there are 0.5*(n 2 +3*n+2) context
10 classes. For instance, in a neighbourhood of 7 bins there
   are 36 possible context classes and a neighbourhood of 6
   bins there are 28 possible context classes.
   A more complex but still quite simple context class
   determination takes into account that research has shown
15 the spectral bin of the preceding spectrum at the same
   frequency being of special importance  (the spectral bin
   depicted by a dotted circle in the Fig. 5a, 5b, 6a,   6b, 7a,
   7b, 7c, 8 and 9). For the other bins in the neighbourhood,
   those depicted as horizontally striped circles in the
20 respective figures, the relative position is less relevant.
   So the bin at same frequency in the preceding spectrum is
   used explicitly for context class determination, whereas
   for the other 6 bins only the number of 0-bins, the number
   of 1-bins and the number of 2-bins are counted. This
25 results in 3 x 28 = 84 possible context classes.
   Experiments have shown that such context classification is
   very efficient for the FD mode.
   The context class determination may be extended by a
   variance estimation VES, which controls a second non
30 uniform quantization NUQ2. This allows a better adaptation
   of the context class generation COCL to a higher dynamic
   range of the predicted variance of the bin to be coded. The
   corresponding block diagram of the extended context class
   determination is exemplarily shown in 4.

                                    20
   In the example shown in fig. 4, non-uniform quantization is
   separated in two steps of which a preceding step provides
   finer quantization     (block NUQ1) and a subsequent step
   provides coarser quantization       (block NUQ2).  This allows for
 5 adaptation of the quantization to e.g. the variance of the
   neighbourhood. The variance of the neighbourhood is
   estimated in the variance estimation block VES wherein the
   variance estimation is based on said preceding finer
   quantization of bins in the neighbourhood NBH in block
10 NUQ1. The estimation of the variance need not to be precise
   but can be very rough. For example,       it is sufficient for
   USAC application to decide whether the sum of the absolute
   values of the bins in the neighbourhood NBH after said
   finer quantization meets or exceeds a variance threshold or
15 not, that is,   a switch between high and low variance is
   sufficient.
   The 2-step non-uniform quantization may look as shown in
   Table 2. In this example the low variance mode corresponds
   to the 1-step quantization shown in Table 2.
20
        Absolute     0      1   2     3    4    5    6    7    8  > 8
        value of
       quantized
        spectral
           bins
          Finer      0      1   2        3         4           5
     quantization
       step 1 (6
         values)
         Coarser     0        1                      2
     quantization
      step 2 (low
     variance) (3
         values)
         Coarser            0                 1                2
     quantization
     step 2 (high
      variance (3
         values)
           Table 2 depicts an exemplary 2-step non-uniform
       quantization;   the second or subsequent step quantizes

                                  21
      differently in dependence on whether variance has been
                   estimated as being high or low
   The final context class determination in block CLASS is the
   same as in the simplified version of Fig. 3. It    is possible
 5 to use different context class determinations according to
   the variance mode. It is also possible to use more than two
   variance modes, which of course results in an increase in
   the number of context classes and an increase in
   complexity.
10 For the first bins in a spectrum a neighbourhood like it is
   shown in Fig. 5a or 5b is not applicable, because for the
   first bins none or not all lower frequency bins exist. For
   each of these special cases an own neighbourhood may be
   defined. In a further embodiment, the non-existing bins are
15 filled with a predefined value. For the exemplary
   neighbourhood given in Fig. 5a the defined neighbourhoods
   for the first bins to be transmitted in a spectrum are
   shown in Fig.  6a and Fig. 6b.   The idea is to expand the
   neighbourhood to higher frequency bins in order to allow
20 for using the same context class determination function as
   for the rest of the spectrum. This means also the same
   context classes and at last the same PDFs can be used. This
   would not be possible, if the size of the neighbourhood is
   just reduced  (of course this is also an option).
25 Resets usually occur before a new spectrum is coded. As
   already mentioned, this is necessary to allow dedicated
   starting points   for decoding. For example, if the decoding
   process shall start from a certain frame/spectrum, in fact
   the decoding process has to start from the point of the
30 last reset to successively decode the preceding frame until
   the desired starting spectrum. This means, the more resets
   occur, the more entry points for the decoding exits.
   However, the coding efficiency is smaller in a spectrum
   after a reset.

                                  22
   After a reset occurred no preceding spectrum is available
   for the neighbourhood definition. This means only preceding
   spectral bins of the actual spectrum may be used in the
   neighbourhood. However, the general procedure may not be
 5 changed and the same "tools" can be used. Again, the first
   bins have to be treated differently as already explained in
   the previous section.
   In Fig. 8 an exemplary reset neighbourhood definition is
   shown. This definition may be used in case of reset in the
10 FD mode of USAC.
   The number of additional context    classes as shown in the
   example in Fig. 8  (using the quantization of Table      with
   finally 3 possible quantized values or     6 values if values
   after quantization step 1 are used) are as follows:      the
15 handling for the very first bin adds     1 context class,  2nd
   bin adds 6  (value after quantization step 1 is used),     3rd
   bin adds 6 and 4th bin adds   10  context classes.  If
   additionally consider two   (low and high) variance modes
   this number of context  classes   is almost doubled   (only for
20 the first bin, where no information is available and for
   the second bin, where the value for the bin after
   quantization step 1 is used are not doubled).
   This results in this example in 1 + 6 + 2x6 + 2x10 = 39
   additional context classes   for the handling of the resets.
25 Mapping block MAP takes the context classification
   determined by block COCL, e.g. a determined context class
   number, and selects the corresponding PDF from PDF-memory
   MEM1. In this step it is possible to further reduce the
   amount of necessary memory size, by using a single PDF for
30 more than one context class.    That is,  context classes which
   have a similar PDF may use a    joint PDF. These PDFs may be
   predefined in a training phase using a sufficiently large
   representative set of data. This training may include an
   optimization phase, where  context classes    corresponding to

                                 23
   similar PDFs are identified and the corresponding PDFs are
   merged. Depending on the statistics of the data this can
   result in a rather small number of PDFs which have to be
   stored in the memory. In an exemplary experiment version
 5 for USAC a mapping from 822  context  classes to 64 PDFs was
   successfully applied.
   The realization of this mapping function MAP may be a
   simple table look-up, if the number of context    classes is
   not too large. If the number gets larger a hash table
10 search may be applied for efficiency reasons.
   As stated above, general mode switch GMS allows for
   switching between frequency domain mode    (FD) and weighted
   linear prediction transform mode   (wLPT).  In dependency on
   the mode, different neighbourhoods may be used. The
15 exemplary neighbourhoods depicted in Fig. 5a, Fig. 6a and
   6b and Fig. 8 has been shown in experiments as sufficiently
   large for FD mode. But  for wLPT mode, larger neighbourhoods
   as exemplarily depicted in Fig. 5b, Fig. 7a, 7b and 7c and
   Fig. 9 has been found to be advantageous.
20 That is, exemplary reset handling in wLPT mode is depicted
   in Fig. 9. Exemplary neighbourhoods in wLPT mode for the
   lowest, the second lowest, the third lowest and the fourth
   lowest bin in a spectrum are depicted in Fig. 7a, 7b,    7c
   and 7d, respectively. And, an exemplary neighbourhood in
25 wLPT mode for all other bins in a spectrum is depicted in
   Fig. 5b.
   The number of context  classes resulting from the exemplary
   neighbourhood depicted in Fig. 5b is   3 x  91 = 273 context
   classes. The factor 3 results from the special handling of
30 the one bin at the same frequency as the one currently to
   be-encoded or currently to-be-decoded. According to the
   formula given above, there are   0.5*((12*12)+3*12+2) =  91
   combinations of number of bins with value 2,    1 or 0 for the
   remaining 12 bins in the neighbourhood. In an embodiment

                                       24
   which differentiates context classes in dependency on
   whether variance of the neighbourhood meets or exceeds a
   threshold, the 273 context        classes are doubled.
   An exemplary reset handling as         shown in Fig. 9 may also add
 5 a number of context classes.
   In a tested exemplary embodiment which yielded good results
   in experiments, there are        822 possible context    classes,
   which are broken down in the following Table 1.
           Mode               Low variance mode      High variance mode
   FD mode                             84                     84
   FD    mode        after                        39
   reset
   wLPT mode                          273                    273
   wLPT    mode      after                        69
   reset
10
     Table 1 Broken down possible context classes of the MPEG
                               USAC CE proposal
   In a tested exemplary embodiment, these 822 possible
   context   classes are mapped onto 64 PDFs. The mapping is
15 determined in a training phase, as described above.
   The resulting 64 PDFs have to be stored in ROM tables e.g.
   in 16Bit accuracy for a fixpoint arithmetic coder. Here
   another advantage of the proposed scheme is revealed:            in
   the current working draft version of the USAC
20 standardization mentioned in the background section,
   quadruples     (vectors containing 4 spectral bins) are        jointly
   coded with a single codeword. This results in very large
   codebooks even if the dynamic range of each component in
   the vector is very small        (e.g. each component may have the
25 values   [-4,...,3]  4  84 = 4096 possible different     vectors).
   Coding of scalars, however, allows a high dynamic range for
   each bin with a very small codebook. The codebook used in
   the tested exemplary embodiment has         32 entries offering a
   dynamic range for the bin form -15         to +15   and an Esc
30 codeword   (for the case, that the value of a bin lies

                                 25
   outside this range).  This means that only 64 x 32 16Bit
   values have to stored in ROM tables.
   Above, a method for arithmetic encoding of a current
   spectral coefficient using preceding spectral coefficients
 5 has been describe wherein said preceding spectral
   coefficients are already encoded and both, said preceding
   and current spectral coefficients, are comprised in one or
   more quantized spectra resulting from quantizing time
   frequency-transform of video, audio or speech signal sample
10 values. In an embodiment, said method comprises processing
   the preceding spectral coefficients, using the processed
   preceding spectral coefficients for determining a context
   class being one of at least two different context classes,
   using the determined context class and a mapping from the
15 at least two different  context classes to at least two
   different probability density functions for determining the
   probability density function, and arithmetic encoding the
   current  spectral coefficient based on the determined
   probability density function wherein processing the
20 preceding spectral coefficients comprises non-uniformly
   quantizing the preceding spectral coefficients.
   In another exemplary embodiment, the device for arithmetic
   encoding of a current spectral coefficient using preceding,
   already encoded spectral coefficients comprises processing
25 means,  first means for determining a context class, a
   memory storing at least two different probability density
   functions, second means for retrieving the probability
   density, and an arithmetic encoder.
   Then, the processing means are adapted for processing the
30 preceding, already encoded spectral coefficients by non
   uniformly quantizing them and said first means are adapted
   for using the processing result for determining the context
   class as being one of at least two different context
   classes.  The memory stores at least two different
35 probability density functions and a mapping from the at

                                 26
   least two different context classes to the at least two
   different probability density functions which allows for
   retrieving the probability density function which
   corresponds to the determined context class. The second
 5 means are adapted for retrieving, from the memory, the
   probability density which corresponds to the determined
   context  class, and the arithmetic encoder is adapted for
   arithmetic encoding of the current spectral coefficient
   based on the retrieved probability density function.
10 There is a corresponding another exemplary embodiment of
   the device for arithmetic decoding of a current spectral
   coefficient using preceding, already decoded spectral
   coefficients which comprises processing means,  first means
   for determining a context class, a memory storing at least
15 two different probability density functions, second means
   for retrieving the probability density, and an arithmetic
   decoder.
   Then, the processing means are adapted for processing the
   preceding, already decoded spectral coefficients by non
20 uniformly quantizing them and said first means are adapted
   for using the processing result for determining the context
   class as being one of at least two different context
   classes.  The memory stores at least two different
   probability density functions and a mapping from the at
25 least two different context classes to the at least two
   different probability density functions which allows for
   retrieving the probability density function which
   corresponds to the determined context class. The second
   means are adapted for retrieving, from the memory, the
30 probability density which corresponds to the determined
   context  class, and the arithmetic decoder is adapted for
   arithmetic decoding of the current spectral coefficient
   based on the retrieved probability density function.

                                27
   CLAIMS:
        1.   A method for arithmetic decoding of a current
   spectral coefficient, said method comprising:
        processing preceding spectral coefficients;
 5      determining a context state based on the processed
   preceding spectral coefficients, wherein the context state
   is determined from at least two different context states,
   and wherein the context state is based on a sum of the
   quantised absolutes of the preceding spectral coefficients;
10      determing a probability density function based on the
   determined context state and a mapping from the at least
   two different context states to at least two different
   probability density functions;  and
        arithmetic decoding the current spectral coefficient
15 based on the determined probability density function.
        2.   The method of claim 1, wherein processing the
   preceding spectral coefficients comprises non-uniformly de
   quantising absolutes of the preceding spectral coefficients
   for use in determination of the context state.
20      3.   The method of claim 1, wherein processing the
   preceding spectral coefficients comprises a first de
   quantizing step in which the absolutes of the preceding
   spectral coefficients are de-quantized according a first
   de-quantization scheme, a step of determining a variance of
25 the absolutes of the preceding spectral coefficients de
   quantized according the first de-quantization scheme, a
   step of using the determined variance for selecting one of
   at least two different nonlinear second de-quantization
   schemes, and a second de-quantizing step in which the
30 absolutes of the preceding spectral coefficients de
   quantized according the first de-quantization scheme are
   further de-quantized according to the selected nonlinear
   second de-quantization scheme.
        4.   The method of claim 3, wherein the step of

                                28
   determining the variance of the absolutes of the preceding
   spectral coefficients de-quantized according the first de
   quantization scheme comprises determining a sum of the
   absolutes of the preceding spectral coefficients de
 5 quantized according the first de-quantization scheme and
   comparing the determined sum with at least one threshold.
        5.   The method of claim 2, wherein processing either
   results in a first outcome or at least a different  second
   outcome and determining the context state further comprises
10 determining a number of preceding spectral coefficients
   being non-uniformly de-quantized to the first outcome, and
   using the determined number for determining the context
   state.
        6.   The method of claim 5, wherein one of the
15 preceding spectral coefficients is preferred over the
   preceding spectral coefficients remaining, said method
   further comprises using the non-uniformly de-quantization
   of the preferred one among the preceding spectral
   coefficient for determining the context state.
20      7.   The method of claim 6, wherein said preferred
   among the preceding spectral coefficients is comprised in a
   preceding spectrum and said current spectral coefficient is
   comprised in a different current spectrum, said preferred
   preceding and said current spectral coefficients being
25 comprised at a same frequency in the respective spectrum.
        8.   A method for arithmetic encoding of a current
   spectral coefficient, said method comprising:
        processing preceding spectral coefficients;
        using the processed preceding spectral coefficients
30 for determining a context state being one of at least two
   different context states,
        using a sum of the quantised absolutes of the
   preceding spectral coefficients for determination of the
   context state;

                                29
        using the determined context state and a mapping from
   the at least two different context states to at least two
   different probability density functions for determining the
   probability density function;
 5      and arithmetic encoding the current spectral
   coefficient based on the determined probability density
   function.
        9.   The method of claim 8, wherein processing the
   preceding spectral coefficients comprises non-uniformly
10 quantising absolutes of the preceding spectral coefficients
   for use in determination of the context state.
        10.  The method of claim 8 or claim 9, said method
   further comprises inserting at least one of a mode
   switching signal and a reset signal and using the at least
15 one inserted-signal for controlling the step of determining
   the context state.
        11.  The method of any one of claims 8 to 10, said
   method further comprises using a representative set of data
   for determining the at least two different probability
20 density functions.
        12.  The method of any one of claims 8 to 11, wherein
   the mapping is realized using a look-up table or a hash
   table.
        13.  A non-transitory storage medium carrying
25 arithmetic encoded spectral coefficients arithmetic encoded
   according to the method of any one of claims 8 to 12.
        14.  A device for arithmetic decoding of a current
   spectral coefficient, said device comprising:
        a processor configured to process the preceding
30 spectral coefficients;
        a context classifier configured to determine a context
   state based on the processed preceding spectral
   coefficients, wherein the context state is determined from

                                30
   at least two different context states, and wherein the
   context state is based on a sum of the quantised absolutes
   of the preceding spectral coefficients, wherein said
   context classifier is configured to use a sum of the
 5 quantised absolutes of the preceding spectral coefficients
   in determination of the context state;
        a probability density module configured to determine a
   probability density function, said probability density
   module being adapted to use the determined context state
10 and a mapping from the at least two different context
   states to at least two different probability density
   functions to determine the probability density function;
        and an arithmetic decoder configured to arithmetically
   decode the current spectral coefficient based on the
15 determined probability density function.
        15.  The device of claim 14, wherein the processor is
   configured to process the preceding spectral coefficients
   by non-uniformly de-quantising absolutes of the preceding
   spectral coefficients for use in determination of the
20 context state.
        16.  The device of claim 14, wherein the processor is
   configured to process the preceding spectral coefficients
   by de-quantizing the absolutes of the preceding spectral
   coefficients according a first de-quantization scheme,
25 determining a variance of the absolutes of the preceding
   spectral coefficients de-quantized according the first de
   quantization scheme, using the determined variance for
   selecting one of at least two different nonlinear second
   de-quantization schemes, and further de-quantizing the
30 absolutes of the preceding spectral coefficients de
   quantized according the first de-quantization scheme
   according to a selected nonlinear second de-quantization
   scheme.
        17.  The device of claim 16, wherein the processor is
35 configured to determine the variance of the absolutes of

                                31
   the preceding spectral coefficients de-quantized according
   the first de-quantization scheme by determining a sum of
   the absolutes of the preceding spectral coefficients de
   quantized according the first de-quantization scheme and
 5 comparing the determined sum with at least one threshold.
        18.  The device of claim 14, wherein the processor is
   configured to provide either a first outcome or at least a
   different second outcome and the context classifier is
   configured to determine the context state in response to
10 determining a number of preceding spectral coefficients
   being non-uniformly quantized to the first outcome, and use
   the determined number for determining the context class.
        19.  The device of claim 18, wherein the processor is
   configured to prefer one of the preceding spectral
15 coefficients over the preceding spectral coefficients
   remaining, and the context classifier is configured to use
   the nonuniformly de-quantization of the preferred one among
   the preceding spectral coefficient to determine the context
   state.
20

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn>   <removed-date>
        Fig. 7d

<removed-apn> <removed-date>
<removed-apn> <removed-date>
