                                          Abstract:
Systems and methods to optimise the performance of an electronic processing system in
accordance with predetermined rules such that the data records that are required to be
monitored for processing are reduced and the computation efficiency in processing the
transactions and relevant offers is improved in a transaction handler configured to process a
huge amount of transactions in real time and a rapidly increasing number of offers.

WO 2015/175893                                               PCT/US2015/031000
                                       1/12
                                     Received
                                     Value 401
                              421                    Accumulation
                                      21             Threshold 403
                                         Is
                         Yes      accumulation     No
                                  allowed by the
                                    threshold ?
           Add to the                                    Create a
         existing record                                new record
                            a         Record,,
                    Record A         Group        Record B
                       405                          415
 Monitor
                     Value A                      Value B
                       407                          417
                                       Move value
                    Retrieved
                    Value 419
                                     FIG. 1

     WO 2015/175893                                                   PCT/US2015/031000
      SYSTEMS AND METHODS TO ORGANIZE AND CONSOLIDATE DATA FOR
                    IMPROVED DATA STORAGE AND PROCESSING
                                RELATED APPLICATIONS
[0001]     The present application claims priority to U.S. Pat. App. Ser. No. 14/712,669,
filed May 14, 2015, and Prov. U.S. Pat. App. Ser. No. 61/994,004, filed May 15, 2014,
the entire disclosures of which are hereby incorporated herein by references.
[0002]     The present application relates to U.S. Pat. App. Ser. No. 13/648,849, filed
Oct. 10, 2012, published as U.S. Pat. App. Pub. No. 2013/0091000, and entitled
"Systems and Methods to Provide Discount at Point of Sales Terminals", U.S. Pat. App.
Ser. No. 13/676,535, filed Nov. 14, 2012, published as U.S. Pat. App. Pub. No.
2013/0124287, and entitled "Systems and Methods to Provide Discount at Point of Sales
Terminals", U.S. Pat. App. Ser. No. 13/804,435, filed Mar. 14, 2013, published as U.S.
Pat. Pub. No. 2013/0246150, and entitled "Systems and Methods to Apply the Benefit of
Offers via a Transaction Handler", U.S. Pat. App. Ser. No. 12/896,632, filed Oct. 1, 2010,
published as U.S. Pat. App. Pub. No. 2011/0087530, and entitled "Systems and Methods
to Provide Loyalty Programs," U.S. Pat. App. Ser. No. 13/152,186, filed Jun. 2, 2011,
issued as U.S. Pat. No. 8,359,274, and entitled "Systems and Methods to Provide
Messages in Real-Time with Transaction Processing," U.S. Pat. App. Ser. No.
13/237,457, filed Sep. 20, 2011, published as 2012/0078697, and entitled "Systems and
Methods to Program Operations for Interaction with Users," and U.S. Pat. App. Ser. No.
13/237,467, filed Sep. 20, 2011, published as 2012/0072997, and entitled "Systems and
Methods to Modify Interaction Rules during Run Time," the entire disclosures of which
applications are hereby incorporated herein by reference.
                              FIELD OF THE TECHNOLOGY
[0003]     At least some embodiments of the present disclosure relate to the organization
of data for real time processing in an electronic processing network.
                                      BACKGROUND
                                           -- 1 --

     WO 2015/175893                                                   PCT/US2015/031000
[0004]      U.S. Pat. No. 8,359,274 discloses an electronic processing system that is
configured to process transactions, identify transactions relevant to offers, and provide
messages related to the offers in real-time with the processing of the transactions in an
electronic processing network.
[0005]      U.S. Pat. App. Pub. No. 2012/0078697 discloses a way to program the
processing of offer campaigns via data records of anticipated events of predetermined
types, linked by pre-requisite conditions such that when the anticipated events are
detected in a sequence corresponding to data records linked by the pre-requisite
conditions, actions specified in the data records are performed for the offer campaigns,
including the transmission of real-time messages in connection with the processing of
the relevant transactions in an electronic processing network.
[0006]     The disclosures of the above discussed patent documents are hereby
incorporated herein by reference.
                        BRIEF DESCRIPTION OF THE DRAWINGS
[0007]     The embodiments are illustrated by way of example and not limitation in the
figures of the accompanying drawings in which like references indicate similar elements.
[0008]      Figure 1 shows a data processing system to organize and consolidate data for
improved data storage and processing according to one embodiment.
[0009]      Figure 2 shows a system to manage multiple discounts according to one
embodiment.
[0010]      Figure 3 shows another system to manage multiple discounts according to
one embodiment.
[0011]      Figure 4 shows a method to manage multiple discounts via a technique to
organize and consolidate data according to one embodiment.
[0012]      Figure 5 shows a system configured to allow the dynamic configuration of the
processing of offers and loyalty programs having different structures according to one
embodiment.
[0013]      Figure 6 shows a system to apply a discount offer via an authorization request
according to one embodiment.
[0014]      Figure 7 shows a system to apply a discount offer via an authorization
                                           -- 2--

     WO 2015/175893                                                    PCT/US2015/031000
response according to one embodiment.
[0015]     Figure 8 shows a system to provide the benefit of an offer according to one
embodiment.
[0016]     Figure 9 shows a method to provide the benefit of an offer according to one
embodiment.
[0017]     Figure 10 illustrates a system to provide services based on transaction data
according to one embodiment.
[0018]     Figure 11 shows the structure of account data for providing loyalty programs
according to one embodiment.
[0019]     Figure 12 shows a system to provide real-time messages according to one
embodiment.
[0020]     Figure 13 shows a system to provide information based on transaction data
according to one embodiment.
[0021]     Figure 14 illustrates a transaction terminal according to one embodiment.
[0022]     Figure 15 illustrates an account identifying device according to one
embodiment.
[0023]     Figure 16 illustrates a data processing system according to one embodiment.
                                 DETAILED DESCRIPTION
[0024]     It is a challenge to optimize the performance of an electronic processing
system that is configured to process both transactions and offers in real time, especially
in an electronic processing network that is tasked to process a huge amount of
transactions in real time while there is a demand to accommodate a rapidly increasing
number of offers.
[0025]     One embodiment disclosed herein dynamically combines offer data records in
accordance with predetermined rules such that the data records that are required to be
monitored for processing are reduced and the computation efficiency in processing the
transactions and relevant offers is improved.
[0026]     Figure 1 shows a data processing system to organize and consolidate data for
improved data storage and processing according to one embodiment.
[0027]     In Figure 1, the system is configured to track values (e.g., 401) that are added
                                            -- 3--

      WO 2015/175893                                                    PCT/US2015/031000
to a user account and track values (e.g., 419) that are retrieved from the user account in
response to relevant transactions.
[0028]      For example, in response to a relevant transaction in the user account that
satisfies a predetermined set of conditions, a value (401) may be added to the user
account.     For example, in response to another relevant transaction in the user account
that satisfies another predetermined set of conditions, another value (419) may be
retrieved from the user account for application towards the transaction.     The system is
configured to monitor the transactions to detect the an applicable record (e.g., 407) and
a relevant transaction such that at least a portion of the value (407) identified in the
record (407) can be retrieved and applied to the corresponding relevant transaction.
[0029]      In Figure 1, the system is configured to maintain at most one active record
(405) that is being monitored for the detection of a transaction that qualifies to retrieve at
least a portion of the value from the record (405).   When the user account has no
retrievable value, there is no record maintained for the user account in one embodiment.
[0030]      In Figure 1, the system is configured with an accumulation threshold (403).
When a received value (401) is to be added to the user account, the system identifies a
currently record (405) that has a value lower than the threshold (403) and determines
(421) if the received value (401) can be added to the existing record (405) in accordance
with the accumulation threshold (403).
[0031]      For example, when the sum of the existing value (407) of the record (405) and
the received value (401) is no more than the accumulation threshold (403), the received
value (401) is added to the record (405) such that the value (407) of the record (405) is
updated to be equal to the sum.
[0032]      In one embodiment, when the sum of the existing value (407) of the record
(405) and the received value (401) exceeds the accumulation threshold (403), a portion
of the received value (401) is added to the record (405) to bring the value (407) to the
accumulation threshold (403), and the remaining portion of the received value (401) is
used to create a new record (415) having the value (417).
[0033]      In Figure 1, the records (405 and 415) are organized as a record group (411)
corresponding to the same set of conditions for the detection of qualified transactions for
value retrieval.   In response to a relevant transaction, a portion or the entire value (407)
                                            -- 4--

     WO 2015/175893                                                    PCT/US2015/031000
of the active record (405) can be retrieved and applied to the relevant transaction.
[0034]     The system is configured to maintain records such that at most one of the
records has a value (e.g., 417) that is lower than the accumulation threshold (403).
Thus, in response to the received value (401), the system is configured to use the
received value to bring the value (417) of the record (415) that is lower than the
accumulation threshold (403) up to the accumulation threshold (403) and create a new
record for the remaining portion of the received value (401), if there is a remaining
portion of the received value (401) to be added to the user account.
[0035]     When there is more than one record in the record group (411), the system is
configured to monitor a record that has the value (407) equal to the accumulation
threshold (403).    Thus, only one record in the group (411) is active.
[0036]      In some embodiments, the record group (411) includes at most two records
(405 and 415).     When there are two records (405 and 415), a record (405) having the
value (407) equals to the accumulation threshold (403) is actively being monitored for the
detection of a relevant transaction, and the other record (415) is configured to hold the
remaining value added to the user account, which may have a value (417) above or
below the threshold (403).     Such an embodiment further optimizes the data storage for
the system.
[0037]      In one embodiment, for each transaction in the user account, the system
determines if a set of predetermined conditions are all satisfied by the transaction; and if
so, at least a portion of the value (407) can be retrieved from the record (405) and
applied to the transaction.
[0038]      In Figure 1, in response to the retrieved value (419) being deducted from the
record (405), the system is configured to move at least a portion of the value (417) from
the record (415) in the group (411) to bring the value (407) of the record (415) up to the
accumulation threshold (403).
[0039]      For example, when the record group (411) includes two records (405 and
415), a portion of the value (417) of the inactive record (415) can be moved to the record
(405) to bring up the value (407) up to the threshold (403).   When the value (417) of the
record (415) is reduced to zero, the record (415) can be deleted.
[0040]      In some embodiments, when the record group (411) includes more than two
                                            -- 5--

      WO 2015/175893                                                      PCT/US2015/031000
records (405 and 415), at least a portion of the value (417) of the inactive record (415)
that has a value (417) lower than the threshold (403) is first moved to the record (405) to
bring up the value (407) up to the threshold (403).      When the value (417) of the record
(415) is reduced to zero, the record (415) can be deleted.       If the value (407) of the
record (405) is still lower than the threshold (403), a portion of the value from another
record can be moved to the record (405).        Thus, after the completion of the move
operation, there is at most one record (415) having a value lower than the threshold
(403); and other records have values equal to the threshold (403).
[0041]      In some embodiments, when the record group (411) includes more than two
records (405 and 415), the system is configured to select another record having a value
equal to the threshold (403) as the active record for monitoring and then schedule the
operations to combine records having values lower than the thresholds in a background
process.
[0042]      The techniques discussed above improves the real time processing
performance of monitoring transactions in view of active records (e.g., 405) to detect a
qualified transaction that meets the requirements of a monitored record (e.g., 405) and
the applicable record (e.g., 405) from which at least a portion of the value (407) can be
retrieved for application towards the transaction, especially when the operations to
combine records are scheduled to be performed in a background process.
[0043]      Figure 1 illustrates an example of a group (411) of records (405, 415) that
have the same set of requirements for a transaction to be qualified to retrieve values
from the records.      In general, a user account may include multiple groups of records,
where different record groups have different qualification requirements for transactions.
[0044]      The techniques discussed above can be used for discount aggregation, which
allows an offer to specify a threshold for maximum discounts that can be redeemed in
one transaction.     For example, an offer may allow only one discount to be redeemed at
a time, or more than one discount to be redeemed in one transaction.          The system and
method further allow an offer to provide partial discount redemption.        After partial
discount redemption, data is stored to indicate the remainder amount of the partially
redeemed discount so that the user may redeem the unclaimed portion of the discount in
a subsequent payment transaction.
                                             -- 6--

      WO 2015/175893                                                     PCT/US2015/031000
[0045]       For example, a system and method is configured in one embodiment to
process multiple discounts earned from the same offer campaign and/or partial
redemption of a discount offer.      The system and method stores information to allow the
modification of the offer benefit based on transaction history of one or more payment
accounts linked to the offer, such as modifications based on transactions that earn
discounts in accordance with the offer and transactions that partially redeem discounts
provided by the offer.     The information may include a field identifying the maximum
number of discounts that can be combined for redemption via a single transaction.
[0046]       For example, when an offer provides a $5 discount for each qualified
transaction, with a limit of up to 2 discounts redeemable in a single transaction, the
system generates a first record to provide $5 discount in response to the detection of a
first qualified transaction.   When a second qualified transaction is detected, the first
record is updated to show $10 discount, instead of generating a second record.          When
a third qualified transaction is detected, a second record providing $5 discount is
generated and queued after the first record.        When a redeeming transaction qualifies
only for a $7 discount, the benefit identified in the first record is updated to $3 (= $10
$7), which may be combined with the second record, resulting in a combined discount
amount of $8 (= $5 + $3).       Thus, the efficiency of the system is improved in providing
the capability of aggregating discounts and/or partial redemption.
[0047]       In one embodiment, a discount manager (217) is configured to keep track of
the multiple discounts, and stack the remainder amount for each discount per user.
The enhancement allows the aggregation of amount discounts, percentage discounts,
per unit discounts, etc.
[0048]       In one embodiment, the discount manager (217) allows an offer to indicate
whether or not to honor the remainder amount of a partially redeemed discount.          If
honored, the system allows the user to redeem remainder amount of a partially
redeemed discount in a subsequent transaction.
[0049]       Figure 2 shows a system to manage multiple discounts according to one
embodiment.        In Figure 2, an offer (186) is configured to allow a user (101) to earn
discounts via first transactions made using the consumer account (146) identified by the
account information (142), and to redeem the earned discounts via second transactions
                                              -- 7--

     WO 2015/175893                                                       PCT/US2015/031000
made using the consumer account (146).
[0050]      In Figure 2, the offer (186) includes offer rules (193), such as awardable
discount (641), combination limit (643) for the discounts, etc.
[0051]      In one embodiment, the awardable discount (641) identifies the amount of
discount that the user (101) may earn in response to a qualifying event, such as the
authorization request (168) or the authorization response (138) for a payment
transaction that satisfies a set of conditions identified in the offer rules (193), enrollment
in a program, checking in with a merchant on a social network site, etc.        The amount of
the discount may be predetermined (e.g., $5 off per qualifying event), or determined
based on the transaction amount of the qualifying transaction (e.g., a discount of %10 of
the current transaction applicable to the next transaction).
[0052]      In one embodiment, discounts may be provided in terms of the transaction
amount of the subsequent transaction that satisfies the requirements for the redemption
of the offer (186).   For example, an offer (186) may be configured to provide a 10%
discount off the next payment transaction with the merchant, when the current payment
transaction meets the requirement for awarding the discount.
[0053]      In one embodiment, discounts may be provided in terms of the purchase price
of a specific item paid for by the subsequent transaction that satisfies the requirements
for the redemption of the offer (186).     For example, an offer (186) may be configured to
provide a 10% discount off or $1 off the price of a specific item purchased via the next
payment transaction with the merchant, when the current payment transaction meets the
requirement for awarding the discount.
[0054]      For example, in one embodiment, in response to a determination that the
transaction corresponding to the authorization response (138) satisfies the conditions for
awarding a discount in accordance with the offer rules (193) of the offer (186), the data
warehouse (149) stores the data identifying the redeemable discount (647) of the offer
(186).
[0055]      In Figure 2, the combination limit (643) indicates the upper limit of discounts
that can be combined for redemption in a single payment transaction.
[0056]      For example, the offer (186) may limit the combination of discounts up to a
predetermined threshold (e.g., no more than $20 discounts can be redeemed in a single
                                             -- 8--

     WO 2015/175893                                                     PCT/US2015/031000
payment transaction).
[0057]      For example, the offer (186) may limit the combination of discounts up to a
predetermined percentage of the transaction amount of the payment transaction that
satisfies the discount redemption requirements (e.g., no more than 20% discounts can
be redeemed in a single payment transaction).
[0058]      For example, the offer (186) may limit the combination of discounts up to a
predetermined discounts (e.g., no more than 3 discounts can be redeemed in a single
payment transaction, where each discount provides a 10% or $1 off the purchase price
of a specific product paid for via the payment transaction).
[0059]      For example, the offer (186) may limit the combination of discounts up to a
predetermined number of discounts (e.g., no more than 3 discounts that can be
combined for redemption in a single payment transaction).
[0060]      In Figure 2, when the user (101) earns more than one discount in accordance
with the offer rules (193) of the offer (186), the data warehouse (149) is configured to
combine the discounts in the redeemable discount (647) in accordance with the offer
rules (193).    The redeemable discount (647) identifies the discounts accumulated
according to the combination limit (643) for redemption in a single transaction.
[0061]      For example, in one embodiment, when the authorization request (168) or the
authorization response (138) for transaction is determined to satisfy the redemption
requirements of the offer rules (193) of the offer (186), the transaction handler (103) is
configured to apply the redeemable discount (647) to the transaction by adjusting the
transaction amount in a way as illustrated in Figures 6 - 9 and discussed in section
entitled "APPLY OFFER".
[0062]      In one embodiment, when the benefit of the discount is sponsored by a third
party (e.g., an advertisement network, a product manufacturer, a government entity, a
charity organization), the benefit of the discount can be applied to the transaction by
seamlessly combining a transaction with the issuer processor (145) for a discounted
payment transaction and a transaction with the sponsor for the cost of the discount to
meet the requirements of the requested transaction from the transaction terminal (105),
as further described in U.S. Pat. Pub. No. 2013/0246150, entitled "Systems and Methods
to Apply the Benefit of Offers via a Transaction Handler", the disclosure of which is
                                             -- 9--

     WO 2015/175893                                                    PCT/US2015/031000
hereby incorporated herein by reference.
[0063]      In one embodiment, when the discounts earned by the user (101) exceed the
combination limit (643), the data warehouse (149) is configured to store a further data
record to track the additional discounts that can be redeemed after the redeemable
discount (647) is redeemed and applied to a qualifying transaction.
[0064]      In some embodiments, the redeemable discount (647) records the discounts
earned by the user (101) in accordance with the offer rules (193); and the transaction
handler (103) is configured to dynamically combine discounts according to the
combination limit (643) at the time of redemption (e.g., in response to a transaction that
meets the redemption requirements).
[0065]      In one embodiment, the offer rules (193) also indicate whether partial
redemption of a discount is allowable.      For example, when the transaction amount of a
transaction is smaller than the amount of discount provided by the redeemable discount
(647), the offer rules (193) may allow the unused portion of the redeemable discount
(647) to remain in the data record for redemption in a subsequent transaction.
[0066]      For example, when the redeemable discount (647) provides the benefit of $10
off a qualifying transaction and a redeeming transaction has a transaction amount of
$6.5, the unused portion of the redeemable discount (647) is $3.5 (= $10- $6.5).      When
the offer rules (193) allow partial redemption, the transaction handler (103) is configured
to apply the $6.5 discount to the transaction; and the redeemable discount (647) is
updated to indicate a discount of $3.5 available for redemption in a future transaction.
When the offer rules (193) prohibit partial redemption, the transaction handler (103) is
configured to apply the $6.5 discount to the transaction; and the redeemable discount
(647) is cleared or removed.
[0067]      In one embodiment, the offer rules (193) may also specify the requirements to
be met by the redeeming transaction in order to apply the redeemable discount (647).
For example, the offer rules (193) may require that the transaction amount of the
redeeming transaction be above a threshold to qualify for the benefit of the redeemable
discount (647).     For example, the offer rules (193) may require that the transaction
amount of the redeeming transaction be above the amount of the awardable discount
(641) to qualify for the benefit of the redeemable discount (647).
                                            -- 10--

     WO 2015/175893                                                      PCT/US2015/031000
[0068]      In one embodiment, a single trigger record (313) is configured for the detection
of both the transactions that qualify for earning the awardable discounts (641) and the
transactions that qualify for the redemption of the redeemable discount (647).
Alternatively, separate trigger record (313) can be configured for the detection of the
transactions that qualify for earning the awardable discounts (641) and for the detection
of the transactions that qualify for the redemption of the redeemable discount (647).
[0069]      Figure 3 shows another system to manage multiple discounts according to
one embodiment.       In Figure 3, separate trigger records (313 and 649) are used to
detect transactions that may be qualified for receiving the awardable discount (641) and
to detect transaction that may be qualified for the redemption of redeemable discount
(647).
[0070]      In Figure 3, the trigger record (313) is configured to trigger the processing of
offer (186) to reward the awardable discount (641).       For example, if the authorization
response (138) or the authorization request (168) of a transaction meets the requirement
of the trigger record (313), the trigger record (313) causes the processing of the offer
(186) to determine if the transaction qualifies for the awardable discount (641).      If the
transaction qualifies for the awardable discount (641), the offer (645) is activated to
associated the redeemable discount (647) with the account information (142) identified in
the transaction.
[0071]      In one embodiment, activating the offer (645) for association with the account
information (142) is in accordance with the offer rules (193), such as the awardable
discount (641), the combination limit (643), etc.    For example, if the account information
(142) does not have a previously earned offer (645) containing redeemable discount
(647) awarded in accordance with the offer rules (193), the offer (645) is linked to the
account information (142) with the redeemable discount (647) being set according to the
awardable discount (641) for the transaction.      For example, if the discounts combined in
the offer (645) have not reached the combination limit (643), the awardable discount
(641) earned from the transaction is added to the redeemable discount (647) of the offer
(645).    For example, if the discounts combined in the offer (645) have reached the
combination limit (643), a separate offer is activated and linked to the account
information (142) to provide the awardable discount (641) as the redeemable discount
                                            -- 11 --

     WO 2015/175893                                                          PCT/US2015/031000
(647) of the separate offer.     The separate offer is queued after the offer (645) for
redemption (e.g., no trigger record is generated for the separate offer until the benefit of
the offer (645) is redeemed).
[0072]      In Figure 3, the trigger record (649) is configured to trigger the processing of
offer (645) to redeem the benefit of the redeemable discount (647).            For example, if the
authorization response (138) or the authorization request (168) of a transaction meets
the requirement of the trigger record (649), the trigger record (649) causes the
processing of the offer (645) to determine if the transaction qualifies for the benefit of the
redeemable discount (647).        If the transaction qualifies for the benefit of the redeemable
discount (647), the transaction handler (103) is configured to provide the applicable
discount via modification of the transaction amount, as illustrated in Figures 6 - 9 when
the discount is sponsored by the merchant, or via combining a modified transaction with
a separate transaction with the sponsor to meet the required transaction with the
acquirer processor (147), in a way as illustrated in U.S. Pat. Pub. No. 2013/0246150,
when the discount is not sponsored by the merchant.
[0073]      When the offer rules (193) prohibit partial redemption of the redeemable
discount (647), the offer (645) is unlinked from the account information (142) after the
benefit of the offer (645) is applied to a redeeming transaction.        If there is a separate
offer with an amount of redeemable discount queued after the offer (645) for redemption,
the trigger record (649) is updated to trigger the processing of the separate offer.
Alternatively, the trigger record (649) for the offer (645) can be deleted; and a new trigger
record can be generated for the separate offer (645).
[0074]      When the offer rules (193) allows partial redemption of the redeemable
discount (647) and the redeeming transaction uses only a portion of the redeemable
discount (647), the redeemable discount (647) of the offer (645) is updated to identify the
remaining portion of the unused discount.         Thus, when a subsequent redeeming
transaction is detected via the trigger record (649), the remaining portion of the unused
discount can be applied to the subsequent redeeming transaction in a similar way.
Further, if there is a separate offer having an amount of redeemable discount queued
after the offer (645) for redemption, it is determined whether the redeemable discount of
the separate offer can be combined with the offer (645) in accordance with the
                                              -- 12 --

     WO 2015/175893                                                        PCT/US2015/031000
combination limit (643); and if so, the redeemable discount (647) is updated to include
the discount provided in the separate offer which, after the combination, can be
eliminated or unlinked from the account information (142).
[0075]     Figure 4 shows a method to manage multiple discounts via a technique to
organize and consolidate data according to one embodiment.            For examples, the
method of Figure 4 can be implemented using the technique of Figure 1 in the system of
Figure 2 or 3.
[0076]     In one embodiment, a computing apparatus is configured to: store (431) an
offer (186) identifying a first set of conditions, a second set of conditions, and a threshold
(403 or 643); store (433) a first record (405) including a first value (407) lower than the
threshold (403 or 643) for a discount previously awarded to a user according to the offer
(186); detect (435) a first transaction that meets the first set of conditions; compute (437)
a second value (401) to be awarded to the user in accordance with the offer (186); and
determine (439) if the sum of the first value (405) and the second value (401) is above
the threshold (403 or 643).
[0077]     If the sum is determined (439) to be above threshold (403 or 643), the
computing apparatus updates (443) the first record (405) to identify the sum; otherwise,
the computing apparatus updates (447) the first record (405) to identify the threshold
(403) and generates (449) a second record (415) to identify the difference between the
sum and the threshold (403 or 643).
[0078]     The computing apparatus is further configured to detect (445) a second
transaction that meets the second set of conditions and retrieve (451) at least a portion
of the value (e.g., 419) from the first record (405) for application to the second
transaction.    Examples of applying the value to a transaction are provided further below.
[0079]     In one embodiment, the offer (186) is configured to provide discounts; and the
computing apparatus is configured to aggregate discounts earned by the user in
accordance with the offer (186).       The offer (186) specifies a threshold for maximum
number of discounts that can be redeemed in one transaction, which is used to
determine the accumulation threshold (403).           For example, an offer may allow only one
discount to be redeemed at a time, or more than one discount to be redeemed in one
transaction.    The offer allows partial discount redemption such that in a qualified
                                              -- 13--

     WO 2015/175893                                                        PCT/US2015/031000
transaction the user may use only a person of the discounts and save the unused portion
of the discounts for a subsequent transaction.        After partial discount redemption, data is
stored to indicate the remainder amount of the partially redeemed discount so that the
user may redeem the unclaimed portion of the discount in a subsequent payment
transaction.
[0080]     Based on the transaction data, the computing apparatus may further present
personalized or targeted advertisements/offers on behalf of advertisers.         A computing
apparatus of, or associated with, the transaction handler uses the transaction data
and/or other data, such as account data, merchant data, search data, social networking
data, web data, etc., to develop intelligence information about individual customers, or
certain types or groups of customers.       The intelligence information can be used to
select, identify, generate, adjust, prioritize, and/or personalize advertisements/offers to
the customers.     Some examples of targeted offer delivery are provided in U.S. Pat. No.
8,606,630, entitled "Systems and Methods to Deliver Targeted Advertisements to
Audience", the entire disclosure of which is hereby incorporated herein by reference.
[0081]     For example, the computing apparatus can be configured to generate trigger
records for a transaction handler to identify authorization requests that satisfy the
conditions specified in the trigger records, identify communication references of the
users associated with the identified authorization requests, and use the communication
references to target real-time messages at the users in parallel with the transaction
handler providing responses to the respective authorization requests.          Details in one
embodiment regarding the generation and delivery of messages in real-time with the
processing of transactions are provided in the section entitled "REAL-TIME
MESSAGES", and U.S. Pat. Nos. 8,359,274 and 8,407,148, both entitled "Systems and
Methods to Provide Messages in Real-Time with Transaction Processing", the entire
disclosures of which are hereby incorporated herein by reference.
[0082]     For example, the computing apparatus can be programmable for real-time
interaction with users to provide messages and/or offers, validate fulfillment conditions,
and provide benefits to qualified users to fulfill the offers.     In one embodiment, the
computing apparatus is configured to be programmed via accepting definitions of
independent events and linking the events via prerequisite requirements to specify
                                             -- 14 --

     WO 2015/175893                                                       PCT/US2015/031000
qualification conditions.   The linked events form a flow or network of events; and user
progress in the flow or network of events is tracked.     The operations for each event are
performed in an atomic way to allow the user positions in the flow or network of events to
be identified as being in between adjacent events in the network.       As a result, the
programming of the real-time interaction, including the offer rules and messages, can be
easily modified during the execution of the programming.        Details in one embodiment
regarding the formulation and management of real-time interaction are provided in U.S.
Pat. App. Pub. No. 2012/0078697, entitled "Systems and Methods to Program
Operations for Interaction with Users", the entire disclosure of which application is
hereby incorporated herein by reference.
[0083]      For example, the computing apparatus can be configured to include a set of
autonomous components coupled together via a messaging system and a workflow for
an offer or loyalty program.    The processing of different offers or loyalty programs can
be programmed via customizing the workflows of the autonomous components and their
configuration parameters.     When a transaction that may be relevant to an offer or
loyalty program is detected, the data about the transaction and other relevant data,
including the workflow of the offer or loyalty program and the processing results of
relevant components, can be posted on the messaging system for further processing
according to the workflow.     Thus, the computing apparatus can support the rapid
development and deployment of offers or loyalty programs having different structures
and rules.    Details in one embodiment regarding such a computing platform for the
processing of offers and loyalty programs are provided in the section entitled "DYNAMIC
PROCESSING FLOW".
[0084]      In one embodiment, the transaction handler is configured to apply the benefit
of a registered offer during the authorization of a qualified transaction that meets the
requirements for the redemption of the offer.      For example, the benefit of the registered
offer can be provided in the form of a reduced transaction amount authorized for the
qualified transaction, reduced via the transaction handler changing the transaction
amount in authorization messages during the authorization phase of the transaction in
one embodiment.       The transaction handler is configured in one embodiment to further
embed information about the offer based on which the transaction amount is modified in
                                           -- 15--

     WO 2015/175893                                                      PCT/US2015/031000
the authorization response transmitted, via the acquirer processor of the merchant, to
the transaction terminal of the merchant.       The embedded information allows the
transaction terminal to prompt an operation to accept the reduced transaction amount
and/or to request further details to decide whether or not to accept the transaction
amount, to provide information to the merchant system for bookkeeping and/or track the
effectiveness of the offer campaign, and/or to identify the offer in the receipt for the
transaction.    Further details and examples are provided in the section entitled "APPLY
OFFER" and U.S. Pat. App. Pub. Nos. 2013/0091000 and 2013/0124287, both entitled
"Systems and Methods to Provide Discount at Point of Sales Terminals", the entire
disclosures of which applications are hereby incorporated herein by reference.
[0085]     For example, the computing apparatus correlates transactions with activities
that occurred outside the context of the transaction, such as online advertisements
presented to the customers that at least in part cause offline transactions.     The
correlation data can be used to demonstrate the success of the advertisements, and/or
to improve intelligence information about how individual customers and/or various types
or groups of customers respond to the advertisements.         Examples of correlating offline
transactions with online activities can be found in U.S. Pat. No. 8,626,579, entitled
"Systems and Methods for Closing the Loop between Online Activities and Offline
Purchases", the entire disclosure of which is hereby incorporated herein by reference.
[0086]     In one embodiment, a single entity operating the transaction handler performs
various operations in the services provided based on the transaction data.       For
example, in the presentation of the personalized or targeted advertisements, the single
entity may perform the operations such as generating the intelligence information,
selecting relevant intelligence information for a given audience, selecting, identifying,
adjusting, prioritizing, personalizing and/or generating advertisements based on selected
relevant intelligence information, and facilitating the delivery of personalized or targeted
advertisements, etc.     Alternatively, the entity operating the transaction handler
cooperates with one or more other entities by providing information to these entities to
allow these entities to perform at least some of the operations for presentation of the
personalized or targeted advertisements.
TRANSACTION DATA BASED SERVICES
                                             -- 16 --

     WO 2015/175893                                                       PCT/US2015/031000
[0087]      Figure 10 illustrates a system to provide services based on transaction data
according to one embodiment.         In Figure 10, the system includes a transaction terminal
(105) to initiate financial transactions for a user (101), a transaction handler (103) to
generate transaction data (109) from processing the financial transactions of the user
(101) (and the financial transactions of other users), a profile generator (121) to generate
transaction profiles (127) based on the transaction data (109) to provide
information/intelligence about user preferences and spending patterns, a point of
interaction (107) to provide information and/or offers to the user (101), a user tracker
(113) to generate user data (125) to identify the user (101) using the point of interaction
(107), a profile selector (129) to select a profile (131) specific to the user (101) identified
by the user data (125), and an advertisement selector (133) to select, identify, generate,
adjust, prioritize and/or personalize advertisements for presentation to the user (101) on
the point of interaction (107) via a media controller (115).
[0088]      In Figure 10, the system further includes a correlator (117) to correlate user
specific advertisement data (119) with transactions resulting from the user specific
advertisement data (119).       The correlation results (123) can be used by the profile
generator (121) to improve the transaction profiles (127).
[0089]     The transaction profiles (127) of one embodiment are generated from the
transaction data (109).      For example, an aggregated spending profile can be generated
via a factor analysis and cluster analysis to summarize the spending patterns/behaviors
reflected in the transaction records, in a way as illustrated in U.S. Pat. App. Pub. No.
2010/0306032, the disclosure of which is hereby incorporated herein by reference.
[0090]      In one embodiment, a data warehouse (149) as illustrated in Figure 13 is
coupled with the transaction handler (103) to store the transaction data (109) and other
data, such as account data (111), transaction profiles (127) and correlation results (123).
In Figure 13, a portal (143) is coupled with the data warehouse (149) to provide data or
information derived from the transaction data (109), in response to a query request from
a third party or as an alert or notification message.
[0091]      In Figure 13, the transaction handler (103) is coupled between an issuer
processor (145) in control of a consumer account (146) and an acquirer processor (147)
in control of a merchant account (148).      An account identification device (141) is
                                             -- 17--

     WO 2015/175893                                                     PCT/US2015/031000
configured to carry the account information (142) that identifies the consumer account
(146) with the issuer processor (145) and provide the account information (142) to the
transaction terminal (105) of a merchant to initiate a transaction between the user (101)
and the merchant.
[0092]      Figures 14 and 15 illustrate examples of transaction terminals (105) and
account identification devices (141).    Figure 16 illustrates the structure of a data
processing system (170) that can be used to implement, with more or fewer elements, at
least some of the components in the system, such as the point of interaction (107), the
transaction handler (103), the portal (143), the data warehouse, the account
identification device (141), the transaction terminal (105), the user tracker (113), the
profile generator (121), the profile selector (129), the advertisement selector (133), the
media controller (115), etc.   Some embodiments use more or fewer components than
those illustrated, such as, in Figures 10 and 13 - 16, and other figures, as further
discussed in the section entitled "VARIATIONS."
[0093]      In one embodiment, the transaction data (109) relates to financial transactions
processed by the transaction handler (103); and the account data (111) relates to
information about the account holders involved in the transactions.      Further data, such
as merchant data that relates to the location, business, products and/or services of the
merchants that receive payments from account holders for their purchases, can be used
in the generation of the transaction profiles (127).
[0094]      In one embodiment, the financial transactions are made via an account
identification device (141), such as financial transaction cards (e.g., credit cards, debit
cards, banking cards, etc.); the financial transaction cards may be embodied in various
devices, such as plastic cards, chips, radio frequency identification (RFID) devices,
mobile phones, personal digital assistants (PDAs), etc.; and the financial transaction
cards may be represented by account identifiers (e.g., account numbers or aliases).         In
one embodiment, the financial transactions are made via directly using the account
information (142), without physically presenting the account identification device (141).
[0095]      Further features, modifications and details are provided in various sections of
this description.
CENTRALIZED DATA WAREHOUSE
                                           -- 18 --

     WO 2015/175893                                                     PCT/US2015/031000
[0096]      In one embodiment, the transaction handler (103) couples with a centralized
data warehouse (149) organized around the transaction data (109).         For example, the
centralized data warehouse (149) may include, and/or support the determination of,
spend band distribution, transaction count and amount, merchant categories, merchant
by state, cardholder segmentation by velocity scores, and spending within merchant
target, competitive set and cross-section.     For example, the centralized data warehouse
(149) may include the advertisement data (135) and/or offers of benefits such as
discount, reward, points, cashback, etc.      The offers can be communicated to the users
(e.g., 101) via the advertisement data (135) or as part of the advertisement data (135).
[0097]      In one embodiment, the centralized data warehouse (149) provides
centralized management but allows decentralized execution.        For example, a third party
strategic marketing analyst, statistician, marketer, promoter, business leader, etc., may
access the centralized data warehouse (149) to analyze customer and shopper data, to
provide follow-up analyses of customer contributions, to develop propensity models for
increased conversion of marketing campaigns, to develop segmentation models for
marketing, etc.    The centralized data warehouse (149) can be used to manage
advertisement campaigns and analyze response profitability.
[0098]      In one embodiment, the centralized data warehouse (149) includes merchant
data (e.g., data about sellers), customer/business data (e.g., data about buyers), and
transaction records between sellers and buyers over time.       The centralized data
warehouse (149) can be used to support corporate sales forecasting, fraud analysis
reporting, sales/customer relationship management (CRM) business intelligence, credit
risk prediction and analysis, advanced authorization reporting, merchant benchmarking,
business intelligence for small business, rewards, etc.
[0099]      In one embodiment, the transaction data (109) is combined with external data,
such as surveys, benchmarks, search engine statistics, demographics, competition
information, emails, etc., to flag key events and data values, to set customer, merchant,
data or event triggers, and to drive new transactions and new customer contacts.
TRANSACTION PROFILE
[00100]     In Figure 10, the profile generator (121) generates transaction profiles (127)
                                           --  19--

      WO 2015/175893                                                      PCT/US2015/031000
based on the transaction data (109), the account data (111), and/or other data, such as
non-transactional data, wish lists, merchant provided information, address information,
information from social network websites, information from credit bureaus, information
from search engines, and other examples discussed in U.S. Pat. App. Pub. No.
2011/0054981, and entitled "Analyzing Local Non-Transactional Data with Transactional
Data in Predictive Models," the disclosure of which is hereby incorporated herein by
reference.
[0100]      In one embodiment, the transaction profiles (127) provide intelligence
information on the behavior, pattern, preference, propensity, tendency, frequency, trend,
and budget of the user (101) in making purchases.         In one embodiment, the transaction
profiles (127) include information about what the user (101) owns, such as points, miles,
or other rewards currency, available credit, and received offers, such as coupons loaded
into the accounts of the user (101).     In one embodiment, the transaction profiles (127)
include information based on past offer/coupon redemption patterns.           In one
embodiment, the transaction profiles (127) include information on shopping patterns in
retail stores as well as online, including frequency of shopping, amount spent in each
shopping trip, distance of merchant location (retail) from the address of the account
holder(s), etc.
[0101]      In one embodiment, the transaction handler (103) (and/or the portal (143)) is
configured to provide at least part of the intelligence for the prioritization, generation,
selection, customization and/or adjustment of the advertisement for delivery within a
transaction process involving the transaction handler (103).      For example, the
advertisement may be presented to a customer in response to the customer making a
payment via the transaction handler (103).
[0102]      Some of the transaction profiles (127) are specific to the user (101), or to an
account of the user (101), or to a group of users of which the user (101) is a member,
such as a household, family, company, neighborhood, city, or group identified by certain
characteristics related to online activities, offline purchase activities, merchant
propensity, etc.
[0103]      The transaction profiles (127) of one embodiment include the values for a set
of parameters.     Computing the values of the parameters may involve counting
                                             -- 20 --

     WO 2015/175893                                                       PCT/US2015/031000
transactions that meet one or more criteria, and/or building a statistically-based model in
which one or more calculated values or transformed values are put into a statistical
algorithm that weights each value to optimize its collective predictiveness for various
predetermined purposes.
[0104]      In one embodiment, the characteristics of transaction patterns of customers
are profiled via clusters, factors, and/or categories of purchases.      Further details and
examples in one embodiment are provided in U.S. Pat. App. Pub. No. 2010/0306032,
entitled "Systems and Methods to Summarize Transaction Data", and U.S. Pat. App.
Pub. No. 2010/0306029, entitled "Cardholder Clusters".
[0105]      In one embodiment, a set of profiles are generated from the transaction data
for a plurality of geographical regions, such as mutually exclusive, non-overlapping
regions defined by postal codes.       Transactions of account holders residing in the
regions are aggregated according to merchant categories for the respective regions and
subsequently normalized to obtain preference indicators that reveal the spending
preferences of the account holders in the respective regions.       Each of the profiles for
respective regions is based on a plurality of different account holders and/or households
to avoid revealing private information about individual account holders or families.
Further, the profiles are constructed in a way to make it impossible to reverse calculate
the transaction amounts.      Further details and examples about profiles constructed for
regions in one embodiment are provided in U.S. Pat. App. Pub. No. 2013/0124263,
entitled "Systems and Methods to Summarize Transaction data," the disclosure of which
is hereby incorporated herein by reference.
LOYALTY PROGRAM
[0106]      In one embodiment, the transaction handler (103) uses the account data (111)
to store information for third party loyalty programs.
[0107]      Figure 11 shows the structure of account data (111) for providing loyalty
programs according to one embodiment.           In Figure 11, data related to a third party
loyalty program may include an identifier of the loyalty benefit offeror (183) that is linked
to a set of loyalty program rules (185) and loyalty record (187) for the loyalty program
activities of the account identifier (181).   In one embodiment, at least part of the data
                                             -- 21 --

     WO 2015/175893                                                      PCT/US2015/031000
related to the third party loyalty program is stored under the account identifier (181) of
the user (101), such as the loyalty record (187).
[0108]      Figure 11 illustrates the data related to one third party loyalty program of a
loyalty benefit offeror (183).   In one embodiment, the account identifier (181) may be
linked to multiple loyalty benefit offerors (e.g., 183), corresponding to different third party
loyalty programs.    The third party loyalty program of the loyalty benefit offeror (183)
provides the user (101), identified by the account identifier (181), with benefits, such as
discounts, rewards, incentives, cash back, gifts, coupons, and/or privileges.
[0109]      In one embodiment, the association of the account identifier (181) and the
loyalty benefit offeror (183) also allows the loyalty benefit offeror (183) to access at least
a portion of the account data (111) relevant to the loyalty program, such as the loyalty
record (187) and certain information about the user (101), such as name, address, and
other demographic data.
[0110]      In one embodiment, the loyalty program allows the user (101) to accumulate
benefits according to loyalty program rules (185), such as reward points, cash back,
levels of discounts, etc.    For example, the user (101) may accumulate reward points for
transactions that satisfy the loyalty program rules (185); and the user (101) may use the
reward points to redeem cash, gift, discounts, etc.      In one embodiment, the loyalty
record (187) stores the accumulated benefits; and the transaction handler (103) updates
the loyalty record (187) associated with the loyalty benefit offeror (183) and the account
identifier (181), when events that satisfy the loyalty program rules occur.
[0111]      In one embodiment, the accumulated benefits as indicated in the loyalty record
(187) can be redeemed when the account identifier (181) is used to perform a payment
transaction, when the payment transaction satisfies the loyalty program rules.        For
example, the user (101) may redeem a number of points to offset or reduce an amount of
the purchase price.
[0112]      A method to provide loyalty programs of one embodiment includes the use of
the transaction handler (103) as part of a computing apparatus.        The computing
apparatus processes a plurality of payment card transactions.        After the computing
apparatus receives a request to track transactions for a loyalty program, such as the
loyalty program rules (185), the computing apparatus stores and updates loyalty
                                             -- 22 --

     WO 2015/175893                                                    PCT/US2015/031000
program information in response to transactions occurring in the loyalty program.      The
computing apparatus provides to a customer (e.g., 101) an offer of a benefit when the
customer satisfies a condition defined in the loyalty program, such as the loyalty program
rules (185).   In one embodiment, the loyalty benefit as identified in the loyalty record
(187) can be redeemed in connection with a transaction in a way the benefit of an offer
stored in association with the account identifier (181) is redeemed.
[0113]     Examples of loyalty programs through collaboration between collaborative
constituents in a payment processing system, including the transaction handler (103) in
one embodiment are provided in U.S. Pat. App. Pub. No. 2008/0059302, and entitled
"Loyalty Program Service," U.S. Pat. App. Pub. No. 2008/0059306, and entitled "Loyalty
Program Incentive Determination," and U.S. Pat. App. Pub. No. 2008/0059307, and
entitled "Loyalty Program Parameter Collaboration," the disclosures of which
applications are hereby incorporated herein by reference.
[0114]     Examples of processing the redemption of accumulated loyalty benefits via the
transaction handler (103) in one embodiment are provided in U.S. Pat. App. Pub. No.
2008/0059303, and entitled "Transaction Evaluation for Providing Rewards," the
disclosure of which is hereby incorporated herein by reference.
[0115]     In one embodiment, the incentive, reward, or benefit provided in the loyalty
program is based on the presence of correlated related transactions.       For example, in
one embodiment, an incentive is provided if a financial payment card is used in a
reservation system to make a reservation and the financial payment card is
subsequently used to pay for the reserved good or service.      Further details and
examples of one embodiment are provided in U.S. Pat. App. Pub. No. 2008/0071587,
and entitled "Incentive Wireless Communication Reservation," the disclosure of which is
hereby incorporated herein by reference.
[0116]     In one embodiment, the transaction handler (103) provides centralized loyalty
program management, reporting and membership services.           In one embodiment,
membership data is downloaded from the transaction handler (103) to acceptance point
devices, such as the transaction terminal (105).     In one embodiment, loyalty
transactions are reported from the acceptance point devices to the transaction handler
(103); and the data indicating the loyalty points, rewards, benefits, etc. are stored on the
                                           -- 23 --

     WO 2015/175893                                                        PCT/US2015/031000
account identification device (141).      Further details and examples of one embodiment
are provided in U.S. Pat. App. Pub. No. 2004/0054581, and entitled "Network Centric
Loyalty System," the disclosure of which is hereby incorporated herein by reference.
[0117]       In one embodiment, the portal (143) of the transaction handler (103) is used to
manage reward or loyalty programs for entities such as issuers, merchants, etc.           The
cardholders, such as the user (101), are rewarded with offers/benefits from merchants.
The portal (143) and/or the transaction handler (103) track the transaction records for the
merchants for the reward or loyalty programs.          Further details and examples of one
embodiment are provided in U.S. Pat. App. Pub. No. 2008/0195473, and entitled
"Reward Program Manager," the disclosure of which is hereby incorporated herein by
reference.
[0118]       In one embodiment, a loyalty program includes multiple entities providing
access to detailed transaction data, which allows the flexibility for the customization of
the loyalty program.      For example, issuers or merchants may sponsor the loyalty
program to provide rewards; and the portal (143) and/or the transaction handler (103)
stores the loyalty currency in the data warehouse (149).          Further details and examples
of one embodiment are provided in U.S. Pat. App. Pub. No. 2009/0030793, and entitled
"Multi-Vender Multi-Loyalty Currency Program," the disclosure of which is hereby
incorporated herein by reference.
[0119]       In one embodiment, an incentive program is created on the portal (143) of the
transaction handler (103).       The portal (143) collects offers from a plurality of merchants
and stores the offers in the data warehouse (149).         The offers may have associated
criteria for their distributions.  The portal (143) and/or the transaction handler (103) may
recommend offers based on the transaction data (109).            In one embodiment, the
transaction handler (103) automatically applies the benefits of the offers during the
processing of the transactions when the transactions satisfy the conditions associated
with the offers.     In one embodiment, the transaction handler (103) communicates with
transaction terminals (105) to set up, customize, and/or update offers based on market
focus, product categories, service categories, targeted consumer demographics, etc.
Further details and examples of one embodiment are provided in U.S. Pat. App. Pub.
No. 2010/0049620, and entitled "Merchant Device Support of an Integrated Offer
                                              -- 24 --

     WO 2015/175893                                                         PCT/US2015/031000
Network," the disclosure of which is hereby incorporated herein by reference.
[0120]      In one embodiment, the transaction handler (103) is configured to provide
offers from merchants to the user (101) via the payment system, making accessing and
redeeming the offers convenient for the user (101).         The offers may be triggered by
and/or tailored to a previous transaction, and may be valid only for a limited period of
time starting from the date of the previous transaction.       If the transaction handler (103)
determines that a subsequent transaction processed by the transaction handler (103)
meets the conditions for the redemption of an offer, the transaction handler (103) may
credit the consumer account (146) for the redemption of the offer and/or provide a
notification message to the user (101).     Further details and examples of one
embodiment are provided in U.S. Pat. App. Pub. No. 2010/0114686, and entitled
"Real-Time Statement Credits and Notifications       ," the disclosure of which is hereby
incorporated herein by reference.
[0121]      Details on loyalty programs in one embodiment are provided in U.S. Pat. App.
Pub. No. 2011/0087530, and entitled "Systems and Methods to Provide Loyalty
Programs," the disclosure of which is hereby incorporated herein by reference.
REAL-TIME MESSAGES
[0122]      In one embodiment, the transaction handler (103) is configured to cooperate
with the media controller (115) to facilitate real-time interaction with the user (101) when
the payment of the user (101) is being processed by the transaction handler (103).            The
real-time interaction provides the opportunity to impact the user experience during the
purchase (e.g., at the time of card swipe), through delivering messages in real-time to a
point of interaction (107), such as a mobile phone, a personal digital assistant, a portable
computer, etc.     The real-time message can be delivered via short message service
(SMS), email, instant messaging, or other communications protocols.
[0123]      In one embodiment, the real-time message is provided without requiring
modifications to existing systems used by the merchants and/or issuers.
[0124]      Figure 12 shows a system to provide real-time messages according to one
embodiment.       In Figure 12, the transaction handler (103) (or a separate computing
system coupled with the transaction handler (103)) is to detect the occurrence of certain
                                            -- 25 --

     WO 2015/175893                                                     PCT/US2015/031000
transactions of interest during the processing of the authorization requests received from
the transaction terminal (105); a message broker (191) is to identify a relevant message
for the user (101) associated with the corresponding authorization request; and the
media controller (115) is to provide the message to the user (101) at the point of
interaction (107) via a communication channel separate from the channel used by the
transaction handler (103) to respond to the corresponding authorization request
submitted from the transaction terminal (105).
[0125]      In one embodiment, the media controller (115) is to provide the message to
the point of interaction (107) in parallel with the transaction handler (103) providing the
response to the authorization request.
[0126]      In one embodiment, the point of interaction (107) receives the message from
the media controller (115) in real-time with the transaction handler (103) processing the
authorization request.    In one embodiment, the message is to arrive at the point of
interaction (107) in the context of the response provided from the transaction handler
(103) to the transaction terminal (105).     For example, the message is to arrive at the
point of interaction (107) substantially at the same time as the response to the
authorization request arrives at the transaction terminal, or with a delay not long enough
to cause the user (101) to have the impression that the message is in response to an
action other that the payment transaction.      For example, the message is to arrive at the
point of interaction (107) prior to the user (101) completing the transaction and leaving
the transaction terminal (105), or prior to the user (101) leaving the retail location of the
merchant operating the transaction terminal (105).
[0127]      In Figure 12, the system includes a portal (143) to provide services to
merchants and/or the user (101).
[0128]      For example, in one embodiment, the portal (143) allows the user (101) to
register the communication reference (195) in association with the account data (111),
such as the account information (142) of the consumer account (146); and the media
controller (115) is to use the communication reference (195) to deliver the message to
the point of interaction (107).   Examples of the communication reference (195) includes
a mobile phone number, an email address, a user identifier of an instant messaging
system, an IP address, etc.
                                            -- 26 --

     WO 2015/175893                                                     PCT/US2015/031000
[0129]      In one embodiment, the portal (143) allows merchants and/or other parties to
define rules (193) to provide offers (186) as real-time responses to authorization
requests; and based on the offer rules (193), the message broker (191) is to generate, or
instruct the media controller to generate, the real-time message to provide the offers
(186) to the user (101).    For example, the offer (186) may include a discount, an
incentive, a reward, a rebate, a gift, or other benefit, which can be redeemed upon the
satisfaction of certain conditions required by the offer rules (193).   In one embodiment,
based on the offer rules (193) the message broker (191) configures a message by
selecting the appropriate message template from (an) existing message(s) template(s),
and inserts any relevant data (e.g., the communication reference (195)) into the selected
template, then passes the configured message to the media controller (115), which
delivers the message to the point of interaction (107).     In one embodiment, the
message broker (191) (or a subsystem) is used to manage message templates along
with the rules for selecting the appropriate message template from among several
potential choices.
[0130]      In one embodiment, the offer rules (193) include offer details, targeting rules,
advertisement campaign details, profile mapping, creative mapping, qualification rules,
award/notify/fulfillment rules, approvals, etc.    Creative elements for offers include text,
images, channels, approvals, etc.
[0131]      In one embodiment, when the offer rules (193) are activated by the merchant
or advertiser via the portal (143), the message broker (191) is to generate trigger records
(197) for the transaction handler (103).     The transaction handler (103) is to monitor the
incoming authorization requests to identify requests that satisfy the conditions specified
in the trigger records (197) during the process of the authorization requests, and to
provide the information about the identified requests to the message broker (191) for the
transmission of an appropriate real-time message in accordance with the offer rules
(193).
[0132]      In one embodiment, the generation of the trigger records (197) for the
transaction handler (103) is in real-time with the merchant or advertiser activating the
offer rules (193).   Thus, the offer rules (193) can be activated and used for the detection
of the new authorization requests in real-time, while the transaction handler (103)
                                             -- 27 --

     WO 2015/175893                                                     PCT/US2015/031000
continues to process the incoming authorization requests.
[0133]     In one embodiment, the portal (143) provides information about the spending
behaviors reflected in the transaction data (109) to assist the merchants or advertisers to
target offers or advertisements.    For example, in one embodiment, the portal (143)
allows merchants to target the offers (186) based on transaction profiles (127).      For
example, the offer rules (193) are partially based on the values in a transaction profile
(127), such as an aggregated spending profile.      In one embodiment, the offer rules
(193) are partially based on the information about the last purchase of the user (101)
from the merchant operating the transaction terminal (105) (or another merchant), and/or
the information about the location of the user (101), such as the location determined
based on the location of the transaction terminal (105) and/or the location of the
merchant operating the transaction terminal (105).
[0134]     In one embodiment, the portal (143) provides transaction based statistics,
such as merchant benchmarking statistics, industry/market segmentation, etc., to assist
merchants and advertisers to identify customers.
[0135]     Thus, the real-time messages can be used to influence customer behaviors
while the customers are in the purchase mode.
[0136]     In one embodiment, the benefit of the offers (186) can be redeemed via the
transaction handler (103).    The redemption of the offer (186) may or may not require the
purchase details (e.g., SKU level purchase details).     Details in one embodiment about
redeeming offers (186) via the transaction handler (103) are provided in U.S. Pat. App.
Pub. No. 2011/0288918, and entitled "Systems and Methods for Redemption of Offers,"
the disclosure of which is hereby incorporated herein by reference.
[0137]     In one embodiment, when the authorization request for a purchase indicates
that the purchase qualifies the offer (186) for redemption if the purchase corresponding
to the authorization request is completed, the message broker (191) is to construct a
message and use the media controller (115) to deliver the message in real-time with the
processing of the authorization request to the point of interaction (107).   The message
informs the user (101) that when the purchase is completed, the transaction handler
(103) and/or the issuer processor (145) is to provide the benefit of the offer (186) to the
user (101) via statement credit or some other settlement value, for example points in a
                                           -- 28 --

     WO 2015/175893                                                     PCT/US2015/031000
registered loyalty program, or credit at the point of sale using a digital coupon delivered
to the purchaser via cell phone.
[0138]      In one embodiment, the settlement of the payment transaction corresponding
to the authorization request does not occur in real-time with the processing of the
authorization request.     For example, the merchant may submit the complete purchases
for settlement at the end of the day, or in accordance with a predetermined schedule.
The settlement may occur one or more days after the processing of the authorization
request.
[0139]      In one embodiment, when transactions are settled, the settled transactions are
matched to the authorization requests to identify offers (186) that are redeemable in view
of the settlement.    When the offer (186) is confirmed to be redeemable based on a
record of successful settlement, the message broker (191) is to use the media controller
(115) to provide a message to the point of interaction (107) of the user (101), such as the
mobile phone of the user (101).      In one embodiment, the message is to inform the user
(101) of the benefit to be provided as statement credits and/or to provide additional
offers.   In one embodiment, the message to confirm the statement credits is transmitted
in real-time with the completion of the transaction settlement.
[0140]      In one embodiment, the message broker (191) is to determine the identity of
the merchant based on the information included in the authorization request transmitted
from the transaction terminal (105) to the transaction handler (103).      In one
embodiment, the identity of the merchant is normalized to allow the application of the
offer rules (193) that are merchant specific.
[0141]      In one embodiment, the portal (143) provides operation facilities, such as
onboarding, contact management, certification, file management, workflow, etc. to assist
the merchants and/or advertisers to complete the tasks related to the offers (186).
[0142]      In one embodiment, the portal (143) allows the user (101) to opt in or opt out of
the real-time message delivery service.
DYNAMIC PROCESSING FLOW
[0143]      Different offers and loyalty programs may have different structures with
different processing requirements in response to payment transactions.
                                            -- 29 --

     WO 2015/175893                                                      PCT/US2015/031000
[0144]      For example, the processing of some offers and loyalty programs may involve
the notification of transaction information to an offer provider for further processing.
[0145]      For example, the processing of some offers and loyalty programs may involve
the notification of transaction information to an offer provider for the determination of
benefits and applying benefits to transactions in response to the response from the offer
provider.
[0146]      For example, the processing of some offers and loyalty programs may involve
the provisioning of benefits of the programs, settling the cost of the benefits, and provide
notifications to the users receiving the benefits.
[0147]      For example, the processing of some offers and loyalty programs may involve
delivering of offers and/or the management of the user enrollments, but others many not.
[0148]      For example, the processing of some offers and loyalty programs may involve
the inline application of benefits during the authorization of a payment transaction based
on predetermined redemption requirements, but may or may not involve notifications to
users.
[0149]      In one embodiment, a messaging system (e.g., implemented using an
enterprise service bus) is used to interconnect a set of independent, autonomous
components for implementing loyalty programs via workflows.          The messages posted
on the enterprise service bus drive the operations of the components according to a
workflow that implements the loyalty program.        When implementing a loyalty program or
offer having a new structure, a user interface allows a user to simply connect the
functions of available components to define a new workflow and specify the configuration
parameters of the components for the loyalty program of offer.        Depositing the workflow
in a repository activates the implementation of the loyalty program.      The system allows
the rapid development and deployment of new loyalty programs or offers in days, instead
of months to a year.
[0150]      Figure 5 shows a system configured to allow the dynamic configuration of the
processing of offers and loyalty programs having different structures according to one
embodiment.
[0151]      In Figure 5, the data warehouse (149) is configured to store transaction data
(109) of payment transactions processed by the transaction handler (103) and trigger
                                            -- 30 --

     WO 2015/175893                                                     PCT/US2015/031000
records (197) for identifying transactions that may be of interest for transaction-related
services, such as offer/loyalty benefit processing.
[0152]      In Figure 5, the data warehouse (149) further stores account data (111) of
users (e.g., 101), including the account information (142) identifying the consumer
account (146) of the user (101), and the communication reference (195) of the user (101)
that may be used for the transmission of notification and/or alert.
[0153]      In Figure 5, the data warehouse (149) further stores the offer (186), including
the offer rules (193) and the workflow (221) for the processing of the offer (186).     In one
embodiment, the offer (186) may include a discount offer, an incentive offer, a reward
offer, a loyalty benefit redemption offer, and/or a loyalty program offer, etc.
[0154]      In Figure 5, the data warehouse (149) further stores enrollment data (223)
identifying the enrollment status of users (e.g., 101), which associates the offer (186)
with the account data (111) of the user (101) who has accepted the offer (186) and/or
enrolled in the program associated with the offer (186).
[0155]      In Figure 5, the transaction handler (103) is configured to process the
payment transactions in a payment network illustrated in Figure 13 and use the trigger
records (197) to identify transactions that satisfy the conditions specified in the trigger
records (197) for further actions specified in the respective trigger records (197).
[0156]      In Figure 5, the rule engine (199) is configured to evaluate the rules, such as
offer rules (193), to determine whether certain conditions are satisfied.
[0157]      In Figure 5, the workflow manager (201) is configured to provide a user
interface that allows a user to design, modify, generate, and configure the workflow
(221).    In one embodiment, at least part of the offer rules (193) are configurable via the
workflow manager (201).
[0158]      In one embodiment, the workflow (221) specifies the processing follow by a
set of autonomous components configured in the system, such as an enrollment
manager (205), a transaction manager (211), a clearing manager (213), a fulfillment
manager (215), a discount manager (217), an event manager (207), a notification
manager (209), a merchant manager (219), etc.
[0159]      In one embodiment, each of the autonomous components is configured to
process available data independent of other autonomous components and/or the
                                            -- 31 --

     WO 2015/175893                                                      PCT/US2015/031000
operation sequences of the components.
[0160]      In Figure 5, the enrollment manager (205) is configured to manage
user-related data, including data registered by other workflow components such as the
transaction manager (211) and the notification manager (209)).        It may provide a user
interface for a customer or a partner to input and manage user-related data, ensure
consistent cross-enrollment / registration in peer systems (e.g., as specified in offer
settings or as registered by other workflow components such as the transaction manager
(211).
[0161]      In Figure 5, the data manager (203) is configured to load data from the data
warehouse (149) and/or other data sources for the processing of a transaction that is
identified to satisfy the requirements of a trigger record (197) in relation with the action
specified in the respective trigger record (197).
[0162]      In one embodiment, after a payment transaction is identified by the transaction
handler (103) in accordance with a trigger record (197), the data manager (203)
identifies the action specified in the trigger record (197) as being related to the offer (186)
and generates a data object that contains the data of payment transaction as being
processed by the transaction handler, data identifying the offer (186) including the
workflow (221), and relevant context data for the processing of offer (186) and/or the
action identified in the trigger record (197).
[0163]      In one embodiment, the data manager (203) is configured to make the data
object available to the autonomous components, such as the transaction manager (211),
the clearing manager (213), the fulfillment manager (215), the discount manager (217),
the event manager (207), the notification manager (209), the merchant manager (219),
etc., and post a message on the message board (200) to allow the autonomous
components to further process the transaction using the data object and in accordance
with the workflow (221) identified in the data object.
[0164]      In one embodiment, each of the autonomous components is configured to
watch the message board (200) to detect messages that require their services.          When a
message on the message board (200) requires the service of a respective autonomous
component, the respective autonomous component retrieves the message, performs
operations in view of the associated data object, updates the data object with results if
                                             -- 32 --

     WO 2015/175893                                                    PCT/US2015/031000
there is any, and posts a resulting message on the message board (200), which may
cause an autonomous component to render its service in accordance with the workflow
(221).
[0165]      In one embodiment, the event manager (207) is configured to store offer
metadata, event rules and actions, location repository data, event history of the user in
complex event processing, etc. The event manager (207) is further configured to
validate, get/set offer metadata, event rules and actions (e.g., by calling downstream
systems for action validation), location data, etc.
[0166]      In one embodiment, the notification manager (209) is configured to store
notification templates.   User contact details (e.g., communication reference (195) may
be stored in user enrollment record (e.g., 223).     In one embodiment, the notification
system defines what details are required and workflow manager (201) enforces the
requirements.     The notification manager (209) is configured to process realtime
message requests, validate template including substitution of variables, and send
messages via proper media channels.
[0167]      For example, the notification manager (209) may be called by the event
manager (207) to validate that a notification template can be assigned to an event based
on the event data.
[0168]      In one embodiment, the transaction manager (211) is configured to coordinate
with the transaction handler (103) for the authorization of the payment transaction in view
of the data object.
[0169]      In one embodiment, the clearing manager (213) is configured to coordinate
with the transaction handler (103) for the clearing of the payment transaction in view of
the data object.
[0170]      In one embodiment, the fulfillment manager (215) is configured to
store/manage the credit balance and other fulfillment data, such as receipt message
template, etc.    For example, the fulfillment manager (215) may include an application
programming interface (API) to manually issue statement credits, and/or an API to
update credit balance.
[0171]      In one embodiment, the discount manager (217) is configured to store
discount templates, listen to enrollment and update discount records for the transaction
                                            -- 33 --

     WO 2015/175893                                                    PCT/US2015/031000
handler (103) as appropriate, register discount trigger templates with the transaction
handler (103), and/or maintain a discount timeout queue for discount timeouts.
[0172]     In one embodiment, the merchant manager (219) is configured to
communicate with an API and/or a user interface to manage merchants.
[0173]     In Figure 5, an advanced computing infrastructure is provided for
implementing, modifying and/or experimenting with offers and/or loyalty programs.
Processing of offers and loyalty programs having different structures can be dynamically
configured through the customization of workflows.
[0174]     In one embodiment, the computing apparatus is implemented using at least
one data processing system, as illustrated in Figure 16, having at least one
microprocessor (173) and memory (167) storing instructions configured to instruct the at
least one microprocessor (173) to perform the operations described herein.        The
computing apparatus includes at least one of: the data warehouse (149), the transaction
handler (103), the data manager (203), the rule engine (199), the workflow manager
(201), the enrollment manager (205), the transaction manager (211), the clearing
manager (213), the fulfillment manager (215), the discount manager (217), the event
manager (207), the notification manager (209), the merchant manager (219), each of
which can be implemented using one or more data processing systems illustrated in
Figure 16.
APPLY OFFER
[0175]     In one embodiment, a computing apparatus coupled on the communication
path from a transaction terminal (105) that initiates an authorization request for a
transaction in a consumer account (146) to an issuer processor (145) in control of the
consumer account (146) is configured to apply the benefit of offers (186) to relevant
transactions in the consumer account (146), via adjusting the transaction amounts during
the processing of the authorization requests.     Thus, the application of the offer (186) is
integrated in the transaction conducted at the transaction terminal (150) during the time
period between transmitting the authorization request for the transaction and approving
the transaction based on the authorization response for the transaction.
[0176]     In one embodiment, the computing apparatus is configured to store
                                          -- 34 --

     WO 2015/175893                                                      PCT/US2015/031000
information about the offer (186) and determine whether a transaction currently in the
process of being authorized in the consumer account (146) is entitled to the benefit of the
offer (186); and if so, the computing apparatus is configured to change the transaction
amount in propagating the authorization request/response on the communication path to
provide the benefit of the offer (186).
[0177]      In one embodiment, the transaction handler (103) configured to route
authorization/settlement requests between acquirer processors (e.g., 147) and issuer
processors (145) is configured to enable to real time discount at transaction terminal
(105) in accordance with the offer (186) stored, in association with the account data
(111) of the user (101), in the data warehouse (149) of the transaction handler (103).
[0178]      In one embodiment, the transaction handler (103) is not only configured to
adjust the transaction amount to apply the benefit of the offer (186) to the qualifying
transaction, but also to provide information about the offer (186) applied to the
transaction in the authorization response.       Thus, the reason for the adjustment of the
transaction amount is communicated to the transaction terminal (105) of the merchant in
the authorization response that approves the transaction.        The information about the
applied offer (186) allows the operator of the transaction terminal (105) to make a
decision on whether or not to accept the adjusted transaction amount, and/or to request
further details about the offer.    In one embodiment, the information about the applied
offer (186) provided in the authorization response allows the transaction terminal (105)
and/or the merchant system to track the redemption progress status of the offer (186),
determine the effectiveness of the offer campaign, and/or adjust the offer campaign in
real time based on the redemption progress and/or the effectiveness of the offer
campaign.
[0179]      Figure 6 shows a system to apply a discount offer via an authorization request
according to one embodiment.         In Figure 6, the authorization request (168) from the
acquirer processor (147) to the issuer processor (145) is modified by the transaction
handler (103) to apply the offer (186) to the transaction that satisfies the requirements of
the offer (186).
[0180]      In Figure 6, after the transaction handler (103) receives the authorization
request (168) from the acquirer processor (147), the transaction handler (103)
                                             -- 35 --

     WO 2015/175893                                                         PCT/US2015/031000
determines whether the offer (186) is applicable to the transaction associated with the
authorization request (168).      If the offer (186) is applicable, the transaction handler
(103) changes the transaction amount A (301) identified in the authorization request
(168) received from the acquirer processor (168) to the transaction amount B (305) in the
authorization request (168) transmitted to the issuer processor (145).
[0181]      If the issuer processor (145) authorizes the transaction amount B (305), the
transaction handler (103) transmits to the transaction terminal (105), via the acquirer
processor (147), the authorization response (138) to indicate the approval of the
transaction amount B (305) and the applicable offer (186).
[0182]      In one embodiment, the benefit of the offer (186) is sponsored by the
merchant.      Thus, the arrangement of modifying the transaction amount A (301)
requested in the authorization request (168) for the transaction to authorize the
transaction amount B (305) that includes the benefit of the applicable offer (186)
combines the transaction to charge the consumer account (146) of the user (101) and
the transaction to charge the merchant to sponsor the benefit of the offer (186) that is
provided to the user (101).     Thus, the efficiency of the transaction processing system is
improved; and the time period to the completion of the related operations to provide the
clear and settle the benefit of the offer is reduced.
[0183]      In one embodiment, the transaction terminal (105) is configured to accept the
modified transaction amount B (305), in view of the indication of the offer (186), and print
the receipt that shows the applicable offer (186) and/or the application of the offer (186)
to the transaction.
[0184]      In one embodiment, the authorization request (168) is configured to include an
identifier of the offer (186).  The transaction terminal (105) is configured to look up the
details of the offer (186) (e.g., in a computer system of the merchant) based on the
identifier provided in the authorization request (168).       In one embodiment, the
transaction terminal (105) is configured to present the details of the offer (186) to the
operator of the transaction terminal (105) to facilitate the decision of whether or not the
transaction is to be accepted.       For example, the operator may check the expiration date
to ensure that the offer is valid.     For example, the operator may request identification
information of the user to provide the benefit of the offer.      For example, the operator
                                               -- 36 --

     WO 2015/175893                                                       PCT/US2015/031000
may check for applicable restrictions and/or limitations of the offer (186) in determining
whether or not to accept the transaction that has a modified and approved transaction
amount B (305) that is reduced from the initial transaction amount A (301).
[0185]      In one embodiment, the authorization request (168) is configured to include at
least certain details of the offer (186), such as a message of the offer (186) identifying
the benefit of the offer (186), one or more terms and conditions of the offer (186), an
artwork of the offer (186), etc.    The details of the offer (186) provided in the
authorization request (168) can be presented to the operator of the transaction terminal
(105) and/or printed on the receipt of the transaction for the user (101).
[0186]      In one embodiment, the authorization request (168) is configured to include an
identifier of the offer (186) that can be used by the transaction terminal (105) to query the
portal (143) for the details of the offer (186) in connection with the transaction.    For
example, using the identifier of the offer (186), the transaction terminal (105) is
configured to query the portal (143) for the message of the offer (186), the artwork of the
offer (186), the terms and conditions of the offer (186), the redemption status of the offer
(186) (e.g., the count of redemptions within a predetermined period of time, such as a
day, a week or a month, the total cost of benefits applied for the offer (186), etc.)
[0187]      In one embodiment, some details of the offer (186) are provided to the
transaction terminal (105) via the authorization response (138), and remaining details of
the offer (186) are retrievable from the portal (143) using the information provided in the
authorization response (138), such as the identifier of the offer (186) and/or the
authorization code (137).
[0188]      In one embodiment, the authorization response (138) is configured to include
an indicator configured to alert the transaction terminal that the transaction amount B
(305) approved for the transaction is less than the transaction amount A (301) initialed
requested in the authorization request (168), due to the benefit of an offer (186)
sponsored by the merchant.        The use of the indicator reduces the amount of information
to be transmitted to the transaction terminal (105); and the transaction terminal (105) and
the portal (143) are configured to subsequently communicate with each other to identify
information specific to the offer (186), based on the identification of the transaction, such
as the authorization code (137) for the transaction, the date and time of the transaction,
                                             -- 37 --

     WO 2015/175893                                                       PCT/US2015/031000
etc.   In one embodiment, the transaction record (307) of the transaction is configured to
be stored in the data warehouse in association with the offer (186), such that when the
transaction is identified, the offer applied to the transaction can also be identified.
[0189]      Figure 7 shows a system to apply a discount offer via an authorization
response according to one embodiment.           In one embodiment, the transaction amount A
(301) is not modified by transaction handler (103) during the propagation of the
authorization request (168) from the acquirer processor (147) to the issuer processor
(145).    In Figure 7, the authorization response (138) from the issuer processor (145) to
the acquirer processor (147) is modified by the transaction handler (103) to apply the
offer (186) to the transaction that satisfies the requirements of the offer (186).
[0190]      In Figure 7, after the transaction handler (103) receives the authorization
response (138) from the issuer processor (145) approving the transaction, the
transaction handler (103) determines whether the offer (186) is applicable to the
transaction associated with the authorization response (138).       If the offer (186) is
applicable, the transaction handler (103) changes the transaction amount A (301) to the
transaction amount B (305) in the authorization response (138) transmitted to the
acquirer processor (147).
[0191]      In the embodiment, the authorization response (138) provided to the
transaction terminal (105), via the acquirer processor (147), is further configured by the
transaction handler (103) to indicate the applicable offer (186).     The transaction
terminal (105) is configured to accept the modified transaction amount B (305), in view of
the indication of the offer (186) presented in the authorization response (138).       The
modified transaction amount B (305) is different from the initial transaction amount A
(301) submitted by the transaction terminal (105) in the authorization request (168) to the
acquirer processor (147).     The transaction terminal (105) prints the receipt that shows
the applicable offer (186) and/or the application of the offer (186) to the transaction.
[0192]      In one embodiment, the transaction handler (103) is configured to apply the
offer (186) during the authorization phase of the transaction to cause the receipt
presented by the transaction terminal (105) to show that the benefit of the offer (186) has
been applied to the transaction.      For example, in one embodiment, the transaction
terminal (105) is configured to provide a user interface that allows the merchant to
                                             -- 38 --

     WO 2015/175893                                                    PCT/US2015/031000
accept the modified transaction amount (305) in view of the applicable offer (186)
identified in the authorization response (138).
[0193]      In one embodiment, the transaction terminal (105) is configured to use the
information provided the authorization response to query the portal (143) of the
transaction handler (103) to obtain further information about the offer (186) that is
applied to the transaction.    For example, in one embodiment, the transaction terminal
(105) may allow the cashier to optionally view the details of the offers before approving
the transaction, when the authorization request (138) indicates that an offer (186)
sponsored by the merchant has been applied to the transaction to change the
transaction from transaction A (301) to transaction B (305).     When the cashier and/or
the user (101) requests details of the offer (186) via the user interface, the transaction
terminal (105) communicates with the portal (143) to retrieve the details of the offer
(186).    In one embodiment, the transaction terminal (143) uses at least the authorization
code (137) provided in the authorization response (138) to identify the offer (186) being
applied.    The portal (143) communicates with the transaction terminal (105) to
reproduce the presentation (401 or 523) of the offer (186) and/or details of the offer
(186), such as terms and requirements of the offer (186), expiration date of the offer
(186), etc.    In one embodiment, the transaction terminal (105) is configured to optionally
print a copy of the offer (186) on the receipt provided for the transaction.
[0194]      In one embodiment, the issuer processor (145) is configured to apply the offer
(186) by change the authorization response (138), after receiving the authorization
request (168) from the transaction handler (103) and before providing the authorization
response (138) to the transaction handler (103).
[0195]      In one embodiment, the acquirer processor (147) is configured to apply the
offer (186) by changing the transaction amount in the authorization request (168) (e.g.,
after receiving the authorization request (168) from the transaction terminal (105) and
before transmitting the authorization request (168) having the modified transaction
amount (305) to the transaction handler (103)), or by changing the transaction amount in
the authorization response (138) (e.g., after receiving the authorization response (138)
from the transaction handler (103) and before transmitting the authorization response
(168) having the modified transaction amount (305) to the transaction terminal (105)).
                                           -- 39 --

     WO 2015/175893                                                       PCT/US2015/031000
[0196]       In one embodiment, after the transaction is approved at the transaction
terminal (105) for the modified transaction amount (305), the system is configured to
clear and settle the transaction based on the modified transaction amount (305), instead
of the initially requested transaction amount (301).
[0197]       In one embodiment, the transaction handler (103) further uses a
communication reference (e.g., a mobile phone number, an email address, an instant
message user identifier) that is stored in the account data (111) to provide a notification
to the user (101) about the applicable offer (186) and the benefit of the offer (186) that
has been applied to the transaction, in parallel with the processing of the authorization
request (168) and/or the authorization response (138).        Details and examples of using
such a communication reference for notification in one embodiment are provided in U.S.
Pat. App. Ser. No. 13/152,186, filed Jun. 2, 2011 and entitled "Systems and Methods to
Provide Messages in Real-Time with Transaction Processing," the disclosure of which is
incorporated herein by reference in its entirety.
[0198]       In one embodiment, the transaction handler (103) is configured to detect the
applicability of the offer (186) during the settlement phase of the transaction and apply
the applicable offer (186) during settlement of the transaction.
[0199]       In one embodiment, the transaction handler (103) is configured to process and
settle the transaction that qualifies for the benefit of the offer (186) without modification.
To provide the benefit of the offer (186), the transaction handler initiates a separate
secondary transaction to issue a statement credit to the consumer account (146) of the
user, after the transaction is settled at the full price.  For example, in one embodiment,
the secondary transaction involves the merchant issuing a refund to the user (101)
corresponding to the benefit of the offer (186).      In one embodiment, the secondary
transaction involves an offer sponsor issuing a refund to the user (101) corresponding to
the benefit of the offer (186).
[0200]       Figure 8 shows a system to provide the benefit of an offer according to one
embodiment.        In Figure 8, the data warehouse (149) coupled with the transaction
handler (103) and the portal (143) is configured to store data associating the offer (186)
with the account information (142) of the consumer account (146).
[0201]       In one embodiment, the portal (143) is configured with a user interface to allow
                                             -- 40--

     WO 2015/175893                                                        PCT/US2015/031000
the user (101) of the consumer account (146) specify a communication reference (311)
that is stored in association with the account information (142).      If the user (101)
provides the communication reference (311) for association with the account information
(142), the user (101) is provided with notification services using the communication
reference (311).    Examples of the communication reference (311) include a phone
number for notification via voice mails, a mobile phone number for notification via short
message service or mobile application, an email address for notification via emails, a
user name in an instant messaging system for notification via instant messages, a
member ID of a social networking site for notification via messages transmitted via the
social networking site, etc.
[0202]      In Figure 8, the data warehouse (149) is configured with one or more trigger
records associated with the offer (186).    The trigger record (313) specifies a set of
conditions and identifies an action, which is to be performed when a transaction
processed by the transaction handler (103) satisfies the set of conditions.        In one
embodiment, the set of conditions specified in the trigger record is a subset of conditions
for the redemption of the benefit of the offer (186).    For improved performed, the
conditions for the trigger records is based on a standardized set of conditions common to
many different operations.     The action associated with the trigger generated for the offer
(186) identifies the offer (186) can cause the transaction handler (103) and/or the portal
(143) to determine whether or not the transaction meet all of the benefit redemption
requirements of the offer (186) and if so, to modify the transaction amount during the
authorization of the transaction.
[0203]      In Figure 8, when the account information (142) is used at the transaction
terminal (105) (e.g., a point of sales device) to initiate a transaction in the consumer
account (146), the transaction terminal (105) communicates with the acquirer processor
(147) to generate an authorization request (168).       The transaction handler (103) is
configured to receive the authorization request (168) from the acquirer processor (147)
and identify the issuer processor (145) based on the account information (142) provided
in the authorization request (168).
[0204]      In one embodiment, a trigger record (313) is configured to determine whether
the transaction handler (103) is to check the offer (186) for the application of the offer
                                           -- 41 --

     WO 2015/175893                                                       PCT/US2015/031000
(186).    When the account information (142) provided in the authorization request (168)
and/or other information as identified in the authorization request (168), such as the
identity of the merchant operating the transaction terminal (105), satisfies the
requirement of the trigger record (313), the trigger record (313) instructs the transaction
handler (103) to determine the applicability of the offer (186) to the transaction for which
the authorization request (168) is submitted (or for which the authorization response
(138) is provided).    The use of the trigger record (313) to trigger the transaction handler
(103) to check the applicability of the offer (186) improves the efficiency of the
transaction handler (103) by optimized requirement checking operations relative to the
trigger records and by filtering out transactions that do not meet the requirements of the
trigger records.
[0205]      In Figure 8, transaction handler (103) is configured to determine whether or
not the offer (186) is applicable to the authorization request (168), after receiving the
authorization request (168) from the acquirer processor (147) and prior to sending the
corresponding authorization request (168) to the issuer processor (145) associated with
the account information (142).     If the offer is applicable to the transaction associated
with the authorization request (168), the transaction handler (103) changes the
transaction amount according to the offer (186) and uses the changed transaction
amount to communicate with the issuer processor (145) for the authorization of the
transaction, in a way as illustrated in Figure 6.
[0206]      For example, the offer (186) provides the benefit of a discount, such as a
predetermined percentage off the purchase from the merchant operating the transaction
terminal (105), if the transaction amount is above a threshold.       For example, a merchant
may offer a 10% discount towards a purchase of at least $50.00 within a predetermined
period of time.
[0207]      In one embodiment, the redemption requirement of the offer (186) is based on
a plurality of transactions.   For example, a merchant may offer a 20% discount to the
11th transaction if the user (101) makes 10 purchases each meeting the minimum
purchase requirement of $5.00.
[0208]      In one embodiment, the benefit of the offer (186) is computed with the
consideration of sales tax.    For example, the authorization request (168) received from
                                             -- 42 --

     WO 2015/175893                                                      PCT/US2015/031000
the acquirer processor (147) includes information about the sales tax rate; the
transaction amount includes the sales tax; and the transaction handler (103) is
configured to determine the pre-tax purchase amount to determine whether the offer
(186) is applicable.   For example, if the offer (186) is applicable, the transaction handler
(103) is configured to adjust the pre-tax purchase amount and compute the sales tax
based on the adjusted purchase amount to determine the adjusted transaction amount.
[0209]     In one embodiment, the redemption of the offer (186) is based on item-level
purchase details (169).    For example, a merchant or manufacturer may offer the deal of
"buy 2 blue shirts, receive the 3rd free," or "buy 5 specialty drinks and receive 6th free."
[0210]     In one embodiment, the transaction terminal (105) is configured to include the
purchase details (169) in the authorization request (168).      The data warehouse (149) is
configured to store the purchase details (169) that are relevant to the offer (186).
[0211]     In one embodiment, the transaction terminal (105) is configured to present a
user interface to allow the user (101) to determine whether or not to allow the transaction
terminal (105) to provide the purchase details (169) to the transaction handler (103) in
the authorization request (168).     Thus, when the user (101) determines that the
purchase is relevant to the offer (186) previously saved in the data warehouse (149), the
user (101) may provide the consent to the user interface to allow the transaction terminal
(105) to include the purchase details (169) in the authorization request (168).
[0212]     In one embodiment, the offers that require item level purchase details (169)
are provided to users (101) of a particular type of consumer accounts; and the use of the
consumer account (146) represents the user consent to allow transaction terminals (e.g.,
105) to transmit the purchase details (169) to the transaction handler (103) for various
services that are based on item level purchase details (169).      The transaction terminal
(105) is configured to selectively transmit the purchase details (169) based on the type of
the consumer accounts used in the transactions.
[0213]     In one embodiment, the portal (143) is configured to communicate with the
transaction terminal (105) during the processing of the authorization request (168).
After the authorization request (168) is received from the acquirer processor (147), the
transaction handler (103) and/or the portal (143) is configured to determine whether to
request the purchase details (169) are required to determine whether the offer (186) is
                                            -- 43--

     WO 2015/175893                                                      PCT/US2015/031000
applicable to the transaction.
[0214]      In one embodiment, the transaction handler (103) is configured to identify
certain transactions that are not qualified for the offer (186) based on the authorization
request (168) without the purchase details (169).       For example, when the transaction
merchant category (306) is not in a predetermined set of merchant categories, the offer
(186) is not applicable in one embodiment.        For example, when the transaction amount
(304) is not in a predetermined range, the offer (186) is not applicable in one
embodiment.      For example, when the transaction channel (307) of the authorization
request (168) is not a predetermined channel, the offer is not applicable in one
embodiment.
[0215]      In one embodiment, after the transaction handler (103) and/or the portal (143)
determines that the purchase details (169) is required to determine whether the offer
(186) is applicable to the transaction represented/identified by the authorization request
(168), the portal (143) is configured to communicate with the transaction terminal (105)
to determine the applicability of the offer (186).    For example, the portal (143) is
configured in one embodiment to request the transaction terminal (105) to provide the
purchase details (169) to determine whether the transaction is eligible for the benefit of
the offer (186) during the processing of the authorization request (168).      Alternative, the
portal (143) is configured to identify the item level requirements to the transaction
terminal (105) and query the transaction terminal (105) to determine whether the
transaction represented/identified by the authorization request (168) satisfies the item
level requirement(s) associated with the offer (186).
[0216]     After the authorization request (168) received from the acquirer processor
(147) is processed to include the benefit of the applicable offer (186), if any, the
transaction handler (103) transmitted the authorization request (168) that is a result of
the application of the benefit of the applicable offer (186).    Thus, the issuer processor
(145) does not involve in the processing of the offer (186).
[0217]     Alternatively, the application of the offer (186) is implemented via the issuer
processor (145), instead of the transaction handler (103); and the issuer processor (145)
is configured to store the offer (186) in its data storage device and apply the offer (186) in
a way similar to that described above in connection with the transaction handler (103).
                                             -- 44 --

     WO 2015/175893                                                      PCT/US2015/031000
However, implementing the application of the offers (e.g., 186) at the transaction handler
(103) provides a system more efficient than a system that implements the application of
the offers (e.g., 186) at individual issuer processors (e.g., 145) are connected with the
transaction handler (103) for the routing of authorization requests (168) and
authorization responses (138), by reducing the overall resource requirement of the entire
system and reducing the data communication requirements of the system.
[0218]      After the transaction handler (103) applies the offer (186) that is associated
with the account information (142) in the data warehouse (149) coupled with the
transaction handler (103), the transaction handler (103) is configured to receive from the
issuer processor (145) the authorization response (138) corresponding to the
authorization request (168).     If the transaction is approved, the authorization response
(138) identifies the approved transaction amount, which includes the benefit of the offer
(186).
[0219]      In one embodiment, the benefit of the offer (186) includes the reduced
transaction amount that is less than the transaction amount initially specified in the
authorization request (186) transmitted from the transaction terminal (105) and/or the
acquirer processor (147).      Thus, the authorized amount in the authorization response
(138) transmitted to the acquirer processor is smaller than the requested amount in the
authorization request (168) received from the acquirer processor (147).
[0220]      In one embodiment, the transaction handler (103), or the issuer processor
(145), is further configured to provide information about the offer (186) that is applied to
the authorization request (168) in the authorization response (168).       For example, the
authorization response (138) in one embodiment includes a message to be printed on
the receipt of the transaction to identify the offer (186) and to indicate that the benefit of
the offer (186) has been provided to the transaction.      For example, the authorization
response (138) in one embodiment identifies the original total amount of the transaction,
the adjusted amount of the transaction, a code identifying the offer (186), a message
describing the offer (186), and/or the amount of the offer (186), etc.
[0221]      In one embodiment, an indicator in the authorization is set to request the
transaction terminal (105) to accept the modified transaction amount (105).        The
operation of the transaction terminal (105) may request the portal (143) to provide further
                                             -- 45 --

     WO 2015/175893                                                     PCT/US2015/031000
details of the offer (186) to approve the transaction.
[0222]      For example, in one embodiment, the transaction terminal (105) is configured
to use at least the authorization code (137) to request the portal (143) to display the offer
(186) that is being applied to the transaction approved by the authorization code (137).
Alternatively, the transaction handler (103) may provide, in the authorization response
(138), an identifier separate from the authorization code (137) to identify offer (186); and
the transaction terminal (105) is configured to use the identifier to retrieve details of the
offer (186) for presentation on the transaction terminal (105) and/or on the receipt
provided to the user (101).
[0223]      In Figure 8, the transaction terminal (105) is configured to present the
information about the offer (186) provided in the authorization response (138).        Thus,
the user (101) can verify the application of the offer (186) to the transaction from the
receipt produced by the transaction terminal (105).       For example, the transaction
terminal (105) uses a printer to produce a paper receipt.
[0224]      In one embodiment, when the authorization response (138) received from the
issuer processor (145) indicates the approval of the transaction that receives the benefit
of the offer (186), the portal (143) is configured to use the communication reference
(311) to send a notification to the point of interaction (107) of the user (101).    The
notification includes at least some of the above discussed information about the offer
(186) that is applied to the authorization request (168) in the authorization response
(168).
[0225]      In one embodiment, the information about the offer (186) is provided via both
the authorization response (138) and the notification to the point of interaction (107)
separate from the transaction terminal (105).        An example of the point of interaction
(107) is a mobile device, such as a mobile phone, a portal media player, or a personal
digital assistant of the user (101).
[0226]      In one embodiment, when the information about the offer (186) is delivered via
the communication reference (311), the same information is not provided via the
authorization response (138).
[0227]      In one embodiment, the authorization response (138) includes data about the
application of the offer (186) to facilitate accounting by the merchant system that
                                             -- 46--

     WO 2015/175893                                                        PCT/US2015/031000
includes the transaction terminal (105).       For example, data provided in the authorization
response (138) allows the back-end account system connected to the transaction
terminal (105) to identify the promotion code/data of the offer (186), the promotion
amount, and/or the final sale amount, etc., from the data provided in the authorization
response (138).      In one embodiment, the back-end accounting system stores various
information for the purchase transaction, including the full sale amount, the identification
of the offer (186) that has been applied to the transaction, the reduction amount in the
sale amount, the final sale amount, tender type, etc.
[0228]      In one embodiment, the portal (143) is configured to show to relevant
merchants and/or users (101) reports associated with the offers (e.g., 186), such as the
offers (e.g., 186) that have been applied with relevant transaction records (307) and
purchase details (169).
[0229]      In Figure 8, the application of the offer (186) is implemented via the
transaction handler (103).      Alternatively, the application of the offer (186) can be
implemented in the acquirer processor (147), or the issuer processor (145), in a way
similar to that described above in connection with the transaction handler (103).
[0230]      Figure 9 shows a method to provide the benefit of an offer according to one
embodiment.       In Figure 9, a computing apparatus is configured to store (321) data
associating an offer (186) and a consumer account (146) that is under control of an
issuer processor (145) and associated with a communication reference (311), and
receive (323) an authorization request (168) for the consumer account (146) from an
acquirer processor (147).      In response to the authorization request (168), the computing
apparatus determines (325) whether the offer (186) is applicable; and if so, the
computing apparatus adjusts (327) the transaction amount according to the offer (186)
and communicates (329) with the issuer processor (145) to obtain authorization
response (138).
[0231]      Prior to communicating (335) the authorization response (138) to the
transaction terminal (105) via the acquirer processor (138), the computing apparatus is
configured to determine whether the offer (186) is applicable; and if so, the computing
apparatus configures (333) the authorization response to identify the offer (186) and the
benefit applied to the transaction in accordance with the offer (186) (e.g., the reduced
                                              -- 47 --

     WO 2015/175893                                                       PCT/US2015/031000
transaction amount).
[0232]      In one embodiment, when the authorization response approves the
transaction, the computing apparatus is configured to optionally transmit (337) a
notification about the offer (186) to the point of interaction (107) of the user (101) using
the communication reference (311).
[0233]      In one embodiment, the computing apparatus includes at least one of: the data
warehouse (149), the transaction handler (103), the portal (143), the issuer processor
(145), the acquirer processor (147), the transaction terminal (105) and the point of
interaction (107), which of each can be implemented using one or more data processing
systems as illustrated in Figure 12, with more or less computers.
[0234]      In one embodiment, the computing apparatus is configured to: store an offer
(186) in association with an account (142) of a user (101); receive, in a transaction
handler (103) coupled between a plurality of issuer processors (e.g., 145) and a plurality
of acquirer processors (e.g., 147), an authorization request (168) from an acquirer
processor (147) associated with a merchant for a transaction in a consumer account
(146) under control of an issuer processor (145); determine whether or not to provide a
benefit of the offer (186) to the transaction, after receiving the authorization request (168)
in the transaction handler (103); in response to a determination that the benefit of the
offer (186) is be provided to the transaction, modify by the transaction handler (103) a
transaction amount (301, 305) of the transaction prior to providing an authorization
response (168) to the acquirer processor (147); and embed information in the
authorization response (138) to identify the offer (186) applied to the transaction.      In
one embodiment, the authorization request (168) received from the acquirer processor
(147) requests authorization of a first transaction amount (301) from the consumer
account (146); and the authorization response (138) provided to the acquirer processor
(147) authorizes a second transaction amount (305) less than the first transaction
amount (301) to provide the benefit of the offer (186).
[0235]      In one embodiment, the information embedded in the authorization response
(138) includes an indicator configured to cause a transaction terminal (105) of the
merchant to prompt an operator of the transaction terminal (105) to accept the second
transaction amount (305) specified in the authorization response (138).        In one
                                             -- 48--

     WO 2015/175893                                                       PCT/US2015/031000
embodiment, the information further includes details of the offer (186) to be presented to
the operator before the transaction is accepted at the transaction terminal (105).
[0236]      In one embodiment, the transaction terminal is configured to print on a receipt
for the transaction the details of the offer (186) applied to the transaction, such as a
message of the offer (186), artwork of the offer (186), etc.
[0237]      In one embodiment, the modifying of the transaction amount includes
transmitting to the issuer processor an authorization request (168) identifying the second
transaction amount (305) for the transaction.       Alternatively, the authorization request
(168) received from the acquirer processor (147) is forwarded by the transaction handler
(103) to the issuer processor (145) without modifying the transaction amount; responsive
to the authorization request (168), the transaction handler (103) receives a response
from the issuer processor (145) approving the first transaction amount (301); in
response, the transaction handler (103) is configured to generate the authorization
response (168) to include the information identifying the offer (186) applied to the
transaction and to identify the second transaction amount (305) approved for the
transaction, in view of the benefit of the offer (186); and the transaction handler (103) is
configured to transmit the authorization response (168) to the acquirer processor (147).
[0238]      In one embodiment, the portal (143) is configured to generate a trigger record
identifying the offer (186) and a subset of requirements of the offer.      The transaction
handler (103) is configured to monitor transactions to identify the transaction that
satisfies the subset of the requirements identified in the trigger record.     The determining
of whether or not to provide a benefit of the offer (186) to the transaction is in response to
a determination that the transaction satisfies the subset of requirements identified in the
trigger record.
[0239]      In one embodiment, the information provided in the authorization response
(138) about the offer (186) includes an indicator indicating that the transaction amount of
the transaction is modified (301, 305) in view of the offer (186) sponsored by the
merchant.
[0240]      In one embodiment, the indicator includes a unique identifier identifying the
offer from a plurality of offers provided by the merchant.
[0241]      In one embodiment, after the authorization response (138) is transmitted to the
                                            -- 49--

     WO 2015/175893                                                      PCT/US2015/031000
acquirer processor (147), a portal (143) is configured to receive a subsequent request
from a transaction terminal (105) of the merchant to request a presentation of the offer
(186); and the portal (143) is configured to provide the presentation of the offer (186) to
the transaction terminal (105) in response to the subsequent request received in the
portal (143) via a communication channel separated from the channel used for the
exchange of the authorization messages (e.g., 138 and 168).
[0242]      In one embodiment, the subsequent request is configured to include at least
an authorization code (137) provided to the authorization response (138).
[0243]      In one embodiment, whether or not to provide the benefit of the offer (168) to
the transaction is based at least in part on item level transaction details, such as item
level transaction details received in the authorization request (168), or received in the
portal (143) in response to a determination that transaction details are required to
determine whether or not to apply the benefit of the offer to the transaction, determined
after the authorization request is received in the transaction handler (103) from the
acquirer processor (147).     In one embodiment, the transaction details are received in
the portal (143) from the transaction terminal (105) prior to the transaction handler (103)
providing the authorization response to the acquirer processor (147).
VARIATIONS
[0244]      Some embodiments use more or fewer components than those illustrated in
the figures.
[0245]      In one embodiment, at least some of the profile generator (121), correlator
(117), profile selector (129), and advertisement selector (133) are controlled by the entity
that operates the transaction handler (103).     In another embodiment, at least some of
the profile generator (121), correlator (117), profile selector (129), and advertisement
selector (133) are not controlled by the entity that operates the transaction handler (103).
[0246]      In one embodiment, the products and/or services purchased by the user (101)
are also identified by the information transmitted from the merchants or service
providers.
[0247]      In one embodiment, the entity operating the transaction handler (103) provides
the intelligence information in real time as the request for the intelligence information
                                           -- 50 --

     WO 2015/175893                                                       PCT/US2015/031000
occurs.    In other embodiments, the entity operating the transaction handler (103) may
provide the intelligence information in batch mode.     The intelligence information can be
delivered via online communications (e.g., via an application programming interface
(API) on a website, or other information server), or via physical transportation of a
computer readable media that stores the data representing the intelligence information.
[0248]      In one embodiment, the intelligence information is communicated to various
entities in the system in a way similar to, and/or in parallel with the information flow in the
transaction system to move money.       The transaction handler (103) routes the
information in the same way it routes the currency involved in the transactions.
TRANSACTION PROCESSING AND DATA
[0249]      Figure 13 shows a system to provide information and/or services based on
transaction data (109) according to one embodiment.
[0250]      In Figure 13, the transaction handler (103) is coupled between an issuer
processor (145) and an acquirer processor (147) to facilitate authorization and
settlement of transactions between a consumer account (146) and a merchant account
(148).   The transaction handler (103) records the transactions in the data warehouse
(149).   The portal (143) is coupled to the data warehouse (149) to provide information
based on the transaction records, such as the transaction profiles (127), aggregated
spending profile, offer redemption notification, etc.   The portal (143) may be
implemented as a web portal, a telephone gateway, a file/data server, etc.
[0251]      In Figure 13, the transaction terminal (105) initiates the transaction for a user
(101) (e.g., a customer) for processing by a transaction handler (103).       The transaction
handler (103) processes the transaction and stores transaction data (109) about the
transaction, in connection with account data (111), such as the account profile of an
account of the user (101).     The account data (111) may further include data about the
user (101), collected from issuers or merchants, and/or other sources, such as social
networks, credit bureaus, merchant provided information, address information, etc.          In
one embodiment, a transaction may be initiated by a server (e.g., based on a stored
schedule for recurrent payments).
[0252]      The accumulated transaction data (109) and the corresponding account data
                                            -- 51 --

     WO 2015/175893                                                       PCT/US2015/031000
(111) are used to generate intelligence information about the purchase behavior, pattern,
preference, tendency, frequency, trend, amount and/or propensity of the users (e.g.,
101), as individuals or as a member of a group.       The intelligence information can then
be used to generate, identify and/or select targeted advertisements for presentation to
the user (101) on the point of interaction (107), during a transaction, after a transaction,
or when other opportunities arise.
[0253]      In Figure 13, the consumer account (146) is under the control of the issuer
processor (145).    The consumer account (146) may be owned by an individual, or an
organization such as a business, a school, etc.      The consumer account (146) may be a
credit account, a debit account, or a stored value account.       The issuer may provide the
consumer (e.g., user (101)) an account identification device (141) to identify the
consumer account (146) using the account information (142).         The respective consumer
of the account (146) can be called an account holder or a cardholder, even when the
consumer is not physically issued a card, or the account identification device (141), in
one embodiment.      The issuer processor (145) is to charge the consumer account (146)
to pay for purchases.
[0254]      The account identification device (141) of one embodiment is a plastic card
having a magnetic strip storing account information (142) identifying the consumer
account (146) and/or the issuer processor (145).       Alternatively, the account
identification device (141) is a smartcard having an integrated circuit chip storing at least
the account information (142).    The account identification device (141) may optionally
include a mobile phone having an integrated smartcard.
[0255]      The account information (142) may be printed or embossed on the account
identification device (141).   The account information (142) may be printed as a bar code
to allow the transaction terminal (105) to read the information via an optical scanner.
The account information (142) may be stored in a memory of the account identification
device (141) and configured to be read via wireless, contactless communications, such
as near field communications via magnetic field coupling, infrared communications, or
radio frequency communications.       Alternatively, the transaction terminal (105) may
require contact with the account identification device (141) to read the account
information (142) (e.g., by reading the magnetic strip of a card with a magnetic strip
                                            -- 52 --

     WO 2015/175893                                                       PCT/US2015/031000
reader).
[0256]      The transaction terminal (105) is configured to transmit an authorization
request message to the acquirer processor (147).          The authorization request includes
the account information (142), an amount of payment, and information about the
merchant (e.g., an indication of the merchant account (148)).        The acquirer processor
(147) requests the transaction handler (103) to process the authorization request, based
on the account information (142) received in the transaction terminal (105).       The
transaction handler (103) routes the authorization request to the issuer processor (145)
and may process and respond to the authorization request when the issuer processor
(145) is not available.     The issuer processor (145) determines whether to authorize the
transaction based at least in part on a balance of the consumer account (146).
[0257]      The transaction handler (103), the issuer processor (145), and the acquirer
processor (147) may each include a subsystem to identify the risk in the transaction and
may reject the transaction based on the risk assessment.
[0258]      The account identification device (141) may include security features to
prevent unauthorized uses of the consumer account (146), such as a logo to show the
authenticity of the account identification device (141), encryption to protect the account
information (142), etc.
[0259]      The transaction terminal (105) of one embodiment is configured to interact
with the account identification device (141) to obtain the account information (142) that
identifies the consumer account (146) and/or the issuer processor (145).         The
transaction terminal (105) communicates with the acquirer processor (147) that controls
the merchant account (148) of a merchant.          The transaction terminal (105) may
communicate with the acquirer processor (147) via a data communication connection,
such as a telephone connection, an Internet connection, etc.         The acquirer processor
(147) is to collect payments into the merchant account (148) on behalf of the merchant.
[0260]      In one embodiment, the transaction terminal (105) is a POS terminal at a
traditional, offline, "brick and mortar" retail store.  In another embodiment, the
transaction terminal (105) is an online server that receives account information (142) of
the consumer account (146) from the user (101) through a web connection.            In one
embodiment, the user (101) may provide account information (142) through a telephone
                                             -- 53 --

      WO 2015/175893                                                   PCT/US2015/031000
call, via verbal communications with a representative of the merchant; and the
representative enters the account information (142) into the transaction terminal (105) to
initiate the transaction.
[0261]      In one embodiment, the account information (142) can be entered directly into
the transaction terminal (105) to make payment from the consumer account (146),
without having to physically present the account identification device (141).    When a
transaction is initiated without physically presenting an account identification device
(141), the transaction is classified as a "card-not-present" (CNP) transaction.
[0262]      In general, the issuer processor (145) may control more than one consumer
account (146); the acquirer processor (147) may control more than one merchant
account (148); and the transaction handler (103) is connected between a plurality of
issuer processors (e.g., 145) and a plurality of acquirer processors (e.g., 147).   An
entity (e.g., bank) may operate both an issuer processor (145) and an acquirer processor
(147).
[0263]      In one embodiment, the transaction handler (103), the issuer processor (145),
the acquirer processor (147), the transaction terminal (105), the portal (143), and other
devices and/or services accessing the portal (143) are connected via communications
networks, such as local area networks, cellular telecommunications networks, wireless
wide area networks, wireless local area networks, an intranet, and Internet. Dedicated
communication channels may be used between the transaction handler (103) and the
issuer processor (145), between the transaction handler (103) and the acquirer
processor (147), and/or between the portal (143) and the transaction handler (103).
[0264]      In Figure 13, the transaction handler (103) uses the data warehouse (149) to
store the records about the transactions, such as the transaction records or transaction
data (109).
[0265]      Typically, the transaction handler (103) is implemented using a powerful
computer, or cluster of computers functioning as a unit, controlled by instructions stored
on a computer readable medium.         The transaction handler (103) is configured to
support and deliver authorization services, exception file services, and clearing and
settlement services.     The transaction handler (103) has a subsystem to process
authorization requests and another subsystem to perform clearing and settlement
                                            -- 54 --

     WO 2015/175893                                                     PCT/US2015/031000
services.    The transaction handler (103) is configured to process different types of
transactions, such credit card transactions, debit card transactions, prepaid card
transactions, and other types of commercial transactions.      The transaction handler
(103) interconnects the issuer processors (e.g., 145) and the acquirer processor (e.g.,
147) to facilitate payment communications.
[0266]      In Figure 13, the transaction terminal (105) is configured to submit the
authorized transactions to the acquirer processor (147) for settlement.      The amount for
the settlement may be different from the amount specified in the authorization request.
The transaction handler (103) is coupled between the issuer processor (145) and the
acquirer processor (147) to facilitate the clearing and settling of the transaction.
Clearing includes the exchange of financial information between the issuer processor
(145) and the acquirer processor (147); and settlement includes the exchange of funds.
[0267]      In Figure 13, the issuer processor (145) is configured to provide funds to
make payments on behalf of the consumer account (146).          The acquirer processor
(147) is to receive the funds on behalf of the merchant account (148).       The issuer
processor (145) and the acquirer processor (147) communicate with the transaction
handler (103) to coordinate the transfer of funds for the transaction.     The funds can be
transferred electronically.
[0268]     The transaction terminal (105) may submit a transaction directly for
settlement, without having to separately submit an authorization request.
[0269]      In one embodiment, the portal (143) provides a user interface to allow the user
(101) to organize the transactions in one or more consumer accounts (146) of the user
with one or more issuers.     The user (101) may organize the transactions using
information and/or categories identified in the transaction records, such as merchant
category, transaction date, amount, etc.      Examples and techniques in one embodiment
are provided in U.S. Pat. App. Pub. No. 2007/0055597, and entitled "Method and System
for Manipulating Purchase Information," the disclosure of which is hereby incorporated
herein by reference.
[0270]      In one embodiment, the portal (143) provides transaction based statistics,
such as indicators for retail spending monitoring, indicators for merchant benchmarking,
industry/market segmentation, indicators of spending patterns, etc.       Further examples
                                            -- 55 --

     WO 2015/175893                                                    PCT/US2015/031000
can be found in U.S. Pat. App. Pub. No. 2009/0048884, and entitled "Merchant
Benchmarking Tool," the disclosure of which application is hereby incorporated herein by
reference.
TRANSACTION TERMINAL
[0271]      Figure 14 illustrates a transaction terminal according to one embodiment.
The transaction terminal (105) illustrated in Figure 14 can be used in various systems
discussed in connection with other figures of the present disclosure.     In Figure 14, the
transaction terminal (105) is configured to interact with an account identification device
(141) to obtain account information (142) about the consumer account (146).
[0272]      In one embodiment, the transaction terminal (105) includes a memory (167)
coupled to the processor (151), which controls the operations of a reader (163), an input
device (153), an output device (165) and a network interface (161).     The memory (167)
may store instructions for the processor (151) and/or data, such as an identification that
is associated with the merchant account (148).
[0273]      In one embodiment, the reader (163) includes a magnetic strip reader.      In
another embodiment, the reader (163) includes a contactless reader, such as a radio
frequency identification (RFID) reader, a near field communications (NFC) device
configured to read data via magnetic field coupling (in accordance with ISO standard
14443/NFC), a Bluetooth transceiver, a WiFi transceiver, an infrared transceiver, a laser
scanner, etc.
[0274]      In one embodiment, the input device (153) includes key buttons that can be
used to enter the account information (142) directly into the transaction terminal (105)
without the physical presence of the account identification device (141).     The input
device (153) can be configured to provide further information to initiate a transaction,
such as a personal identification number (PIN), password, zip code, etc. that may be
used to access the account identification device (141), or in combination with the
account information (142) obtained from the account identification device (141).
[0275]      In one embodiment, the output device (165) may include a display, a speaker,
and/or a printer to present information, such as the result of an authorization request, a
receipt for the transaction, an advertisement, etc.
                                            -- 56 --

     WO 2015/175893                                                     PCT/US2015/031000
[0276]      In one embodiment, the network interface (161) is configured to communicate
with the acquirer processor (147) via a telephone connection, an Internet connection, or
a dedicated data communication channel.
[0277]      In one embodiment, the instructions stored in the memory (167) are configured
at least to cause the transaction terminal (105) to send an authorization request
message to the acquirer processor (147) to initiate a transaction.     The transaction
terminal (105) may or may not send a separate request for the clearing and settling of
the transaction.    The instructions stored in the memory (167) are also configured to
cause the transaction terminal (105) to perform other types of functions discussed in this
description.
[0278]      In one embodiment, a transaction terminal (105) may have fewer components
than those illustrated in Figure 14.    For example, in one embodiment, the transaction
terminal (105) is configured for "card-not-present" transactions; and the transaction
terminal (105) does not have a reader (163).
[0279]      In one embodiment, a transaction terminal (105) may have more components
than those illustrated in Figure 14.    For example, in one embodiment, the transaction
terminal (105) is an ATM machine, which includes components to dispense cash under
certain conditions.
ACCOUNT IDENTIFICATION DEVICE
[0280]      Figure 15 illustrates an account identifying device according to one
embodiment.      In Figure 15, the account identification device (141) is configured to carry
account information (142) that identifies the consumer account (146).
[0281]      In one embodiment, the account identification device (141) includes a memory
(167) coupled to the processor (151), which controls the operations of a communication
device (159), an input device (153), an audio device (157) and a display device (155).
The memory (167) may store instructions for the processor (151) and/or data, such as
the account information (142) associated with the consumer account (146).
[0282]      In one embodiment, the account information (142) includes an identifier
identifying the issuer (and thus the issuer processor (145)) among a plurality of issuers,
and an identifier identifying the consumer account among a plurality of consumer
                                            -- 57 --

     WO 2015/175893                                                     PCT/US2015/031000
accounts controlled by the issuer processor (145).     The account information (142) may
include an expiration date of the account identification device (141), the name of the
consumer holding the consumer account (146), and/or an identifier identifying the
account identification device (141) among a plurality of account identification devices
associated with the consumer account (146).
[0283]      In one embodiment, the account information (142) may further include a
loyalty program account number, accumulated rewards of the consumer in the loyalty
program, an address of the consumer, a balance of the consumer account (146), transit
information (e.g., a subway or train pass), access information (e.g., access badges),
and/or consumer information (e.g., name, date of birth), etc.
[0284]      In one embodiment, the memory includes a nonvolatile memory, such as
magnetic strip, a memory chip, a flash memory, a Read Only Memory (ROM), etc. to
store the account information (142).
[0285]      In one embodiment, the information stored in the memory (167) of the account
identification device (141) may also be in the form of data tracks that are traditionally
associated with credits cards.   Such tracks include Track 1 and Track 2.       Track 1
("International Air Transport Association") stores more information than Track 2, and
contains the cardholder's name as well as the account number and other discretionary
data.    Track 1 is sometimes used by airlines when securing reservations with a credit
card.    Track 2 ("American Banking Association") is currently most commonly used and
is read by ATMs and credit card checkers.      The ABA (American Banking Association)
designed the specifications of Track 1 and banks abide by it.     It contains the
cardholder's account number, encrypted PIN, and other discretionary data.
[0286]      In one embodiment, the communication device (159) includes a
semiconductor chip to implement a transceiver for communication with the reader (163)
and an antenna to provide and/or receive wireless signals.
[0287]      In one embodiment, the communication device (159) is configured to
communicate with the reader (163).      The communication device (159) may include a
transmitter to transmit the account information (142) via wireless transmissions, such as
radio frequency signals, magnetic coupling, or infrared, Bluetooth or WiFi signals, etc.
[0288]      In one embodiment, the account identification device (141) is in the form of a
                                          -- 58 --

     WO 2015/175893                                                    PCT/US2015/031000
mobile phone, personal digital assistant (PDA), etc.     The input device (153) can be
used to provide input to the processor (151) to control the operation of the account
identification device (141); and the audio device (157) and the display device (155) may
present status information and/or other information, such as advertisements or offers.
The account identification device (141) may include further components that are not
shown in Figure 15, such as a cellular communications subsystem.
[0289]      In one embodiment, the communication device (159) may access the account
information (142) stored on the memory (167) without going through the processor (151).
[0290]      In one embodiment, the account identification device (141) has fewer
components than those illustrated in Figure 15.      For example, an account identification
device (141) does not have the input device (153), the audio device (157) and the display
device (155) in one embodiment; and in another embodiment, an account identification
device (141) does not have components (151-159).
[0291]      For example, in one embodiment, an account identification device (141) is in
the form of a debit card, a credit card, a smartcard, or a consumer device that has
optional features such as magnetic strips, or smartcards.
[0292]      An example of an account identification device (141) is a magnetic strip
attached to a plastic substrate in the form of a card.   The magnetic strip is used as the
memory (167) of the account identification device (141) to provide the account
information (142).    Consumer information, such as account number, expiration date,
and consumer name may be printed or embossed on the card.           A semiconductor chip
implementing the memory (167) and the communication device (159) may also be
embedded in the plastic card to provide account information (142) in one embodiment.
In one embodiment, the account identification device (141) has the semiconductor chip
but not the magnetic strip.
[0293]      In one embodiment, the account identification device (141) is integrated with a
security device, such as an access card, a radio frequency identification (RFID) tag, a
security card, a transponder, etc.
[0294]      In one embodiment, the account identification device (141) is a handheld and
compact device.     In one embodiment, the account identification device (141) has a size
suitable to be placed in a wallet or pocket of the consumer.
                                            -- 59 --

     WO 2015/175893                                                     PCT/US2015/031000
[0295]      Some examples of an account identification device (141) include a credit card,
a debit card, a stored value device, a payment card, a gift card, a smartcard, a smart
media card, a payroll card, a health care card, a wrist band, a keychain device, a
supermarket discount card, a transponder, and a machine readable medium containing
account information (142).
POINT OF INTERACTION
[0296]      In one embodiment, the point of interaction (107) is to provide an
advertisement to the user (101), or to provide information derived from the transaction
data (109) to the user (101).
[0297]      In one embodiment, an advertisement is a marketing interaction which may
include an announcement and/or an offer of a benefit, such as a discount, incentive,
reward, coupon, gift, cash back, or opportunity (e.g., special ticket/admission).    An
advertisement may include an offer of a product or service, an announcement of a
product or service, or a presentation of a brand of products or services, or a notice of
events, facts, opinions, etc.    The advertisements can be presented in text, graphics,
audio, video, or animation, and as printed matter, web content, interactive media, etc.
An advertisement may be presented in response to the presence of a financial
transaction card, or in response to a financial transaction card being used to make a
financial transaction, or in response to other user activities, such as browsing a web
page, submitting a search request, communicating online, entering a wireless
communication zone, etc.       In one embodiment, the presentation of advertisements may
be not a result of a user action.
[0298]      In one embodiment, the point of interaction (107) can be one of various
endpoints of the transaction network, such as point of sale (POS) terminals, automated
teller machines (ATMs), electronic kiosks (or computer kiosks or interactive kiosks),
self-assist checkout terminals, vending machines, gas pumps, websites of banks (e.g.,
issuer banks or acquirer banks of credit cards), bank statements (e.g., credit card
statements), websites of the transaction handler (103), websites of merchants, checkout
websites or web pages for online purchases, etc.
[0299]      In one embodiment, the point of interaction (107) may be the same as the
                                            -- 60 --

     WO 2015/175893                                                      PCT/US2015/031000
transaction terminal (105), such as a point of sale (POS) terminal, an automated teller
machine (ATM), a mobile phone, a computer of the user for an online transaction, etc.
In one embodiment, the point of interaction (107) may be co-located with, or near, the
transaction terminal (105) (e.g., a video monitor or display, a digital sign), or produced by
the transaction terminal (e.g., a receipt produced by the transaction terminal (105)).     In
one embodiment, the point of interaction (107) may be separate from and not co-located
with the transaction terminal (105), such as a mobile phone, a personal digital assistant,
a personal computer of the user, a voice mail box of the user, an email inbox of the user,
a digital sign, etc.
[0300]      For example, the advertisements can be presented on a portion of media for a
transaction with the customer, which portion might otherwise be unused and thus
referred to as a "white space" herein.     A white space can be on a printed matter (e.g., a
receipt printed for the transaction, or a printed credit card statement), on a video display
(e.g., a display monitor of a POS terminal for a retail transaction, an ATM for cash
withdrawal or money transfer, a personal computer of the customer for online
purchases), or on an audio channel (e.g., an interactive voice response (IVR) system for
a transaction over a telephonic device).
[0301]      In one embodiment, the white space is part of a media channel available to
present a message from the transaction handler (103) in connection with the processing
of a transaction of the user (101).    In one embodiment, the white space is in a media
channel that is used to report information about a transaction of the user (101), such as
an authorization status, a confirmation message, a verification message, a user interface
to verify a password for the online use of the account information (142), a monthly
statement, an alert or a report, or a web page provided by the portal (143) to access a
loyalty program associated with the consumer account (146) or a registration program.
[0302]      In other embodiments, the advertisements can also be presented via other
media channels which may not involve a transaction processed by the transaction
handler (103).     For example, the advertisements can be presented on publications or
announcements (e.g., newspapers, magazines, books, directories, radio broadcasts,
television, digital signage, etc., which may be in an electronic form, or in a printed or
painted form).     The advertisements may be presented on paper, on websites, on
                                            -- 61 --

     WO 2015/175893                                                      PCT/US2015/031000
billboards, on digital signs, or on audio portals.
[0303]      In one embodiment, the transaction handler (103) purchases the rights to use
the media channels from the owner or operators of the media channels and uses the
media channels as advertisement spaces.          For example, white spaces at a point of
interaction (e.g., 107) with customers for transactions processed by the transaction
handler (103) can be used to deliver advertisements relevant to the customers
conducting the transactions; and the advertisement can be selected based at least in
part on the intelligence information derived from the accumulated transaction data (109)
and/or the context at the point of interaction (107) and/or the transaction terminal (105).
[0304]      In general, a point of interaction (e.g., 107) may or may not be capable of
receiving inputs from the customers, and may or may not co-located with a transaction
terminal (e.g., 105) that initiates the transactions.   The white spaces for presenting the
advertisement on the point of interaction (107) may be on a portion of a geographical
display space (e.g., on a screen), or on a temporal space (e.g., in an audio stream).
[0305]      In one embodiment, the point of interaction (107) may be used to primarily to
access services not provided by the transaction handler (103), such as services provided
by a search engine, a social networking website, an online marketplace, a blog, a news
site, a television program provider, a radio station, a satellite, a publisher, etc.
[0306]      In one embodiment, a consumer device is used as the point of interaction
(107), which may be a non-portable consumer device or a portable computing device.
The consumer device is to provide media content to the user (101) and may receive
input from the user (101).
[0307]      Examples of non-portable consumer devices include a computer terminal, a
television set, a personal computer, a set-top box, or the like.     Examples of portable
consumer devices include a portable computer, a cellular phone, a personal digital
assistant (PDA), a pager, a security card, a wireless terminal, or the like.    The consumer
device may be implemented as a data processing system as illustrated in Figure 16,
with more or fewer components.
[0308]      In one embodiment, the consumer device includes an account identification
device (141).     For example, a smart card used as an account identification device (141)
is integrated with a mobile phone, or a personal digital assistant (PDA).
                                             -- 62 --

     WO 2015/175893                                                      PCT/US2015/031000
[0309]      In one embodiment, the point of interaction (107) is integrated with a
transaction terminal (105).     For example, a self-service checkout terminal includes a
touch pad to interact with the user (101); and an ATM machine includes a user interface
subsystem to interact with the user (101).
HARDWARE
[0310]      In one embodiment, a computing apparatus is configured to include some of
the components of systems illustrated in various figures, such as the transaction handler
(103), the profile generator (121), the media controller (115), the portal (143), the profile
selector (129), the advertisement selector (133), the user tracker (113), the correlator,
and their associated storage devices, such as the data warehouse (149).
[0311]      In one embodiment, at least some of the components such as the transaction
handler (103), the transaction terminal (105), the point of interaction (107), the user
tracker (113), the media controller (115), the correlator (117), the profile generator (121),
the profile selector (129), the advertisement selector (133), the portal (143), the issuer
processor (145), the acquirer processor (147), and the account identification device
(141), can be implemented as a computer system, such as a data processing system
(170) illustrated in Figure 16.    Some of the components may share hardware or be
combined on a computer system.          In one embodiment, a network of computers can be
used to implement one or more of the components.
[0312]      Further, the data illustrated in the figures, such as transaction data (109),
account data (111), transaction profiles (127), and advertisement data (135), can be
stored in storage devices of one or more computers accessible to the corresponding
components.      For example, the transaction data (109) can be stored in the data
warehouse (149) that can be implemented as a data processing system illustrated in
Figure 16, with more or fewer components.
[0313]      In one embodiment, the transaction handler (103) is a payment processing
system, or a payment card processor, such as a card processor for credit cards, debit
cards, etc.
[0314]      Figure 16 illustrates a data processing system according to one embodiment.
While Figure 16 illustrates various components of a computer system, it is not intended
                                              -- 63 --

     WO 2015/175893                                                    PCT/US2015/031000
to represent any particular architecture or manner of interconnecting the components.
One embodiment may use other systems that have fewer or more components than
those shown in Figure 16.
[0315]      In Figure 16, the data processing system (170) includes an inter-connect
(171) (e.g., bus and system core logic), which interconnects a microprocessor(s) (173)
and memory (167).       The microprocessor (173) is coupled to cache memory (179) in the
example of Figure 16.
[0316]      In one embodiment, the inter-connect (171) interconnects the
microprocessor(s) (173) and the memory (167) together and also interconnects them to
input/output (1/O) device(s) (175) via 1/O controller(s) (177).  1/O devices (175) may
include a display device and/or peripheral devices, such as mice, keyboards, modems,
network interfaces, printers, scanners, video cameras and other devices known in the
art.  In one embodiment, when the data processing system is a server system, some of
the I/O devices (175), such as printers, scanners, mice, and/or keyboards, are optional.
[0317]      In one embodiment, the inter-connect (171) includes one or more buses
connected to one another through various bridges, controllers and/or adapters.       In one
embodiment the 1/O controllers (177) include a USB (Universal Serial Bus) adapter for
controlling USB peripherals, and/or an IEEE-1394 bus adapter for controlling IEEE-1 394
peripherals.
[0318]      In one embodiment, the memory (167) includes one or more of: ROM (Read
Only Memory), volatile RAM (Random Access Memory), and non-volatile memory, such
as hard drive, flash memory, etc.
[0319]      Volatile RAM is typically implemented as dynamic RAM (DRAM) which
requires power continually in order to refresh or maintain the data in the memory.
Non-volatile memory is typically a magnetic hard drive, a magnetic optical drive, an
optical drive (e.g., a DVD RAM), or other type of memory system which maintains data
even after power is removed from the system.        The non-volatile memory may also be a
random access memory.
[0320]      The non-volatile memory can be a local device coupled directly to the rest of
the components in the data processing system.        A non-volatile memory that is remote
from the system, such as a network storage device coupled to the data processing
                                           -- 64 --

     WO 2015/175893                                                     PCT/US2015/031000
system through a network interface such as a modem or Ethernet interface, can also be
used.
[0321]      In this description, some functions and operations are described as being
performed by or caused by software code to simplify description.       However, such
expressions are also used to specify that the functions result from execution of the
code/instructions by a processor, such as a microprocessor.
[0322]      Alternatively, or in combination, the functions and operations as described
here can be implemented using special purpose circuitry, with or without software
instructions, such as using Application-Specific Integrated Circuit (ASIC) or
Field-Programmable Gate Array (FPGA). Embodiments can be implemented using
hardwired circuitry without software instructions, or in combination with software
instructions.    Thus, the techniques are limited neither to any specific combination of
hardware circuitry and software, nor to any particular source for the instructions
executed by the data processing system.
[0323]      While one embodiment can be implemented in fully functioning computers and
computer systems, various embodiments are capable of being distributed as a
computing product in a variety of forms and are capable of being applied regardless of
the particular type of machine or computer-readable media used to actually effect the
distribution.
[0324]      At least some aspects disclosed can be embodied, at least in part, in software.
That is, the techniques may be carried out in a computer system or other data
processing system in response to its processor, such as a microprocessor, executing
sequences of instructions contained in a memory, such as ROM, volatile RAM,
non-volatile memory, cache or a remote storage device.
[0325]      Routines executed to implement the embodiments may be implemented as
part of an operating system or a specific application, component, program, object,
module or sequence of instructions referred to as "computer programs." The computer
programs typically include one or more instructions set at various times in various
memory and storage devices in a computer, and that, when read and executed by one or
more processors in a computer, cause the computer to perform operations necessary to
execute elements involving the various aspects.
                                            -- 65 --

     WO 2015/175893                                                      PCT/US2015/031000
[0326]      A machine readable medium can be used to store software and data which
when executed by a data processing system causes the system to perform various
methods.     The executable software and data may be stored in various places including
for example ROM, volatile RAM, non-volatile memory and/or cache.            Portions of this
software and/or data may be stored in any one of these storage devices.          Further, the
data and instructions can be obtained from centralized servers or peer to peer networks.
Different portions of the data and instructions can be obtained from different centralized
servers and/or peer to peer networks at different times and in different communication
sessions or in a same communication session.           The data and instructions can be
obtained in entirety prior to the execution of the applications.    Alternatively, portions of
the data and instructions can be obtained dynamically, just in time, when needed for
execution.     Thus, it is not required that the data and instructions be on a machine
readable medium in entirety at a particular instance of time.
[0327]      Examples of computer-readable media include but are not limited to
recordable and non-recordable type media such as volatile and non-volatile memory
devices, read only memory (ROM), random access memory (RAM), flash memory
devices, floppy and other removable disks, magnetic disk storage media, optical storage
media (e.g., Compact Disk Read-Only Memory (CD ROMS), Digital Versatile Disks
(DVDs), etc.), among others.       The computer-readable media may store the instructions.
[0328]      The instructions may also be embodied in digital and analog communication
links for electrical, optical, acoustical or other forms of propagated signals, such as
carrier waves, infrared signals, digital signals, etc.    However, propagated signals, such
as carrier waves, infrared signals, digital signals, etc. are not tangible machine readable
medium and are not configured to store instructions.
[0329]      In general, a machine readable medium includes any mechanism that
provides (i.e., stores and/or transmits) information in a form accessible by a machine
(e.g., a computer, network device, personal digital assistant, manufacturing tool, any
device with a set of one or more processors, etc.).
[0330]      In various embodiments, hardwired circuitry may be used in combination with
software instructions to implement the techniques.        Thus, the techniques are neither
limited to any specific combination of hardware circuitry and software nor to any
                                              -- 66 --

      WO 2015/175893                                                      PCT/US2015/031000
particular source for the instructions executed by the data processing system.
OTHER ASPECTS
[0331]      The description and drawings are illustrative and are not to be construed as
limiting.   The present disclosure is illustrative of inventive features to enable a person
skilled in the art to make and use the techniques.      Various features, as described
herein, should be used in compliance with all current and future rules, laws and
regulations related to privacy, security, permission, consent, authorization, and others.
Numerous specific details are described to provide a thorough understanding.
However, in certain instances, well known or conventional details are not described in
order to avoid obscuring the description.       References to one or an embodiment in the
present disclosure are not necessarily references to the same embodiment; and, such
references mean at least one.
[0332]      The use of headings herein is merely provided for ease of reference, and shall
not be interpreted in any way to limit this disclosure or the following claims.
[0333]      Reference to "one embodiment" or "an embodiment" means that a particular
feature, structure, or characteristic described in connection with the embodiment is
included in at least one embodiment of the disclosure.        The appearances of the phrase
"in one embodiment" in various places in the specification are not necessarily all referring
to the same embodiment, and are not necessarily all referring to separate or alternative
embodiments mutually exclusive of other embodiments.           Moreover, various features
are described which may be exhibited by one embodiment and not by others.             Similarly,
various requirements are described which may be requirements for one embodiment but
not other embodiments.      Unless excluded by explicit description and/or apparent
incompatibility, any combination of various features described in this description is also
included here.      For example, the features described above in connection with "in one
embodiment" or "in some embodiments" can be all optionally included in one
implementation, except where the dependency of certain features on other features, as
apparent from the description, may limit the options of excluding selected features from
the implementation, and incompatibility of certain features with other features, as
apparent from the description, may limit the options of including selected features
                                             -- 67 --

     WO 2015/175893                                                       PCT/US2015/031000
together in the implementation.
[0334]     The disclosures of the above discussed patent documents are hereby
incorporated herein by reference.
[0335]      In the foregoing specification, the disclosure has been described with
reference to specific exemplary embodiments thereof.        It will be evident that various
modifications may be made thereto without departing from the broader spirit and scope
as set forth in the following claims. The specification and drawings are, accordingly, to
be regarded in an illustrative sense rather than a restrictive sense.
                                             -- 68 --

                                            CLAIMS
1.    A method to organize data in a computing apparatus for transaction processing,
the method comprising:
      storing, in a computing apparatus, a first record identifying a first value retrievable
              for application to a transaction that satisfies a set of conditions associated
              with the first record, the first value being less than a threshold;
       receiving, in the computing apparatus, an input identifying a second value
              applicable to transactions that satisfies the set of conditions;
      determining, by the computing apparatus, whether a sum of the first value and the
              second value is above the threshold;
       updating, by the computing apparatus, the first record to identify a third value,
              wherein:
              when the sum of the first value and the second value does not exceed the
                       threshold, the third value is equal to the sum of the first value and
                       the second value; and
              when the sum of the first value and the second value exceeds the
                       threshold, the third value is equal to the threshold;
      creating, by the computing apparatus, a second record associated with the set of
              conditions when the sum exceeds the threshold, wherein the second
               record identifies a difference between the threshold and the sum of the first
              value and the second value when the sum exceeds the threshold;
      generating a trigger record to monitor the first record, wherein the trigger record
              identifies a subset of the set of conditions;
       processing, by the computing apparatus, a plurality of transactions, each
              transaction of the plurality of transactions comprising at least one of an
              authorization request and an authorization response;
      determining, by the computing apparatus, a first transaction of the plurality of
              transactions triggers the trigger record based on the at least one of the
              authorization request or the authorization response satisfying the subset of
              the set of conditions identified by the trigger record;
       in response to a determination that the first transaction triggers the trigger record,

           determining, by the computing apparatus, whether the first transaction
           satisfies the set of conditions; and
   in response to a determination that the first transaction satisfies the set of
           conditions, retrieving at least a portion of the third value from the first
           record and applying the portion of the third value to the first transaction
           while the first transaction is being processed in the computing apparatus.
2. The method of claim 1, wherein the second record is independent of the first
   record and capable of being monitored for application to a transaction that
   satisfies the set of conditions.
3. The method of claim 2, wherein the first record and the second record are tracked
   as a group for association with the set of conditions.
4. The method of claim 3, wherein the trigger record is generated to monitor the first
   record without monitoring the second record.
5. The method of claim 1, wherein applying the portion of the third value to the first
   transaction comprises reducing a transaction amount of the at least one of the
   authorization request or the authorization response by an amount equal to the
   portion of the third value.
6. The method of claim 1, further comprising:
   after the portion of the third value is retrieved and applied to the first transaction,
           moving at least a portion of a value in the second record to the first record
           without exceeding the threshold.
7. The method of claim 6, further comprising:
   scheduling the moving in a background process for execution at a time after the
           first transaction is processed in the computing apparatus.
8. The method of claim 6, further comprising:
   after the moving, deleting the second record in response to a determination that a
           value in the second record becomes zero.
9. The method of claim 1, wherein further comprising:
   storing data identifying a discount offer;
   processing a second transaction;

    making a determination that the second transaction satisfies requirements of the
            discount offer; and
    determining the second value to generate the input based on the discount offer.
10. The method of claim 9, wherein the second value is further determined based on a
    transaction amount of the second transaction.
11. The method of claim 9, further comprising:
    determining, by the computing apparatus, a fourth value in accordance with the
            discount offer, wherein the fourth value does not exceed the threshold;
    wherein the at least a portion of the third value retrieved from the first record is
            equal to the fourth value.
12. The method of claim 11, wherein the fourth value is less than the threshold for a
    partial redemption of discounts aggregated in the first record.
13. A non-transitory computer storage medium storing instructions configured to
    control a computing apparatus to process multiple transactions as a single
    transaction, comprising:
    storing, in the computing apparatus, a first record identifying a first value
             retrievable for application to a transaction that satisfies a set of conditions
            associated with the first record, the first value being less than a threshold;
    receiving, in the computing apparatus, an input identifying a second value
            applicable to transactions that satisfies the set of conditions;
    determining, by the computing apparatus, whether a sum of the first value and the
            second value is above the threshold;
    updating, by the computing apparatus, the first record to identify a third value,
            wherein:
            when the sum of the first value and the second value does not exceed the
                     threshold, the third value is equal to the sum of the first value and
                     the second value; and
            when the sum of the first value and the second value exceeds the
                     threshold, the third value is equal to the threshold;
    creating, by the computing apparatus, a second record associated with the set of
            conditions when the sum exceeds the threshold, wherein the second
             record identifies a difference between the threshold and the sum of the first
            value and the second value when the sum exceeds the threshold;

    generating a trigger record to monitor the first record, wherein the trigger record
            identifies a subset of the set of conditions;
    processing, by the computing apparatus, a plurality of transactions, each
            transaction of the plurality of transactions comprising at least one of an
            authorization request and an authorization response;
    determining, by the computing apparatus, a first transaction of the plurality of
            transactions triggers the trigger record based on the at least one of the
            authorization request or the authorization response satisfying the subset of
            the set of conditions identified by the trigger record;
    in response to a determination that the first transaction triggers the trigger record,
            determining, by the computing apparatus, whether the first transaction
            satisfies the set of conditions; and
    in response to a determination that the first transaction satisfies the set of
            conditions, retrieving at least a portion of the third value from the first
            record and applying the portion of the third value to the first transaction
            while the first transaction is being processed in the computing apparatus.
14. A computing apparatus having at least one microprocessor and memory storing
    instructions configured to instruct the at least one microprocessor to process
    multiple transactions as a single transaction, the computing apparatus comprising:
    a transaction handler of an electronic payment processing network in which the
            transaction handler interconnects issuers controlling payment accounts
            and acquirers controlling merchant accounts;
    a data warehouse coupled with the transaction handler and storing a first record
            identifying a first value retrievable for application to a transaction that
            satisfies a set of conditions associated with the first record, the first value
            being less than a threshold;
    wherein in response to an input identifying a second value applicable to
            transactions that satisfies the set of conditions, the transaction handler
            updates the first record to identify a third value, wherein:
            when the sum of the first value and the second value does not exceed the
                    threshold, the third value is equal to the sum of the first value and
                    the second value; and
            when the sum of the first value and the second value exceeds the
                    threshold, the third value is equal to the threshold;

    wherein the transaction handler creates a second record associated with the set
            of conditions when the sum exceeds the threshold, wherein the second
             record identifies a difference between the threshold and the sum of the first
            value and the second value when the sum exceeds the threshold;
    wherein the transaction handler generates a trigger record to monitor the first
             record, wherein the trigger record identifies a subset of the set of
            conditions;
    wherein during processing of a plurality of transactions in the electronic payment
             processing network, each transaction of the plurality of transactions
            comprises at least one of an authorization request and an authorization
             response, and the transaction handler determines a first transaction of the
             plurality of transactions triggers the trigger record based on the at least one
            of the authorization request or the authorization response satisfying the
            subset of the set of conditions identified by the trigger record,
    wherein, in response to a determination that the first transaction triggers the
            trigger record, the transaction handler determines whether the first
            transaction satisfies the set of conditions and, in response to a
            determination that the first transaction satisfies the set of conditions,
             retrieves at least a portion of the third value from the first record and
            applies the portion of the third value to the first transaction while the first
            transaction is being processed for authorization via the transaction
             handler.
15. The computing apparatus of claim 14, wherein the second record is independent
    of the first record and capable of being monitored for application to a transaction
    that satisfies the set of conditions; the first record and the second record are
    tracked as a group for association with the set of conditions.
16. The computing apparatus of claim 15, wherein the transaction handler generates
    the trigger record to monitor the first record without monitoring the second record.
17. The computing apparatus of claim 14, wherein the transaction handler is
    configured to, after the portion of the third value is retrieved and applied to the first
    transaction, moving at least a portion of a value in the second record to the first
    record without exceeding the threshold, in a background process executed at a
    time after the authorization of the first transaction is completed in the electronic

    payment processing network.
18. The computing apparatus of claim 14, wherein the data warehouse is further
    configured to store data identifying a discount offer; during processing of a second
    transaction, the transaction handler is configured to make a determination that the
    second transaction satisfies requirements of the discount offer and compute the
    second value to generate the input based on the discount offer.
19. The computing apparatus of claim 18, further comprising:
    determining, by the computing apparatus, a fourth value in accordance with the
            discount offer, wherein the fourth value does not exceed the threshold;
    wherein the at least a portion of the third value retrieved from the first record is
            equal to the fourth value; and
    the fourth value is less than the threshold for a partial redemption of discounts
            aggregated in the first record.
20. The computing apparatus of claim 14, wherein the transaction handler is
    configured to modify a transaction amount authorized for the first transaction to
    apply the portion of the third value to the first transaction during the authorization
    of the first transaction in the electronic payment processing network.

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
