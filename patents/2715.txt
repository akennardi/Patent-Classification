                                                    24
LINEAR PREDICTION COEFFICIENT CONVERSION DEVICE AND
LINEAR PREDICTION COEFFICIENT CONVERSION METHOD
                                            ABSTRACT
          The purpose of the present invention is to estimate, with a small amount of computation,
a linear prediction synthesis filter after conversion of an internal sampling frequency. A linear
prediction coefficient conversion device is a device that converts first linear prediction
coefficients calculated at a first sampling frequency to second linear prediction coefficients at a
second sampling frequency different from the first sampling frequency, which includes a means
for calculating, on the real axis of the unit circle, a power spectrum corresponding to the second
linear prediction coefficients at the second sampling frequency based on the first linear prediction
coefficients or an equivalent parameter, a means for calculating, on the real axis of the unit circle,
autocorrelation coefficients from the power spectrum, and a means for converting the
autocorrelation coefficients to the second linear prediction coefficients at the second sampling
frequency.
16999001

                                                    1
TITLE OF INVENTION
LINEAR PREDICTION COEFFICIENT CONVERSION DEVICE AND
LINEAR PREDICTION COEFFICIENT CONVERSION METHOD
Corresponding Applications
[0001] This application is a divisional application of Australian Patent Application No.
2015251609, filed on 16 April 2015, the contents of which are hereby incorporated in its
entirety.
Technical Field
[0002]    The present invention relates to a linear prediction coefficient conversion device and a
linear prediction coefficient conversion method.
Background Art
[0003]    An autoregressive all-pole model is a method that is often used for modeling of a short
term spectral envelope in speech and audio coding, where an input signal is acquired for a certain
collective unit or a frame with a specified length, a parameter of the model is encoded and
transmitted to a decoder together with another parameter as transmission information. The
autoregressive all-pole model is generally estimated by linear prediction and represented as a
linear prediction synthesis filter.
[0004]    One of the latest typical speech and audio coding techniques is ITU-T Recommendation
G.718. The Recommendation describes a typical frame structure for coding using a linear
prediction synthesis filter, and an estimation method, a coding method, an interpolation method,
and a use method of a linear prediction synthesis filter in detail. Further, speech and audio coding
on the basis of linear prediction is also described in detail in Patent Literature 2.
16999001

                                                     2
Description
[0005]    In speech and audio coding that can handle various input/output sampling frequencies
and operate at a wide range of bit rate, which vary from frame to frame, it is generally required to
change the internal sampling frequency of an encoder. Because the same operation is required
also in a decoder, decoding is performed at the same internal sampling frequency as in the
encoder. Fig. 1 shows an example where the internal sampling frequency changes. In this
example, the internal sampling frequency is 16,000Hz in a frame i, and it is 12,800Hz in the
previous frame i-I. The linear prediction synthesis filter that represents the characteristics of an
input signal in the previous frame i-I needs to be estimated again after re-sampling the input
signal at the changed internal sampling frequency of 16,000Hz, or converted to the one
corresponding to the changed internal sampling frequency of 16,000Hz. The reason that the
linear prediction synthesis filter needs to be calculated at a changed internal sampling frequency
is to obtain the correct internal state of the linear prediction synthesis filter for the current input
signal and to perform interpolation in order to obtain a model that is temporarily smoother.
[0006]     One method for obtaining another linear prediction synthesis filter on the basis of the
characteristics of a certain linear prediction synthesis filter is to calculate a linear prediction
synthesis filter after conversion from a desired frequency response after conversion in a
frequency domain as shown in Fig. 2. In this example, LSF coefficients are input as a parameter
representing the linear prediction synthesis filter. It may be LSP coefficients, ISF coefficients, ISP
coefficients or reflection coefficients, which are generally known as parameters equivalent to
linear prediction coefficients. First, linear prediction coefficients are calculated in order to obtain
a power spectrum Y(o) of the linear prediction synthesis filter at the first internal sampling
frequency (001). This step can be omitted when the linear prediction coefficients are known.
Next, the power spectrum Y(io) of the linear prediction synthesis filter, which is determined by
the obtained linear prediction coefficients, is calculated (002). Then, the obtained power spectrum
is modified to a desired power spectrum Y'(o) (003). Autocorrelation coefficients are calculated
from the modified power spectrum (004). Linear prediction coefficients are calculated from the
16999001

                                                   3
autocorrelation coefficients (005). The relationship between the autocorrelation coefficients and
the linear prediction coefficients is known as the Yule-Walker equation, and the Levinson-Durbin
algorithm is well known as a solution of that equation.
[0007]    This algorithm is effective in conversion of a sampling frequency of the above
described linear prediction synthesis filter. This is because, although a signal that is temporally
ahead of a signal in a frame to be encoded, which is called a look-ahead signal, is generally used
in linear prediction analysis, the look-ahead signal cannot be used when performing linear
prediction analysis again in a decoder.
[0008]    As described above, in speech and audio coding with two different internal sampling
frequencies, it is preferred to use a power spectrum in order to convert the internal sampling
frequency of a known linear prediction synthesis filter. However, because calculation of a power
spectrum is complex computation, there is a problem that the amount of computation is large.
Citation List
Non Patent Literature
[0009]    Non Patent Literature 1: ITU-T Recommendation G.718
          Non Patent Literature 2: Speech coding and synthesis, W.B. Kleijn, K.K. Pariwal, et. al.
ELSEVIER.
Summary of Invention
Technical Problem
[0010]    As described above, there is a problem that, in a coding scheme that has a linear
prediction synthesis filter with two different internal sampling frequencies, a large amount of
computation is required to convert the linear prediction synthesis filter at a certain internal
sampling frequency into the one at a desired internal sampling frequency.
Solution to Problem
[0011]    To solve the above problem, a linear prediction coefficient conversion device according
16999001

                                                     4
to one aspect of the present invention is a device that converts first linear prediction coefficients
calculated at a first sampling frequency to second linear prediction coefficients at a second
sampling frequency different from the first sampling frequency, which includes a means for
calculating, on the real axis of the unit circle, a power spectrum corresponding to the second
linear prediction coefficients at the second sampling frequency based on the first linear prediction
coefficients or an equivalent parameter, a means for calculating, on the real axis of the unit circle,
autocorrelation coefficients from the power spectrum, and a means for converting the
autocorrelation coefficients to the second linear prediction coefficients at the second sampling
frequency. In this configuration, it is possible to effectively reduce the amount of computation.
[0012]    Further, in the linear prediction coefficient conversion device according to one aspect of
the present invention, the power spectrum corresponding to the second linear prediction
coefficients may be obtained by calculating a power spectrum using the first linear prediction
coefficients at points on the real axis corresponding to NI number of different frequencies, where
N1=1+(F1/F2)(N2-1),       when the first sampling frequency is Fl and the second sampling
frequency is F2 (where F1<F2), and extrapolating the power spectrum calculated using the first
linear prediction coefficients for (N2-N1) number of power spectrum components. In this
configuration, it is possible to effectively reduce the amount of computation when the second
sampling frequency is higher than the first sampling frequency.
[0013]    Further, in the linear prediction coefficient conversion device according to one aspect of
the present invention, the power spectrum corresponding to the second linear prediction
coefficients may be obtained by calculating a power spectrum using the first linear prediction
coefficients at points on the real axis corresponding to NI number of different frequencies, where
N1=1+(F1/F2)(N2-1),       when the first sampling frequency is Fl and the second sampling
frequency is F2 (where F1<F2). In this configuration, it is possible to effectively reduce the
amount of computation when the second sampling frequency is lower than the first sampling
frequency.
16999001

                                                     5
[0014]    One aspect of the present invention can be described as an invention of a device as
mentioned above and, in addition, may also be described as an invention of a method as follows.
They fall under different categories but are substantially the same invention and achieve similar
operation and effects.
[0015]    Specifically, a linear prediction coefficient conversion method according to one aspect
of the present invention is a linear prediction coefficient conversion method performed by a
device that converts first linear prediction coefficients calculated at a first sampling frequency to
second linear prediction coefficients at a second sampling frequency different from the first
sampling frequency, the method including a step of calculating, on the real axis of the unit circle,
a power spectrum corresponding to the second linear prediction coefficients at the second
sampling frequency based on the first linear prediction coefficients or an equivalent parameter, a
step of calculating, on the real axis of the unit circle, autocorrelation coefficients from the power
spectrum and a step of converting the autocorrelation coefficients to the second linear prediction
coefficients at the second sampling frequency.
[0016]    Further, a linear prediction coefficient conversion method according to one aspect of the
present invention may obtain the power spectrum corresponding to the second linear prediction
coefficients by calculating a power spectrum using the first linear prediction coefficients at points
on the real axis corresponding to NI number of different frequencies, where N1=1+(F1/F2)(N2
1), when the first sampling frequency is Fl and the second sampling frequency is F2 (where
F1<F2), and extrapolating the power spectrum calculated using the first linear prediction
coefficients for (N2-N1) number of power spectrum components.
[0017]    Further, a linear prediction coefficient conversion method according to one aspect of the
present invention may obtain the power spectrum corresponding to the second linear prediction
coefficients by calculating a power spectrum using the first linear prediction coefficients at points
on the real axis corresponding to NI number of different frequencies, where N1=1+(F1/F2)(N2
1), when the first sampling frequency is Fl and the second sampling frequency is F2 (where
F1<F2).
16999001

                                                     6
Advantageous Effects of Invention
[0018]    It is possible to estimate a linear prediction synthesis filter after conversion of an
internal sampling frequency with a smaller amount of computation than the existing means.
Brief Description of Drawings
[0019]    Fig. 1 is a view showing the relationship between switching of an internal sampling
frequency and a linear prediction synthesis filter.
          Fig. 2 is a view showing conversion of linear prediction coefficients.
          Fig. 3 is a flowchart of conversion 1.
          Fig. 4 is a flowchart of conversion 2.
          Fig. 5 is a block diagram of an embodiment of the present invention.
          Fig. 6 is a view showing the relationship between a unit circle and a cosine function.
Description of Embodiments
[0020]    Embodiments of a device, a method and a program are described hereinafter with
reference to the drawings. Note that, in the description of the drawings, the same elements are
denoted by the same reference symbols and redundant description thereof is omitted.
[0021]    First, definitions required to describe embodiments are described hereinafter.
[0022]    A response of an Nth order autoregressive linear prediction filter (which is referred to
hereinafter as a linear prediction synthesis filter)
(1)        =
     A(z)     1+a,z +...+az-"
can be adapted to the power spectrum Y(o) by calculating autocorrelation
(2) Rk =       f Y(a)cos kcodo, k =0,1,...,n
          2;rT
for a known power spectrum Y(o) at an angular frequency wE[-n,          7U] and, using the Nth order
autocorrelation coefficients, solving linear prediction coefficients ai,a2,...,an by the Levinson
Durbin method as a typical method, for example.
16999001

                                                   7
[0023]    Such generation of an autoregressive model using a known power spectrum can be used
also for modification of a linear prediction synthesis filter 1/A(z) in the frequency domain. This is
achieved by calculating the power spectrum of a known filter
(3) Y(o)) =1/ A(o)) 2
and modifying the obtained power spectrum Y(co) by an appropriate method that is suitable for
the purpose to obtain the modified power spectrum Y'(w), then calculating the autocorrelation
coefficients of Y'(o) by the above equation (2), and obtaining the linear prediction coefficients of
the modified filter 1/A'(z) by the Levinson-Durbin algorithm or a similar method.
[0024]    While the equation (2) cannot be analytically calculated except for simple cases, the
rectangle approximation can be used as follows, for example.
            1
(4) Rk ;    -IY(   p)cos kV
          M 'Pa
where Q indicates the M number of frequencies placed at regular intervals at the angular
frequency [-t,t]. When the symmetric property of Y(-o)=-Y(o) is used, the above-mentioned
addition only needs to evaluate the angular frequency oE[O, 7u], which corresponds to the upper
half of the unit circle. Thus, it is preferred in terms of the amount of computation that the
rectangle approximation represented by the above equation (4) is altered as follows
           1
(5) Rk    -(Y(O)   + (-1)k Y(c) + 2 >LY(p)coskp)
where Q indicates the (N-2) number of frequencies placed at regular intervals at (0, n), excluding
0 and  7.
[0025]    Hereinafter, line spectral frequencies (which are referred to hereinafter as LSF) as an
equivalent means of expression of linear prediction coefficients are described hereinafter.
[0026]    The representation by LSF is used in various speech and audio coding techniques for the
feature quantity of a linear prediction synthesis filter, and the operation and coding of a linear
prediction synthesis filter. The LSF uniquely characterizes the Nth order polynomial A(z) by the
16999001

                                                   8
n number of parameters which are different from linear prediction coefficients. The LSF has
characteristics such as it easily guarantee the stability of a linear prediction synthesis filter, it is
intuitively interpreted in the frequency domain, it is less likely to be affected by quantization
errors than other parameters such as linear prediction coefficients and reflection coefficients, it is
suitable for interpolation and the like.
[0027]    For the purpose of one embodiment of the present invention, LSF is defined as follows.
[0028]    LSF decomposition of the Nth order polynomial A(z) can be represented as follows by
using displacement of an integer where K>0
(6)       A(z)={P(z)+Q(z)}/2
where P(z)=A(z)+z-"-A(z-') and
          Q(z)=A(z)-z-"-'A(z-1)
The equation (6) indicates that P(z) is symmetric and Q(z) is antisymmetric as follows
          P(z)=z-"-,P(z-I)
          Q(z)= -z-"-'Q(z- 1)
Such symmetric property is an important characteristic in LSF decomposition.
[0029]    It is obvious that P(z) and Q(z) each have a root at z=+1. Those obvious roots are as
shown in the table I as n and     K. Thus, polynomials representing the obvious roots of P(z) and
Q(z) are defined as PT(Z) and QT(Z), respectively. When P(z) does not have an obvious root, PT(Z)
is 1. The same applies to Q(z).
[0030]    LSF of A(z) is a non-trivial root of the positive phase angle of P(z) and Q(z). When the
polynomial A(z) is the minimum phase, that is, when all roots of A(z) are inside the unit circle,
the non- trivial roots of P(z) and Q(z) are arranged alternately on the unit circle. The number of
complex roots of P(z) and Q(z) is mp and mQ, respectively. Table 1 shows the relationship of mp
and mQ with the order n and displacement K.
[0031]    When the complex roots of P(z), which is the positive phase angle, are represented as
16999001

                                                    9
and the roots of Q(z) are represented as
   1o 3 ..'"   2mQp-19
the positions of the roots of the polynomial A(z), which is the minimum phase, can be
represented as follows.
(7) 0 < o0 < m1 < ...    < 0'm+,Q_1 <;rI
[0032]     In speech and audio coding, displacement K=0 or ic=1 is used. When x=O, it is generally
called immitance spectral frequency (ISF), and when x=1, it is generally called LSF in a narrower
sense than that in the description of one embodiment of the present invention. Note that,
however, the representation using displacement can handle both of ISF and LSF in a unified way.
In many cases, a result obtained by LSF can be applied as it is to given K;>O or can be generalized.
[0033]     When x=O, the LSF representation only has the (mP+mQ=n-1) number of frequency
parameters as shown in Table 1. Thus, one more parameter is required to uniquely represent A(z),
and the n-th reflection coefficient (which is referred to hereinafter as 1n) of A(z) is typically used.
This parameter is introduced into LSF decomposition as the next factor.
(8) '=-(yn+1)/ (yn-1)
           where 7n is the n-th reflection coefficient of A(z) which begins with Q(z), and it is
typically yn=an.
[0034]     When K= 1, the (mp+mQ=n) number of parameters are obtained by LSF decomposition,
and it is possible to uniquely represent A(z). In this case, u=1.
Table 1
Case         n                  ,M                  P,.(Z)    Qr(Z)     V
                                                               2
(1)         even       0      n/2        n/2-1      1        z -1      -(7.+1)/ (y.-1)
(2)         odd        0      (n-1)/2    (n-1)/2    z+1      z-1       -(7.+1)/ (yn-1)
(3)         even       1      n/2        n/2        z+1      z-1       1
(4)         odd        1      (n+1)/2    (n-1)/2    1        z2-1      1
 [0034] In consideration of the fact that non-obvious roots, excluding obvious roots, are a pair of
complex numbers on the unit circle and obtain symmetric polynomials, the following equation is
16999001

                                                                   10
obtained.
                                             2                       2                  2
(9) P(z)/ Pr(z) =1+ pz-' + P 2 z- +---+P                  2 z -2,+      + pz-2m,+1 +z-    m,
            =(1 +z        2'"  ) + p1 (z-, +z -2n+1)+ -+         p,Mz-'"
            =z      "'' ((z"' +z-"P) + p(z"'P       +z-"'')            +-+p     )
Likewise,
(10) Q(z)/tQT(z) =z'((z m                  -zmQ)+qi(zmQ-l         -z-mQ      +---+q,)
In those polynomials,
 pP2        ',Pnp
and
 q1, q2   *,,'-,   Q
completely represent P(z) and Q(z) by using given displacement                        K and v that is determined by the
order n of A(z). Those coefficients can be directly obtained from the expressions (6) and (8).
[0035]         When z=eJ and using the following relationship
 Zk      -k      _   jok      -j=
the expressions (9) and (10) can be represented as follows
(11) P(co) = 2e- ""''R(co)Pr(o,)
(12)    Q(co)      = 2e     "" us (Co)QT(o)
where
(13) R(co) = cos mpa)+p, cos(m, -1)co+- --+p,m, /2
and
(14) S(c)= cos moo + q, cos(mQ - 1)co +                      + q,Q     /2
[0036]         Specifically, LSF of the polynomial A(z) is the roots of R(o) and S(O) at the angular
frequency coE(O, 7r).
[0037]         The Chebyshev polynomials of the first kind, which is used in one embodiment of the
present invention, is described hereinafter.
16999001

                                                          11
[0038]    The Chebyshev polynomials of the first kind is defined as follows using a recurrence
relation
(15) Tk+1I(x)=2xTk(x)-T-I.1(X)              k=,..
Note that the initial values are To(x)=1 and Ti(x)=x, respectively. For x where [-1, 1], the
Chebyshev polynomials can be represented as follows
(16) Tk(x)=cos{k cos-'x}        k=0,1,...
[0039]    One embodiment of the present invention explains that the equation (15) provides a
simple method for calculating coskco (where k=2,3,...) that begins with costo and cosO=1.
Specifically, with use of the equation (16), the equation (15) is rewritten in the following form
(17) coskto=2coscocos(k- l)uo-cos(k-2)co               k=2,3,...
When conversion co=arccosx is used, the first polynomials obtained from the equation (15) are as
follows
       T2(x)=2x2 - 1
      T3(x)=4x 3-3x
     T4(x)=8x 4 -8x 2+1
    T5(x)=16x 5-20x 3 +5x
    T6(x)=32x 6-48x 4 +1 8x 2 _I
   T7(x)=64x 7-1 12x 5+56x 3 -7x
  T8(x)=128x 8-256x 6+ 160x 4 -32x 2 +1
When the equations (13) and (14) for x E[-1,1] are replaced by those Chebyshev polynomials, the
following equations are obtained
(18) R(x)=T, (x)+p.,T            (x)+---+p, /2
(19) S(x)=T, (x)+qT,,             (x)+--.+q, /2
When LSFoi is known for i=0,1,...,mp+mQ-1, the following equations are obtained using the
cosine of LSF xi=cosoi (LSP)
(20) R(x)=ro(x-       X0 )(X - X 2 )...(X   - X2,-  2)
(21) S(x)= S (x -x)(x -x)--             (x -x 2    1)
16999001

                                                  12
The coefficients ro and so can be obtained by comparison of the equations (18) and (19) with (20)
and (21) on the basis of mp and me.
[0040]    The equations (20) and (21) are written as
(22) R(x) = rox"* + rx"-i +---+r
(23) S(x) = sox"' + sx"" +--- +sQ
Those polynomials can be efficiently calculated for a given x by a method known as the Homer's
method. The Homer's method obtains R(x)=bo(x) by use of the following recursive relation
          bk(x)=xb+ 1(x)+rk
where the initial value is
           b,, (x)=r,
The same applies to S(x).
[0041]    A method of calculating the coefficients of the polynomials of the equations (22) and
(23) is described hereinafter using an example. It is assumed in this example that the order of
A(z) is 16 (n=16). Accordingly, mp=mQ=8 in this case. Series expansion of the equation (18) can
be represented in the form of the equation (22) by substitution and simplification by the
Chebyshev polynomials. As a result, the coefficients of the polynomial of the equation (22) are
represented as follows using the coefficient pi of the polynomial P(z).
    ro=128
    ri=64pi
   r2=-256+32p2
  r3=-11 8 pi+1 6 p3
  r4=160- 4 8 p2+ 8 p4
  r5=56pi-20p3+4p5
 r6=-32+l 8 p2- 8 p4+ 2 p6
 r7=-7pi+ 5 p3- 3 p5+p7
 r8=l-p2+p4-p6+p8/ 2
The coefficients of P(z) can be obtained from the equation (6). This example can be applied also
16999001

                                                   13
to the polynomial of the equation (23) by using the same equation and using the coefficients of
Q(z). Further, the same equation for calculating the coefficients of R(x) and S(x) can easily derive
another order n and displacement K as well.
[0042]    Further, when the roots of the equations (20) and (21) are known, coefficients can be
obtained from the equations (20) and (21).
[0043]    The outline of processing according to one embodiment of the present invention is
described hereinafter.
[0044]    One embodiment of the present invention provides an effective calculation method and
device for, when converting a linear prediction synthesis filter calculated in advance by an
encoder or a decoder at a first sampling frequency to the one at a second sampling frequency,
calculating the power spectrum of the linear prediction synthesis filter and modifying it to the
second sampling frequency, and then obtaining autocorrelation coefficients from the modified
power spectrum.
[0045]    A calculation method for the power spectrum of a linear prediction synthesis filter
according to one embodiment of the present invention is described hereinafter. The calculation of
the power spectrum uses the LSF decomposition of the equation (6) and the properties of the
polynomials P(z) and Q(z). By using the LSF decomposition and the above-described Chebyshev
polynomials, the power spectrum can be converted to the real axis of the unit circle.
[0046]    With the conversion to the real axis, it is possible to achieve an effective method for
calculating a power spectrum at an arbitrary frequency in oEO[,     E]. This is because it is possible
to eliminate transcendental functions since the power spectrum is represented by polynomials.
Particularly, it is possible to simplify the calculation of the power spectrum at o=O, o=7/2 and
co=.  The same simplification is applicable also to LSF where either one of P(z) or Q(z) is zero.
Such properties are advantageous compared with FFT, which is generally used for the calculation
of the power spectrum.
16999001

                                                            14
[0047]     It is known that the power spectrum of A(z) can be represented as follows using LSF
decomposition.
(26) A(o>) 2 =P(o       2
                           +jQ()     2
                                       }/4
[0048]     One embodiment of the present invention uses the Chebyshev polynomials as a way to
more effectively calculate the power spectrum |A(o)| 2 of A(z) compared with the case of directly
applying the equation (26). Specifically, the power spectrum |A(o)| 2 is calculated on the real axis
of the unit circle as represented by the following equation, by converting a variable to x=coso
and using LSF decomposition by the Chebyshev polynomials.
(27) |A(x) 2 =P(x)2 +Q(x)               2/4
                         -         R 2 (X)+42(_       X2 )S  2
                                                               (x), Case (1)(4)
                                    2(1 + x)R 2 (x) + 2V 2 (1 _ X)S  2
                                                                       (x),  Case (2)(3)
(1) to (4) correspond to (1) to (4) in Table 1, respectively.
 [0049] The equation (27) is proven as follows.
 [0050] The following equations are obtained from the equations (11) and (12).
            P(m) 2 = 4R()        2
                                    P(m) 2
            Q(w) 2 =4       2
                                        Q()
                                       2S()    2
The factors that represent the obvious roots of P(o) and Q(wo) are respectively as follows.
  P         =    1,                                     Case (1) (4)
                        1+e-j,    2  =2 + 2coso,                    Case(2) (3)
  Q,(m)  2
                    2
                      =            2-2cos2o,                        Case (1) (4)
                        1-e'?        =2-2coso',                     Case (2) (3)
Application of the substitution coso=x and cos2o=2x 2-1 to PT(o)j and QT(o)l, respectively, gives
the equation (27).
16999001

                                                    15
[0051]     The polynomials R(x) and S(x) may be calculated by the above-described Homer's
method. Further, when x to calculate R(x) and S(x) is known, the calculation of a trigonometric
function can be omitted by storing x in a memory.
[0052]     The calculation of the power spectrum of A(z) can be further simplified. First, in the
case of calculating with LSF, one of R(x) and S(x) in the corresponding equation (27) is zero.
When the displacement is K-- and the order n is an even number, the equation (27) is simplified
as follows.
  A(x,)| =     2 (1 -x )S 2 (xi),      i even
              2(1+ x,)R 2 (x,)         i odd
Further, in the case of 0={0,7/2,1}, it is simplified when x={1,0,-1}. The equations are as follows
when the displacement is x=1 and the order n is an even number, which are the same as in the
above example.
 A(co=0)| 2 =4R 2(1)
 A(co=7u/2)|2=2(R2(0)+S2(0))
 |A(co=)12 =4S 2 (_ )
The similar results can be easily obtained also when the displacement is K=0 and the order n is an
odd number.
[0053]     The calculation of autocorrelation coefficients according to one embodiment of the
present invention is described below.
[0054]     In the equation (5), when a frequency Q+=A,2A,...,(N-1)A     where N is an odd number
and the interval of frequencies is A=7/(N-1) is defined, the calculation of autocorrelation contains
the above-described simplified power spectrum at o<=0,7/2,7r. Because the normalization of
autocorrelation coefficients by 1/N does not affect linear prediction coefficients to be obtained as
a result, any positive value can be used.
[0055]     Still, however, the calculation of the equation (5) requires coskco where k=1,2,...,n for
16999001

                                                    16
each of the (N-2) number of frequencies. Thus, the symmetric property of coskco is used.
(28) cos(7-ko)=(-1)kcos kwo,    toE(O, 7c/2)
The following characteristics are also used.
(29) cos(kr /2) = (1/2)(1+(-)k±1*)(-)Lk2
where Lx| indicates the largest integer that does not exceed x. Note that the equation (29) is
simplified to 2,0,-2,0,2,0,... for k=0,1,2,....
[0056]    Further, by conversion to x=cosco, the autocorrelation coefficients are moved onto the
real axis of the unit circle. For this purpose, the variable X(x)=Y(arccos x) is introduced. This
enables the calculation of coskco by use of the equation (15).
[0057]    Given the above, the autocorrelation approximation of the equation (5) can be replaced
by the following equation.
(30)
 Rk= X(1) + (1)k X(-1) + (1-+ (_l)k1)(-)Lk2jX(O)                 (X(x) + (-1)kX(-x)T(x) where
                                                             xEA
Tk(x)=2xTk1 (x)-Tk-2(x)
k=2,3,...,n, and To(x)=1, Ti(x)=cosx as described above. When the symmetric property of the
equation (28) is taken into consideration, the last term of the equation (30) needs to be calculated
only when xEA={cosA,cos2A,...,(N-3)A/2}, and the (N-3)/2 number of cosine values can be
stored in a memory. Fig. 6 shows the relationship between the frequency A and the cosine
function when N=3 1.
[0058]    An example of the present invention is described hereinafter. In this example, a case of
converting a linear prediction synthesis filter calculated at a first sampling frequency of 16,000Hz
to that at a second sampling frequency of 12,800Hz (which is referred to hereinafter as
conversion 1) and a case of converting a linear prediction synthesis filter calculated at a first
sampling frequency of 12,800Hz to that at a second sampling frequency of 16,000Hz (hereinafter
as conversion 2) are used. Those two sampling frequencies have a ratio of 4:5 and are generally
16999001

                                                  17
used in speech and audio coding. Each of the conversion 1 and the conversion 2 of this example
is performed on the linear prediction synthesis filter in the previous frame when the internal
sampling frequency has changed, and it can be performed in any of an encoder and a decoder.
Such conversion is required for setting the correct internal state to the linear prediction synthesis
filter in the current frame and for performing interpolation of the linear prediction synthesis filter
in accordance with time.
[0059]     Processing in this example is described hereinafter with reference to the flowcharts of
Figs. 3 and 4.
[0060]     To calculate a power spectrum and autocorrelation coefficients by using a common
frequency point in both cases of the conversions 1 and 2, the number of frequencies when a
sampling frequency is 12,800Hz is determined as NL=1+(12,800Hz/16,00OHz)(N-1). Note that N
is the number of frequencies at a sampling frequency of 16,000Hz. As described earlier, it is
preferred that N and NL are both odd numbers in order to contain frequencies at which the
calculation of a power spectrum and autocorrelation coefficients is simplified. For example, when
N is 31, 41, 51, 61, the corresponding NL is 25, 33, 41, 49. The case where N=31 and NL=25 is
described as an example below (Step SOOO).
[0061]     When the number of frequencies to be used for the calculation of a power spectrum and
autocorrelation coefficients in the domain where the sampling frequency is 16,000Hz is N=31,
the interval of frequencies is A=/30, and the number of elements required for the calculation of
autocorrelation contained in A is (N-3)/2= 14.
[0062]     The conversion 1 that is performed in an encoder and a decoder under the above
conditions is carried out in the following procedure.
[0063]     Determine the coefficients of polynomials R(x) and S(x) by using the equations (20) and
(21) from roots obtained by displacement        =O or x=1 and LSF which correspond to a linear
prediction synthesis filter obtained at a sampling frequency of 16,000Hz, which is the first
16999001

                                                   18
sampling frequency (Step S001).
[0064]    Calculate the power spectrum of the linear prediction synthesis filter at the second
sampling frequency up to 6,400Hz, which is the Nyquist frequency of the second sampling
frequency. Because this cutoff frequency corresponds to co=(4/5)7r at the first sampling frequency,
a power spectrum is calculated using the equation (27) at NL=25 number of frequencies on the
low side. For the calculation of R(x) and S(x), the Homer's method may be used to reduce the
calculation. There is no need to calculate a power spectrum for the remaining 6 (=N-NL)
frequencies on the high side (Step S002).
[0065]    Calculate autocorrelation coefficients corresponding to the power spectrum obtained in
Step S002 by using the equation (30). In this step, N in the equation (30) is set to NL=25, which is
the number of frequencies at the second sampling frequency (Step S003).
[0066]    Derive linear prediction coefficients by the Levinson-Durbin method or a similar
method with use of the autocorrelation coefficient obtained in Step S003, and obtain a linear
prediction synthesis filter at the second sampling frequency (Step S004).
[0067]    Convert the linear prediction coefficient obtained in Step S004 to LSF (Step SO05).
[0068]    The conversion 2 that is performed in an encoder or a decoder can be achieved in the
following procedure, in the same manner as the conversion 1.
[0069]    Determine the coefficients of polynomials R(x) and S(x) by using the equations (20) and
(21) from roots obtained by displacement      K=O   or K=1  and LSF which correspond to a linear
prediction synthesis filter obtained at a sampling frequency of 12,800Hz, which is the first
sampling frequency (Step SO11).
[0070]    Calculate the power spectrum of the linear prediction synthesis filter at the second
sampling frequency up to 6,400Hz, which is the Nyquist frequency of the first sampling
16999001

                                                   19
frequency, first. This cutoff frequency corresponds to o=n, and a power spectrum is calculated
using the equation (27) at NL=25 number of frequencies. For the calculation of R(x) and S(x), the
Homer's method may be used to reduce the calculation. For 6 frequencies exceeding 6,400Hz at
the second sampling frequency, a power spectrum is extrapolated. As an example of
extrapolation, the power spectrum obtained at the NL-th frequency may be used (Step SO 12).
[0071]    Calculate autocorrelation coefficients corresponding to the power spectrum obtained in
Step S012 by using the equation (30). In this step, N in the equation (30) is set to N=31, which is
the number of frequencies at the second sampling frequency (Step SO 13).
[0072]    Derive linear prediction coefficients by the Levinson-Durbin method or a similar
method with use of the autocorrelation coefficient obtained in Step S013, and obtain a linear
prediction synthesis filter at the second sampling frequency (Step SO14).
[0073]    Convert the linear prediction coefficient obtained in Step S014 to LSF (Step SO15).
[0074]    Fig. 5 is a block diagram in the example of the present invention. A real power spectrum
conversion unit 100 is composed of a polynomial calculation unit 101, a real power spectrum
calculation unit 102, and a real power spectrum extrapolation unit 103, and further a real
autocorrelation calculation unit 104 and a linear prediction coefficient calculation unit 105 are
provided. This is to achieve the above-described conversions 1 and 2. Just like the description of
the flowcharts described above, the real power spectrum conversion unit 100 receives, as an
input, LSF representing a linear prediction synthesis filter at the first sampling frequency, and
outputs the power spectrum of a desired linear prediction synthesis filter at the second sampling
frequency. First, the polynomial calculation unit 101 performs the processing in Steps SOO1, SOIl
described above to calculate the polynomials R(x) and S(x) from LSF. Next, the real power
spectrum calculation unit 102 performs the processing in Steps S002 or S012 to calculate the
power spectrum. Further, the real power spectrum extrapolation unit 103 performs extrapolation
of the spectrum, which is performed in Step S012 in the case of the conversion 2. By the above
16999001

                                                  20
process, the power spectrum of a desired linear prediction synthesis filter is obtained at the
second sampling frequency. After that, the real autocorrelation calculation unit 104 performs the
processing in Steps S003 and S013 to convert the power spectrum to autocorrelation coefficients.
Finally, the linear prediction coefficient calculation unit 105 performs the processing in Steps
S004 and S014 to obtain linear prediction coefficients from the autocorrelation coefficients. Note
that, although this block diagram does not show the block corresponding to S005 and SO15, the
conversion from the linear prediction coefficients to LSF or another equivalent coefficients can
be easily achieved by a known technique.
[0075] [Alternative Example]
          Although the coefficients of the polynomials R(x) and S(x) are calculated using the
equations (20) and (21) in Steps SOO and SOI of the above-described example, the calculation
may be performed using the coefficients of the polynomials of the equations (9) and (10), which
can be obtained from the linear prediction coefficients. Further, the linear prediction coefficients
may be converted from LSP coefficients or ISP coefficients.
[0076]    Furthermore, in the case where a power spectrum at the first sampling frequency or the
second sampling frequency is known by some method, the power spectrum may be converted to
that at the second sampling frequency, and Steps SOO, S002, SOll and S012 may be omitted.
[0077]    In addition, in order to assign weights in the frequency domain, a power spectrum may
be deformed, and linear prediction coefficients at the second sampling frequency may be
obtained.
Reference Signs List
[0078]     100 real power spectrum conversion unit, 101 polynomial calculation unit, 102 real
power spectrum calculation unit, 103 real power spectrum extrapolation unit, 104 real
autocorrelation calculation unit, 105 linear prediction coefficient calculation unit
16999001

                                                   21
CLAIMS
1.        A linear prediction coefficient conversion device that converts first linear prediction
coefficients calculated at a first sampling frequency F1 to second linear prediction coefficients at
a second sampling frequency F2 (where F1 < F2) different from the first sampling frequency,
comprising:
          a means for calculating, on the real axis of the unit circle, a power spectrum
corresponding to the second linear prediction coefficients at the second sampling frequency
based on the first linear prediction coefficients or an equivalent parameter, wherein the power
spectrum is obtained, using the first linear prediction coefficients, at points on the real axis
corresponding to NI number of different frequencies, where frequencies are 0 or more and F 1 or
less, and (N1-1)(F2-F1)/F1 number of power spectrum components corresponding to more than
F 1 and F2 or less are obtained by extrapolating the power spectrum calculated using the first
linear prediction coefficients;
          a means for calculating, on the real axis of the unit circle, autocorrelation coefficients
from the power spectrum; and
          a means for converting the autocorrelation coefficients to the second linear prediction
coefficients at the second sampling frequency.
2.        A linear prediction coefficient conversion device that converts first linear prediction
coefficients calculated at a first sampling frequency F1 to second linear prediction coefficients at
a second sampling frequency F2 (where F1 > F2) different from the first sampling frequency,
comprising:
          a means for calculating, on the real axis of the unit circle, a power spectrum
corresponding to the second linear prediction coefficients at the second sampling frequency
based on the first linear prediction coefficients or an equivalent parameter, wherein the power
spectrum is obtained, using the first linear prediction coefficients, at points on the real axis
corresponding to NI number of different frequencies, where frequencies are 0 or more and F2 or
16999001

                                                     22
less, excluding (N1-1)(F1-F2)/F2 number of power spectrum components corresponding to more
than F2 and F1 or less;
           a means for calculating, on the real axis of the unit circle, autocorrelation coefficients
from the power spectrum; and
           a means for converting the autocorrelation coefficients to the second linear prediction
coefficients at the second sampling frequency.
3.         A linear prediction coefficient conversion method performed by a device that converts
first linear prediction coefficients calculated at a first sampling frequency F1 to second linear
prediction coefficients at a second sampling frequency F2 (where F 1 < F2) different from the first
sampling frequency, comprising:
           a step of calculating, on the real axis of the unit circle, a power spectrum corresponding
to the second linear prediction coefficients at the second sampling frequency based on the first
linear prediction coefficients or an equivalent parameter, wherein the power spectrum is obtained,
using the first linear prediction coefficients, at points on the real axis corresponding to NI
number of different frequencies, where frequencies are 0 or more and F1 or less, and (N1-1)(F2
F1)/F1 number of power spectrum components corresponding to more than F1 and F2 or less are
obtained by extrapolating the power spectrum calculated using the first linear prediction
coefficients;
           a step of calculating, on the real axis of the unit circle, autocorrelation coefficients from
the power spectrum; and
           a step of converting the autocorrelation coefficients to the second linear prediction
coefficients at the second sampling frequency.
4.         A linear prediction coefficient conversion method performed by a device that converts
first linear prediction coefficients calculated at a first sampling frequency F1 to second linear
prediction coefficients at a second sampling frequency F2 (where F 1 > F2) different from the first
sampling frequency, comprising:
16999001

                                                     23
          a step of calculating, on the real axis of the unit circle, a power spectrum corresponding
to the second linear prediction coefficients at the second sampling frequency based on the first
linear prediction coefficients or an equivalent parameter, wherein the power spectrum is obtained,
using the first linear prediction coefficients, at points on the real axis corresponding to NI
number of different frequencies, where frequencies are 0 or more and F2 or less, excluding (NI
1)(F1-F2)/F2 number of power spectrum components corresponding to more than F2 and F1 or
less;
          a step of calculating, on the real axis of the unit circle, autocorrelation coefficients from
the power spectrum; and
          a step of converting the autocorrelation coefficients to the second linear prediction
coefficients at the second sampling frequency.
16999001

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
