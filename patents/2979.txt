       CONTROLLING TRANSITIONS IN OPTICALLY SWITCHABLE DEVICES
                                             ABSTRACT
          This disclosure provides systems, methods, and apparatus for controlling transitions in
an optically switchable device. In one aspect, a controller for a tintable window may include a
processor, an input for receiving output signals from sensors, and instructions for causing the
processor to determine a level of tint of the tintable window, and an output for controlling the
level of tint in the tintable window.   The instructions may include a relationship between the
received output signals and the level of tint, with the relationship employing output signals from
an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor. In some instances, the controller may receive output signals
over a network and/or be interfaced with a network, and in some instances, the controller may be
a standalone controller that is not interfaced with a network.

                                                    1
        CONTROLLING TRANSITIONS IN OPTICALLY SWITCHABLE DEVICES
                    CROSS REFERENCE TO RELATED APPLICATIONS
         This application is a divisional application of Australian Patent Application No.
2013249621, a National Phase Entry of International Patent Application No.
PCT/US2013/036235, filed on 11 April 2013. International Patent Application No.
PCT/US2013/036235 claims priority to and benefit of U.S. Patent Application, serial number
13/449,235, naming Brown et al. as inventors, titled "CONTROLLING TRANSITIONS IN
OPTICALLY SWITCHABLE DEVICES" (Attorney Docket No. SLDMPO35) filed on April 17,
2012 which is incorporated herein by reference in its entirety and for all purposes. Australian
Patent Application No. 2013249621 is incorporated herein by reference in its entirety.
                                                FIELD
         The embodiments disclosed herein relate generally to electrochromic devices, more
particularly to controllers and related algorithms for electrochromic windows.
                                           BACKGROUND
         Electrochromism is a phenomenon in which a material exhibits a reversible
electrochemically-mediated change in an optical property when placed in a different electronic
state, typically by being subjected to a voltage change. The optical property is typically one or
more of color, transmittance, absorbance, and reflectance. One well known electrochromic
material is tungsten oxide (W03). Tungsten oxide is a cathodic electrochromic material in
which a coloration transition, transparent to blue, occurs by electrochemical reduction.
         Electrochromic materials may be incorporated into, for example, windows for home,
commercial and other uses. The color, transmittance, absorbance, and/or reflectance of such
windows may be changed by inducing a change in the electrochromic material, that is,
electrochromic windows are windows that can be darkened or lightened electronically. A small
voltage applied to an electrochromic device (EC) of the window will cause them to darken;
reversing the voltage causes them to lighten. This capability allows control of the amount of
light that passes through the windows, and presents an opportunity for electrochromic windows
to be used as energy-saving devices.
         While electrochromism was discovered in the 1960's, EC devices, and particularly EC
windows, still unfortunately suffer various problems and have not

                                                    2
begun to realize their full commercial potential despite many recent advancements in EC
technology, apparatus and related methods of making and/or using EC devices.
                                              SUMMARY
         It is an object of the present invention to substantially overcome, or at least ameliorate, at
least one disadvantage of present arrangements.
         One aspect of the present disclosure provides a method of controlling at least one tintable
window located between an interior and exterior of a facility, wherein the level of tinting in the
at least one tintable window can be controlled automatically, the method comprising: (a)
receiving output signals from any two or more sensors selected from the group consisting of an
exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the at least one tintable
window from the exterior, wherein receiving the output signals comprises receiving sensor
output signals from a network comprising multiple window controllers configured to receive the
output signals and provide instructions to the at least one tintable window, wherein the output
signal of at least one of the two or more sensors is received at the multiple window controllers;
(b) determining a level of tint for said at least one tintable window using the received output
signals; and (c) providing instructions to change the tint of the at least one tintable window to the
level of tint determined in (b).
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input
configured to receive output signals from one or more sensors over a network; (c) instructions
for (i) causing the processor or control circuit to determine a level of tint in a tintable window by
using the output signals from any two or more sensors selected from the group consisting of an
exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the tintable window from
the exterior, and (ii) comparing the output signals from more than one exterior photosensor; and
(d) at least one output configured to control, directly or indirectly, the level of tint in the at least
one tintable window.
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input
configured to receive output signals from one or more sensors over a network; (c) instructions
for causing the processor or control circuit to determine a level of tint in said at least one tintable

                                                    2a
window by using the output signals from any two or more sensors selected from the group
consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior
temperature sensor, and a transmissivity sensor which detects light passing through the at least
one tintable window from the exterior, further comprising instructions for causing the processor
or control circuit to compare the output signals from more than one exterior photosensor; and
further comprising instructions for determining the level of tint for a zone of tintable windows
using output signals from sensors associated with the zone of tintable windows; and (d) at least
one output configured to control, directly or indirectly, the level of tint in the at least one tintable
window.
         Another aspect of the present disclosure provides a method of controlling at least one
tintable window between an interior and exterior of a facility, wherein the level of tinting in the
at least one tintable window can be controlled automatically, the method comprising: (a)
receiving output signals from an exterior photosensor and/or an interior photosensor comprising
a photovoltaic cell, wherein receiving the output signals comprises receiving sensor output
signals from a network comprising multiple window controllers configured to receive the output
signals and provide instructions to the at least one tintable window, wherein the output signal of
at least one of the two or more sensors is received at the multiple window controllers; (b)
determining a level of tint for said at least one tintable window using a relationship between the
received output signals and the level of tint; and (c) providing instructions to change the tint of
the at least one tintable window to the level of tint determined in (b).
         Another aspect of the present disclosure provides a method of controlling at least one
tintable window located between an interior and exterior of a facility, wherein the level of tinting
in the at least one tintable window can be controlled automatically, the method comprising: (a)
receiving output signals from any two or more sensors, wherein a first of the sensors is selected
from the group consisting of an exterior photosensor, an interior photosensor, an occupancy
sensor, an exterior temperature sensor, and a transmissivity sensor which detects light passing
through the tintable window from the exterior, wherein a second of the sensors is an exterior
photosensor located on the roof of a building having the tintable window, wherein receiving the
output signals comprises receiving sensor output signals from a network comprising multiple
window controllers configured to receive the output signals and provide instructions to the at
least one tintable window, and wherein the output signal of at least one of the two or more
sensors is received at the multiple window controllers; (b) determining a level of tint for said at
least one tintable window using the received output signals; and (c) providing instructions to
change the tint of the at least one tintable window to the level of tint determined in (b).

                                                   2b
         Another aspect of the present disclosure provides a method of controlling at least one
tintable window located between an interior and exterior of a facility, wherein the level of tinting
in the at least one tintable window can be controlled automatically, the method comprising: (a)
receiving output signals from more than one exterior photosensor, wherein receiving the output
signals comprises receiving sensor output signals from a network; (b) comparing output signals
from the exterior photosensors to one another; (c) determining a level of tint for said at least one
tintable window using the received output signals; and (d) providing instructions to change the
tint of the at least one tintable window to the level of tint determined in (c).
         Another aspect of the present disclosure provides a method of controlling at least one
tintable window located between an interior and exterior of a facility, wherein the level of tinting
in the at least one tintable window can be controlled automatically, the method comprising: (a)
receiving output signals from an exterior photosensor on each side of the facility, wherein
receiving the output signals comprises receiving sensor output signals from a network
comprising multiple window controllers configured to receive the output signals and provide
instructions to the at least one tintable window; (b) determining a level of tint for said at least
one tintable window using the received output signals; and (c) providing instructions to change
the tint of the at least one tintable window to the level of tint determined in (b).
Another aspect of the present disclosure provides a method of controlling at least one tintable
window located between an interior and exterior of a facility, wherein the level of tinting in the
at least one tintable window can be controlled automatically, the method comprising: (a)
receiving output signals from any two or more sensors selected from the group consisting of an
exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the tintable window from
the exterior, wherein the output signals comprise output signals from sensors associated with a
zone comprising multiple tintable windows, wherein receiving the output signals comprises
receiving the sensor output signal from a network comprising multiple window controllers
configured to receive the output signals and provide instructions to the at least one tintable
window, and wherein the output signals at least one of the two or more sensors are received at
the multiple window controllers; (b) determining a level of tint for said at least one tintable
window using the received output signals; and (c) providing instructions to change the tint of the
at least one tintable window to the level of tint determined in (b).
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input

                                                     2c
configured to receive output signals from one or more sensors over a network; (c) instructions
for causing the processor or control circuit to determine a level of tint in the at least one tintable
window by using the output signals from any two or more sensors selected from the group
consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior
temperature sensor, and a transmissivity sensor which detects light passing through the at least
one tintable window from the exterior, wherein the output signals comprise a sensor output
signal from an exterior photosensor located on a roof of a building having the at least one
tintable window; (d) instructions for causing the processor or control circuit to (i) compare the
output signals from more than one exterior photosensor, and (ii) determine whether one of the
exterior photosensors is shaded based on the comparison; and (e) at least one output configured
to control, directly or indirectly, the level of tint in the at least one tintable window.
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input
configured to receive output signals from one or more sensors over a network of controllers
comprising (i) a master and/or intermediate window controller and (ii) an end window controller,
and wherein the master and/or intermediate window controller and end window controller are
configured to communicate by wireless communication; (c) instructions for causing the
processor or control circuit to determine a level of tint in the at least one tintable window by
using the output signals from any two or more sensors selected from the group consisting of an
exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the tintable window from
the exterior, wherein the output signals comprise a sensor output signal from an exterior
photosensor located on a roof of the facility having the at least one tintable window; and (d) at
least one output configured to control, directly or indirectly, the level of tint in the at least one
tintable window.
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input
configured to receive output signals from one or more sensors over a network of controllers
comprising (i) a master and/or intermediate window controller and (ii) an end window controller,
and wherein the master and/or intermediate window controller and end window controller are
configured to communicate by wireless communication; (c) instructions for causing the
processor or control circuit to determine a level of tint in the at least one tintable window by

                                                     2d
using the output signals from any two or more sensors selected from the group consisting of an
exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the tintable window from
the exterior, wherein the output signals comprise sensor output signals from an exterior
photosensor on each side of the facility; and (d) at least one output configured to control, directly
or indirectly, the level of tint in the at least one tintable window.
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input
configured to receive output signals from one or more sensors over a network; (c) instructions
for causing the processor or control circuit to determine a level of tint in the at least one tintable
window by using the output signals from any two or more sensors selected from the group
consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior
temperature sensor, and a transmissivity sensor which detects light passing through the at least
one tintable window from the exterior; (d) instructions for determining the level of tint for a zone
of tintable windows using output signals from sensors associated with the zone of tintable
windows; (e) instructions for causing the processor or control circuit to (i) compare the output
signals from more than one exterior photosensor, and (ii) determine whether one of the exterior
photosensors is shaded based on the comparison; and (f) at least one output configured to
control, directly or indirectly, the level of tint in the at least one tintable window.
         Another aspect of the present disclosure provides a controller for at least one tintable
window in a facility, the at least one tintable window between an interior and exterior of the
facility, the controller comprising: (a) a processor or control circuit; (b) at least one input
configured to receive output signals from one or more sensors over a network of controllers
comprising (i) a master and/or intermediate window controller and (ii) an end window controller,
and wherein the master and/or intermediate window controller and end window controller are
configured to communicate by wireless communication; (c) instructions for causing the
processor or control circuit to determine a level of tint in the at least one tintable window by
using the output signals from any two or more sensors selected from the group consisting of an
exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the tintable window from
the exterior, further comprising instructions for determining the level of tint for a zone of tintable
windows using output signals from sensors associated with the zone of tintable windows; and (d)

                                                    2e
at least one output configured to control, directly or indirectly, the level of tint in the at least one
tintable window.
          Systems, methods, and apparatus for controlling transitions in an optically switchable
device are disclosed herein.
         In another aspect, a method of limiting energy consumption in a facility having at least
one tintable window between an interior and exterior of the facility is provided. The level of
tinting in the tintable window can be controlled automatically. The method includes receiving
output signals from any two or more sensors selected from the group consisting of an exterior
photosensor, an interior photosensor, an occupancy sensor, an exterior temperature sensor, and a
transmissivity sensor which detects light passing through the tintable window from the exterior.
A level of tint for the tintable window is determined using a relationship between the received
output signals and the level of tint. Instructions to change the tint of the tintable window to the
level of tint determined are provided.
         In another aspect, a controller for a tintable window for a facility having at least one
tintable window between an interior and exterior of the facility is provided. The controller
includes a processor or control circuit, at least one input for receiving output signals from one or
more sensors, and instructions for causing the processor or control circuit to determine a level of
tint in the tintable window by using a relationship between the received output signals and the
level of tint. The relationship employs output signals from any two or more sensors selected
from the group consisting of an exterior photosensor, an interior photosensor, an occupancy
sensor, an exterior temperature sensor, and a transmissivity sensor which detects light passing
through the tintable window from the exterior. The controller further includes at least one output
for controlling, directly or indirectly, the level of tint in the tintable window.
         In another aspect, a system for controlling energy consumption in a facility that contains
a tintable window between an interior and exterior of the facility is provided. The system
includes a building management system, a lighting control panel, a network over which the
building management system and the lighting control panel communicate, and a controller for
the tintable window. The controller includes instructions for determining a level of tint in the
tintable window by using a

   relationship between received output signals and the level of tint. The relationship
   employs output signals from any two or more sensors selected from the group
   consisting of an exterior photosensor, an interior photosensor, an occupancy sensor,
   an exterior temperature sensor, and a transmissivity sensor which detects light passing
 5 through the tintable window from the exterior. The controller further includes at least
   one output for controlling, directly or indirectly, the level of tint in the tintable
   window.
            In another aspect, a method of minimizing energy consumption in a facility
   having a tintable window between an exterior and an interior of the facility is
10 provided. The tintable window has an adjustable level of tint controllable from a
   controller. The method includes receiving a signal indicating energy or power
   consumption by a heating system, a cooling system, and/or lighting within the facility,
   determining a level of tint for the tintable window using the signal indicating energy
   or power consumption of a device or system within the facility, and providing
15 instructions to set the level of tint in the tintable window to the determined level of
   tint.
            In another aspect, a controller for a tintable window for a facility having at
   least one tintable window between an interior and exterior of the facility is provided.
   The controller includes a processor or control circuit, at least one input for receiving
20 output signals from one or more sensors, and instructions for causing the processor or
   control circuit to determine a level of tint in the tintable window by using a
   relationship between the received output signals and the level of tint. The relationship
   employs output signals from an exterior photosensor, an interior photosensor, an
   outside temperature sensor, and a tint command. The controller further includes at
25 least one output for controlling, directly or indirectly, the level of tint in the tintable
   window.
            In another aspect, a method of limiting energy consumption in a facility
   having at least one tintable window between an interior and exterior of the facility is
   provided. The level of tinting in the tintable window can be controlled automatically.
30 The method includes receiving signals indicating a level of exterior irradiance
   received at or proximate the tintable window and determining a level of tint for the
   tintable window using a relationship between the received output signals and the level
   of tint. The relationship requires (i) transitioning from a first darker tint level to a
   second lighter tint level when the received level of irradiance passes a first threshold

   and (ii) transitioning from the second lighter tint level to the first darker tint level
   when the received level of irradiance passes a second threshold. The first and second
   thresholds are different. The method further includes providing instructions to change
   the tint of the tintable window to the determined level of tint.
 5          These and other features and advantages will be described in further detail
   below, with reference to the associated drawings.
                        BRIEF DESCRIPTION OF THE DRAWINGS
            The following detailed description can be more fully understood when
10 considered in conjunction with the drawings in which:
            Figures 1A-IC show schematic diagrams of electrochromic devices formed on
   glass substrates, i.e., electrochromic lites.
            Figures 2A and 2B show cross-sectional schematic diagrams of the
   electrochromic lites as described in relation to Figures lA-C integrated into an IGU.
15          Figure 3A depicts a schematic cross-section of an electrochromic device.
            Figure 3B depicts a schematic cross-section of an electrochromic device in a
   bleached state (or transitioning to a bleached state).
            Figure 3C depicts a schematic cross-section of the electrochromic device
   shown in Figure 3B, but in a colored state (or transitioning to a colored state).
20          Figure 4 depicts a block diagram of a window controller.
            Figure 5 depicts a schematic diagram of a room including an electrochromic
   window and a plurality of sensors.
            Figure 6 shows a function that may be used to determine the level of tint of an
   electrochromic window.
25          Figure 7 shows a schedule of weighting constants that may be used with the
   function shown in Figure 6.
            Figure 8 shows a flow chart of a method for limiting the energy consumption
   in a room having at least one tintable window between an interior and exterior of the
   room.
30          Figure 9 shows a flow chart of a method of operating a tintable window
   installed between an interior and exterior of a room.
            Figure 10 shows a plot of illuminance versus time for an exterior photosensor
   over a 24-hour period.
                                                 AI

            Figure 11 depicts a schematic diagram of an embodiment of a building
   management system.
            Figure 12 depicts a block diagram of an embodiment of a building network.
 5                              DETAILED DESCRIPTION
            Window controllers described herein are used to control tintable windows,
   including electrochromic windows. Virtually any tintable and/or reflective window or
   mirror will work with the window controllers described herein. For example, non
   electrochromic optically switchable devices such liquid crystal devices and suspended
10 particle devices may be used with the described window controllers.
            The window controllers described herein significantly augment environmental
   control in a building, for example, when the window controllers are integrated with a
   building management system (BMS). Interrelationships between window
   performance, microclimate sensing, and environmental control are described in more
15 detail below.
            For example, as shown in Figures 5, 6, and 7, a standalone window controller
   may receive input from various sensors, including an exterior photosensor, an interior
   photosensor, a temperature sensor, an interior transmissivity sensor, an occupancy
   sensor, and a power meter. These inputs may be processed by the window controller
20 to determine a desired tint for a tintable window using, for example, a function (e.g.,
   see Figure 6) or a lookup table. The function or lookup table may change with the
   time of day or the day of the year to account for the changes in sunlight incident upon
   the tintable window (e.g., see Figure 7). Further, tintable windows and a window
   controller may be integrated into a building including a building network or a BMS
25 (e.g., see Figures 11 and 12). The window controller may interface with the different
   systems of the building to aid in the control of the environment in the building.
   Overview of ElectrochromicDevices
            It should be understood that while the disclosed embodiments focus on
30 electrochromic (EC) windows (also referred to as smart windows), the concepts
   disclosed herein may apply to other types of tintable windows. For example, a
   window incorporating a liquid crystal device or a suspended particle device, instead
   of an electrochromic device, could be incorporated in any of the disclosed
   embodiments.

            In order to orient the reader to the embodiments of systems, window
   controllers, and methods disclosed herein, a brief discussion of electrochromic
   devices is provided. This initial discussion of electrochromic devices is provided for
   context only, and the subsequently described embodiments of systems, window
 5 controllers, and methods are not limited to the specific features and fabrication
   processes of this initial discussion.
            A particular example of an electrochromic lite is described with reference to
   Figures 1A-IC, in order to illustrate embodiments described herein. Figure 1A is a
   cross-sectional representation (see cut X-X' of Figure 1C) of an electrochromic lite,
10 100, which is fabricated starting with a glass sheet, 105. Figure lB shows an end
   view (see perspective Y-Y' of Figure IC) of EC lite 100, and Figure IC shows a top
   down view of EC lite 100. Figure 1A shows the electrochromic lite after fabrication
   on glass sheet 105, edge deleted to produce area, 140, around the perimeter of the lite.
   The electrochromic lite has also been laser scribed and bus bars have been attached.
15 The glass lite 105 has a diffusion barrier, 110, and a first transparent conducting oxide
   (TCO), 115, on the diffusion barrier. In this example, the edge deletion process
   removes both TCO 115 and diffusion barrier 110, but in other embodiments only the
   TCO is removed, leaving the diffusion barrier intact. The TCO 115 is the first of two
   conductive layers used to form the electrodes of the electrochromic device fabricated
20 on the glass sheet. In this example, the glass sheet includes underlying glass and the
   diffusion barrier layer. Thus, in this example, the diffusion barrier is formed, and then
   the first TCO, an EC stack, 125, (e.g., having electrochromic, ion conductor, and
   counter electrode layers), and a second TCO, 130, are formed. In one embodiment,
   the electrochromic device (EC stack and second TCO) is fabricated in an integrated
25 deposition system where the glass sheet does not leave the integrated deposition
   system at any time during fabrication of the stack. In one embodiment, the first TCO
   layer is also formed using the integrated deposition system where the glass sheet does
   not leave the integrated deposition system during deposition of the EC stack and the
   (second) TCO layer. In one embodiment, all of the layers (diffusion barrier, first
30 TCO, EC stack, and second TCO) are deposited in the integrated deposition system
   where the glass sheet does not leave the integrated deposition system during
   deposition. In this example, prior to deposition of EC stack 125, an isolation trench,
   120, is cut through TCO 115 and diffusion barrier 110. Trench 120 is made in
   contemplation of electrically isolating an area of TCO 115 that will reside under bus
                                                  A

   bar 1 after fabrication is complete (see Figure 1A). This is done to avoid charge
   buildup and coloration of the EC device under the bus bar, which can be undesirable.
            After formation of the EC device, edge deletion processes and additional laser
   scribing are performed. Figure 1A depicts areas 140 where the device has been
 5 removed, in this example, from a perimeter region surrounding laser scribe trenches,
   150, 155, 160, and 165. Trenches 150, 160 and 165 pass through the EC stack and
   also through the first TCO and diffusion barrier. Trench 155 passes through second
   TCO 130 and the EC stack, but not the first TCO 115. Laser scribe trenches 150, 155,
   160, and 165 are made to isolate portions of the EC device, 135, 145, 170, and 175,
10 which were potentially damaged during edge deletion processes from the operable EC
   device. In this example, laser scribe trenches 150, 160, and 165 pass through the first
   TCO to aid in isolation of the device (laser scribe trench 155 does not pass through
   the first TCO, otherwise it would cut off bus bar 2's electrical communication with
   the first TCO and thus the EC stack). The laser or lasers used for the laser scribe
15 processes are typically, but not necessarily, pulse-type lasers, for example, diode
   pumped solid state lasers. For example, the laser scribe processes can be performed
   using a suitable laser from IPG Photonics (of Oxford, Massachusetts), or from Ekspla
   (of Vilnius, Lithuania). Scribing can also be performed mechanically, for example,
   by a diamond tipped scribe. One of ordinary skill in the art would appreciate that the
20 laser scribing processes can be performed at different depths and/or performed in a
   single process whereby the laser cutting depth is varied, or not, during a continuous
   path around the perimeter of the EC device. In one embodiment, the edge deletion is
   performed to the depth of the first TCO.
            After laser scribing is complete, bus bars are attached. Non-penetrating bus
25 bar (1) is applied to the second TCO. Non-penetrating bus bar (2) is applied to an
   area where the device was not deposited (e.g., from a mask protecting the first TCO
   from device deposition), in contact with the first TCO or, in this example, where an
   edge deletion process (e.g., laser ablation using an apparatus having a XY or XYZ
   galvanometer) was used to remove material down to the first TCO. In this example,
30 both bus bar 1 and bus bar 2 are non-penetrating bus bars. A penetrating bus bar is
   one that is typically pressed into and through the EC stack to make contact with the
   TCO at the bottom of the stack. A non-penetrating bus bar is one that does not
   penetrate into the EC stack layers, but rather makes electrical and physical contact on
   the surface of a conductive layer, for example, a TCO.
                                                7

            The TCO layers can be electrically connected using a non-traditional bus bar,
   for example, a bus bar fabricated with screen and lithography patterning methods. In
   one embodiment, electrical communication is established with the device's
   transparent conducting layers via silk screening (or using another patterning method)
 5 a conductive ink followed by heat curing or sintering the ink. Advantages to using the
   above described device configuration include simpler manufacturing, for example,
   and less laser scribing than conventional techniques which use penetrating bus bars.
            After the bus bars are connected, the device is integrated into an insulated
   glass unit (IGU), which includes, for example, wiring the bus bars and the like. In
10 some embodiments, one or both of the bus bars are inside the finished IGU, however
   in one embodiment one bus bar is outside the seal of the IGU and one bus bar is inside
   the IGU. In the former embodiment, area 140 is used to make the seal with one face
   of the spacer used to form the IGU. Thus, the wires or other connection to the bus
   bars runs between the spacer and the glass. As many spacers are made of metal, e.g.,
15 stainless steel, which is conductive, it is desirable to take steps to avoid short
   circuiting due to electrical communication between the bus bar and connector thereto
   and the metal spacer.
            As described above, after the bus bars are connected, the electrochromic lite is
   integrated into an IGU, which includes, for example, wiring for the bus bars and the
20 like. In the embodiments described herein, both of the bus bars are inside the primary
   seal of the finished IGU. Figure 2A shows a cross-sectional schematic diagram of the
   electrochromic window as described in relation to Figures 1A-C integrated into an
   IGU, 200. A spacer, 205, is used to separate the electrochromic lite from a second
   lite, 210. Second lite 210 in IGU 200 is a non-electrochromic lite, however, the
25 embodiments disclosed herein are not so limited. For example, lite 210 can have an
   electrochromic device thereon and/or one or more coatings such as low-E coatings
   and the like. Lite 201 can also be laminated glass, such as depicted in Figure 2B (lite
   201 is laminated to reinforcing pane, 230, via resin, 235). Between spacer 205 and
   the first TCO layer of the electrochromic lite is a primary seal material, 215. This
30 primary seal material is also between spacer 205 and second glass lite 210. Around
   the perimeter of spacer 205 is a secondary seal, 220. Bus bar wiring/leads traverse the
   seals for connection to a controller. Secondary seal 220 may be much thicker that
   depicted. These seals aid in keeping moisture out of an interior space, 225, of the

   IGU. They also serve to prevent argon or other gas in the interior of the IGU from
   escaping.
            Figure 3A schematically depicts an electrochromic device, 300, in cross
   section. Electrochromic device 300 includes a substrate, 302, a first conductive layer
 5 (CL), 304, an electrochromic layer (EC), 306, an ion conducting layer (IC), 308, a
   counter electrode layer (CE), 310, and a second conductive layer (CL), 314. Layers
   304, 306, 308, 310, and 314 are collectively referred to as an electrochromic stack
   320. A voltage source 316 operable to apply an electric potential across
   electrochromic stack 320 effects the transition of the electrochromic device from, for
10 example, a bleached state to a colored state (depicted). The order of layers can be
   reversed with respect to the substrate.
            Electrochromic devices having distinct layers as described can be fabricated as
   all solid state devices and/or all inorganic devices having low defectivity. Such
   devices and methods of fabricating them are described in more detail in U.S. Patent
15 Application, serial number 12/645,111, entitled, "Fabrication of Low-Defectivity
   Electrochromic Devices," filed on December 22, 2009 and naming Mark Kozlowski
   et al. as inventors, and in U.S. Patent Application, serial number 12/645,159, entitled,
   "Electrochromic Devices," filed on December 22, 2009 and naming Zhongchun Wang
   et al. as inventors, both of which are incorporated by reference herein for all purposes.
20 It should be understood, however, that any one or more of the layers in the stack may
   contain some amount of organic material. The same can be said for liquids that may
   be present in one or more layers in small amounts. It should also be understood that
   solid state material may be deposited or otherwise formed by processes employing
   liquid components such as certain processes employing sol-gels or chemical vapor
25 deposition.
            Additionally, it should be understood that the reference to a transition between
   a bleached state and colored state is non-limiting and suggests only one example,
   among many, of an electrochromic transition that may be implemented. Unless
   otherwise specified herein (including the foregoing discussion), whenever reference is
30 made to a bleached-colored transition, the corresponding device or process
   encompasses other optical state transitions such as non-reflective-reflective,
   transparent-opaque, etc. Further, the term "bleached" refers to an optically neutral
   state, for example, uncolored, transparent, or translucent. Still further, unless
   specified otherwise herein, the "color" of an electrochromic transition is not limited to
                                                a

   any particular wavelength or range of wavelengths. As understood by those of skill in
   the art, the choice of appropriate electrochromic and counter electrode materials
   governs the relevant optical transition.
            In embodiments described herein, the electrochromic device reversibly cycles
 5 between a bleached state and a colored state. In some cases, when the device is in a
   bleached state, a potential is applied to the electrochromic stack 320 such that
   available ions in the stack reside primarily in the counter electrode 310. When the
   potential on the electrochromic stack is reversed, the ions are transported across the
   ion conducting layer 308 to the electrochromic material 306 and cause the material to
10 transition to the colored state.
            Referring again to Figure 3A, voltage source 316 may be configured to
   operate in conjunction with radiant and other environmental sensors. As described
   herein, voltage source 316 interfaces with a device controller (not shown in this
   figure). Additionally, voltage source 316 may interface with an energy management
15 system that controls the electrochromic device according to various criteria such as
   the time of year, time of day, and measured environmental conditions. Such an
   energy management system, in conjunction with large area electrochromic devices
   (e.g., an electrochromic window), can dramatically lower the energy consumption of a
   building.
20          Any material having suitable optical, electrical, thermal, and mechanical
   properties may be used as substrate 302. Such substrates include, for example, glass,
   plastic, and mirror materials. Suitable glasses include either clear or tinted soda lime
   glass, including soda lime float glass. The glass may be tempered or untempered.
            In many cases, the substrate is a glass pane sized for residential window
25 applications. The size of such glass pane can vary widely depending on the specific
   needs of the residence. In other cases, the substrate is architectural glass.
   Architectural glass is typically used in commercial buildings, but may also be used in
   residential buildings, and typically, though not necessarily, separates an indoor
   environment from an outdoor environment. In certain embodiments, architectural
30 glass is at least 20 inches by 20 inches, and can be much larger, for example, as large
   as about 80 inches by 120 inches. Architectural glass is typically at least about 2 mm
   thick, typically between about 3 mm and about 6 mm thick. Of course,
   electrochromic devices are scalable to substrates smaller or larger than architectural
                                                1(

   glass. Further, the electrochromic device may be provided on a mirror of any size and
   shape.
            On top of substrate 302 is conductive layer 304. In certain embodiments, one
   or both of the conductive layers 304 and 314 is inorganic and/or solid. Conductive
 5 layers 304 and 314 may be made from a number of different materials, including
   conductive oxides, thin metallic coatings, conductive metal nitrides, and composite
   conductors. Typically, conductive layers 304 and 314 are transparent at least in the
   range of wavelengths where electrochromism is exhibited by the electrochromic layer.
   Transparent conductive oxides include metal oxides and metal oxides doped with one
10 or more metals. Examples of such metal oxides and doped metal oxides include
   indium oxide, indium tin oxide, doped indium oxide, tin oxide, doped tin oxide, zinc
   oxide, aluminum zinc oxide, doped zinc oxide, ruthenium oxide, doped ruthenium
   oxide and the like. Since oxides are often used for these layers, they are sometimes
   referred to as "transparent conductive oxide" (TCO) layers. Thin metallic coatings
15 that are substantially transparent may also be used.
            The function of the conductive layers is to spread an electric potential
   provided by voltage source 316 over surfaces of the electrochromic stack 320 to
   interior regions of the stack, with relatively little ohmic potential drop. The electric
   potential is transferred to the conductive layers though electrical connections to the
20 conductive layers. In some embodiments, bus bars, one in contact with conductive
   layer 304 and one in contact with conductive layer 314, provide the electric
   connection between the voltage source 316 and the conductive layers 304 and 314.
   The conductive layers 304 and 314 may also be connected to the voltage source 316
   with other conventional means.
25          Overlaying conductive layer 304 is electrochromic layer 306. In some
   embodiments, electrochromic layer 306 is inorganic and/or solid. The electrochromic
   layer may contain any one or more of a number of different electrochromic materials,
   including metal oxides. Such metal oxides include tungsten oxide (W0 3 ),
   molybdenum oxide (MoO 3 ), niobium oxide (Nb 20 5 ), titanium oxide (TiO 2 ), copper
30 oxide (CuO), iridium oxide (Ir 2 0 3 ), chromium oxide (Cr 2 0 3 ), manganese oxide
   (Mn 2 0 3 ), vanadium oxide (V 2 0 5 ), nickel oxide (Ni 2O 3 ), cobalt oxide (Co 20 3 ) and the
   like. During operation, electrochromic layer 306 transfers ions to and receives ions
   from counter electrode layer 310 to cause optical transitions.
                                                   11

            Generally, the colorization (or change in any optical property - e.g.,
   absorbance, reflectance, and transmittance) of the electrochromic material is caused
   by reversible ion insertion into the material (e.g., intercalation) and a corresponding
   injection of a charge balancing electron. Typically some fraction of the ions
 5 responsible for the optical transition is irreversibly bound up in the electrochromic
   material. Some or all of the irreversibly bound ions are used to compensate "blind
   charge" in the material. In most electrochromic materials, suitable ions include
   lithium ions (Li') and hydrogen ions (H) (that is, protons). In some cases, however,
   other ions will be suitable. In various embodiments, lithium ions are used to produce
10 the electrochromic phenomena. Intercalation of lithium ions into tungsten oxide
   (WO 3 _y (0 <y     -0.3)) causes the tungsten oxide to change from transparent
                      ~
   (bleached state) to blue (colored state).
            Referring again to Figure 3A, in electrochromic stack 320, ion conducting
   layer 308 is sandwiched between electrochromic layer 306 and counter electrode layer
15 310. In some embodiments, counter electrode layer 310 is inorganic and/or solid.
   The counter electrode layer may comprise one or more of a number of different
   materials that serve as a reservoir of ions when the electrochromic device is in the
   bleached state. During an electrochromic transition initiated by, for example,
   application of an appropriate electric potential, the counter electrode layer transfers
20 some or all of the ions it holds to the electrochromic layer, changing the
   electrochromic layer to the colored state. Concurrently, in the case of NiWO, the
   counter electrode layer colors with the loss of ions.
            In some embodiments, suitable materials for the counter electrode
   complementary to W0 3 include nickel oxide (NiO), nickel tungsten oxide (NiWO),
25 nickel vanadium oxide, nickel chromium oxide, nickel aluminum oxide, nickel
   manganese oxide, nickel magnesium oxide, chromium oxide (Cr 2 0 3 ), manganese
   oxide (MnO 2), and Prussian blue.
            When charge is removed from a counter electrode 310 made of nickel tungsten
   oxide (that is, ions are transported from counter electrode 310 to electrochromic layer
30 306), the counter electrode layer will transition from a transparent state to a colored
   state.
            In the depicted electrochromic device, between electrochromic layer 306 and
   counter electrode layer 310, there is the ion conducting layer 308. Ion conducting
                                                 192

   layer 308 serves as a medium through which ions are transported (in the manner of an
   electrolyte) when the electrochromic device transitions between the bleached state and
   the colored state. Preferably, ion conducting layer 308 is highly conductive to the
   relevant ions for the electrochromic and the counter electrode layers, but has
 5 sufficiently low electron conductivity that negligible electron transfer takes place
   during normal operation. A thin ion conducting layer with high ionic conductivity
   permits fast ion conduction and hence fast switching for high performance
   electrochromic devices. In certain embodiments, the ion conducting layer 308 is
   inorganic and/or solid.
10         Examples of suitable ion conducting layers (for electrochromic devices having
   a distinct IC layer) include silicates, silicon oxides, tungsten oxides, tantalum oxides,
   niobium oxides, and borates. These materials may be doped with different dopants,
   including lithium. Lithium doped silicon oxides include lithium silicon-aluminum
   oxide. In some embodiments, the ion conducting layer comprises a silicate-based
15 structure. In some embodiments, a silicon-aluminum-oxide (SiAlO) is used for the
   ion conducting layer 308.
           Electrochromic device 300 may include one or more additional layers (not
   shown), such as one or more passive layers. Passive layers used to improve certain
   optical properties may be included in electrochromic device 300. Passive layers for
20 providing moisture or scratch resistance may also be included in electrochromic
   device 300. For example, the conductive layers may be treated with anti-reflective or
   protective oxide or nitride layers. Other passive layers may serve to hermetically seal
   electrochromic device 300.
           Figure 3B is a schematic cross-section of an electrochromic device in a
25 bleached state (or transitioning to a bleached state). In accordance with specific
   embodiments, an electrochromic device, 400, includes a tungsten oxide
   electrochromic layer (EC), 406, and a nickel-tungsten oxide counter electrode layer
   (CE), 410. Electrochromic device 400 also includes a substrate, 402, a conductive
   layer (CL), 404, an ion conducting layer (IC), 408, and conductive layer (CL), 414.
30         A power source, 416, is configured to apply a potential and/or current to an
   electrochromic stack, 420, through suitable connections (e.g., bus bars) to the
   conductive layers, 404 and 414. In some embodiments, the voltage source is
   configured to apply a potential of a few volts in order to drive a transition of the
   device from one optical state to another. The polarity of the potential as shown in
                                                 12

   Figure 3A is such that the ions (lithium ions in this example) primarily reside (as
   indicated by the dashed arrow) in nickel-tungsten oxide counter electrode layer 410.
           Figure 3C is a schematic cross-section of electrochromic device 400 shown in
   Figure 3B but in a colored state (or transitioning to a colored state). In Figure 3C, the
 5 polarity of voltage source 416 is reversed, so that the electrochromic layer is made
   more negative to accept additional lithium ions, and thereby transition to the colored
   state. As indicated by the dashed arrow, lithium ions are transported across ion
   conducting layer 408 to tungsten oxide electrochromic layer 406. Tungsten oxide
   electrochromic layer 406 is shown in the colored state. Nickel-tungsten oxide counter
10 electrode 410 is also shown in the colored state. As explained, nickel-tungsten oxide
   becomes progressively more opaque as it gives up (deintercalates) lithium ions. In
   this example, there is a synergistic effect where the transition to colored states for
   both layers 406 and 410 are additive toward reducing the amount of light transmitted
   through the stack and substrate.
15         As described above, an electrochromic device may include an electrochromic
   (EC) electrode layer and a counter electrode (CE) layer separated by an ionically
   conductive (IC) layer that is highly conductive to ions and highly resistive to
   electrons. As conventionally understood, the ionically conductive layer therefore
   prevents shorting between the electrochromic layer and the counter electrode layer.
20 The ionically conductive layer allows the electrochromic and counter electrodes to
   hold a charge and thereby maintain their bleached or colored states. In electrochromic
   devices having distinct layers, the components form a stack which includes the ion
   conducting layer sandwiched between the electrochromic electrode layer and the
   counter electrode layer. The boundaries between these three stack components are
25 defined by abrupt changes in composition and/or microstructure. Thus, the devices
   have three distinct layers with two abrupt interfaces.
           In accordance with certain embodiments, the counter electrode and
   electrochromic electrodes are formed immediately adjacent one another, sometimes in
   direct contact, without separately depositing an ionically conducting layer. In some
30 embodiments, electrochromic devices having an interfacialregion rather than a
   distinct IC layer are employed. Such devices, and methods of fabricating them, are
   described in U.S. Patent Applications, serial numbers 12/772,055 and 12/772,075,
   each filed on April 30, 2010, and in U.S. Patent Applications, serial numbers
   12/814,277 and 12/814,279, each filed on June 11, 2010 - each of the four
                                                11A

   applications is entitled "Electrochromic Devices," each names Zhongchun Wang et al.
   as inventors, and each is incorporated by reference herein in its entirety.
            Window Controllersand Control Algorithms
 5          A window controller is used to control the state (i.e., bleached, neutral or some
   level of coloration) of the electrochromic device of an electrochromic window. In
   some embodiments, the window controller is able to transition the electrochromic
   window between two states, a bleached state and a colored state. In other
   embodiments, the controller can additionally transition the electrochromic window
10 (e.g., having a single electrochromic device) to intermediate coloration states. Certain
   electrochromic windows allow intermediate coloration levels by using two
   electrochromic lites in a single IGU, where each lite is a two-state lite. This is
   described in more detail below.
            As noted above with respect to Figures 2A and 2B, in some embodiments, an
15 electrochromic window can include an electrochromic device on one lite of an IGU
   and another electrochromic device on the other lite of an IGU. If the window
   controller is able to transition each electrochromic device between two states, a
   bleached state and a colored state, the electrochromic window is able to attain four
   different states, a colored state with both electrochromic devices being colored, a first
20 intermediate state with one electrochromic device being colored, a second
   intermediate state with the other electrochromic device being colored, and a bleached
   state with both electrochromic devices being bleached. Embodiments of multi-pane
   electrochromic windows are further described in U.S. Patent Application, serial
   number 12/851,514, naming Friedman et al. as inventors, titled "MULTI-PANE
25 ELECTROCHROMIC WINDOWS" and filed on August 05, 2010, which is
   incorporated herein by reference in its entirety and for all purposes.
            In some embodiments, the window controller is able to transition an
   electrochromic window having an electrochromic device capable of transitioning
   between two or more states. For example, a window controller may be able to
30 transition the electrochromic window to a bleached state, an intermediate state, and a
   colored state. In some other embodiments, the window controller is able to transition
   an electrochromic window incorporating an electrochromic device between any
   number of states between the bleached state and the colored state. Embodiments of
   methods and controllers for transitioning an electrochromic window to an
                                                1r

   intermediate state or states are further described in U.S. Patent Application, serial
   number 13/049,623, naming Mehtani et al. as inventors, titled "CONTROLLING
   TRANSITIONS IN OPTICALLY SWITCHABLE DEVICES" and filed on March
   16, 2011, which is incorporated herein by reference in its entirety and for all purposes.
 5         In some embodiments, a window controller can power one or more
   electrochromic devices in an electrochromic window. Typically, this function of the
   window controller is augmented with one or more other functions described in more
   detail below. Window controllers described herein are not limited to those that have
   the function of powering an electrochromic device to which it is associated for the
10 purposes of control. That is, the power source for the electrochromic window may be
   separate from the window controller, where the controller has its own power source
   and directs application of power from the window power source to the window.
   However, it is convenient to include a power source with the window controller and
   to configure the controller to power the window directly, because it obviates the need
15 for separate wiring for powering the electrochromic window.
           Further, the window controllers described in this section are described as
   standalone controllers which may be configured to control the functions of a single
   window or a plurality of electrochromic windows, without integration of the window
   controller into a building control network or a building management system (BMS).
20 Window controllers, however, may be integrated into a building control network or a
   BMS, as described further in the Building Management System section of this
   disclosure.
           Figure 4 depicts a block diagram of a window controller. Figure 4 is a
   simplified block diagram of a window controller, and more detail regarding window
25 controllers can be found in U.S. Patent Application, serial number 13/449,248,
   naming Brown as inventor, titled "CONTROLLER FOR OPTICALLY
   SWITCHABLE WINDOWS" (Attorney Docket No. SLDMPO41) filed on April 17,
   2012, and in U.S. Patent Application, serial number 13/449,251, naming Brown as
   inventor, titled "CONTROLLER FOR OPTICALLY-SWITCHABLE WINDOWS"
30 (Attorney Docket No. SLDMPO42) filed on April 17, 2012. As shown in Figure 4, a
   window controller, 450, includes a microcontroller, 455, a power width modulator
   (PWM), 460, a signal conditioning module, 465, and a smart logic module, 470.
           Figure 5 depicts a schematic diagram of a room including an electrochromic
   window and a plurality of sensors. In some embodiments, output from these sensors
                                                1A

   may be input to a signal conditioning module, 465, of a window controller, 450. In
   some other embodiments, output from these sensors may be input to a network
   including a building management system, as described further below in the Building
   Management System section. Although the various sensors are depicted as being,
 5 e.g., on a vertical surface of the room, this is for the sake of simplicity, and any or all
   of the sensors may be on the ceiling or the floor as well.
           A room, 500, includes an electrochromic window, 505. Electrochromic
   window 505 is between the exterior and the interior of a building which includes
   room 500. Window controller 450 is connected to and configured to control the
10 optical state of electrochromic window 505. The sensors in room 500 include an
   exterior photosensor, 510, an exterior temperature sensor, 515, an interior
   photosensor, 520, an interior transmissivity sensor, 525, an occupancy sensor, 530,
   and a power meter, 535. Each of these sensors is described briefly, below.
           Exterior photosensor 510 and interior photosensor 520 are devices that are
15 able to detect the irradiance of light incident upon them. Light incident upon a
   photosensor may be light directly from a light source or light reflected from a surface
   to the photosensor. Exterior photosensor 510 generally measures the direct or
   reflected sunlight incident upon the photosensor. A light level detected by exterior
   photosensor 510 changes with the time of day and with the time of year as the angle at
20 which sunlight strikes the earth changes. The light level detected by exterior
   photosensor 510 also changes with the weather; e.g., on cloudy days, sunlight would
   be blocked by the clouds and the light level detected by exterior photosensor 510
   would be lower than on cloudless days. In some embodiments, there may be one or
   more exterior photosensors 510. Output from the one or more exterior photosensors
25 510 could be compared to one another to determine, for example, if one of exterior
   photosensors 510 is shaded by an object, such as by a bird that landed on exterior
   photosensor 510.
           Interior photosensor 520 generally measures the ambient light in room 500. In
   some embodiments, interior photosensor measures the light reflected from a surface in
30 the field of view of interior photosensor 520. With the same lighting of room 500,
   interior photosensor 520 would measure a higher light level when a piece of white
   paper is in the field of view of interior photosensor 520 than when, e.g., a piece of
   colored carpet is in the field of view of interior photosensor 520, for example, due to
   the higher reflectivity of the white paper. Because of this, if interior photosensor 520
                                                17

   is moved or if the object(s) in the field of view of interior photosensor 520 is changed,
   the output of interior photosensor 520 may change. Thus, in some embodiments,
   window controller 450 may perform a recalibration routine to determine the output
   range of interior photosensor 520, which again depends on the object(s) in the field of
 5 view interior photosensor 520. Such a recalibration routine may be performed
   according to set schedule (e.g., once a week) or triggered by a person (e.g., a
   maintenance person who rearranges the furniture in room 500).
            Exterior photosensor 510 and interior photosensor 520 may be any number of
   different types of photosensors. For example, exterior photosensor 510 and interior
10 photosensor 520 can be charge coupled devices (CCDs), photodiodes, photoresistors,
   or photovoltaic cells. One of ordinary skill in the art would appreciate that future
   developments in photosensor technology would also work, as they measure light
   intensity and provide an electrical output representative of the light level.
            Exterior temperature sensor 515 is a device able to measure the outside
15 temperature. Exterior temperature sensor 515 can be any number of different
   temperature sensors, including a thermocouple, a thermistor, or a resistance
   temperature detector. In some embodiments, room 500 further includes an interior
   temperature sensor.
            Interior transmissivity sensor 525 is a device able to measure the amount of
20 light transmitted though electrochromic window 505. In some embodiments, interior
   transmissivity sensor 525 is a photosensor, which may be similar to exterior
   photosensor 510 or interior photosensor 520, with the field of view of the sensor
   oriented to be facing electrochromic window 505 in order to measure incident light
   passing through electrochromic window 505. By combining the measurement of
25 exterior photosensor 510 with a photosensor having a field of view facing the interior
   of electrochromic window 505, the transmissivity of electrochromic window 505 can
   be determined.
            Occupancy sensor 530 is a device able to detect when a person is in room 500.
   Occupancy sensors are usually motion sensors; when occupancy sensor 530 detects
30 motion, it is assumed that a person in in room 500, and when occupancy sensor 530
   does not detect motion, it is assumed that a person in not in room 500. Occupancy
   sensors may be set so that it is assumed that a person is in a room for a period of time
   after the last motion was detected; this can account for a person sitting at a desk and
   not moving very much, but still being in the room. In some embodiments, the
                                                152

   occupancy sensor may be a motion sensor used to control the lights lighting the room.
   Occupancy sensor 530 can use, for example, infrared (IR) technology, acoustic
   technology, or a combination of the two. The field of view of occupancy sensor 530
   may be selected/adjusted so that it responds to motion in room 500 and not to motion
 5 outside of room 500 (e.g., motion outside of the building housing room 500 or motion
   in a hallway of the building housing room 500).
            Power meter 535 is a device able to measure the power consumption of room
   500. The power consumption of room 500 may include heating, ventilation, and air
   conditioning systems (HVAV systems) and lighting. In some embodiments, power
10 meter 535 includes devices able to interface with the wires of the circuits providing
   power to room 500. Power meter may be able to separately measure the power
   consumed by the interior lighting of room 500 and the power consumed by HVAC
   system of room 500 if the interior lighting and HVAC system are on different circuits
   of room 500.
15          In some embodiments, when window controller 450 is not connected to a
   network, two or more sensors may provide output signals to window controller 450
   through signal conditioning module 465. Signal conditioning module 465 passes
   these output signals to a microcontroller, 455. Microcontroller 455 determines the
   level of tint of electrochromic window 505, based on the outputs, and instructs a
20 PWM, 460, to apply a voltage and/or current to electrochromic window 505 to
   transition to the desired state.
            In some embodiments, output from exterior photosensor 510, interior
   photosensor 520, a temperature sensor, and a tint command are input to signal
   conditioning module 465. The temperature sensor may be an interior temperature
25 sensor (not shown) or exterior temperature sensor 515. The tint command may be a
   command from a person or occupant in room 500 as to the tint level desired by the
   person. For example, depending on electrochromic window 505, the person may
   instruct the window to transition to a bleached state, a colored state, or an
   intermediate state. Such tint command instructions may be made, for example, with a
30 wireless remote or with a panel associated with window controller 450. If room 500
   is a bedroom, for example, the person may want electrochromic window 505 to be in
   a colored state at night for privacy.
            In some embodiments, the tint command input may be a voltage signal to
   signal conditioning module 465 of about 0 V to about 10 V. A tint command input of
                                               10

   0 V to 4.9 V may indicate a command for electrochromic window 505 to transition to
   a beached state and a tint command input of 5 V to about 10 V may indicate a
   command for electrochromic window 505 to transition to a colored state. As another
   example, when the electrochromic window 505 has four states, a tint command input
 5 of 0 V to 2.5 V may indicate a command for electrochromic window 505 to transition
   to a beached state, a tint command input of 2.6 V to 5 V may indicate a command for
   electrochromic window 505 to transition to a first intermediate state, a tint command
   input of 5.1 V to 7.5 V may indicate a command for electrochromic window 505 to
   transition to a second intermediate state, and a tint command input of 7.6 V to about
10 10 V may indicate a command for electrochromic window 505 to transition to a
   colored state.
            The output signals from the sensors and the tint command are passed to
   microcontroller 455. Whether or not electrochromic window 505 transitions to a state
   as indicated by the tint command will depend on how microcontroller 455 is
15 configured to process outputs from exterior photosensor 510, interior photosensor
   520, and the temperature sensor, in relation to the tint command. For example, in
   some embodiments, the tint command input may override the output from exterior
   photosensor 510, interior photosensor 520, and the temperature sensor and
   electrochromic window 505 may transition to a state indicated by the tint command
20 input. Microcontroller 455 instructs PWM 460 to supply current and/or voltage to
   transition electrochromic window 505 according to the tint command input.
            In some embodiments, microcontroller 455 may employ any one or more of
   various logic functions or algorithms to arrive at tint decisions based on signals from
   the sensors and/or other input. The sensor outputs may serve as independent variables
25 to a linear or non-linear expression, a look up table, a tree, etc. In some embodiments,
   microcontroller 455 uses a function to determine the current and/or voltage that power
   width modulator 460 should send to electrochromic window 505. An example of one
   function is shown in Figure 6.
            Figure 6 depicts a function that uses weighting constants, ki, k2 , k 3, and k 4 to
30 weight the outputs from the different sensors/commands, where EP is the exterior
   photosensor output, IP is the interior photosensor output, T is the temperature sensor
   output, and TC is the tint command input. The weighting constants are set to achieve
   the desired response for electrochromic window 505. Using the function, an output
                                                90n

   value (OV) is determined. Depending on the output value, the microcontroller 455
   can instruct PWM 460 to transition electrochromic window 505 to a desired state.
            For example, when the output value ranges from 0 to 15 (e.g., 16 tint states,
   ranging from about 67% transmissivity to 4% transmissivity) and electrochromic
 5 window 505 has two states, with an output value of 0, window controller 450 can
   instruct electrochromic window 505 to transition to a bleached state, and with an
   output value of 15, window controller 450 can instruct electrochromic window 505 to
   transition to a colored state. As another example, when the output value ranges from
   0 to 15 and electrochromic window 505 has four states, with an output value of 0 to 4,
10 window controller 450 can instruct electrochromic window 505 to transition to a
   bleached state, with an output value of 5 to 9, window controller 450 can instruct
   electrochromic window 505 to transition to a first intermediate state, with an output
   value of 10 to 14, window controller 450 can instruct electrochromic window 505 to
   transition to a second intermediate state, and with an output value of 15, window
15 controller 450 can instruct electrochromic window 505 to transition to a colored state.
   As yet another example, when the output value ranges from 0 to 15 and
   electrochromic window 505 has an infinite number of intermediate states, with an
   output value of 0, window controller 450 can instruct electrochromic window 505 to
   transition to a bleached state, with an output value of 15, window controller 450 can
20 instruct electrochromic window 505 to transition to a colored state, and with an output
   value between 0 to 15, window controller 450 can instruct electrochromic window
   505 to transition to a tint level corresponding to the output value.
            The weighting constants, ki, k 2, k 3, and k 4 are set to achieve the desired
   response for electrochromic window 505. For example, if an occupant in the room is
25 to have control over the tint level of electrochromic window 505, the weighting
   constants are set to ki=0, k2 =0, k 3 =0, and k 4 =1. Weighting constant k 3 (i.e., for the
   exterior temperature sensor output) may be given a large value if electrochromic
   window 505 is used to reduce HVAC energy consumption in room 500. Weighting
   constants ki and k2 (i.e., for the exterior photosensor output and the interior
30 photosensor output, respectively) may be given values to keep the lighting in room
   500 relatively constant. The weighting constants may be set to achieve any of a
   number of different responses for electrochromic window 505.
            In some embodiments, weighting constants, ki, k2 , k3 , and k 4 may change
   according to an external influence or a schedule. Examples of external influences that
                                                 21

   may cause the constants to vary include changes in the weather and changes in the
   power consumption conditions within a building or across a geographic area (which
   may be noted by a communication from a power utility company). In some
   embodiments, the schedule may be a daily schedule, and in some other embodiments,
 5 the schedule may be a yearly schedule. In some embodiments, the schedule may be a
   schedule that includes different daily schedules for different times of the year. For
   example, the daily schedule may change for the different seasons of the year, i.e.,
   winter, spring, summer, and fall.
            An example of one schedule is shown in Figure 7. For example, schedule 1
10 may be a schedule for 10 pm to 6 am, schedule 2 may be a schedule for 10 am to 1
   pm, and schedule 3 may be a schedule for 1 pm to 10 pm. When room 500 is a room
   in a residential home, schedule 1 may color electrochromic window 505 for privacy,
   and schedules 2 and 3 may balance the light in room 500 and the temperature.
            As another example, schedule 1 may be a schedule for the winter, schedule 2
15 may be a schedule for the spring and the summer, and schedule 3 may be a schedule
   for the fall. Schedules 1, 2, and 3 may balance the light and the temperature in room
   500, taking into account the different seasons, including, for example, concomitant
   changes in average temperature, angle and location of the sun, precipitation patterns,
   and the like.
20          Figures 6 and 7 show one embodiment of a relationship for determining the
   tint level that window controller 450 may use. More outputs from different sensors
   can be input to signal conditioning module 465 and the function and weighting
   constants of the function may be adjusted appropriately. Also, fewer outputs can be
   input to signal conditioning module 465. In some other embodiments, the relationship
25 used for determining a level of tint is a lookup table in which levels of tint are
   specified for various combinations of output signal values.
            Figure 8 shows a flow chart of a method for limiting the energy consumption
   in a room having at least one tintable window between an interior and exterior of the
   room. The level of tinting may be controlled automatically; i.e., output from the
30 sensors may be input to the window controller, and the window controller may control
   the tint state of the tintable window according to the output from the sensors.
            As shown in Figure 8, in operation 805, output signals from any two or more
   sensors are received. In some embodiments, output from the sensors is received by a
   window controller. In some other embodiments, output from these sensors is received
                                                T,

   at a network including a building management system or a master network controller.
   Again, building management systems are described further below in the Building
   Management System section. The sensors may be selected from the group consisting
   of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior
 5 temperature sensor, and a transmissivity sensor which detects light passing through
   the tintable window from the exterior. In some embodiments, when the interior
   photosensor is facing the tintable window, output from both the exterior photosensor
   and the interior photosensor can be used to determine the light passing through the
   tintable window from the exterior.
10          In some embodiments, output indicating an energy or power consumption by a
   heating system, a cooling system, and/or lighting in the room also is received. In
   some embodiments, devices that interface with the wires of the circuits providing
   power to the room including the tintable window provide the energy or power
   consumption output.
15          In operation 810, a level of tint for the tintable window is determined using a
   relationship between the received energy output signals and the level of tint. In some
   embodiments, the relationship tends to minimize energy consumption by a heating
   system, a cooling system, and/or lighting in the room while providing conditions
   suitable for occupancy of the room. For example, when output indicating an energy
20 or power consumption by a heating system, a cooling system, and/or lighting in the
   room is received, this output may be used with the other received output signals in to
   determine the level of tinting for the tintable window to minimize energy
   consumption.
            In some embodiments, the relationship is an expression in which the level of
25 tint is the dependent variable and the output signals are independent variables; an
   example of such a relationship is shown in Figure 6. The window controller receives
   the output signals and computes the level of tint based on the relationship and the
   output signals. In some other embodiments, the relationship is a lookup table in
   which levels of tint are specified for various combinations of output signal values.
30 Such a lookup table may be used, for example, when the tintable window is capable
   of achieving a finite number of states (e.g., two states, bleached and colored, or four
   states).
            In some embodiments of method 800, the output signals include a signal from
   an exterior photosensor. The relationship employed in operation 810 requires

   transitioning from a first darker tint level to a second lighter tint level when the output
   signal from the exterior photosensor passes a first threshold. The relationship
   employed in operation 810 also requires transitioning from the second lighter tint
   level to the first darker tint level when the output signal from the exterior photosensor
 5 passes a second threshold. These embodiments are described further below with
   respect to Figures 9 and 10.
            Referring again to Figure 8, in operation 815, instructions are provided to
   change the tint of the tintable window to the level of tint determined in operation 810.
   In some embodiments, this includes a window controller applying voltage or current
10 to the tintable window to drive the change in tint pursuant to the instructions. For
   example, for window controller 450 shown in Figure 4, microcontroller 455 provides
   instruction to PWM 460 to apply voltage and/or current to the tintable window.
            Method 800 can be implemented in an iterative process, as described in
   operation 820, a decision block. For example, as part of an automated program to
15 control one or more electrochromic windows, the tint level instructions may be
   generated based on a preset timing function, where after a preset time has elapsed, the
   controller samples output from the sensors in order to generate new instructions for
   the window. If the time period has not elapsed, then no further instructions are
   needed and the method ends. Once the time period has elapsed, then operations 805
20 through 815 are repeated. Decision block 820 may also be based on any number of
   criteria, depending on the desired control level of the one or more windows. For
   example, decision block 820 may query whether there has been any change in the
   output from one or more sensors. If the answer is negative, then the method is
   complete; if the answer is affirmative, then operations 805 through 815 are repeated.
25          Figure 9 shows a flow chart of a method, 900, of operating a tintable window
   installed between an interior and exterior of a room. The level of tinting may be
   controlled automatically; i.e., output from the sensors may be input to the window
   controller, and the window controller may control the tint state of the tintable window
   according to the output from the sensors.
30          In operation 905 of method 900 shown in Figure 9, signals indicating a level
   of exterior irradiance received at or proximate to the tintable window are received.
   The exterior photosensor measures the amount of light incident upon the photosensor,
   or the irradiance. Illuminance is closely related to irradiance; illuminance is a
   measure of the intensity of illumination on a surface. Irradiance, however, is based on
                                                 911

   physical power, with all wavelengths being weighted equally, while illuminance takes
   into account that the human eye's visual system is more sensitive to some wavelengths
   than others, and accordingly every wavelength is given a different weight. Figure 10
   shows a plot of illuminance versus time for a 24-hour period, with the time starting at
 5 0 (i.e., 12 AM) and ending 24 hours later. As shown, the illuminance is low at 0, then
   increases with time until about midday, reaching a maximum at midday, and then
   decreases throughout the remainder of the day.
            In operation 910, a level of tint for the tintable window is determined using a
   relationship between the received output signals and the level of tint. The relationship
10 employed in operation 910 requires transitioning from a first lighter tint level to a
   second darker tint level when the output signal from the exterior photosensor passes a
   first threshold, 1005. The relationship employed in operation 910 also requires
   transitioning from the second darker tint level to the first lighter tint level when the
   output signal from the exterior photosensor passes a second threshold, 1010. First
15 threshold 1005 and second threshold 1010 are different levels of
   irradiance/illuminance. For example, in some embodiments, the level of
   irradiance/illuminance at second threshold 1010 is lower than the level of
   irradiance/illuminance at first threshold 1005.
            In operation 915, instructions are provided to change the tint of the tintable
20 window to the level of tint determined in operation 910. In some embodiments,
   operation 915 is similar to operation 815 described with respect to Figure 8.
            Method 900 of controlling the tint state of a tintable window may maximize
   energy savings for the room including the tintable window. For example, the room
   may be lit by sunlight in the early morning, minimizing lighting energy. As the sun's
25 position changes and temperature in the room starts to increase due to sunlight though
   the tintable window, the HVAC power used for cooling the room increases, and the
   tintable window is transitioned at first threshold 1005. Then, when the sun begins to
   set and the sunlight though the tintable window decreases the HVAC power used for
   cooling, the tintable window is transitioned at second threshold 1010, which may
30 reduce the lighting energy.
            Analogous to method 800, method 900 may include a decision block as in
   method 800. For example, the decision to repeat operations 905-915 may be based on
   a preset timing event; for example, knowing the expected illumination during a 24
   hour period, the illumination is sampled according to a preset schedule. In another
                                                 1)r

   example, if a change in illumination level as read by the photosensor meets a certain
   threshold value, then new tint instructions are generated and provided to the
   window(s) based on this change in illumination.
           The methods shown in Figures 8 and 9 are two methods of controlling the tint
 5 state of a tintable window. Many other methods of controlling the tint state of a
   tintable window are possible, using different combinations of sensors and weighting
   the output of the different sensors using weighting functions.
   Building Management Systems
10         The window controllers described herein also are suited for integration with a
   BMS. A BMS is a computer-based control system installed in a building that
   monitors and controls the building's mechanical and electrical equipment such as
   ventilation, lighting, power systems, elevators, fire systems, and security systems. A
   BMS consists of hardware, including interconnections by communication channels to
15 a computer or computers, and associated software for maintaining conditions in the
   building according to preferences set by the occupants and/or by the building
   manager. For example, a BMS may be implemented using a local area network, such
   as Ethernet. The software can be based on, for example, internet protocols and/or
   open standards. One example of software is software from Tridium, Inc. (of
20 Richmond, Virginia). One communications protocol commonly used with a BMS is
   BACnet (building automation and control networks).
           A BMS is most common in a large building, and typically functions at least to
   control the environment within the building. For example, a BMS may control
   temperature, carbon dioxide levels, and humidity within a building. Typically, there
25 are many mechanical devices that are controlled by a BMS such as heaters, air
   conditioners, blowers, vents, and the like. To control the building environment, a
   BMS may turn on and off these various devices under defined conditions. A core
   function of a typical modern BMS is to maintain a comfortable environment for the
   building's occupants while minimizing heating and cooling costs/demand. Thus, a
30 modern BMS is used not only to monitor and control, but also to optimize the synergy
   between various systems, for example, to conserve energy and lower building
   operation costs. In some embodiments, a window controller is integrated with a
   BMS, where the window controller is configured to control one or more tintable or
   electrochromic windows. In one embodiment, the one or more electrochromic

   windows include at least one all solid state and inorganic electrochromic device. In
   one embodiment, the one or more electrochromic windows include only all solid state
   and inorganic windows. In one embodiment, the electrochromic windows are
   multistate electrochromic windows, as described in U.S. Patent Application, serial
 5 number 12/851,514, filed on August 5, 2010, and entitled "Multipane Electrochromic
   Windows."
           Figure 11 depicts a schematic diagram of an embodiment of a BMS, 1100, that
   manages a number of systems of a building, 1101, including security systems,
   heating/ventilation/air conditioning (HVAC), lighting of the building, power systems,
10 elevators, fire systems, and the like. Security systems may include magnetic card
   access, turnstiles, solenoid driven door locks, surveillance cameras, burglar alarms,
   metal detectors, and the like. Fire systems may include fire alarms and fire
   suppression systems including a water plumbing control. Lighting systems may
   include interior lighting, exterior lighting, emergency warning lights, emergency exit
15 signs, and emergency floor egress lighting. Power systems may include the main
   power, backup power generators, and uninterrupted power source (UPS) grids.
           Also, BMS 1100 manages a window controller, 1102. In this example,
   window controller 1102 is depicted as a distributed network of window controllers
   including a master network controller, 1103, intermediate network controllers, 1105 a
20 and 1105b, and end or leaf controllers, 1110. End or leaf controllers 1110 may be
   similar to window controller 450 described with respect to Figure 4. For example,
   master network controller 1103 may be in proximity to the BMS, and each floor of
   building 1101 may have one or more intermediate network controllers 1105 a and
   1105b, while each window of the building has its own end controller 1110. In this
25 example, each of controllers 1110 controls a specific electrochromic window of
   building 1101.
           Each of controllers 1110 can be in a separate location from the electrochromic
   window that it controls, or be integrated into the electrochromic window. For
   simplicity, only ten electrochromic windows of building 1101 are depicted as
30 controlled by window controller 1102. In a typical setting there may be a large
   number of electrochromic windows in a building controlled by window controller
   1102. Window controller 1102 need not be a distributed network of window
   controllers. For example, a single end controller which controls the functions of a
   single electrochromic window also falls within the scope of the embodiments
                                                 9)7

   disclosed herein, as described above. Advantages and features of incorporating
   electrochromic window controllers as described herein with BMS's are described
   below in more detail and in relation to Figure 11, where appropriate.
           One aspect of the disclosed embodiments is a BMS including a multipurpose
 5 electrochromic window controller as described herein. By incorporating feedback
   from a electrochromic window controller, a BMS can provide, for example, enhanced:
   1) environmental control, 2) energy savings, 3) security, 4) flexibility in control
   options, 5) improved reliability and usable life of other systems due to less reliance
   thereon and therefore less maintenance thereof, 6) information availability and
10 diagnostics, 7) effective use of staff, and various combinations of these, because the
   electrochromic windows can be automatically controlled.
           In some embodiments, a BMS may not be present or a BMS may be present
   but may not communicate with a master network controller or communicate at a high
   level with a master network controller. In some embodiments, a master network
15 controller can provide, for example, enhanced: 1) environmental control, 2) energy
   savings, 3) flexibility in control options, 4) improved reliability and usable life of
   other systems due to less reliance thereon and therefore less maintenance thereof, 5)
   information availability and diagnostics, 6) effective use of staff, and various
   combinations of these, because the electrochromic windows can be automatically
20 controlled. In these embodiments, maintenance on the BMS would not interrupt
   control of the electrochromic windows.
           Figure 12 depicts a block diagram of an embodiment of a building network,
   1200, for a building. As noted above, network 1200 may employ any number of
   different communication protocols, including BACnet. As shown, building network
25 1200 includes a master network controller, 1205, a lighting control panel, 1210, a
   building management system (BMS), 1215, a security control system, 1220, and a
   user console, 1225. These different controllers and systems in the building may be
   used to receive input from and/or control a HVAC system, 1230, lights, 1235, security
   sensors, 1240, door locks, 1245, cameras, 1250, and tintable windows, 1255, of the
30 building.
           Master network controller 1205 may function in a similar manner as master
   network controller 1103 described with respect to Figure 11. Lighting control panel
   1210 may include circuits to control the interior lighting, the exterior lighting, the
   emergency warning lights, the emergency exit signs, and the emergency floor egress

   lighting. Lighting control panel 1210 also may include occupancy sensors in the
   rooms of the building. BMS 1215 may include a computer server that receives data
   from and issues commands to the other systems and controllers of network 1200. For
   example, BMS 1215 may receive data from and issue commands to each of the master
 5 network controller 1205, lighting control panel 1210, and security control system
   1220. Security control system 1220 may include magnetic card access, turnstiles,
   solenoid driven door locks, surveillance cameras, burglar alarms, metal detectors, and
   the like. User console 1225 may be a computer terminal that can be used by the
   building manager to schedule operations of, control, monitor, optimize, and
10 troubleshoot the different systems of the building. Software from Tridium, Inc., may
   generate visual representations of data from different systems for user console 1225.
           Each of the different controls may control individual devices/apparatus.
   Master network controller 1205 controls windows 1255. Lighting control panel 1210
   controls lights 1235. BMS 1215 may control HVAC 1230. Security control system
15 1220 controls security sensors 1240, door locks 1245, and cameras 1250. Data may
   be exchanged and/or shared between all of the different devices/apparatus and
   controllers that are part of building network 1200.
           In some cases, the systems of BMS 1100 or building network 1200 may run
   according to daily, monthly, quarterly, or yearly schedules. For example, the lighting
20 control system, the window control system, the HVAC, and the security system may
   operate on a 24 hour schedule accounting for when people are in the building during
   the work day. At night, the building may enter an energy savings mode, and during
   the day, the systems may operate in a manner that minimizes the energy consumption
   of the building while providing for occupant comfort. As another example, the
25 systems may shut down or enter an energy savings mode over a holiday period.
           The scheduling information may be combined with geographical information.
   Geographical information may include the latitude and longitude of the building.
   Geographical information also may include information about the direction that each
   side of the building faces. Using such information, different rooms on different sides
30 of the building may be controlled in different manners. For example, for east facing
   rooms of the building in the winter, the window controller may instruct the windows
   to have no tint in the morning so that the room warms up due to sunlight shining in
   the room and the lighting control panel may instruct the lights to be dim because of
   the lighting from the sunlight. The west facing windows may be controllable by the
                                               ,0

   occupants of the room in the morning because the tint of the windows on the west side
   may have no impact on energy savings. However, the modes of operation of the east
   facing windows and the west facing windows may switch in the evening (e.g., when
   the sun is setting, the west facing windows are not tinted to allow sunlight in for both
 5 heat and lighting).
            Described below is an example of a building, for example, like building 1101
   in Figure 11, including a building network or a BMS, tintable windows for the
   exterior windows of the building (i.e., windows separating the interior of the building
   from the exterior of the building), and a number of different sensors. Light from
10 exterior windows of a building generally has an effect on the interior lighting in the
   building about 20 feet or about 30 feet from the windows. That is, space in a building
   that is more that about 20 feet or about 30 feet from an exterior window receives little
   light from the exterior window. Such spaces away from exterior windows in a
   building are lit by lighting systems of the building.
15          Further, the temperature within a building may be influenced by exterior light
   and/or the exterior temperature. For example, on a cold day and with the building
   being heated by a heating system, rooms closer to doors and/or windows will lose
   heat faster than the interior regions of the building and be cooler compared to the
   interior regions.
20          For exterior photosensors, the building may include exterior photosensors on
   the roof of the building. Alternatively, the building may include an exterior
   photosensor associated with each exterior window (e.g., as described in relation to
   Figure 5, room 500) or an exterior photosensor on each side of the building. An
   exterior photosensor on each side of the building could track the
25 irradiance/illuminance on a side of the building as the sun changes position
   throughout the day.
            For exterior temperature sensors, the building may include exterior
   temperature sensors at a few locations to determine an average exterior temperature.
   For interior temperature sensors, each room that has an exterior window may include
30 an interior temperature sensor. Alternatively, a few rooms on each side of the
   building may include an interior temperature sensor.
            For interior photosensors and transmissivity sensors, the building may include
   interior photosensors and interior transmissivity sensors in each room that has an

   exterior window. Alternatively, a few rooms on each side of the building may include
   these sensors.
           Each room of the building may include an occupancy sensor that is associated
   with the lights and/or lighting panel in the room. The building may include power
 5 meters for individual rooms or groups of rooms (e.g., a group of rooms having
   exterior windows on one side of the building). A power meter setup will depend on
   the circuitry setup of the building, however.
           Regarding the methods described with respect to Figures 8 and 9, when a
   window controller is integrated into a building network or a BMS, outputs from
10 sensors may be input to a network of BMS and provided as input to the window
   controller. For example, in some embodiments, output signals from any two or more
   sensors are received. In some embodiments, only one output signal is received, and in
   some other embodiments, three, four, five, or more outputs are received. These
   output signals may be received over a building network or a BMS.
15         A level of tint for the tintable window is determined using a relationship
   between the received output signals and the level of tint. In some embodiments,
   determining the level of tint includes using scheduling information for the building.
   For example, in some embodiments, the scheduling information includes time of year
   and/or time of day information for the building. In some embodiments, the
20 scheduling information further includes information about the geographical facing
   direction of the tintable window and the latitude of the building. The lookup table
   used to determine the level of tint of the windows or the weighting constants used in a
   relationship used to determine the level of tint of the windows may change according
   to the schedule.
25         The window controllers and the methods of controlling the tint state of a
   tintable window described herein may employ different sensors or combinations of
   sensors. Different sensors or combinations of sensors may be referred to as different
   "sensor setups" or "levels." For example, use of an exterior photosensor may be
   referred to as "level 0," use of an exterior photosensor and an interior photosensor
30 may be referred to as "level 1," use of an exterior photosensor, an interior
   photosensor, and an occupancy sensor may be referred to as "level 2," and use of an
   exterior photosensor, an interior photosensor, an occupancy sensor, and a signal
   indicating energy or power consumption by a heating system, a cooling system,
                                                 11

   and/or lighting within the building (described below) may be referred to as "level 3."
   Embodiments of each of these different levels are described further, below.
           In some embodiments, the output signals include a signal from an exterior
   photosensor (i.e., level 0). The relationship employed to determine the level of tint
 5 may include an expression or look up table in which the level of tint is the dependent
   variable and the signal from the exterior photosensor is the independent variable. In
   some embodiments, the relationship employed in operation 810 uses scheduling
   information including time of year and/or time of day information for the building.
   For example, a different relationship over a 24 hour day may be used for each
10 calendar day of the year.
           In some embodiments, the output signals include a signal from an exterior
   photosensor and a signal from an interior photosensor (i.e., level 1). The relationship
   employed to determine the level of tint may include an expression or look up table in
   which the level of tint is the dependent variable and the signals from the exterior
15 photosensor and the interior photosensor are independent variables. In some
   embodiments, the relationship employed in operation 810 uses scheduling information
   including time of year and/or time of day information for the building. For example,
   a different relationship over a 24 hour day may be used for each calendar day of the
   year.
20         In some embodiments, the output signals received include a signal from an
   exterior photosensor, a signal from an interior photosensor, and a signal from an
   occupancy sensor (i.e., level 2). The relationship employed to determine the level of
   tint may include an expression or look up table in which the level of tint is the
   dependent variable and the signals from the exterior photosensor, the interior
25 photosensor, and the occupancy sensor are independent variables. In some
   embodiments, when the occupancy sensor indicates that the room is not occupied, the
   room may enter into a maximum energy savings mode.
           In some embodiments, the output signals received include a signal indicating
   energy or power consumption by a heating system, a cooling system, and/or lighting
30 within the building. For example, the energy or power consumption of the heating
   system, the cooling system, and/or the lighting of the building may be monitored to
   provide the signal indicating energy or power consumption. Devices may be
   interfaced with or attached to the circuits and/or wiring of the building to enable this
   monitoring. Alternatively, the power systems in the building may be installed such

   that the power consumed by the heating system, a cooling system, and/or lighting for
   an individual room within the building or a group of rooms within the building can be
   monitored.
           For example, with respect to lighting in the building, a signal indicating the
 5 energy or power consumption of a light, group of lights, or a lighting system within
   the building is received. The light, the group of lights, or the lighting system may
   include at least one light within about 20 feet or about 30 feet of a tintable window, in
   an area where changing the tint of the window can influence the lighting in the area.
           As another example, with respect to the heating and/or cooling in the building,
10 a signal indicating the energy or power consumption of a heating or cooling device
   providing temperature control within the building is received. The heating or cooling
   device may be heating or cooling an area of the building within about 50 feet of a
   tintable window.
           In some embodiments, the output signals received include a signal from an
15 exterior photosensor, a signal from an interior photosensor, a signal from an
   occupancy sensor, and an energy or power consumption signal (i.e., level 3). The
   energy or power consumption signal indicates energy or power consumption by a
   heating system, a cooling system, and/or lighting in the building or by room in the
   building. The relationship employed to determine the level of tint reduces energy
20 consumption by a heating system, a cooling system, and/or lighting in the building
   while providing conditions suitable for occupancy of the building.
           Instructions are then provided to change the tint of the tintable window to the
   determined level of tint. For example, referring to Figure 11, this may include master
   network controller 1103 issuing commands to one or more intermediate network
25 controllers 1105 a and 1 105b, which in turn issue commands to end controllers 1110
   that control each window of the building. End controllers 1100 may apply voltage
   and/or current to the window to drive the change in tint pursuant to the instructions.
           In some embodiments, a building including electrochromic windows and a
   BMS may be enrolled in or participate in a program run by the utility or utilities
30 providing power to the building. The program may be a program in which the energy
   consumption of the building is reduced when a peak load occurrence is expected. The
   utility may send out a warning signal prior to an expected peak load occurrence. For
   example, the warning may be sent on the day before, the morning of, or about one
   hour before the expected peak load occurrence. A peak load occurrence may be

   expected to occur on a hot summer day when cooling systems/air conditioners are
   drawing a large amount of power from the utility, for example. The warning signal
   may be received by the BMS of the building or by window controllers configured to
   control the electrochromic windows in the building. The BMS can then instruct the
 5 window controller(s) to transition the appropriate electrochromic windows to a
   colored state to aid in reducing the power draw of the cooling systems in the building
   at the time when the peak load is expected.
            In some embodiments, tintable windows for the exterior windows of the
   building (i.e., windows separating the interior of the building from the exterior of the
10 building), may be grouped in zones, with tintable windows in a zone being instructed
   in a similar manner. For example, groups of electrochromic windows on different
   floors of the building or different sides of the building may be in different zones. For
   example, on the first floor of the building, all of the east facing electrochromic
   windows may be in zone 1, all of the south facing electrochromic windows may be in
15 zone 2, all of the west facing electrochromic windows may be in zone 3, and all of the
   north facing electrochromic windows may be in zone 4. As another example, all of
   the electrochromic windows on the first floor of the building may be in zone 1, all of
   the electrochromic windows on the second floor may be in zone 2, and all of the
   electrochromic windows on the third floor may be in zone 3. As yet another example,
20 all of the east facing electrochromic windows may be in zone 1, all of the south facing
   electrochromic windows may be in zone 2, all of the west facing electrochromic
   windows may be in zone 3, and all of the north facing electrochromic windows may
   be in zone 4. As yet another example, east facing electrochromic windows on one
   floor could be divided into different zones. Any number of tintable windows on the
25 same side and/or different sides and/or different floors of the building may be
   assigned to a zone.
            In some embodiments, electrochromic windows in a zone may be controlled
   by the same window controller. In some other embodiments, electrochromic
   windows in a zone may be controlled by different window controllers, but the window
30 controllers may all receive the same output signals from sensors and use the same
   function or lookup table to determine the level of tint for the windows in a zone.
            In some embodiments, electrochromic windows in a zone may be controlled
   by a window controller or controllers that receive an output signal from a
   transmissivity sensor. In some embodiments, the transmissivity sensor may be
                                                114

   mounted proximate the windows in a zone. For example, the transmissivity sensor
   may be mounted in or on a frame containing an IGU (e.g., mounted in or on a
   mullion, the horizontal sash of a frame) included in the zone. In some other
   embodiments, electrochromic windows in a zone that includes the windows on a
 5 single side of the building may be controlled by a window controller or controllers
   that receive an output signal from a transmissivity sensor.
           In some embodiments, a transmissivity sensor may provide an output signal to
   a window controller to control the electrochromic windows of a first zone (e.g., a
   master control zone). The window controller may also control the electrochromic
10 windows in a second zone (e.g., a slave control zone) in the same manner as the first
   zone. In some other embodiments, another window controller may control the
   electrochromic windows in the second zone in the same manner as the first zone.
           In some embodiments, a building manager, occupants of rooms in the second
   zone, or other person may manually instruct (using a tint or clear command or a
15 command from a user console of a BMS, for example) the electrochromic windows in
   the second zone (i.e., the slave control zone) to enter a tint state or a clear state. In
   some embodiments, when the tint state of the windows in the second zone is
   overridden with such a manual command, the electrochromic windows in the first
   zone (i.e., the master control zone) remain under control of the window controller
20 receiving output from the transmissivity sensor. The second zone may remain in a
   manual command mode for a period of time and then revert back to be under control
   of the window controller receiving output from the transmissivity sensor. For
   example, the second zone may stay in a manual mode for one hour after receiving an
   override command, and then may revert back to be under control of the window
25 controller receiving output from the transmissivity sensor.
           In some embodiments, a building manager, occupants of rooms in the first
   zone, or other person may manually instruct (using a tint command or a command
   from a user console of a BMS, for example) the electrochromic windows in the first
   zone (i.e., the master control zone) to enter a tint state or a clear state. In some
30 embodiments, when the tint state of the windows in the first zone is overridden with
   such a manual command, the electrochromic windows in the second zone (i.e., the
   slave control zone) remain under control of the window controller receiving outputs
   from the exterior photosensor. The first zone may remain in a manual command
   mode for a period of time and then revert back to be under control of window

   controller receiving output from the transmissivity sensor. For example, the first zone
   may stay in a manual mode for one hour after receiving an override command, and
   then may revert back to be under control of the window controller receiving output
   from the transmissivity sensor. In some other embodiments, the electrochromic
 5 windows in the second zone may remain in the tint state that they are in when the
   manual override for the first zone is received. The first zone may remain in a manual
   command mode for a period of time and then both the first zone and the second zone
   may revert back to be under control of the window controller receiving output from
   the transmissivity sensor.
10         Any of the methods described herein of control of a tintable window,
   regardless of whether the window controller is a standalone window controller or is
   interfaced with a building network, may be used control the tint of a tintable window.
   Wireless or Wired Communication
15         In some embodiments, window controllers described herein include
   components for wired or wireless communication between the window controller,
   sensors, and separate communication nodes. Wireless or wired communications may
   be accomplished with a communication interface that interfaces directly with the
   window controller. Such interface could be native to the microprocessor or provided
20 via additional circuitry enabling these functions.
           A separate communication node for wireless communications can be, for
   example, another wireless window controller, an end, intermediate, or master window
   controller, a remote control device, or a BMS. Wireless communication is used in the
   window controller for at least one of the following operations: programming and/or
25 operating the EC window, collecting data from the EC window from the various
   sensors and protocols described herein, and using the EC window as a relay point for
   wireless communication. Data collected from EC windows also may include count
   data such as number of times an EC device has been activated, efficiency of the EC
   device over time, and the like. These wireless communication features is described in
30 more detail below.
           In one embodiment, wireless communication is used to operate the associated
   electrochromic windows, for example, via an infrared (IR), and/or radio frequency
   (RF) signal. In certain embodiments, the controller will include a wireless protocol
   chip, such as Bluetooth, EnOcean,WiFi, Zigbee, and the like. Window controllers

   may also have wireless communication via a network. Input to the window controller
   can be manually input by a user, either directly or via wireless communication, or the
   input can be from a BMS of a building of which the electrochromic window is a
   component.
 5          In one embodiment, when the window controller is part of a distributed
   network of controllers, wireless communication is used to transfer data to and from
   each of a plurality of electrochromic windows via the distributed network of
   controllers, each having wireless communication components. For example, referring
   again to Figure 11, master network controller 1103, communicates wirelessly with
10 each of intermediate network controllers 1105 a and 1 105b, which in turn
   communicate wirelessly with end controllers 1110, each associated with an
   electrochromic window. Master network controller 1103 may also communicate
   wirelessly with the BMS. In one embodiment, at least one level of communication in
   the window controller is performed wirelessly.
15          In some embodiments, more than one mode of wireless communication is used
   in the window controller distributed network. For example, a master window
   controller may communicate wirelessly to intermediate controllers via WiFi or
   Zigbee, while the intermediate controllers communicate with end controllers via
   Bluetooth, Zigbee, EnOcean, or other protocol. In another example, window
20 controllers have redundant wireless communication systems for flexibility in end user
   choices for wireless communication.
            Wireless communication between, for example, master and/or intermediate
   window controllers and end window controllers offers the advantage of obviating the
   installation of hard communication lines. This is also true for wireless
25 communication between window controllers and BMS. In one aspect, wireless
   communication in these roles is useful for data transfer to and from electrochromic
   windows for operating the window and providing data to, for example, a BMS for
   optimizing the environment and energy savings in a building. Window location data
   as well as feedback from sensors are synergized for such optimization. For example,
30 granular level (window-by-window) microclimate information is fed to a BMS in
   order to optimize the building's various environments.
            Although the foregoing disclosed embodiments have been described in some
   detail to facilitate understanding, the described embodiments are to be considered
   illustrative and not limiting. It will be apparent to one of ordinary skill in the art that

certain changes and modifications can be practiced within the scope of the appended
claims.

                                                      39
CLAIMS:
1.        A method of controlling at least one tintable window located between an interior and
exterior of a facility, wherein the level of tinting in the at least one tintable window can be
controlled automatically, the method comprising:
         (a) receiving output signals from any two or more sensors selected from the group consisting
of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the at least one tintable
window from the exterior, wherein receiving the output signals comprises receiving sensor output
signals from a network comprising multiple window controllers configured to receive the output
signals and provide instructions to the at least one tintable window, wherein the output signal of at
least one of the two or more sensors is received at the multiple window controllers;
         (b) determining a level of tint for said at least one tintable window using the received output
signals; and
         (c) providing instructions to change the tint of the at least one tintable window to the level of
tint determined in (b).
2.         The method of claim 1, wherein receiving the output signals comprises receiving sensor
output signals from any two or more of the sensors at the multiple window controllers.
3.         The method of claim 1, wherein the network comprises a building management system.
4.        The method of claim 1, wherein receiving the output signals comprises receiving sensor
output signals produced by sensors outside a room containing the at least one tintable window.
5.        The method of claim 1, wherein receiving output signals comprises receiving an output
signal from the exterior photosensor, and wherein the exterior photosensor is located on the roof of a
building having the at least one tintable window.

                                                   40
6.       The method of claim 1, wherein receiving output signals comprises receiving an output
signal from the transmissivity sensor, and wherein the transmissivity sensor is outside a room
containing the at least one tintable window.
7.       The method of claim 1, wherein receiving output signals comprises receiving an output
signal from more than one exterior photosensor, the method further comprising comparing output
signals from the exterior photosensors to one another.
8.       The method of claim 7, further comprising, from the comparison, determining whether one
of the exterior photosensors is shaded.
9.       The method of claim 1, wherein receiving output signals comprises receiving an output
signal from an exterior photosensor on each side of the facility.
10.      The method of claim 9, further comprising tracking irradiance and/or illuminance on a side
of the building as the sun changes position throughout a day.
11.      The method of claim 1, wherein receiving output signals comprises receiving an output
signal via wireless communication.
12.      The method of claim 1, wherein the two or more sensors comprise an exterior photosensor,
and wherein the at least one tintable window is in a zone comprising multiple tintable windows, and
further comprising determining a level of tint for the multiple tintable windows using output signals
from the exterior photosensor.
13.      The method of claim 1, wherein receiving the output signals comprises receiving output
signals from sensors associated with a zone of tintable windows.
14.      The method of claim 1, wherein the multiple window controllers comprise (i) a master
and/or intermediate window controller and (ii) an end window controller, and wherein the master

                                                    41
and/or intermediate window controller and end window controller communicate by wireless
communication.
15.       A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
        (a) a processor or control circuit;
        (b) at least one input configured to receive output signals from one or more sensors over a
network;
        (c) instructions for (i) causing the processor or control circuit to determine a level of tint in a
tintable window by using the output signals from any two or more sensors selected from the group
consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior
temperature sensor, and a transmissivity sensor which detects light passing through the tintable
window from the exterior, and (ii) comparing the output signals from more than one exterior
photosensor; and
        (d) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
16.       The controller of claim 15, wherein the controller is configured to receive the output signals
from any two or more of the sensors through the network.
17.       The controller of claim 15, wherein the output signals are sensor output signals produced by
one or more sensors outside a room containing the at least one tintable window.
18.       The controller of claim 15, wherein the output signals comprise a sensor output signal from
an exterior photosensor located on a roof of a building having the at least one tintable window.
19.       The controller of claim 15, wherein the output signals comprise a sensor output signal from
a transmissivity sensor outside a room containing the at least one tintable window.

                                                     42
20.        A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
         (a) a processor or control circuit;
         (b) at least one input configured to receive output signals from one or more sensors over a
network;
         (c) instructions for causing the processor or control circuit to determine a level of tint in said
at least one tintable window by using the output signals from any two or more sensors selected from
the group consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an
exterior temperature sensor, and a transmissivity sensor which detects light passing through the at
least one tintable window from the exterior,
         further comprising instructions for causing the processor or control circuit to compare the
output signals from more than one exterior photosensor; and
          further comprising instructions for determining the level of tint for a zone of tintable
windows using output signals from sensors associated with the zone of tintable windows; and
         (d) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
21.        The controller of claim 20, further comprising instructions for causing the processor or
control circuit to determine whether one of the exterior photosensors is shaded based on the
comparison.
22.        The controller of claim 20, wherein the output signals comprise a sensor output signal from
an exterior photosensor on each side of the facility.
23.        The controller of claim 22, wherein the controller is configured to use output signals from
the exterior photosensor on each side of the facility to track irradiance and/or illuminance on the
side of the building as the sun changes position throughout a day.
24.        The controller of claim 20, wherein the instructions for causing the processor or control
circuit to determine the level of tint comprises instructions for determining the level of tint for a

                                                       43
zone of tintable windows using output signals from sensors associated with the zone of tintable
windows.
25.        A method of controlling at least one tintable window between an interior and exterior of a
facility, wherein the level of tinting in the at least one tintable window can be controlled
automatically, the method comprising:
           (a) receiving output signals from an exterior photosensor and/or an interior photosensor
comprising a photovoltaic cell, wherein receiving the output signals comprises receiving sensor
output signals from a network comprising multiple window controllers configured to receive the
output signals and provide instructions to the at least one tintable window, wherein the output signal
of at least one of the two or more sensors is received at the multiple window controllers;
           (b) determining a level of tint for said at least one tintable window using a relationship
between the received output signals and the level of tint; and
           (c) providing instructions to change the tint of the at least one tintable window to the level
of tint determined in (b).
26.        The method of claim 25, wherein the network comprises windows and window controllers.
27.        The method of claim 26, wherein the network comprises a building management system.
28.        The method of claim 26, wherein at least one of the multiple window controllers is
configured to receive the output signals and provide instructions to the at least one tintable window.
29.        A method of controlling at least one tintable window located between an interior and
exterior of a facility, wherein the level of tinting in the at least one tintable window can be
controlled automatically, the method comprising:
         (a) receiving output signals from any two or more sensors,
                  wherein a first of the sensors is selected from the group consisting of an exterior
photosensor, an interior photosensor, an occupancy sensor, an exterior temperature sensor, and a
transmissivity sensor which detects light passing through the tintable window from the exterior,

                                                      44
                 wherein a second of the sensors is an exterior photosensor located on the roof of a
building having the tintable window,
                 wherein receiving the output signals comprises receiving sensor output signals from a
network comprising multiple window controllers configured to receive the output signals and
provide instructions to the at least one tintable window, and
                 wherein the output signal of at least one of the two or more sensors is received at the
multiple window controllers;
         (b) determining a level of tint for said at least one tintable window using the received output
signals; and
         (c) providing instructions to change the tint of the at least one tintable window to the level of
tint determined in (b).
30.       The method of claim 29, wherein the network comprises (i) a master and/or intermediate
window controller and (ii) an end window controller, and wherein the master and/or intermediate
window controller and end window controller communicate by wireless communication.
31.        The method of claim 29, wherein receiving output signals comprises receiving an output
signal from more than one exterior photosensor, the method further comprising (i) comparing output
signals from the exterior photosensors to one another, and (ii) from the comparison, determining
whether one of the exterior photosensors is shaded.
32.        A method of controlling at least one tintable window located between an interior and
exterior of a facility, wherein the level of tinting in the at least one tintable window can be
controlled automatically, the method comprising:
         (a) receiving output signals from more than one exterior photosensor, wherein receiving the
output signals comprises receiving sensor output signals from a network;
         (b) comparing output signals from the exterior photosensors to one another;
         (c) determining a level of tint for said at least one tintable window using the received output
signals; and
         (d) providing instructions to change the tint of the at least one tintable window to the level of
tint determined in (c).

                                                     45
33.       The method of claim 32, further comprising, from the comparison, determining whether
one of the exterior photosensors is shaded.
34.       The method of claim 32, wherein the network comprises a window controller configured to
receive the output signals and provide instructions to the at least one tintable window.
35.       The method of claim 32, further comprising receiving the output signal of at least one of the
two or more sensors at multiple window controllers.
36.       The method of claim 32, wherein receiving the output signals comprises receiving sensor
output signals produced by sensors outside a room containing the at least one tintable window.
37.       The method of claim 32, wherein receiving output signals comprises receiving an output
signal from at least one of the exterior photosensors, and wherein the at least one exterior
photosensor is located on the roof of a building having the at least one tintable window.
38.       The method of claim 32, wherein receiving output signals further comprises receiving an
output signal from a transmissivity sensor.
39.       The method of claim 32, further comprising tracking irradiance and/or illuminance on a
side of the building as the sun changes position throughout a day.
40.       The method of claim 32, wherein receiving the output signals comprises receiving output
signals from sensors associated with a zone of tintable windows.
41.      A method of controlling at least one tintable window located between an interior and
exterior of a facility, wherein the level of tinting in the at least one tintable window can be
controlled automatically, the method comprising:
        (a) receiving output signals from an exterior photosensor on each side of the facility, wherein
receiving the output signals comprises receiving sensor output signals from a network comprising

                                                      46
multiple window controllers configured to receive the output signals and provide instructions to the
at least one tintable window;
         (b) determining a level of tint for said at least one tintable window using the received output
signals; and
         (c) providing instructions to change the tint of the at least one tintable window to the level of
tint determined in (b).
42.        The method of claim 41, further comprising (i) comparing output signals from two or more
exterior photosensors, and (ii) from the comparison, determining whether one of the exterior
photosensors is shaded.
43.       A method of controlling at least one tintable window located between an interior and
exterior of a facility, wherein the level of tinting in the at least one tintable window can be
controlled automatically, the method comprising:
         (a) receiving output signals from any two or more sensors selected from the group consisting
of an exterior photosensor, an interior photosensor, an occupancy sensor, an exterior temperature
sensor, and a transmissivity sensor which detects light passing through the tintable window from the
exterior, wherein the output signals comprise output signals from sensors associated with a zone
comprising multiple tintable windows,
                 wherein receiving the output signals comprises receiving the sensor output signal
from a network comprising multiple window controllers configured to receive the output signals and
provide instructions to the at least one tintable window, and wherein the output signals at least one
of the two or more sensors are received at the multiple window controllers;
         (b) determining a level of tint for said at least one tintable window using the received output
signals; and
         (c) providing instructions to change the tint of the at least one tintable window to the level of
tint determined in (b).
44.        The method of claim 43, wherein receiving output signals comprises receiving an output
signal from more than one exterior photosensor, the method further comprising (i) comparing output
signals from the exterior photosensors to one another, and (ii) from the comparison, determining

                                                     47
whether one of the exterior photosensors is shaded.
45.        A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
         (a) a processor or control circuit;
         (b) at least one input configured to receive output signals from one or more sensors over a
network;
         (c) instructions for causing the processor or control circuit to determine a level of tint in the
at least one tintable window by using the output signals from any two or more sensors selected from
the group consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an
exterior temperature sensor, and a transmissivity sensor which detects light passing through the at
least one tintable window from the exterior, wherein the output signals comprise a sensor output
signal from an exterior photosensor located on a roof of a building having the at least one tintable
window;
         (d) instructions for causing the processor or control circuit to (i) compare the output signals
from more than one exterior photosensor, and (ii) determine whether one of the exterior
photosensors is shaded based on the comparison; and
         (e) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
46.        A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
         (a) a processor or control circuit;
         (b) at least one input configured to receive output signals from one or more sensors over a
network of controllers comprising (i) a master and/or intermediate window controller and (ii) an end
window controller, and wherein the master and/or intermediate window controller and end window
controller are configured to communicate by wireless communication;
         (c) instructions for causing the processor or control circuit to determine a level of tint in the
at least one tintable window by using the output signals from any two or more sensors selected from
the group consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an
exterior temperature sensor, and a transmissivity sensor which detects light passing through the

                                                     48
tintable window from the exterior, wherein the output signals comprise a sensor output signal from
an exterior photosensor located on a roof of the facility having the at least one tintable window; and
         (d) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
47.       A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
         (a) a processor or control circuit;
         (b) at least one input configured to receive output signals from one or more sensors over a
network of controllers comprising (i) a master and/or intermediate window controller and (ii) an end
window controller, and wherein the master and/or intermediate window controller and end window
controller are configured to communicate by wireless communication;
         (c) instructions for causing the processor or control circuit to determine a level of tint in the
at least one tintable window by using the output signals from any two or more sensors selected from
the group consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an
exterior temperature sensor, and a transmissivity sensor which detects light passing through the
tintable window from the exterior, wherein the output signals comprise sensor output signals from
an exterior photosensor on each side of the facility; and
         (d) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
48.       A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
         (a) a processor or control circuit;
         (b) at least one input configured to receive output signals from one or more sensors over a
network;
         (c) instructions for causing the processor or control circuit to determine a level of tint in the
at least one tintable window by using the output signals from any two or more sensors selected from
the group consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an
exterior temperature sensor, and a transmissivity sensor which detects light passing through the at
least one tintable window from the exterior;

                                                     49
         (d) instructions for determining the level of tint for a zone of tintable windows using output
signals from sensors associated with the zone of tintable windows;
         (e) instructions for causing the processor or control circuit to (i) compare the output signals
from more than one exterior photosensor, and (ii) determine whether one of the exterior
photosensors is shaded based on the comparison; and
         (f) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
49.        A controller for at least one tintable window in a facility, the at least one tintable window
between an interior and exterior of the facility, the controller comprising:
         (a) a processor or control circuit;
         (b) at least one input configured to receive output signals from one or more sensors over a
network of controllers comprising (i) a master and/or intermediate window controller and (ii) an end
window controller, and wherein the master and/or intermediate window controller and end window
controller are configured to communicate by wireless communication;
         (c) instructions for causing the processor or control circuit to determine a level of tint in the
at least one tintable window by using the output signals from any two or more sensors selected from
the group consisting of an exterior photosensor, an interior photosensor, an occupancy sensor, an
exterior temperature sensor, and a transmissivity sensor which detects light passing through the
tintable window from the exterior,
          further comprising instructions for determining the level of tint for a zone of tintable
windows using output signals from sensors associated with the zone of tintable windows; and
         (d) at least one output configured to control, directly or indirectly, the level of tint in the at
least one tintable window.
                                                  View, Inc.
                                    Patent Attorneys for the Applicant
                                        SPRUSON & FERGUSON

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
