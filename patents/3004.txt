                                             ABSTRACT
      An audio encoding method and an apparatus are provided. The method includes: determining
sparseness of distribution, on spectrums, of energy of N input audio frames, where the N audio frames
include a current audio frame, and N is a positive integer; and determining, according to the
sparseness of distribution, on the spectrums, of the energy of the N audio frames, whether to use a
first encoding method or a second encoding method to encode the current audio frame, where the first
encoding method is an encoding method that is based on time-frequency transform and transform
coefficient quantization and that is not based on linear prediction, and the second encoding method is
a linear-predication-based encoding method. According to the method, when an audio frame is
encoded, sparseness of distribution, on a spectrum, of energy of the audio frame is considered, which
can reduce encoding complexity and ensure that encoding is of relatively high accuracy.

                                   1/1
Determine sparseness of distribution, on spectrums, of energy of N 101
                        input audio frames
   Determine, according to the sparseness of distribution, on the  102
 spectrums, of the energy of the N audio frames, whether to use a
 first encoding method or a second encoding method to encode a
                        current audio frame
                                 FIG. 1
                                                   200
                          Apparatus
                                                   201
                                   unit
                       Obtaining
                      Determining unit             202
                                 FIG. 2
                                                    300
                                 Apparatus
                                             301
                               Processor        Bus system
                                                     303
                                  302
                  Memory
                                 FIG. 3

                AUDIO ENCODING METHOD AND APPARATUS
                                        TECHNICAL FIELD
[0001]      Embodiments of the present invention relate to the field of signal processing technologies,
and more specifically, to an audio encoding method and an apparatus.
                                          BACKGROUND
[0002]      In the prior art, a hybrid encoder is usually used to encode an audio signal in a voice
communications system. Specifically, the hybrid encoder usually includes two sub encoders. One sub
encoder is suitable to encoding a speech signal, and the other encoder is suitable to encoding a non
speech signal. For a received audio signal, each sub encoder of the hybrid encoder encodes the audio
signal. The hybrid encoder directly compares quality of encoded audio signals to select an optimum
sub encoder. However, such a closed-loop encoding method has high operation complexity.
                                             SUMMARY
[0003]      Embodiments of the present invention provide an audio encoding method and an apparatus,
which can reduce encoding complexity and ensure that encoding is of relatively high accuracy.
[0004]      According to a first aspect, an audio encoding method is provided, where the method
includes: determining sparseness of distribution, on spectrums, of energy of N input audio frames,
where the N audio frames include a current audio frame, and N is a positive integer; and determining,
according to the sparseness of distribution, on the spectrums, of the energy of the N audio frames,
whether to use a first encoding method or a second encoding method to encode the current audio
frame, where the first encoding method is an encoding method that is based on time-frequency
transform and transform coefficient quantization and that is not based on linear prediction, and the
second encoding method is a linear-predication-based encoding method.
[0005]      With reference to the first aspect, in a first possible implementation manner of the first
aspect, the determining sparseness of distribution, on spectrums, of energy of N input audio frames
includes: dividing a spectrum of each of the N audio frames into P spectral envelopes, where P is a
positive integer; and determining a general sparseness parameter according to energy of the P spectral
                                                    1

envelopes of each of the N audio frames, where the general sparseness parameter indicates the
sparseness of distribution, on the spectrums, of the energy of the N audio frames.
[0006]       With reference to the first possible implementation manner of the first aspect, in a second
possible implementation manner of the first aspect, the general sparseness parameter includes a first
minimum bandwidth; the determining a general sparseness parameter according to energy of the P
spectral envelopes of each of the N audio frames includes: determining an average value of minimum
bandwidths, distributed on the spectrums, of first-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, where the average
value of the minimum bandwidths, distributed on the spectrums, of the first-preset-proportion energy
of the N audio frames is the first minimum bandwidth; and the determining, according to the
sparseness of distribution, on the spectrums, of the energy of the N audio frames, whether to use a
first encoding method or a second encoding method to encode the current audio frame includes: when
the first minimum bandwidth is less than a first preset value, determining to use the first encoding
method to encode the current audio frame; or when the first minimum bandwidth is greater than the
first preset value, determining to use the second encoding method to encode the current audio frame.
[0007]       With reference to the second possible implementation manner of the first aspect, in a third
possible implementation manner of the first aspect, the determining an average value of minimum
bandwidths, distributed on the spectrums, of first-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames includes: sorting
the energy of the P spectral envelopes of each audio frame in descending order; determining,
according to the energy, sorted in descending order, of the P spectral envelopes of each of the N audio
frames, a minimum bandwidth, distributed on the spectrum, of energy that accounts for not less than
the first preset proportion of each of the N audio frames; and determining, according to the minimum
bandwidth, distributed on the spectrum, of the energy that accounts for not less than the first preset
proportion of each of the N audio frames, an average value of minimum bandwidths, distributed on
the spectrums, of energy that accounts for not less than the first preset proportion of the N audio
frames.
[0008]       With reference to the first possible implementation manner of the first aspect, in a fourth
possible implementation manner of the first aspect, the general sparseness parameter includes a first
energy proportion; the determining a general sparseness parameter according to energy of the P
spectral envelopes of each of the N audio frames includes: selecting Pi spectral envelopes from the P
spectral envelopes of each of the N audio frames; and determining the first energy proportion
according to energy of the P 1 spectral envelopes of each of the N audio frames and total energy of the
respective N audio frames, where PI is a positive integer less than P; and the determining, according
                                                    2

to the sparseness of distribution, on the spectrums, of the energy of the N audio frames, whether to
use a first encoding method or a second encoding method to encode the current audio frame includes:
when the first energy proportion is greater than a second preset value, determining to use the first
encoding method to encode the current audio frame; or when the first energy proportion is less than
the second preset value, determining to use the second encoding method to encode the current audio
frame.
[0009]       With reference to the fourth possible implementation manner of the first aspect, in a fifth
possible implementation manner of the first aspect, energy of any one of the P1 spectral envelopes is
greater than energy of any one of the other spectral envelopes in the P spectral envelopes except the
Pi spectral envelopes.
[0010]       With reference to the first possible implementation manner of the first aspect, in a sixth
possible implementation manner of the first aspect, the general sparseness parameter includes a
second minimum bandwidth and a third minimum bandwidth; the determining a general sparseness
parameter according to energy of the P spectral envelopes of each of the N audio frames includes:
determining an average value of minimum bandwidths, distributed on the spectrums, of second
preset-proportion energy of the N audio frames and determining an average value of minimum
bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, where the average
value of the minimum bandwidths, distributed on the spectrums, of the second-preset-proportion
energy of the N audio frames is used as the second minimum bandwidth, the average value of the
minimum bandwidths, distributed on the spectrums, of the third-preset-proportion energy of the N
audio frames is used as the third minimum bandwidth, and the second preset proportion is less than
the third preset proportion; and the determining, according to the sparseness of distribution, on the
spectrums, of the energy of the N audio frames, whether to use a first encoding method or a second
encoding method to encode the current audio frame includes: when the second minimum bandwidth
is less than a third preset value and the third minimum bandwidth is less than a fourth preset value,
determining to use the first encoding method to encode the current audio frame; when the third
minimum bandwidth is less than a fifth preset value, determining to use the first encoding method to
encode the current audio frame; or when the third minimum bandwidth is greater than a sixth preset
value, determining to use the second encoding method to encode the current audio frame, where the
fourth preset value is greater than or equal to the third preset value, the fifth preset value is less than
the fourth preset value, and the sixth preset value is greater than the fourth preset value.
[0011]       With reference to the sixth possible implementation manner of the first aspect, in a seventh
possible implementation manner of the first aspect, the determining an average value of minimum
                                                     3

bandwidths, distributed on the spectrums, of second-preset-proportion energy of the N audio frames
and determining an average value of minimum bandwidths, distributed on the spectrums, of third
preset-proportion energy of the N audio frames according to the energy of the P spectral envelopes of
each of the N audio frames includes: sorting the energy of the P spectral envelopes of each audio
frame in descending order; determining, according to the energy, sorted in descending order, of the P
spectral envelopes of each of the N audio frames, a minimum bandwidth, distributed on the spectrum,
of energy that accounts for not less than the second preset proportion of each of the N audio frames;
determining, according to the minimum bandwidth, distributed on the spectrum, of the energy that
accounts for not less than the second preset proportion of each of the N audio frames, an average
value of minimum bandwidths, distributed on the spectrums, of energy that accounts for not less than
the second preset proportion of the N audio frames; determining, according to the energy, sorted in
descending order, of the P spectral envelopes of each of the N audio frames, a minimum bandwidth,
distributed on the spectrum, of energy that accounts for not less than the third preset proportion of
each of the N audio frames; and determining, according to the minimum bandwidth, distributed on
the spectrum, of the energy that accounts for not less than the third preset proportion of each of the N
audio frames, an average value of minimum bandwidths, distributed on the spectrums, of energy that
accounts for not less than the third preset proportion of the N audio frames.
[0012]       With reference to the first possible implementation manner of the first aspect, in an eighth
possible implementation manner of the first aspect, the general sparseness parameter includes a
second energy proportion and a third energy proportion; the determining a general sparseness
parameter according to energy of the P spectral envelopes of each of the N audio frames includes:
selecting P2 spectral envelopes from the P spectral envelopes of each of the N audio frames;
determining the second energy proportion according to energy of the P2 spectral envelopes of each of
the N audio frames and total energy of the respective N audio frames; selecting P3 spectral envelopes
from the P spectral envelopes of each of the N audio frames; and determining the third energy
proportion according to energy of the P3 spectral envelopes of each of the N audio frames and the
total energy of the respective N audio frames, where P2 and P3 are positive integers less than P, and
P2 is less than P3; and the determining, according to the sparseness of distribution, on the spectrums,
of the energy of the N audio frames, whether to use a first encoding method or a second encoding
method to encode the current audio frame includes: when the second energy proportion is greater than
a seventh preset value and the third energy proportion is greater than an eighth preset value,
determining to use the first encoding method to encode the current audio frame; when the second
energy proportion is greater than a ninth preset value, determining to use the first encoding method
                                                     4

to encode the current audio frame; or when the third energy proportion is less than a tenth preset value,
determining to use the second encoding method to encode the current audio frame.
[0013]      With reference to the eighth possible implementation manner of the first aspect, in a ninth
possible implementation manner of the first aspect, the P 2 spectral envelopes are P 2 spectral envelopes
having maximum energy in the P spectral envelopes; and the P 3 spectral envelopes are P 3 spectral
envelopes having maximum energy in the P spectral envelopes.
[0014]      With reference to the first aspect, in a tenth possible implementation manner of the first
aspect, the sparseness of distribution of the energy on the spectrums includes global sparseness, local
sparseness, and short-time burstiness of distribution of the energy on the spectrums.
[0015]      With reference to the tenth possible implementation manner of the first aspect, in an
eleventh possible implementation manner of the first aspect, N is 1, and the N audio frames are the
current audio frame; and the determining sparseness of distribution, on spectrums, of energy of N
input audio frames includes: dividing a spectrum of the current audio frame into       Q sub bands; and
determining a burst sparseness parameter according to peak energy of each     of the Q sub bands of the
spectrum of the current audio frame, where the burst sparseness parameter is used to indicate global
sparseness, local sparseness, and short-time burstiness of the current audio frame.
[0016]      With reference to the eleventh possible implementation manner of the first aspect, in a
twelfth possible implementation manner of the first aspect, the burst sparseness parameter includes:
a global peak-to-average proportion of each of the     Q sub bands, a local peak-to-average proportion
of each of the Q sub bands,  and a short-time energy fluctuation of each of the Q sub   bands, where the
global peak-to-average proportion is determined according to the peak energy in the sub band and
average energy of all the sub bands of the current audio frame, the local peak-to-average proportion
is determined according to the peak energy in the sub band and average energy in the sub band, and
the short-time peak energy fluctuation is determined according to the peak energy in the sub band and
peak energy in a specific frequency band of an audio frame before the audio frame; and the
determining, according to the sparseness of distribution, on the spectrums, of the energy of the N
audio frames, whether to use a first encoding method or a second encoding method to encode the
current audio frame includes: determining whether there is a first sub band in the   Q sub bands,   where
a local peak-to-average proportion of the first sub band is greater than an eleventh preset value, a
global peak-to-average proportion of the first sub band is greater than a twelfth preset value, and a
short-time peak energy fluctuation of the first sub band is greater than a thirteenth preset value; and
when there is the first sub band in the Q sub   bands, determining to use the first encoding method to
encode the current audio frame.
                                                    5

[00171      With reference to the first aspect, in a thirteenth possible implementation manner of the
first aspect, the sparseness of distribution of the energy on the spectrums includes band-limited
characteristics of distribution of the energy on the spectrums.
[0018]      With reference to the thirteenth possible implementation manner of the first aspect, in a
fourteenth possible implementation manner of the first aspect, the determining sparseness of
distribution, on spectrums, of energy of N input audio frames includes: determining a demarcation
frequency of each of the N audio frames; and determining a band-limited sparseness parameter
according to the demarcation frequency of each of the N audio frames.
[0019]      With reference to the fourteenth possible implementation manner of the first aspect, in a
fifteenth possible implementation manner of the first aspect, the band-limited sparseness parameter
is an average value of the demarcation frequencies of the N audio frames; and the determining,
according to the sparseness of distribution, on the spectrums, of the energy of the N audio frames,
whether to use a first encoding method or a second encoding method to encode the current audio
frame includes: when it is determined that the band-limited sparseness parameter of the audio frames
is less than a fourteenth preset value, determining to use the first encoding method to encode the
current audio frame.
[0020]      According to a second aspect, an embodiment of the present invention provides an
apparatus, where the apparatus includes: an obtaining unit, configured to obtain N audio frames,
where the N audio frames include a current audio frame, and N is a positive integer; and a determining
unit, configured to determine sparseness of distribution, on the spectrums, of energy of the N audio
frames obtained by the obtaining unit; and the determining unit is further configured to determine,
according to the sparseness of distribution, on the spectrums, of the energy of the N audio frames,
whether to use a first encoding method or a second encoding method to encode the current audio
frame, where the first encoding method is an encoding method that is based on time-frequency
transform and transform coefficient quantization and that is not based on linear prediction, and the
second encoding method is a linear-predication-based encoding method.
[0021]       With reference to the second aspect, in a first possible implementation manner of the
second aspect, the determining unit is specifically configured to divide a spectrum of each of the N
audio frames into P spectral envelopes, and determine a general sparseness parameter according to
energy of the P spectral envelopes of each of the N audio frames, where P is a positive integer, and
the general sparseness parameter indicates the sparseness of distribution, on the spectrums, of the
energy of the N audio frames.
[0022]      With reference to the first possible implementation manner of the second aspect, in a
second possible implementation manner of the second aspect, the general sparseness parameter
                                                    6

includes a first minimum bandwidth; the determining unit is specifically configured to determine an
average value of minimum bandwidths, distributed on the spectrums, of first-preset-proportion energy
of the N audio frames according to the energy of the P spectral envelopes of each of the N audio
frames, where the average value of the minimum bandwidths, distributed on the spectrums, of the
first-preset-proportion energy of the N audio frames is the first minimum bandwidth; and the
determining unit is specifically configured to: when the first minimum bandwidth is less than a first
preset value, determine to use the first encoding method to encode the current audio frame; and when
the first minimum bandwidth is greater than the first preset value, determine to use the second
encoding method to encode the current audio frame.
[0023]       With reference to the second possible implementation manner of the second aspect, in a
third possible implementation manner of the second aspect, the determining unit is specifically
configured to: sort the energy of the P spectral envelopes of each audio frame in descending order;
determine, according to the energy, sorted in descending order, of the P spectral envelopes of each of
the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that accounts for
not less than the first preset proportion of each of the N audio frames; and determine, according to
the minimum bandwidth, distributed on the spectrum, of the energy that accounts for not less than the
first preset proportion of each of the N audio frames, an average value of minimum bandwidths,
distributed on the spectrums, of energy that accounts for not less than the first preset proportion of
the N audio frames.
[0024]       With reference to the first possible implementation manner of the second aspect, in a
fourth possible implementation manner of the second aspect, the general sparseness parameter
includes a first energy proportion; the determining unit is specifically configured to select P1 spectral
envelopes from the P spectral envelopes of each of the N audio frames, and determine the first energy
proportion according to energy of the P1 spectral envelopes of each of the N audio frames and total
energy of the respective N audio frames, where P1 is a positive integer less than P; and the determining
unit is specifically configured to: when the first energy proportion is greater than a second preset
value, determine to use the first encoding method to encode the current audio frame; and when the
first energy proportion is less than the second preset value, determine to use the second encoding
method to encode the current audio frame.
[0025]       With reference to the fourth possible implementation manner of the second aspect, in a
fifth possible implementation manner of the second aspect, the detennining unit is specifically
configured to determine the P1 spectral envelopes according to the energy of the P spectral envelopes,
where energy of any one of the P1 spectral envelopes is greater than energy of any one of the other
spectral envelopes in the P spectral envelopes except the P1 spectral envelopes.
                                                   7

[00261      With reference to the first possible implementation manner of the second aspect, in a sixth
possible implementation manner of the second aspect, the general sparseness parameter includes a
second minimum bandwidth and a third minimum bandwidth; the determining unit is specifically
configured to determine an average value of minimum bandwidths, distributed on the spectrums, of
second-preset-proportion energy of the N audio frames and determine an average value of minimum
bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, where the average
value of the minimum bandwidths, distributed on the spectrums, of the second-preset-proportion
energy of the N audio frames is used as the second minimum bandwidth, the average value of the
minimum bandwidths, distributed on the spectrums, of the third-preset-proportion energy of the N
audio frames is used as the third minimum bandwidth, and the second preset proportion is less than
the third preset proportion; and the determining unit is specifically configured to: when the second
minimum bandwidth is less than a third preset value and the third minimum bandwidth is less than a
fourth preset value, determine to use the first encoding method to encode the current audio frame;
when the third minimum bandwidth is less than a fifth preset value, determine to use the first encoding
method to encode the current audio frame; and when the third minimum bandwidth is greater than a
sixth preset value, determine to use the second encoding method to encode the current audio frame,
where the fourth preset value is greater than or equal to the third preset value, the fifth preset value is
less than the fourth preset value, and the sixth preset value is greater than the fourth preset value.
[0027]      With reference to the sixth possible implementation manner of the second aspect, in a
seventh possible implementation manner of the second aspect, the determining unit is specifically
configured to: sort the energy of the P spectral envelopes of each audio frame in descending order;
determine, according to the energy, sorted in descending order, of the P spectral envelopes of each of
the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that accounts for
not less than the second preset proportion of each of the N audio frames; determine, according to the
minimum bandwidth, distributed on the spectrum, of the energy that accounts for not less than the
second preset proportion of each of the N audio frames, an average value of minimum bandwidths,
distributed on the spectrums, of energy that accounts for not less than the second preset proportion of
the N audio frames; determine, according to the energy, sorted in descending order, of the P spectral
envelopes of each of the N audio frames, a minimum bandwidth, distributed on the spectrum, of
energy that accounts for not less than the third preset proportion of each of the N audio frames; and
determine, according to the minimum bandwidth, distributed on the spectrum, of the energy that
accounts for not less than the third preset proportion of each of the N audio frames, an average value
                                                    8

of minimum bandwidths, distributed on the spectrums, of energy that accounts for not less than the
third preset proportion of the N audio frames.
[0028]      With reference to the first possible implementation manner of the second aspect, in an
eighth possible implementation manner of the second aspect, the general sparseness parameter
includes a second energy proportion and a third energy proportion; the determining unit is specifically
configured to: select P2 spectral envelopes from the P spectral envelopes of each of the N audio frames,
determine the second energy proportion according to energy of the P2 spectral envelopes of each of
the N audio frames and total energy of the respective N audio frames, select P3 spectral envelopes
from the P spectral envelopes of each of the N audio frames, and determine the third energy proportion
according to energy of the P3 spectral envelopes of each of the N audio frames and the total energy
of the respective N audio frames, where P2 and P3 are positive integers less than P, and P2 is less than
P3 ; and the determining unit is specifically configured to: when the second energy proportion is
greater than a seventh preset value and the third energy proportion is greater than an eighth preset
value, determine to use the first encoding method to encode the current audio frame; when the second
energy proportion is greater than a ninth preset value, determine to use the first encoding method to
encode the current audio frame; and when the third energy proportion is less than a tenth preset value,
determine to use the second encoding method to encode the current audio frame.
[0029]      With reference to the eighth possible implementation manner of the second aspect, in a
ninth possible implementation manner of the second aspect, the determining unit is specifically
configured to determine, from the P spectral envelopes of each of the N audio frames, P2 spectral
envelopes having maximum energy, and determine, from the P spectral envelopes of each of the N
audio frames, P3 spectral envelopes having maximum energy.
[0030]      With reference to the second aspect, in a tenth possible implementation manner of the
second aspect, N is 1, and the N audio frames are the current audio frame; and the determining unit
is specifically configured to divide a spectrum of the current audio frame into       Q sub bands, and
determine a burst sparseness parameter according to peak energy of each       of the Q sub bands of the
spectrum of the current audio frame, where the burst sparseness parameter is used to indicate global
sparseness, local sparseness, and short-time burstiness of the current audio frame.
[0031]      With reference to the tenth possible implementation manner of the second aspect, in an
eleventh possible implementation manner of the second aspect, the determining unit is specifically
configured to determine a global peak-to-average proportion of each of the   Q sub bands, a local peak
to-average proportion of each of the   Q sub  bands, and a short-time energy fluctuation of each of the
Q   sub bands, where the global peak-to-average proportion is determined by the determining unit
according to the peak energy in the sub band and average energy of all the sub bands of the current
                                                    9

audio frame, the local peak-to-average proportion is determined by the determining unit according to
the peak energy in the sub band and average energy in the sub band, and the short-time peak energy
fluctuation is determined according to the peak energy in the sub band and peak energy in a specific
frequency band of an audio frame before the audio frame; and the determining unit is specifically
configured to: determine whether there is a first sub band in the   Q sub  bands, where a local peak-to
average proportion of the first sub band is greater than an eleventh preset value, a global peak-to
average proportion of the first sub band is greater than a twelfth preset value, and a short-time peak
energy fluctuation of the first sub band is greater than a thirteenth preset value; and when there is the
first sub band in the  Q  sub bands, determine to use the first encoding method to encode the current
audio frame.
[0032]      With reference to the second aspect, in a twelfth possible implementation manner of the
second aspect, the determining unit is specifically configured to determine a demarcation frequency
of each of the N audio frames; and the determining unit is specifically configured to determine a
band-limited sparseness parameter according to the demarcation frequency of each of the N audio
frames.
[0033]      With reference to the twelfth possible implementation manner of the second aspect, in a
thirteenth possible implementation manner of the second aspect, the band-limited sparseness
parameter is an average value of the demarcation frequencies of the N audio frames; and the
determining unit is specifically configured to: when it is determined that the band-limited sparseness
parameter of the audio frames is less than a fourteenth preset value, determine to use the first encoding
method to encode the current audio frame.
[0034]      According to the foregoing technical solutions, when an audio frame is encoded,
sparseness of distribution, on a spectrum, of energy of the audio frame is considered, which can
reduce encoding complexity and ensure that encoding is of relatively high accuracy.
                               BRIEF DESCRIPTION OF DRAWINGS
[0035]      To describe the technical solutions in the embodiments of the present invention more
clearly, the following briefly describes the accompanying drawings required for describing the
embodiments of the present invention. Apparently, the accompanying drawings in the following
description show merely some embodiments of the present invention, and a person of ordinary skill
in the art may still derive other drawings from these accompanying drawings without creative efforts.
[0036]      FIG. 1 is a schematic flowchart of an audio encoding method according to an embodiment
of the present invention;
                                                    10

[0037]       FIG. 2 is a structural block diagram of an apparatus according to an embodiment of the
present invention; and
[0038]       FIG. 3 is a structural block diagram of an apparatus according to an embodiment of the
present invention.
                                DESCRIPTION OF EMBODIMENTS
[0039]       The following clearly and completely describes the technical solutions in the embodiments
of the present invention with reference to the accompanying drawings in the embodiments of the
present invention. Apparently, the described embodiments are merely a part rather than all of the
embodiments of the present invention. All other embodiments obtained by a person of ordinary skill
in the art based on the embodiments of the present invention without creative efforts shall fall within
the protection scope of the present invention.
[0040]       FIG. 1 is a schematic flowchart of an audio encoding method according to an embodiment
of the present invention.
[0041]       101: Determine sparseness of distribution, on spectrums, of energy of N input audio
frames, where the N audio frames include a current audio frame, and N is a positive integer.
[0042]       102: Determine, according to the sparseness of distribution, on the spectrums, of the
energy of the N audio frames, whether to use a first encoding method or a second encoding method
to encode the current audio frame, where the first encoding method is an encoding method that is
based on time-frequency transform and transform coefficient quantization and that is not based on
linear prediction, and the second encoding method is a linear-predication-based encoding method.
[0043]       According to the method shown in FIG. 1, when an audio frame is encoded, sparseness of
distribution, on a spectrum, of energy of the audio frame is considered, which can reduce encoding
complexity and ensure that encoding is of relatively high accuracy.
[0044]       During selection of an appropriate encoding method for an audio frame, sparseness of
distribution, on a spectrum, of energy of the audio frame may be considered. There may be three types
of sparseness of distribution, on a spectrum, of energy of an audio frame: general sparseness, burst
sparseness, and band-limited sparseness.
[0045]       Optionally, in an embodiment, an appropriate encoding method may be selected for the
current audio frame by using the general sparseness. In this case, the determining sparseness of
distribution, on spectrums, of energy of N input audio frames includes: dividing a spectrum of each
of the N audio frames into P spectral envelopes, where P is a positive integer; and determining a
general sparseness parameter according to energy of the P spectral envelopes of each of the N audio
                                                    11

frames, where the general sparseness parameter indicates the sparseness of distribution, on the
spectrums, of the energy of the N audio frames.
[0046]       Specifically, an average value of minimum bandwidths, distributed on spectrums, of
specific-proportion energy of N input consecutive audio frames may be defined as the general
sparseness. A smaller bandwidth indicates stronger general sparseness, and a larger bandwidth
indicates weaker general sparseness. In other words, stronger general sparseness indicates that energy
of an audio frame is more centralized, and weaker general sparseness indicates that energy of an audio
frame is more disperse. Efficiency is high when the first encoding method is used to encode an audio
frame whose general sparseness is relatively strong. Therefore, an appropriate encoding method may
be selected by determining general sparseness of an audio frame, to encode the audio frame. To help
determine general sparseness of an audio frame, the general sparseness may be quantized to obtain a
general sparseness parameter. Optionally, when N is 1, the general sparseness is a minimum
bandwidth, distributed on a spectrum, of specific-proportion energy of the current audio frame.
[0047]       Optionally, in an embodiment, the general sparseness parameter includes a first minimum
bandwidth. In this case, the determining a general sparseness parameter according to energy of the P
spectral envelopes of each of the N audio frames includes: determining an average value of minimum
bandwidths, distributed on the spectrums, of first-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, where the average
value of the minimum bandwidths, distributed on the spectrums, of the first-preset-proportion energy
of the N audio frames is the first minimum bandwidth. The determining, according to the sparseness
of distribution, on the spectrums, of the energy of the N audio frames, whether to use a first encoding
method or a second encoding method to encode the current audio frame includes: when the first
minimum bandwidth is less than a first preset value, determining to use the first encoding method to
encode the current audio frame; or when the first minimum bandwidth is greater than the first preset
value, determining to use the second encoding method to encode the current audio frame. Optionally,
in an embodiment, when N is 1, the N audio frames are the current audio frame, and the average value
of the minimum bandwidths, distributed on the spectrums, of the first-preset-proportion energy of the
N audio frames is a minimum bandwidth, distributed on the spectrum, of first-preset-proportion
energy of the current audio frame.
[0048]       A person skilled in the art may understand that, the first preset value and the first preset
proportion may be determined according to a simulation experiment. An appropriate first preset value
and first preset proportion may be determined by means of a simulation experiment, so that a good
encoding effect can be obtained when an audio frame meeting the foregoing condition is encoded by
using the first encoding method or the second encoding method. Generally, a value of the first preset
                                                   12

proportion is generally a number between 0 and 1 and relatively close to 1, for example, 90% or 80%.
The selection of the first preset value is related to the value of the first preset proportion, and also
related to a selection tendency between the first encoding method and the second encoding method.
For example, a first preset value corresponding to a relatively large first preset proportion is generally
greater than a first preset value corresponding to a relatively small first preset proportion. For another
example, a first preset value corresponding to a tendency to select the first encoding method is
generally greater than a first preset value corresponding to a tendency to select the second encoding
method.
[0049]      The determining an average value of minimum bandwidths, distributed on the spectrums,
of first-preset-proportion energy of the N audio frames according to the energy of the P spectral
envelopes of each of the N audio frames includes: sorting the energy of the P spectral envelopes of
each audio frame in descending order; determining, according to the energy, sorted in descending
order, of the P spectral envelopes of each of the N audio frames, a minimum bandwidth, distributed
on the spectrum, of energy that accounts for not less than the first preset proportion of each of the N
audio frames; and determining, according to the minimum bandwidth, distributed on the spectrum,
of the energy that accounts for not less than the first preset proportion of each of the N audio frames,
an average value of minimum bandwidths, distributed on the spectrums, of energy that accounts for
not less than the first preset proportion of the N audio frames. For example, an input audio signal is
a wideband signal sampled at 16 kHz, and the input signal is input in a frame of 20 ins. Each frame
of signal is 320 time domain sampling points. Time-frequency transform is performed on a time
domain signal. For example, time-frequency transform is performed by means of fast Fourier
transform (Fast Fourier Transformation, FFT), to obtain 160 spectral envelopes S(k), that is, 160 FFT
energy spectrum coefficients, where k=0, 1, 2, ... , 159. A minimum bandwidth is found from the
spectral envelopes S(k) in a manner that a proportion that energy on the bandwidth accounts for in
total energy of the frame is the first preset proportion. Specifically, determining a minimum
bandwidth, distributed on a spectrum, of first-preset-proportion energy of an audio frame according
to energy, sorted in descending order, of P spectral envelopes of the audio frame includes: sequentially
accumulating energy of frequency bins in the spectral envelopes S(k) in descending order; and
comparing energy obtained after each time of accumulation with the total energy of the audio frame,
and if a proportion is greater than the first preset proportion, ending the accumulation process, where
a quantity of times of accumulation is the minimum bandwidth. For example, the first preset
proportion is 90%, and if a proportion that an energy sum obtained after 30 times of accumulation
accounts for in the total energy exceeds 90%, a proportion that an energy sum obtained after 29 times
of accumulation accounts for in the total energy is less than 90%, and a proportion that an energy sum
                                                      13

obtained after 31 times of accumulation accounts for in the total energy exceeds the proportion that
the energy sum obtained after 30 times of accumulation accounts for in the total energy, it may be
considered that a minimum bandwidth, distributed on the spectrum, of energy that accounts for not
less than the first preset proportion of the audio frame is 30. The foregoing minimum bandwidth
determining process is executed for each of the N audio frames, to separately determine the minimum
bandwidths, distributed on the spectrums, of the energy that accounts for not less than the first preset
proportion of the N audio frames including the current audio frame, and calculate the average value
of the N minimum bandwidths. The average value of the N minimum bandwidths may be referred to
as the first minimum bandwidth, and the first minimum bandwidth may be used as the general
sparseness parameter. When the first minimum bandwidth is less than the first preset value, it is
determined to use the first encoding method to encode the current audio frame. When the first
minimum bandwidth is greater than the first preset value, it is determined to use the second encoding
method to encode the current audio frame.
[0050]       Optionally, in another embodiment, the general sparseness parameter may include a first
energy proportion. In this case, the determining a general sparseness parameter according to energy
of the P spectral envelopes of each of the N audio frames includes: selecting Pi spectral envelopes
from the P spectral envelopes of each of the N audio frames; and determining the first energy
proportion according to energy of the P1 spectral envelopes of each of the N audio frames and total
energy of the respective N audio frames, where PI is a positive integer less than P. The determining,
according to the sparseness of distribution, on the spectrums, of the energy of the N audio frames,
whether to use a first encoding method or a second encoding method to encode the current audio
frame includes: when the first energy proportion is greater than a second preset value, determining to
use the first encoding method to encode the current audio frame; or when the first energy proportion
is less than the second preset value, determining to use the second encoding method to encode the
current audio frame. Optionally, in an embodiment, when N is 1, the N audio frames are the current
audio frame, and the determining the first energy proportion according to energy of the Pi spectral
envelopes of each of the N audio frames and total energy of the respective N audio frames includes:
determining the first energy proportion according to energy of Pi spectral envelopes of the current
audio frame and total energy of the current audio frame.
[0051]       Specifically, the first energy proportion may be calculated by using the following formula:
                      N
                    Ir(n)
               RI =       N
                                                                                            Formula 1.1
                       E 1(n)
               r(n)= Eai (n)
                       E,1(n)
                                                      14

             where R 1 represents the first energy proportion, EP,(n) represents an energy sum of Pi
selected spectral envelopes in an n* audio frame, Eall(n) represents total energy of the n* audio
frame, and r(n) represents a proportion that the energy of the P1 spectral envelopes of the nth audio
frame in the N audio frames accounts for in the total energy of the audio frame.
[0052]       A person skilled in the art may understand that, the second preset value and selection of
the Pi spectral envelopes may be determined according to a simulation experiment. An appropriate
second preset value, an appropriate value ofP 1, and an appropriate method for selecting the Pi spectral
envelopes may be determined by means of a simulation experiment, so that a good encoding effect
can be obtained when an audio frame meeting the foregoing condition is encoded by using the first
encoding method or the second encoding method. Generally, the value of P1 may be a relatively small
number. For example, Pi is selected in a manner that a proportion of P1 to P is less than 20%. For the
second preset value, a number corresponding to an excessively small proportion is generally not
selected. For example, a number less than 10% is not selected. The selection of the second preset
value is related to the value of Pi and a selection tendency between the first encoding method and the
second encoding method. For example, a second preset value corresponding to relatively large Pi is
generally greater than a second preset value corresponding to relatively small P i. For another example,
a second preset value corresponding to a tendency to select the first encoding method is generally
less than a second preset value corresponding to a tendency to select the second encoding method.
Optionally, in an embodiment, energy of any one of the Pi spectral envelopes is greater than energy
of any one of the remaining (P-P 1 ) spectral envelopes in the P spectral envelopes.
[0053]       For example, an input audio signal is a wideband signal sampled at 16 kHz, and the input
signal is input in a frame of 20 ins. Each frame of signal is 320 time domain sampling points. Time
frequency transform is performed on a time domain signal. For example, time-frequency transform
is performed by means of fast Fourier transform, to obtain 160 spectral envelopes S(k), where k=0,
1, 2, ... , 159. Pi spectral envelopes are selected from the 160 spectral envelopes, and a proportion
that an energy sum of the P1 spectral envelopes accounts for in total energy of the audio frame is
calculated. The foregoing process is executed for each of the N audio frames. That is, a proportion
that an energy sum of the Pi spectral envelopes of each of the N audio frames accounts for in
respective total energy is calculated. An average value of the proportions is calculated. The average
value of the proportions is the first energy proportion. When the first energy proportion is greater than
the second preset value, it is determined to use the first encoding method to encode the current audio
frame. When the first energy proportion is less than the second preset value, it is determined to use
the second encoding method to encode the current audio frame. Energy of any one of the P1 spectral
                                                     15

envelopes is greater than energy of any one of the other spectral envelopes in the P spectral envelopes
except the Pi spectral envelopes. Optionally, in an embodiment, the value of Pi may be 20.
[0054]      Optionally, in another embodiment, the general sparseness parameter may include a
second minimum bandwidth and a third minimum bandwidth. In this case, the determining a general
sparseness parameter according to energy of the P spectral envelopes of each of the N audio frames
includes: determining an average value of minimum bandwidths, distributed on the spectrums, of
second-preset-proportion energy of the N audio frames and determining an average value of minimum
bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, where the average
value of the minimum bandwidths, distributed on the spectrums, of the second-preset-proportion
energy of the N audio frames is used as the second minimum bandwidth, the average value of the
minimum bandwidths, distributed on the spectrums, of the third-preset-proportion energy of the N
audio frames is used as the third minimum bandwidth, and the second preset proportion is less than
the third preset proportion. The determining, according to the sparseness of distribution, on the
spectrums, of the energy of the N audio frames, whether to use a first encoding method or a second
encoding method to encode the current audio frame includes: when the second minimum bandwidth
is less than a third preset value and the third minimum bandwidth is less than a fourth preset value,
determining to use the first encoding method to encode the current audio frame; when the third
minimum bandwidth is less than a fifth preset value, determining to use the first encoding method to
encode the current audio frame; or when the third minimum bandwidth is greater than a sixth preset
value, determining to use the second encoding method to encode the current audio frame. The fourth
preset value is greater than or equal to the third preset value, the fifth preset value is less than the
fourth preset value, and the sixth preset value is greater than the fourth preset value. Optionally, in an
embodiment, when N is 1, the N audio frames are the current audio frame. The determining an average
value of minimum bandwidths, distributed on the spectrums, of second-preset-proportion energy of
the N audio frames as the second minimum bandwidth includes: determining a minimum bandwidth,
distributed on the spectrum, of second-preset-proportion energy of the current audio frame as the
second minimum bandwidth. The determining an average value of minimum bandwidths, distributed
on the spectrums, of third-preset-proportion energy of the N audio frames as the third minimum
bandwidth includes: determining a minimum bandwidth, distributed on the spectrum, of third-preset
proportion energy of the current audio frame as the third minimum bandwidth.
[0055]      A person skilled in the art may understand that, the third preset value, the fourth preset
value, the fifth preset value, the sixth preset value, the second preset proportion, and the third preset
proportion may be determined according to a simulation experiment. Appropriate preset values and
                                                     16

preset proportions may be determined by means of a simulation experiment, so that a good encoding
effect can be obtained when an audio frame meeting the foregoing condition is encoded by using the
first encoding method or the second encoding method.
[0056]      The determining an average value of minimum bandwidths, distributed on the spectrums,
of second-preset-proportion energy of the N audio frames and determining an average value of
minimum bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N audio
frames according to the energy of the P spectral envelopes of each of the N audio frames includes:
sorting the energy of the P spectral envelopes of each audio frame in descending order; determining,
according to the energy, sorted in descending order, of the P spectral envelopes of each of the N audio
frames, a minimum bandwidth, distributed on the spectrum, of energy that accounts for not less than
the second preset proportion of each of the N audio frames; determining, according to the minimum
bandwidth, distributed on the spectrum, of the energy that accounts for not less than the second preset
proportion of each of the N audio frames, an average value of minimum bandwidths, distributed on
the spectrums, of energy that accounts for not less than the second preset proportion of the N audio
frames; determining, according to the energy, sorted in descending order, of the P spectral envelopes
of each of the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that
accounts for not less than the third preset proportion of each of the N audio frames; and determining,
according to the minimum bandwidth, distributed on the spectrum, of the energy that accounts for not
less than the third preset proportion of each of the N audio frames, an average value of minimum
bandwidths, distributed on the spectrums, of energy that accounts for not less than the third preset
proportion of the N audio frames. For example, an input audio signal is a wideband signal sampled
at 16 kHz, and the input signal is input in a frame of 20 ins. Each frame of signal is 320 time domain
sampling points. Time-frequency transform is performed on a time domain signal. For example, time
frequency transform is performed by means of fast Fourier transform, to obtain 160 spectral envelopes
S(k), where k=0, 1, 2, ... , 159. A minimum bandwidth is found from the spectral envelopes S(k) in a
manner that a proportion that energy on the bandwidth accounts for in total energy of the frame is the
second preset proportion. A bandwidth continues to be found from the spectral envelopes S(k) in a
manner that a proportion that energy on the bandwidth accounts for in the total energy is the third
preset proportion. Specifically, determining, according to energy, sorted in descending order, of P
spectral envelopes of the audio frame, a minimum bandwidth, distributed on a spectrum, of energy
that accounts for not less than the second preset proportion of an audio frame and a minimum
bandwidth, distributed on the spectrum, of energy that accounts for not less than the third preset
proportion of the audio frame includes: sequentially accumulating energy of frequency bins in the
spectral envelopes S(k) in descending order. Energy obtained after each time of accumulation is
                                                    17

compared with total energy of the audio frame, and if a proportion is greater than the second preset
proportion, a quantity of times of accumulation is a minimum bandwidth that meets being not less
than the second preset proportion. The accumulation is continued, and if a proportion of energy
obtained after accumulation to the total energy of the audio frame is greater than the third preset
proportion, the accumulation is ended, and a quantity of times of accumulation is a minimum
bandwidth that meets being not less than the third preset proportion. For example, the second preset
proportion is 85%, and the third preset proportion is 95%. If a proportion that an energy sum obtained
after 30 times of accumulation accounts for in the total energy exceeds 85%, it may be considered
that the minimum bandwidth, distributed on the spectrum, of the second-preset-proportion energy of
the audio frame is 30. The accumulation is continued, and if a proportion that an energy sum obtained
after 35 times of accumulation accounts for in the total energy is 95%, it may be considered that the
minimum bandwidth, distributed on the spectrum, of the third-preset-proportion energy of the audio
frame is 35. The foregoing process is executed for each of the N audio frames, to separately determine
the minimum bandwidths, distributed on the spectrums, of the energy that accounts for not less than
the second preset proportion of the N audio frames including the current audio frame and the
minimum bandwidths, distributed on the spectrums, of the energy that accounts for not less than the
third preset proportion of the N audio frames including the current audio frame. The average value of
the minimum bandwidths, distributed on the spectrums, of the energy that accounts for not less than
the second preset proportion of the N audio frames is the second minimum bandwidth. The average
value of the minimum bandwidths, distributed on the spectrums, of the energy that accounts for not
less than the third preset proportion of the N audio frames is the third minimum bandwidth. When the
second minimum bandwidth is less than the third preset value and the third minimum bandwidth is
less than the fourth preset value, it is determined to use the first encoding method to encode the current
audio frame. When the third minimum bandwidth is less than the fifth preset value, it is determined
to use the first encoding method to encode the current audio frame. When the third minimum
bandwidth is greater than the sixth preset value, it is determined to use the second encoding method
to encode the current audio frame.
[0057]      Optionally, in another embodiment, the general sparseness parameter includes a second
energy proportion and a third energy proportion. In this case, the determining a general sparseness
parameter according to energy of the P spectral envelopes of each of the N audio frames includes:
selecting P2 spectral envelopes from the P spectral envelopes of each of the N audio frames;
determining the second energy proportion according to energy of the P 2 spectral envelopes of each of
the N audio frames and total energy of the respective N audio frames; selecting P 3 spectral envelopes
from the P spectral envelopes of each of the N audio frames; and determining the third energy
                                                      18

proportion according to energy of the P 3 spectral envelopes of each of the N audio frames and the
total energy of the respective N audio frames. The determining, according to the sparseness of
distribution, on the spectrums, of the energy of the N audio frames, whether to use a first encoding
method or a second encoding method to encode the current audio frame includes: when the second
energy proportion is greater than a seventh preset value and the third energy proportion is greater than
an eighth preset value, determining to use the first encoding method to encode the current audio frame;
when the second energy proportion is greater than a ninth preset value, determining to use the first
encoding method to encode the current audio frame; or when the third energy proportion is less than
a tenth preset value, determining to use the second encoding method to encode the current audio
frame. P2 and P3 are positive integers less than P, and P 2 is less than P 3. Optionally, in an embodiment,
when N is 1, the N audio frames are the current audio frame. The determining the second energy
proportion according to energy of the P 2 spectral envelopes of each of the N audio frames and total
energy of the respective N audio frames includes: determining the second energy proportion
according to energy of P 2 spectral envelopes of the current audio frame and total energy of the current
audio frame. The determining the third energy proportion according to energy of the P 3 spectral
envelopes of each of the N audio frames and the total energy of the respective N audio frames includes:
determining the third energy proportion according to energy of P3 spectral envelopes of the current
audio frame and the total energy of the current audio frame.
[0058]       A person skilled in the art may understand that, values of P 2 and P-, the seventh preset
value, the eighth preset value, the ninth preset value, and the tenth preset value may be determined
according to a simulation experiment. Appropriate preset values may be determined by means of a
simulation experiment, so that a good encoding effect can be obtained when an audio frame meeting
the foregoing condition is encoded by using the first encoding method or the second encoding method.
Optionally, in an embodiment, the P 2 spectral envelopes may be P2 spectral envelopes having
maximum energy in the P spectral envelopes; and the P 3 spectral envelopes may be P 3 spectral
envelopes having maximum energy in the P spectral envelopes.
[0059]       For example, an input audio signal is a wideband signal sampled at 16 kHz, and the input
signal is input in a frame of 20 ins. Each frame of signal is 320 time domain sampling points. Time
frequency transform is performed on a time domain signal. For example, time-frequency transform
is performed by means of fast Fourier transform, to obtain 160 spectral envelopes S(k), where k=0,
1, 2, ... , 159. P2 spectral envelopes are selected from the 160 spectral envelopes, and a proportion
that an energy sum of the P 2 spectral envelopes accounts for in total energy of the audio frame is
calculated. The foregoing process is executed for each of the N audio frames. That is, a proportion
that an energy sum of the P 2 spectral envelopes of each of the N audio frames accounts for in
                                                     19

respective total energy is calculated. An average value of the proportions is calculated. The average
value of the proportions is the second energy proportion. P 3 spectral envelopes are selected from the
160 spectral envelopes, and a proportion that an energy sum of the P 3 spectral envelopes accounts for
in the total energy of the audio frame is calculated. The foregoing process is executed for each of the
N audio frames. That is, a proportion that an energy sum of the P 3 spectral envelopes of each of the
N audio frames accounts for in the respective total energy is calculated. An average value of the
proportions is calculated. The average value of the proportions is the third energy proportion. When
the second energy proportion is greater than the seventh preset value and the third energy proportion
is greater than the eighth preset value, it is determined to use the first encoding method to encode the
current audio frame. When the second energy proportion is greater than the ninth preset value, it is
determined to use the first encoding method to encode the current audio frame. When the third energy
proportion is less than the tenth preset value, it is determined to use the second encoding method to
encode the current audio frame. The P2 spectral envelopes may be P2 spectral envelopes having
maximum energy in the P spectral envelopes; and the P 3 spectral envelopes may be P 3 spectral
envelopes having maximum energy in the P spectral envelopes. Optionally, in an embodiment, the
value of P2 may be 20, and the value of P 3 may be 30.
[0060]       Optionally, in another embodiment, an appropriate encoding method may be selected for
the current audio frame by using the burst sparseness. For the burst sparseness, global sparseness,
local sparseness, and short-time burstiness of distribution, on a spectrum, of energy of an audio frame
need to be considered. In this case, the sparseness of distribution of the energy on the spectrums may
include global sparseness, local sparseness, and short-time burstiness of distribution of the energy on
the spectrums. In this case, a value of N may be 1, and the N audio frames are the current audio frame.
The determining sparseness of distribution, on spectrums, of energy of N input audio frames includes:
dividing a spectrum of the current audio frame into     Q sub bands; and determining a burst sparseness
parameter according to peak energy of each of the      Q sub bands of the spectrum of the current audio
frame, where the burst sparseness parameter is used to indicate global sparseness, local sparseness,
and short-time burstiness of the current audio frame. The burst sparseness parameter includes: a
global peak-to-average proportion of each of the     Q sub  bands, a local peak-to-average proportion of
each of the   Q sub bands, and a short-time energy fluctuation of each of the     Q sub bands, where the
global peak-to-average proportion is determined according to the peak energy in the sub band and
average energy of all the sub bands of the current audio frame, the local peak-to-average proportion
is determined according to the peak energy in the sub band and average energy in the sub band, and
the short-time peak energy fluctuation is determined according to the peak energy in the sub band and
peak energy in a specific frequency band of an audio frame before the audio frame. The determining,
                                                     20

according to the sparseness of distribution, on the spectrums, of the energy of the N audio frames,
whether to use a first encoding method or a second encoding method to encode the current audio
frame includes: determining whether there is a first sub band in the       Q sub  bands, where a local peak
to-average proportion of the first sub band is greater than an eleventh preset value, a global peak-to
average proportion of the first sub band is greater than a twelfth preset value, and a short-time peak
energy fluctuation of the first sub band is greater than a thirteenth preset value; and when there is the
first sub band in the Q sub   bands, determining to use the first encoding method to encode the current
audio frame. The global peak-to-average proportion of each of the           Q  sub bands, the local peak-to
average proportion of each of the       Q sub bands,    and the short-time energy fluctuation of each of the
Q  sub bands respectively represent the global sparseness, the local sparseness, and the short-time
burstiness.
[0061]      Specifically, the global peak-to-average proportion may be determined by using the
following formula:
            p2s(i) = e(i) /   -*     s(k)                                                      Formula 1.2
            where e(i) represents peak energy of an ith sub band in the      Q sub bands,   s(k) represents
energy of a kth spectral envelope in the P spectral envelopes, and p2s(i) represents a global peak-to
average proportion of the fi*sub band.
[0062]      The local peak-to-average proportion may be determined by using the following formula:
                                                h(i)
                                     1
            p2a(i)  = e(i) /   h           - *       s(k)                                      Formula 1.3
                             (h(i) -1(i) +1    k=ei
            where e(i) represents the peak energy of the fi* sub band in the             Q sub bands, s(k)
represents the energy of the k*h spectral envelope in the P spectral envelopes, h(i) represents an index
of a spectral envelope that is included in the ith sub band and that has a highest frequency,             l(i)
represents an index of a spectral envelope that is included in the ith sub band and that has a lowest
frequency, p2a(i) represents a local peak-to-average proportion of the i* sub band, and h(i) is less
than or equal to P-1.
[0063]      The short-time peak energy fluctuation may be determined by using the following formula:
            dev(i) = (2* e(i)) / (e, + e2 )                                                    Formula 1.4
            where e(i) represents the peak energy of the ith sub band in the       Q sub bands of the current
audio frame, and ei and e2 represent peak energy of specific frequency bands of audio frames before
the current audio frame. Specifically, assuming that the current audio frame is an Mth audio frame, a
spectral envelope in which peak energy of the ith sub band of the current audio frame is located is
                                                         21

determined. It is assumed that the spectral envelope in which the peak energy is located is i1 . Peak
energy within a range from an      (ii-t)th spectral envelope to an  (il+t)h spectral envelope in an (M-1)"
audio frame is determined, and the peak energy is ei. Similarly, peak energy within a range from an
(ii-t)th spectral envelope to an  (il+t)th  spectral envelope in an (M-2)th audio frame is determined, and
the peak energy is   e2.
[0064]       A person skilled in the art may understand that, the eleventh preset value, the twelfth preset
value, and the thirteenth preset value may be determined according to a simulation experiment.
Appropriate preset values may be determined by means of a simulation experiment, so that a good
encoding effect can be obtained when an audio frame meeting the foregoing condition is encoded by
using the first encoding method.
[0065]       Optionally, in another embodiment, an appropriate encoding method may be selected for
the current audio frame by using the band-limited sparseness. In this case, the sparseness of
distribution of the energy on the spectrums includes band-limited sparseness of distribution of the
energy on the spectrums. In this case, the determining sparseness of distribution, on spectrums, of
energy of N input audio frames includes: determining a demarcation frequency of each of the N audio
frames; and determining a band-limited sparseness parameter according to the demarcation frequency
of each N audio frame. The band-limited sparseness parameter may be an average value of the
demarcation frequencies of the N audio frames. For example, an Nith audio frame is any one of the N
audio frames, and a frequency range of the Ni'h audio frame is from Fb to Fe, where Fb is less than Fe.
Assuming that a start frequency is Fb, a method for determining a demarcation frequency of the Nith
audio frame may be searching for a frequency Fs by starting from Fb, where Fs meets the following
conditions: a proportion of an energy sum from Fb to F, to total energy of the Ni1h audio frame is not
less than a fourth preset proportion, and a proportion of an energy sum from Fb to any frequency less
than Fs to the total energy of the Nit audio frame is less than the fourth preset proportion, where Fs is
the demarcation frequency of the Ni' audio frame. The foregoing demarcation frequency determining
step is performed for each of the N audio frames. In this way, the N demarcation frequencies of the
N audio frames may be obtained. The determining, according to the sparseness of distribution, on the
spectrums, of the energy of the N audio frames, whether to use a first encoding method or a second
encoding method to encode the current audio frame includes: when it is determined that the band
limited sparseness parameter of the audio frames is less than a fourteenth preset value, determining
to use the first encoding method to encode the current audio frame.
[0066]       A person skilled in the art may understand that, the fourth preset proportion and the
fourteenth preset value may be determined according to a simulation experiment. An appropriate
preset value and preset proportion may be determined according to a simulation experiment, so that
                                                        22

a good encoding effect can be obtained when an audio frame meeting the foregoing condition is
encoded by using the first encoding method. Generally, a number less than 1 but close to 1, for
example, 95% or 99%, is selected as a value of the fourth preset proportion. For the selection of the
fourteenth preset value, a number corresponding to a relatively high frequency is generally not
selected. For example, in some embodiments, if a frequency range of an audio frame is 0 Hz to 8 kHz,
a number less than a frequency of 5 kHz may be selected as the fourteenth preset value.
[0067]      For example, energy of each of P spectral envelopes of the current audio frame may be
determined, and a demarcation frequency is searched for from a low frequency to a high frequency
in a manner that a proportion that energy that is less than the demarcation frequency accounts for in
total energy of the current audio frame is the fourth preset proportion. Assuming that N is 1, the
demarcation frequency of the current audio frame is the band-limited sparseness parameter. Assuming
that N is an integer greater than 1, it is determined that the average value of the demarcation
frequencies of the N audio frames is the band-limited sparseness parameter. A person skilled in the
art may understand that, the demarcation frequency determining mentioned above is merely an
example. Alternatively, the demarcation frequency determining method may be searching for a
demarcation frequency from a high frequency to a low frequency or may be another method.
[0068]      Further, to avoid frequent switching between the first encoding method and the second
encoding method, a hangover period may be further set. For an audio frame in the hangover period,
an encoding method used for an audio frame at a start position of the hangover period may be used.
In this way, a switching quality decrease caused by frequent switching between different encoding
methods can be avoided.
[0069]      If a hangover length of the hangover period is L, L audio frames after the current audio
frame all belong to a hangover period of the current audio frame. If sparseness of distribution, on a
spectrum, of energy of an audio frame belonging the hangover period is different from sparseness of
distribution, on a spectrum, of energy of an audio frame at a start position of the hangover period, the
audio frame is still encoded by using an encoding method that is the same as that used for the audio
frame at the start position of the hangover period.
[0070]      The hangover period length may be updated according to sparseness of distribution, on a
spectrum, of energy of an audio frame in the hangover period, until the hangover period length is 0.
[0071]      For example, if it is determined to use the first encoding method for an I audio frame and
a length of a preset hangover period is L, the first encoding method is used for an (I+1)th audio frame
to an (I+L)" audio frame. Then, sparseness of distribution, on a spectrum, of energy of the (1+1)th
audio frame is determined, and the hangover period is re-calculated according to the sparseness of
distribution, on the spectrum, of the energy of the (I+1)th audio frame. If the (I+1)th audio frame still
                                                    23

meets a condition of using the first encoding method, a subsequent hangover period is still the preset
hangover period L. That is, the hangover period starts from an (L+ 2 )th audio frame to an (I+I+L)*h
audio frame. If the  (I+1)th audio frame does not meet the condition of using the first encoding method,
the hangover period is re-determined according to the sparseness of distribution, on the spectrum, of
the energy of the (I+1)t* audio frame. For example, it is re-determined that the hangover period is L
LI, where LI is a positive integer less than or equal to L. If LI is equal to L, the hangover period
length is updated to 0. In this case, the encoding method is re-determined according to the sparseness
of distribution, on the spectrum, of the energy of the (I+1)th audio frame. If LI is an integer less than
L, the encoding method is re-determined according to sparseness of distribution, on a spectrum, of
energy of an (I+1+L-L1)* audio frame. However, because the (I+1)th audio frame is in a hangover
period of the I' audio frame, the (I+1)th audio frame is still encoded by using the first encoding
method. LI may be referred to as a hangover update parameter, and a value of the hangover update
parameter may be determined according to sparseness of distribution, on a spectrum, of energy of an
input audio frame. In this way, hangover period update is related to sparseness of distribution, on a
spectrum, of energy of an audio frame.
[0072]       For example, when a general sparseness parameter is determined and the general
sparseness parameter is a first minimum bandwidth, the hangover period may be re-determined
according to a minimum bandwidth, distributed on a spectrum, of first-preset-proportion energy of
an audio frame. It is assumed that it is determined to use the first encoding method to encode the Ih
audio frame, and a preset hangover period is L. A minimum bandwidth, distributed on a spectrum, of
first-preset-proportion energy of each of H consecutive audio frames including the (l+1)th audio frame
is determined, where H is a positive integer greater than 0. If the (I+1)"' audio frame does not meet
the condition of using the first encoding method, a quantity of audio frames whose minimum
bandwidths, distributed on spectrums, of first-preset-proportion energy are less than a fifteenth preset
value (the quantity is briefly referred to as a first hangover parameter) is determined. When a
minimum bandwidth, distributed on a spectrum, of first-preset-proportion energy of an (L+1)th audio
frame is greater than a sixteenth preset value and is less than a seventeenth preset value, and the first
hangover parameter is less than an eighteenth preset value, the hangover period length is subtracted
by 1, that is, the hangover update parameter is 1. The sixteenth preset value is greater than the first
preset value. When the minimum bandwidth, distributed on the spectrum, of the first-preset
proportion energy of the (L+I)th audio frame is greater than the seventeenth preset value and is less
than a nineteenth preset value, and the first hangover parameter is less than the eighteenth preset value,
the hangover period length is subtracted by 2, that is, the hangover update parameter is 2. When the
minimum bandwidth, distributed on the spectrum, of the first-preset-proportion energy of the (L+I)th
                                                    24

audio frame is greaterthan the nineteenth preset value, the hangover period is set to 0. When the first
hangover parameter and the minimum bandwidth, distributed on the spectrum, of the first-preset
proportion energy of the (L+1)h audio frame do not meet one or more of the sixteenth preset value to
the nineteenth preset value, the hangover period remains unchanged.
[0073]      A person skilled in the art may understand that, the preset hangover period may be set
according to an actual status, and the hangover update parameter also may be adjusted according to
an actual status. The fifteenth preset value to the nineteenth preset value may be adjusted according
to an actual status, so that different hangover periods may be set.
[0074]      Similarly, when the general sparseness parameter includes a second minimum bandwidth
and a third minimum bandwidth, or the general sparseness parameter includes a first energy
proportion, or the general sparseness parameter includes a second energy proportion and a third
energy proportion, a corresponding preset hangover period, a corresponding hangover update
parameter, and a related parameter used to determine the hangover update parameter may be set, so
that a corresponding hangover period can be determined, and frequent switching between encoding
methods is avoided.
[0075]      When the encoding method is determined according to the burst sparseness (that is, the
encoding method is determined according to global sparseness, local sparseness, and short-time
burstiness of distribution, on a spectrum, of energy of an audio frame), a corresponding hangover
period, a corresponding hangover update parameter, and a related parameter used to determine the
hangover update parameter may be set, to avoid frequent switching between encoding methods. In
this case, the hangover period may be less than the hangover period that is set in the case of the
general sparseness parameter.
[0076]      When the encoding method is determined according to a band-limited characteristic of
distribution of energy on a spectrum, a corresponding hangover period, a corresponding hangover
update parameter, and a related parameter used to determine the hangover update parameter may be
set, to avoid frequent switching between encoding methods. For example, a proportion of energy of
a low spectral envelope of an input audio frame to energy of all spectral envelopes may be calculated,
and the hangover update parameter is determined according to the proportion. Specifically, the
proportion of the energy of the low spectral envelope to the energy of all the spectral envelopes may
be determined by using the following formula:
                     Is(k)
             RI    =                                                                 Formula 1.5
                     Is(k)
                     k=0
            where RIOW represents the proportion of the energy of the low spectral envelope to the
                                                    25

energy of all the spectral envelopes, s(k) represents energy of a kth spectral envelope, y represents an
index of a highest spectral envelope of a low frequency band, and P indicates that the audio frame is
divided into P spectral envelopes in total. In this case, if Rj0 w is greater than a twentieth preset value,
the hangover update parameter is 0. Otherwise, if Row          is greater than a twenty-first preset value,
the hangover update parameter may have a relatively small value, where the twentieth preset value is
greater than the twenty-first preset value. If Rj0 w is not greater than the twenty-first preset value,
the hangover parameter may have a relatively large value. A person skilled in the art may understand
that, the twentieth preset value and the twenty-first preset value may be determined according to a
simulation experiment, and the value of the hangover update parameter also may be determined
according to an experiment. Generally, a number that is an excessively small proportion is generally
not selected as the twenty-first preset value. For example, a number greater than 50% may be
generally selected. The twentieth preset value ranges between the twenty-first preset value and 1.
[0077]      In addition, when the encoding method is determined according to a band-limited
characteristic of distribution of energy on a spectrum, a demarcation frequency of an input audio
frame may be further determined, and the hangover update parameter is determined according to the
demarcation frequency, where the demarcation frequency may be different from a demarcation
frequency used to determine a band-limited sparseness parameter. If the demarcation frequency is
less than a twenty-second preset value, the hangover update parameter is 0. Otherwise, if the
demarcation frequency is less than a twenty-third preset value, the hangover update parameter has a
relatively small value. The twenty-third preset value is greater than the twenty-second preset value.
If the demarcation frequency is greater than the twenty-third preset value, the hangover update
parameter may have a relatively large value. A person skilled in the art may understand that, the
twenty-second preset value and the twenty-third preset value may be determined according to a
simulation experiment, and the value of the hangover update parameter also may be determined
according to an experiment. Generally, a number corresponding to a relatively high frequency is not
selected as the twenty-third preset value. For example, if a frequency range of an audio frame is 0 Hz
to 8 kHz, a number less than a frequency of 5 kHz may be selected as the twenty-third preset value.
[0078]      FIG. 2 is a structural block diagram of an apparatus according to an embodiment of the
present invention. The apparatus 200 shown in FIG. 2 can perform the steps in FIG. 1. As shown in
FIG. 2, the apparatus 200 includes an obtaining unit 201 and a determining unit 202.
[0079]      The obtaining unit 201 is configured to obtain N audio frames, where the N audio frames
include a current audio frame, and N is a positive integer.
[0080]      The determining unit 202 is configured to determine sparseness of distribution, on the
spectrums, of energy of the N audio frames obtained by the obtaining unit 201.
                                                     26

[0081]       The determining unit 202 is further configured to determine, according to the sparseness
of distribution, on the spectrums, of the energy of the N audio frames, whether to use a first encoding
method or a second encoding method to encode the current audio frame, where the first encoding
method is an encoding method that is based on time-frequency transform and transform coefficient
quantization and that is not based on linear prediction, and the second encoding method is a linear
predication-based encoding method.
[0082]       According to the apparatus shown in FIG. 2, when an audio frame is encoded, sparseness
of distribution, on a spectrum, of energy of the audio frame is considered, which can reduce encoding
complexity and ensure that encoding is of relatively high accuracy.
[0083]       During selection of an appropriate encoding method for an audio frame, sparseness of
distribution, on a spectrum, of energy of the audio frame may be considered. There may be three types
of sparseness of distribution, on a spectrum, of energy of an audio frame: general sparseness, burst
sparseness, and band-limited sparseness.
[0084]       Optionally, in an embodiment, an appropriate encoding method may be selected for the
current audio frame by using the general sparseness. In this case, the determining unit 202 is
specifically configured to divide a spectrum of each of the N audio frames into P spectral envelopes,
and determine a general sparseness parameter according to energy of the P spectral envelopes of each
of the N audio frames, where P is a positive integer, and the general sparseness parameter indicates
the sparseness of distribution, on the spectrums, of the energy of the N audio frames.
[0085]       Specifically, an average value of minimum bandwidths, distributed on spectrums, of
specific-proportion energy of N input consecutive audio frames may be defined as the general
sparseness. A smaller bandwidth indicates stronger general sparseness, and a larger bandwidth
indicates weaker general sparseness. In other words, stronger general sparseness indicates that energy
of an audio frame is more centralized, and weaker general sparseness indicates that energy of an audio
frame is more disperse. Efficiency is high when the first encoding method is used to encode an audio
frame whose general sparseness is relatively strong. Therefore, an appropriate encoding method may
be selected by determining general sparseness of an audio frame, to encode the audio frame. To help
determine general sparseness of an audio frame, the general sparseness may be quantized to obtain a
general sparseness parameter. Optionally, when N is 1, the general sparseness is a minimum
bandwidth, distributed on a spectrum, of specific-proportion energy of the current audio frame.
[0086]       Optionally, in an embodiment, the general sparseness parameter includes a first minimum
bandwidth. In this case, the determining unit 202 is specifically configured to determine an average
value of minimum bandwidths, distributed on the spectrums, of first-preset-proportion energy of the
N audio frames according to the energy of the P spectral envelopes of each of the N audio frames,
                                                   27

where the average value of the minimum bandwidths, distributed on the spectrums, of the first-preset
proportion energy of the N audio frames is the first minimum bandwidth. The determining unit 202
is specifically configured to: when the first minimum bandwidth is less than a first preset value,
determine to use the first encoding method to encode the current audio frame; and when the first
minimum bandwidth is greater than the first preset value, determine to use the second encoding
method to encode the current audio frame.
[0087]      A person skilled in the art may understand that, the first preset value and the first preset
proportion may be determined according to a simulation experiment. An appropriate first preset value
and first preset proportion may be determined by means of a simulation experiment, so that a good
encoding effect can be obtained when an audio frame meeting the foregoing condition is encoded by
using the first encoding method or the second encoding method.
[0088]      The determining unit 202 is specifically configured to: sort the energy of the P spectral
envelopes of each audio frame in descending order; determine, according to the energy, sorted in
descending order, of the P spectral envelopes of each of the N audio frames, a minimum bandwidth,
distributed on the spectrum, of energy that accounts for not less than the first preset proportion of
each of the N audio frames; and determine, according to the minimum bandwidth, distributed on the
spectrum, of the energy that accounts for not less than the first preset proportion of each of the N
audio frames, an average value of minimum bandwidths, distributed on the spectrums, of energy that
accounts for not less than the first preset proportion of the N audio frames. For example, an audio
signal obtained by the obtaining unit 201 is a wideband signal sampled at 16 kHz, and the obtained
audio signal is obtained in a frame of 20 ms. Each frame of signal is 320 time domain sampling points.
The determining unit 202 may perform time-frequency transform on a time domain signal, for
example, perform time-frequency transform by means of fast Fourier transform (Fast Fourier
Transformation, FFT), to obtain 160 spectral envelopes S(k), that is, 160 FFT energy spectrum
coefficients, where k=0, 1, 2, ... , 159. The determining unit 202 may find a minimum bandwidth from
the spectral envelopes S(k) in a manner that a proportion that energy on the bandwidth accounts for
in total energy of the frame is the first preset proportion. Specifically, the determining unit 202 may
sequentially accumulate energy of frequency bins in the spectral envelopes S(k) in descending order;
and compare energy obtained after each time of accumulation with the total energy of the audio frame,
and if a proportion is greater than the first preset proportion, end the accumulation process, where a
quantity of times of accumulation is the minimum bandwidth. For example, the first preset proportion
is 90%, and if a proportion that an energy sum obtained after 30 times of accumulation accounts for
in the total energy exceeds 90%, it may be considered that a minimum bandwidth of energy that
accounts for not less than the first preset proportion of the audio frame is 30. The determining unit
                                                     28

202 may execute the foregoing minimum bandwidth determining process for each of the N audio
frames, to separately determine the minimum bandwidths of the energy that accounts for not less than
the first preset proportion of the N audio frames including the current audio frame. The determining
unit 202 may calculate an average value of the minimum bandwidths of the energy that accounts for
not less than the first preset proportion of the N audio frames. The average value of the minimum
bandwidths of the energy that accounts for not less than the first preset proportion of the N audio
frames may be referred to as the first minimum bandwidth, and the first minimum bandwidth may be
used as the general sparseness parameter. When the first minimum bandwidth is less than the first
preset value, the determining unit 202 may determine to use the first encoding method to encode the
current audio frame. When the first minimum bandwidth is greater than the first preset value, the
determining unit 202 may determine to use the second encoding method to encode the current audio
frame.
[0089]       Optionally, in another embodiment, the general sparseness parameter may include a first
energy proportion. In this case, the determining unit 202 is specifically configured to select P1 spectral
envelopes from the P spectral envelopes of each of the N audio frames, and determine the first energy
proportion according to energy of the Pi spectral envelopes of each of the N audio frames and total
energy of the respective N audio frames, where Pi is a positive integer less than P. The determining
unit 202 is specifically configured to: when the first energy proportion is greater than a second preset
value, determine to use the first encoding method to encode the current audio frame; and when the
first energy proportion is less than the second preset value, determine to use the second encoding
method to encode the current audio frame. Optionally, in an embodiment, when N is 1, the N audio
frames are the current audio frame, and the determining unit 202 is specifically configured to
determine the first energy proportion according to energy of Pi spectral envelopes of the current audio
frame and total energy of the current audio frame. The determining unit 202 is specifically configured
to determine the Pi spectral envelopes according to the energy of the P spectral envelopes, where
energy of any one of the PI spectral envelopes is greater than energy of any one of the other spectral
envelopes in the P spectral envelopes except the P1 spectral envelopes.
[0090]       Specifically, the determining unit 202 may calculate the first energy proportion by using
the following formula:
                      N
                    Ir(n)
              RI          N                                                                 Formula 1.6
              r(n) = EP, (n)
                       Ea, (n)
             where R 1 represents the first energy proportion, E,(n) represents an energy sum of Pi
                                                    29

selected spectral envelopes in an nth audio frame, E all (n) represents total energy of the nh audio
frame, and r(n) represents a proportion that the energy of the P1 spectral envelopes of the ni audio
frame in the N audio frames accounts for in the total energy of the audio frame.
[0091]       A person skilled in the art may understand that, the second preset value and selection of
the Pi spectral envelopes may be determined according to a simulation experiment. An appropriate
second preset value, an appropriate value of P 1, and an appropriate method for selecting the Pi spectral
envelopes may be determined by means of a simulation experiment, so that a good encoding effect
can be obtained when an audio frame meeting the foregoing condition is encoded by using the first
encoding method or the second encoding method. Optionally, in an embodiment, the P 1 spectral
envelopes may be Pi spectral envelopes having maximum energy in the P spectral envelopes.
[0092]       For example, an audio signal obtained by the obtaining unit 201 is a wideband signal
sampled at 16 kHz, and the obtained audio signal is obtained in a frame of 20 ms. Each frame of
signal is 320 time domain sampling points. The determining unit 202 may perform time-frequency
transform on a time domain signal, for example, perform time-frequency transform by means of fast
Fourier transform, to obtain 160 spectral envelopes S(k), where k=0, 1, 2, ... , 159. The determining
unit 202 may select P1 spectral envelopes from the 160 spectral envelopes, and calculate a proportion
that an energy sum of the Pi spectral envelopes accounts for in total energy of the audio frame. The
determining unit 202 may execute the foregoing process for each of the N audio frames, that is,
calculate a proportion that an energy sum of the P1 spectral envelopes of each of the N audio frames
accounts for in respective total energy. The determining unit 202 may calculate an average value of
the proportions. The average value of the proportions is the first energy proportion. When the first
energy proportion is greater than the second preset value, the determining unit 202 may determine to
use the first encoding method to encode the current audio frame. When the first energy proportion is
less than the second preset value, the determining unit 202 may determine to use the second encoding
method to encode the current audio frame. The P1 spectral envelopes may be Pi spectral envelopes
having maximum energy in the P spectral envelopes. That is, the determining unit 202 is specifically
configured to determine, from the P spectral envelopes of each of the N audio frames, P1 spectral
envelopes having maximum energy. Optionally, in an embodiment, the value of Pi may be 20.
[0093]       Optionally, in another embodiment, the general sparseness parameter may include a
second minimum bandwidth and a third minimum bandwidth. In this case, the determining unit 202
is specifically configured to determine an average value of minimum bandwidths, distributed on the
spectrums, of second-preset-proportion energy of the N audio frames and determine an average value
of minimum bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N
audio frames according to the energy of the P spectral envelopes of each of the N audio frames, where
                                                    30

the average value of the minimum bandwidths, distributed on the spectrums, of the second-preset
proportion energy of the N audio frames is used as the second minimum bandwidth, the average value
of the minimum bandwidths, distributed on the spectrums, of the third-preset-proportion energy of
the N audio frames is used as the third minimum bandwidth, and the second preset proportion is less
than the third preset proportion. The determining unit 202 is specifically configured to: when the
second minimum bandwidth is less than a third preset value and the third minimum bandwidth is less
than a fourth preset value, determine to use the first encoding method to encode the current audio
frame; when the third minimum bandwidth is less than a fifth preset value, determine to use the first
encoding method to encode the current audio frame; and when the third minimum bandwidth is
greater than a sixth preset value, determine to use the second encoding method to encode the current
audio frame. Optionally, in an embodiment, when N is 1, the N audio frames are the current audio
frame. The determining unit 202 may determine a minimum bandwidth, distributed on the spectrum,
of second-preset-proportion energy of the current audio frame as the second minimum bandwidth.
The determining unit 202 may determine a minimum bandwidth, distributed on the spectrum, of third
preset-proportion energy of the current audio frame as the third minimum bandwidth.
[0094]      A person skilled in the art may understand that, the third preset value, the fourth preset
value, the fifth preset value, the sixth preset value, the second preset proportion, and the third preset
proportion may be determined according to a simulation experiment. Appropriate preset values and
preset proportions may be determined by means of a simulation experiment, so that a good encoding
effect can be obtained when an audio frame meeting the foregoing condition is encoded by using the
first encoding method or the second encoding method.
[0095]      The determining unit 202 is specifically configured to: sort the energy of the P spectral
envelopes of each audio frame in descending order; determine, according to the energy, sorted in
descending order, of the P spectral envelopes of each of the N audio frames, a minimum bandwidth,
distributed on the spectrum, of energy that accounts for not less than the second preset proportion of
each of the N audio frames; determine, according to the minimum bandwidth, distributed on the
spectrum, of the energy that accounts for not less than the second preset proportion of each of the N
audio frames, an average value of minimum bandwidths, distributed on the spectrums, of energy that
accounts for not less than the second preset proportion of the N audio frames; determine, according
to the energy, sorted in descending order, of the P spectral envelopes of each of the N audio frames,
a minimum bandwidth, distributed on the spectrum, of energy that accounts for not less than the third
preset proportion of each of the N audio frames; and determine, according to the minimum bandwidth,
distributed on the spectrum, of the energy that accounts for not less than the third preset proportion
of each of the N audio frames, an average value of minimum bandwidths, distributed on the spectrums,
                                                    31

of energy that accounts for not less than the third preset proportion of the N audio frames. For example,
an audio signal obtained by the obtaining unit 201 is a wideband signal sampled at 16 kHz, and the
obtained audio signal is obtained in a frame of 20 ms. Each frame of signal is 320 time domain
sampling points. The determining unit 202 may perform time-frequency transform on a time domain
signal, for example, perform time-frequency transform by means of fast Fourier transform, to obtain
160 spectral envelopes S(k), where k=0, 1, 2, ... , 159. The determining unit 202 may find a minimum
bandwidth from the spectral envelopes S(k) in a manner that a proportion that energy on the
bandwidth accounts for in total energy of the frame is not less than the second preset proportion. The
determining unit 202 may continue to find a bandwidth from the spectral envelopes S(k) in a manner
that a proportion that energy on the bandwidth accounts for in the total energy is not less than the
third preset proportion. Specifically, the determining unit 202 may sequentially accumulate energy of
frequency bins in the spectral envelopes S(k) in descending order. Energy obtained after each time of
accumulation is compared with the total energy of the audio frame, and if a proportion is greater than
the second preset proportion, a quantity of times of accumulation is a minimum bandwidth that is not
less than the second preset proportion. The determining unit 202 may continue the accumulation. If a
proportion of energy obtained after accumulation to the total energy of the audio frame is greater than
the third preset proportion, the accumulation is ended, and a quantity of times of accumulation is a
minimum bandwidth that is not less than the third preset proportion. For example, the second preset
proportion is 85%, and the third preset proportion is 95%. If a proportion that an energy sum obtained
after 30 times of accumulation accounts for in the total energy exceeds 85%, it may be considered
that the minimum bandwidth, distributed on the spectrum, of the energy that accounts for not less
than the second preset proportion of the audio frame is 30. The accumulation is continued, and if a
proportion that an energy sum obtained after 35 times of accumulation accounts for in the total energy
is 95%, it may be considered that the minimum bandwidth, distributed on the spectrum, of the energy
that accounts for not less than the third preset proportion of the audio frame is 35. The determining
unit 202 may execute the foregoing process for each of the N audio frames. The determining unit 202
may separately determine the minimum bandwidths, distributed on the spectrums, of the energy that
accounts for not less than the second preset proportion of the N audio frames including the current
audio frame and the minimum bandwidths, distributed on the spectrums, of the energy that accounts
for not less than the third preset proportion of the N audio frames including the current audio frame.
The average value of the minimum bandwidths, distributed on the spectrums, of the energy that
accounts for not less than the second preset proportion of the N audio frames is the second minimum
bandwidth. The average value of the minimum bandwidths, distributed on the spectrums, of the
energy that accounts for not less than the third preset proportion of the N audio frames is the third
                                                     32

minimum bandwidth. When the second minimum bandwidth is less than the third preset value and
the third minimum bandwidth is less than the fourth preset value, the determining unit 202 may
determine to use the first encoding method to encode the current audio frame. When the third
minimum bandwidth is less than the fifth preset value, the determining unit 202 may determine to use
the first encoding method to encode the current audio frame. When the third minimum bandwidth is
greater than the first preset value, the detennining unit 202 may determine to use the second encoding
method to encode the current audio frame.
[0096]      Optionally, in another embodiment, the general sparseness parameter includes a second
energy proportion and a third energy proportion. In this case, the determining unit 202 is specifically
configured to: select P2 spectral envelopes from the P spectral envelopes of each of the N audio frames,
determine the second energy proportion according to energy of the P2 spectral envelopes of each of
the N audio frames and total energy of the respective N audio frames, select P3 spectral envelopes
from the P spectral envelopes of each of the N audio frames, and determine the third energy proportion
according to energy of the P3 spectral envelopes of each of the N audio frames and the total energy
of the respective N audio frames, where P2 and P3 are positive integers less than P, and P2 is less than
P3 . The determining unit 202 is specifically configured to: when the second energy proportion is
greater than a seventh preset value and the third energy proportion is greater than an eighth preset
value, determine to use the first encoding method to encode the current audio frame; when the second
energy proportion is greater than a ninth preset value, determine to use the first encoding method to
encode the current audio frame; and when the third energy proportion is less than a tenth preset value,
determine to use the second encoding method to encode the current audio frame. Optionally, in an
embodiment, when N is 1, the N audio frames are the current audio frame. The determining unit 202
may determine the second energy proportion according to energy of P2 spectral envelopes of the
current audio frame and total energy of the current audio frame. The determining unit 202 may
determine the third energy proportion according to energy of P3 spectral envelopes of the current
audio frame and the total energy of the current audio frame.
[0097]      A person skilled in the art may understand that, values of P2 and P3, the seventh preset
value, the eighth preset value, the ninth preset value, and the tenth preset value may be determined
according to a simulation experiment. Appropriate preset values may be determined by means of a
simulation experiment, so that a good encoding effect can be obtained when an audio frame meeting
the foregoing condition is encoded by using the first encoding method or the second encoding method.
Optionally, in an embodiment, the determining unit 202 is specifically configured to determine, from
the P spectral envelopes of each of the N audio frames, P2 spectral envelopes having maximum energy,
                                                    33

and determine, from the P spectral envelopes of each of the N audio frames, P3 spectral envelopes
having maximum energy.
[0098]       For example, an audio signal obtained by the obtaining unit 201 is a wideband signal
sampled at 16 kHz, and the obtained audio signal is obtained in a frame of 20 is. Each frame of
signal is 320 time domain sampling points. The determining unit 202 may perform time-frequency
transform on a time domain signal, for example, perform time-frequency transform by means of fast
Fourier transform, to obtain 160 spectral envelopes S(k), where k=0, 1, 2, ... , 159. The determining
unit 202 may select P 2 spectral envelopes from the 160 spectral envelopes, and calculate a proportion
that an energy sum of the P2 spectral envelopes accounts for in total energy of the audio frame. The
determining unit 202 may execute the foregoing process for each of the N audio frames, that is,
calculate a proportion that an energy sum of the P2 spectral envelopes of each of the N audio frames
accounts for in respective total energy. The determining unit 202 may calculate an average value of
the proportions. The average value of the proportions is the second energy proportion. The
determining unit 202 may select P 3 spectral envelopes from the 160 spectral envelopes, and calculate
a proportion that an energy sum of the P 3 spectral envelopes accounts for in the total energy of the
audio frame. The determining unit 202 may execute the foregoing process for each of the N audio
frames, that is, calculate a proportion that an energy sum of the P3 spectral envelopes of each of the
N audio frames accounts for in the respective total energy. The determining unit 202 may calculate
an average value of the proportions. The average value of the proportions is the third energy
proportion. When the second energy proportion is greater than the seventh preset value and the third
energy proportion is greater than the eighth preset value, the determining unit 202 may determine to
use the first encoding method to encode the current audio frame. When the second energy proportion
is greater than the ninth preset value, the determining unit 202 may determine to use the first encoding
method to encode the current audio frame. When the third energy proportion is less than the tenth
preset value, the determining unit 202 may determine to use the second encoding method to encode
the current audio frame. The P 2 spectral envelopes may be P2 spectral envelopes having maximum
energy in the P spectral envelopes; and the P 3 spectral envelopes may be P 3 spectral envelopes having
maximum energy in the P spectral envelopes. Optionally, in an embodiment, the value of P 2 may be
20, and the value of P 3 may be 30.
[0099]       Optionally, in another embodiment, an appropriate encoding method may be selected for
the current audio frame by using the burst sparseness. For the burst sparseness, global sparseness,
local sparseness, and short-time burstiness of distribution, on a spectrum, of energy of an audio frame
need to be considered. In this case, the sparseness of distribution of the energy on the spectrums may
include global sparseness, local sparseness, and short-time burstiness of distribution of the energy on
                                                     34

the spectrums. In this case, a value of N may be 1, and the N audio frames are the current audio frame.
The determining unit 202 is specifically configured to divide a spectrum of the current audio frame
into  Q sub  bands, and determine a burst sparseness parameter according to peak energy of each of the
Q sub bands    of the spectrum of the current audio frame, where the burst sparseness parameter is used
to indicate global sparseness, local sparseness, and short-time burstiness of the current audio frame.
[00100]       Specifically, the determining unit 202 is specifically configured to determine a global
peak-to-average proportion of each of the        Q sub bands,  a local peak-to-average proportion of each of
the  Q sub   bands, and a short-time energy fluctuation of each of the        Q sub bands, where the global
peak-to-average proportion is determined by the determining unit 202 according to the peak energy
in the sub band and average energy of all the sub bands of the current audio frame, the local peak-to
average proportion is determined by the determining unit 202 according to the peak energy in the sub
band and average energy in the sub band, and the short-time peak energy fluctuation is determined
according to the peak energy in the sub band and peak energy in a specific frequency band of an audio
frame before the audio frame. The global peak-to-average proportion of each of the          Q sub  bands, the
local peak-to-average proportion of each of the         Q sub bands, and the short-time energy fluctuation of
each of the    Q sub  bands respectively represent the global sparseness, the local sparseness, and the
short-time burstiness. The determining unit 202 is specifically configured to: determine whether there
is a first sub band in the   Q sub bands,     where a local peak-to-average proportion of the first sub band
is greater than an eleventh preset value, a global peak-to-average proportion of the first sub band is
greater than a twelfth preset value, and a short-time peak energy fluctuation of the first sub band is
greater than a thirteenth preset value; and when there is the first sub band in the            Q  sub bands,
determine to use the first encoding method to encode the current audio frame.
[00101]       Specifically, the determining unit 202 may calculate the global peak-to-average proportion
by using the following formula:
              p2s(i)= e(i) /    -*     s(k)                                                     Formula 1.7
                              (P   kO
              where e(i) represents peak energy of an ith sub band in the Q sub bands, s(k) represents
energy of a kth spectral envelope in the P spectral envelopes, and p2s(i) represents a global peak-to
average proportion of the i* sub band.
[00102]       The determining unit 202 may calculate the local peak-to-average proportion by using the
following formula:
                                       1         h(i)
              p2a(i) = e(i) /                  *I     s(k)                                      Formula 1.8
                               (h(i) - 1(i) +1  ke~i
              where e(i) represents the peak energy of the i' sub band in the            Q sub bands, s(k)
                                                          35

represents the energy of the k*l spectral envelope in the P spectral envelopes, h(i) represents an index
of a spectral envelope that is included in the        ith   sub band and that has a highest frequency, 1(i)
represents an index of a spectral envelope that is included in the        ith sub band and that has a lowest
frequency, p2a(i) represents a local peak-to-average proportion of the it" sub band, and h(i) is less
than or equal to P-1.
[00103]     The determining unit 202 may calculate the short-time peak energy fluctuation by using
the following formula:
             dev(i) = (2* e(i)) / (e, + e2 )                                                    Formula 1.9
            where e(i) represents the peak energy of the ith sub band in the Q sub bands of the current
audio frame, and ei and   e2 represent peak energy of specific frequency bands of audio frames before
the current audio frame. Specifically, assuming that the current audio frame is an       Mth  audio frame, a
spectral envelope in which peak energy of the ith sub band of the current audio frame is located is
determined. It is assumed that the spectral envelope in which the peak energy is located is i1 . Peak
energy within a range from an (ii-t)th spectral envelope to an (iI+t)h spectral envelope in an (M-1 )[h
audio frame is determined, and the peak energy is ei. Similarly, peak energy within a range from an
(ii-t)* spectral envelope to an    (ii+t)th spectral envelope in an (M-2)th audio frame is determined, and
the peak energy is e2.
[00104]     A person skilled in the art may understand that, the eleventh preset value, the twelfth preset
value, and the thirteenth preset value may be determined according to a simulation experiment.
Appropriate preset values may be determined by means of a simulation experiment, so that a good
encoding effect can be obtained when an audio frame meeting the foregoing condition is encoded by
using the first encoding method.
[00105]     Optionally, in another embodiment, an appropriate encoding method may be selected for
the current audio frame by using the band-limited sparseness. In this case, the sparseness of
distribution of the energy on the spectrums includes band-limited sparseness of distribution of the
energy on the spectrums. In this case, the determining unit 202 is specifically configured to determine
a demarcation frequency of each of the N audio frames. The determining unit 202 is specifically
configured to determine a band-limited sparseness parameter according to the demarcation frequency
of each of the N audio frames.
[00106]     A person skilled in the art may understand that, the fourth preset proportion and the
fourteenth preset value may be determined according to a simulation experiment. An appropriate
preset value and preset proportion may be determined according to a simulation experiment, so that
                                                         36

a good encoding effect can be obtained when an audio frame meeting the foregoing condition is
encoded by using the first encoding method.
[00107]     For example, the determining unit 202 may determine energy of each of P spectral
envelopes of the current audio frame, and search for a demarcation frequency from a low frequency
to a high frequency in a manner that a proportion that energy that is less than the demarcation
frequency accounts for in total energy of the current audio frame is the fourth preset proportion. The
band-limited sparseness parameter may be an average value of the demarcation frequencies of the N
audio frames. In this case, the determining unit 202 is specifically configured to: when it is determined
that the band-limited sparseness parameter of the audio frames is less than a fourteenth preset value,
determine to use the first encoding method to encode the current audio frame. Assuming that N is 1,
the demarcation frequency of the current audio frame is the band-limited sparseness parameter.
Assuming that N is an integer greater than 1, the determining unit 202 may determine that the average
value of the demarcation frequencies of the N audio frames is the band-limited sparseness parameter.
A person skilled in the art may understand that, the demarcation frequency determining mentioned
above is merely an example. Alternatively, the demarcation frequency determining method may be
searching for a demarcation frequency from a high frequency to a low frequency or may be another
method.
[00108]     Further, to avoid frequent switching between the first encoding method and the second
encoding method, the determining unit 202 may be further configured to set a hangover period. The
determining unit 202 may be configured to: for an audio frame in the hangover period, use an
encoding method used for an audio frame at a start position of the hangover period. In this way, a
switching quality decrease caused by frequent switching between different encoding methods can be
avoided.
[00109]     If a hangover length of the hangover period is L, the determining unit 202 may be
configured to determine that L audio frames after the current audio frame all belong to a hangover
period of the current audio frame. If sparseness of distribution, on a spectrum, of energy of an audio
frame belonging the hangover period is different from sparseness of distribution, on a spectrum, of
energy of an audio frame at a start position of the hangover period, the determining unit 202 may be
configured to determine that the audio frame is still encoded by using an encoding method that is the
same as that used for the audio frame at the start position of the hangover period.
[00110]     The hangover period length may be updated according to sparseness of distribution, on a
spectrum, of energy of an audio frame in the hangover period, until the hangover period length is 0.
[00111]     For example, if the determining unit 202 determines to use the first encoding method for
an Ith audio frame and a length of a preset hangover period is L, the determining unit 202 may
                                                   37

determine that the first encoding method is used for an (I+1)* audio frame to an (I+L)h audio frame.
Then, the determining unit 202 may determine sparseness of distribution, on a spectrum, of energy of
the (1+1)Ih audio frame, and re-calculate the hangover period according to the sparseness of
distribution, on the spectrum, of the energy of the (I+1)th audio frame. If the (I+l)th audio frame still
meets a condition of using the first encoding method, the determining unit 202 may determine that a
subsequent hangover period is still the preset hangover period L. That is, the hangover period starts
from an (L+2)h audio frame to an (I+1+L)th audio frame. If the (I+1)th audio frame does not meet the
condition of using the first encoding method, the determining unit 202 may re-determine the hangover
period according to the sparseness of distribution, on the spectrum, of the energy of the (I+1)th audio
frame. For example, the determining unit 202 may re-determine that the hangover period is L-L1,
where LI is a positive integer less than or equal to L. If LI is equal to L, the hangover period length
is updated to 0. In this case, the determining unit 202 may re-determine the encoding method
according to the sparseness of distribution, on the spectrum, of the energy of the (I+1)*h audio frame.
If LI is an integer less than L, the determining unit 202 may re-determine the encoding method
according to sparseness of distribution, on a spectrum, of energy of an (I+1+L-Ll)h audio frame.
However, because the (I+1     )h audio frame is in a hangover period of the   1 th audio frame, the (I+1 )th
audio frame is still encoded by using the first encoding method. LI may be referred to as a hangover
update parameter, and a value of the hangover update parameter may be determined according to
sparseness of distribution, on a spectrum, of energy of an input audio frame. In this way, hangover
period update is related to sparseness of distribution, on a spectrum, of energy of an audio frame.
[00112]     For example, when a general sparseness parameter is determined and the general
sparseness parameter is a first minimum bandwidth, the determining unit 202 may re-determine the
hangover period according to a minimum bandwidth, distributed on a spectrum, of first-preset
proportion energy of an audio frame. It is assumed that it is determined to use the first encoding
method to encode the Ith audio frame, and a preset hangover period is L. The determining unit 202
may determine a minimum bandwidth, distributed on a spectrum, of first-preset-proportion energy of
each of H consecutive audio frames including the (1+1)*' audio frame, where H is a positive integer
greater than 0. If the (I+1)t* audio frame does not meet the condition of using the first encoding
method, the determining unit 202 may determine a quantity of audio frames whose minimum
bandwidths, distributed on spectrums, of first-preset-proportion energy are less than a fifteenth preset
value (the quantity is briefly referred to as a first hangover parameter). When a minimum bandwidth,
distributed on a spectrum, of first-preset-proportion energy of an (L+1 )th audio frame is greater than
a sixteenth preset value and is less than a seventeenth preset value, and the first hangover parameter
is less than an eighteenth preset value, the determining unit 202 may subtract the hangover period
                                                      38

length by 1, that is, the hangover update parameter is 1. The sixteenth preset value is greater than the
first preset value. When the minimum bandwidth, distributed on the spectrum, of the first-preset
proportion energy of the (L+1)th audio frame is greater than the seventeenth preset value and is less
than a nineteenth preset value, and the first hangover parameter is less than the eighteenth preset value,
the determining unit 202 may subtract the hangover period length by 2, that is, the hangover update
parameter is 2. When the minimum bandwidth, distributed on the spectrum, of the first-preset
proportion energy of the (L+1)h audio frame is greater than the nineteenth preset value, the
determining unit 202 may set the hangover period to 0. When the first hangover parameter and the
minimum bandwidth, distributed on the spectrum, of the first-preset-proportion energy of the (L+1)th
audio frame do not meet one or more of the sixteenth preset value to the nineteenth preset value, the
determining unit 202 may determine that the hangover period remains unchanged.
[00113]      A person skilled in the art may understand that, the preset hangover period may be set
according to an actual status, and the hangover update parameter also may be adjusted according to
an actual status. The fifteenth preset value to the nineteenth preset value may be adjusted according
to an actual status, so that different hangover periods may be set.
[00114]      Similarly, when the general sparseness parameter includes a second minimum bandwidth
and a third minimum bandwidth, or the general sparseness parameter includes a first energy
proportion, or the general sparseness parameter includes a second energy proportion and a third
energy proportion, the determining unit 202 may set a corresponding preset hangover period, a
corresponding hangover update parameter, and a related parameter used to determine the hangover
update parameter, so that a corresponding hangover period can be determined, and frequent switching
between encoding methods is avoided.
[00115]      When the encoding method is determined according to the burst sparseness (that is, the
encoding method is determined according to global sparseness, local sparseness, and short-time
burstiness of distribution, on a spectrum, of energy of an audio frame), the determining unit 202 may
set a corresponding hangover period, a corresponding hangover update parameter, and a related
parameter used to determine the hangover update parameter, to avoid frequent switching between
encoding methods. In this case, the hangover period may be less than the hangover period that is set
in the case of the general sparseness parameter.
[00116]      When the encoding method is determined according to a band-limited characteristic of
distribution of energy on a spectrum, the determining unit 202 may set a corresponding hangover
period, a corresponding hangover update parameter, and a related parameter used to determine the
hangover update parameter, to avoid frequent switching between encoding methods. For example,
the determining unit 202 may calculate a proportion of energy of a low spectral envelope of an input
                                                    39

audio frame to energy of all spectral envelopes, and determine the hangover update parameter
according to the proportion. Specifically, the determining unit 202 may determine the proportion of
the energy of the low spectral envelope to the energy of all the spectral envelopes by using the
following formula:
                    Ys(k)
                    R =_                                                              Formula 1.10
                    Is(k)
                    k=0
             where Row represents the proportion of the energy of the low spectral envelope to the
energy of all the spectral envelopes, s(k) represents energy of a kth spectral envelope, y represents an
index of a highest spectral envelope of a low frequency band, and P indicates that the audio frame is
divided into P spectral envelopes in total. In this case, if Rj0 w is greater than a twentieth preset value,
the hangover update parameter is 0. If Rlow is greater than a twenty-first preset value, the hangover
update parameter may have a relatively small value, where the twentieth preset value is greater than
the twenty-first preset value. If Rlow   is not greater than the twenty-first preset value, the hangover
parameter may have a relatively large value. A person skilled in the art may understand that, the
twentieth preset value and the twenty-first preset value may be determined according to a simulation
experiment, and the value of the hangover update parameter also may be determined according to an
experiment.
[00117]      In addition, when the encoding method is determined according to a band-limited
characteristic of distribution of energy on a spectrum, the determining unit 202 may further determine
a demarcation frequency of an input audio frame, and determine the hangover update parameter
according to the demarcation frequency, where the demarcation frequency may be different from a
demarcation frequency used to determine a band-limited sparseness parameter. If the demarcation
frequency is less than a twenty-second preset value, the determining unit 202 may determine that the
hangover update parameter is 0. If the demarcation frequency is less than a twenty-third preset value,
the determining unit 202 may determine that the hangover update parameter has a relatively small
value. If the demarcation frequency is greater than the twenty-third preset value, the determining unit
202 may determine that the hangover update parameter may have a relatively large value. A person
skilled in the art may understand that, the twenty-second preset value and the twenty-third preset
value may be determined according to a simulation experiment, and the value of the hangover update
parameter also may be determined according to an experiment.
                                                     40

[00118]     FIG. 3 is a structural block diagram of an apparatus according to an embodiment of the
present invention. The apparatus 300 shown in FIG. 3 can perform the steps in FIG. 1. As shown in
FIG. 3, the apparatus 300 includes a processor 301 and a memory 302.
[00119]     Components in the apparatus 300 are coupled by using a bus system 303. The bus system
303 further includes a power supply bus, a control bus, and a status signal bus in addition to a data
bus. However, for ease of clear description, all buses are marked as the bus system 303 in FIG. 3.
[00120]     The method disclosed in the foregoing embodiments of the present invention may be
applied to the processor 301, or implemented by the processor 301. The processor 301 may be an
integrated circuit chip and has a signal processing capability. In an implementation process, the steps
of the method may be completed by using an integrated logic circuit of hardware in the processor 301
or an instruction in a software form. The processor 301 may be a general purpose processor, a digital
signal processor (Digital Signal Processor, DSP),          an application-specific  integrated circuit
(Application Specific      Integrated Circuit, ASIC),    a field programmable      gate   array (Field
Programmable Gate Array, FPGA) or another programmable logical device, a discrete gate or
transistor logic device, or a discrete hardware component. The processor 301 may implement or
execute methods, steps and logical block diagrams disclosed in the embodiments of the present
invention. The general purpose processor may be a microprocessor or the processor may be any
common processor, and the like. Steps of the methods disclosed with reference to the embodiments
of the present invention may be directly executed and completed by means of a hardware decoding
processor, or may be executed and completed by using a combination of hardware and software
modules in the decoding processor. The software module may be located in a storage medium that is
mature in the art such as a random access memory (Random Access Memory, RAM), a flash memory,
a read-only memory (Read-Only Memory, ROM), a programmable read-only memory or an
electrically erasable programmable memory, or a register. The storage medium is located in the
memory 302. The processor 301 reads the instruction from the memory 302, and completes the steps
of the method in combination with hardware thereof.
[00121]     The processor 301 is configured to obtain N audio frames, where the N audio frames
include a current audio frame, and N is a positive integer.
[00122]     The processor 301 is configured to determine sparseness of distribution, on the spectrums,
of energy of the N audio frames obtained by the processor 301.
[00123]     The processor 301 is further configured to determine, according to the sparseness of
distribution, on the spectrums, of the energy of the N audio frames, whether to use a first encoding
method or a second encoding method to encode the current audio frame, where the first encoding
method is an encoding method that is based on time-frequency transform and transform coefficient
                                                   41

quantization and that is not based on linear prediction, and the second encoding method is a linear
predication-based encoding method.
[00124]      According to the apparatus shown in FIG. 3, when an audio frame is encoded, sparseness
of distribution, on a spectrum, of energy of the audio frame is considered, which can reduce encoding
complexity and ensure that encoding is of relatively high accuracy.
[00125]      During selection of an appropriate encoding method for an audio frame, sparseness of
distribution, on a spectrum, of energy of the audio frame may be considered. There may be three types
of sparseness of distribution, on a spectrum, of energy of an audio frame: general sparseness, burst
sparseness, and band-limited sparseness.
[00126]      Optionally, in an embodiment, an appropriate encoding method may be selected for the
current audio frame by using the general sparseness. In this case, the processor 301 is specifically
configured to divide a spectrum of each of the N audio frames into P spectral envelopes, and
determine a general sparseness parameter according to energy of the P spectral envelopes of each of
the N audio frames, where P is a positive integer, and the general sparseness parameter indicates the
sparseness of distribution, on the spectrums, of the energy of the N audio frames.
[00127]      Specifically, an average value of minimum bandwidths, distributed on spectrums, of
specific-proportion energy of N input consecutive audio frames may be defined as the general
sparseness. A smaller bandwidth indicates stronger general sparseness, and a larger bandwidth
indicates weaker general sparseness. In other words, stronger general sparseness indicates that energy
of an audio frame is more centralized, and weaker general sparseness indicates that energy of an audio
frame is more disperse. Efficiency is high when the first encoding method is used to encode an audio
frame whose general sparseness is relatively strong. Therefore, an appropriate encoding method may
be selected by determining general sparseness of an audio frame, to encode the audio frame. To help
determine general sparseness of an audio frame, the general sparseness may be quantized to obtain a
general sparseness parameter. Optionally, when N is 1, the general sparseness is a minimum
bandwidth, distributed on a spectrum, of specific-proportion energy of the current audio frame.
[00128]      Optionally, in an embodiment, the general sparseness parameter includes a first minimum
bandwidth. In this case, the processor 301 is specifically configured to determine an average value of
minimum bandwidths, distributed on the spectrums, of first-preset-proportion energy of the N audio
frames according to the energy of the P spectral envelopes of each of the N audio frames, where the
average value of the minimum bandwidths, distributed on the spectrums, of the first-preset-proportion
energy of the N audio frames is the first minimum bandwidth. The processor 301 is specifically
configured to: when the first minimum bandwidth is less than a first preset value, determine to use
the first encoding method to encode the current audio frame; and when the first minimum bandwidth
                                                   42

is greater than the first preset value, determine to use the second encoding method to encode the
current audio frame.
[00129]     A person skilled in the art may understand that, the first preset value and the first preset
proportion may be determined according to a simulation experiment. An appropriate first preset value
and first preset proportion may be determined by means of a simulation experiment, so that a good
encoding effect can be obtained when an audio frame meeting the foregoing condition is encoded by
using the first encoding method or the second encoding method.
[00130]     The processor 301 is specifically configured to: sort the energy of the P spectral envelopes
of each audio frame in descending order; determine, according to the energy, sorted in descending
order, of the P spectral envelopes of each of the N audio frames, a minimum bandwidth, distributed
on the spectrum, of energy that accounts for not less than the first preset proportion of each of the N
audio frames; and determine, according to the minimum bandwidth, distributed on the spectrum, of
the energy that accounts for not less than the first preset proportion of each of the N audio frames, an
average value of minimum bandwidths, distributed on the spectrums, of energy that accounts for not
less than the first preset proportion of the N audio frames. For example, an audio signal obtained by
the processor 301 is a wideband signal sampled at 16 kHz, and the obtained audio signal is obtained
in a frame of 30 ms. Each frame of signal is 330 time domain sampling points. The processor 301
may perform time-frequency transform on a time domain signal, for example, perform time
frequency transform by means of fast Fourier transform (Fast Fourier Transformation, FFT), to obtain
130 spectral envelopes S(k), that is, 130 FFT energy spectrum coefficients, where k=0, 1, 2, ..., 159.
The processor 301 may find a minimum bandwidth from the spectral envelopes S(k) in a manner that
a proportion that energy on the bandwidth accounts for in total energy of the frame is the first preset
proportion. Specifically, the processor 301 may sequentially accumulate energy of frequency bins in
the spectral envelopes S(k) in descending order; and compare energy obtained after each time of
accumulation with the total energy of the audio frame, and if a proportion is greater than the first
preset proportion, end the accumulation process, where a quantity of times of accumulation is the
minimum bandwidth. For example, the first preset proportion is 90%, and if a proportion that an
energy sum obtained after 30 times of accumulation accounts for in the total energy exceeds 90%, it
may be considered that a minimum bandwidth of energy that accounts for not less than the first preset
proportion of the audio frame is 30. The processor 301 may execute the foregoing minimum
bandwidth determining process for each of the N audio frames, to separately determine the minimum
bandwidths of the energy that accounts for not less than the first preset proportion of the N audio
frames including the current audio frame. The processor 301 may calculate an average value of the
minimum bandwidths of the energy that accounts for not less than the first preset proportion of the N
                                                     43

audio frames. The average value of the minimum bandwidths of the energy that accounts for not less
than the first preset proportion of the N audio frames may be referred to as the first minimum
bandwidth, and the first minimum bandwidth may be used as the general sparseness parameter. When
the first minimum bandwidth is less than the first preset value, the processor 301 may determine to
use the first encoding method to encode the current audio frame. When the first minimum bandwidth
is greater than the first preset value, the processor 301 may determine to use the second encoding
method to encode the current audio frame.
[00131]     Optionally, in another embodiment, the general sparseness parameter may include a first
energy proportion. In this case, the processor 301 is specifically configured to select Pi spectral
envelopes from the P spectral envelopes of each of the N audio frames, and determine the first energy
proportion according to energy of the Pi spectral envelopes of each of the N audio frames and total
energy of the respective N audio frames, where Pi is a positive integer less than P. The processor 301
is specifically configured to: when the first energy proportion is greater than a second preset value,
determine to use the first encoding method to encode the current audio frame; and when the first
energy proportion is less than the second preset value, determine to use the second encoding method
to encode the current audio frame. Optionally, in an embodiment, when N is 1, the N audio frames
are the current audio frame, and the processor 301 is specifically configured to determine the first
energy proportion according to energy of Pi spectral envelopes of the current audio frame and total
energy of the current audio frame. The processor 301 is specifically configured to determine the Pi
spectral envelopes according to the energy of the P spectral envelopes, where energy of any one of
the Pi spectral envelopes is greater than energy of any one of the other spectral envelopes in the P
spectral envelopes except the PI spectral envelopes.
[00132]      Specifically, the processor 301 may calculate the first energy proportion by using the
following formula:
                     N
                    Zr(n)
                       N                                                                  Formula 1.6
               r(n) =E,(n
                      Ea, (n)
            where R 1 represents the first energy proportion, EP,(n) represents an energy sum of PI
selected spectral envelopes in an n"' audio frame, E,,l(n) represents total energy of the n* audio
frame, and r(n) represents a proportion that the energy of the Pi spectral envelopes of the nth audio
frame in the N audio frames accounts for in the total energy of the audio frame.
[00133]     A person skilled in the art may understand that, the second preset value and selection of
the Pi spectral envelopes may be determined according to a simulation experiment. An appropriate
                                                   44

second preset value, an appropriate value of P1, and an appropriate method for selecting the P i spectral
envelopes may be determined by means of a simulation experiment, so that a good encoding effect
can be obtained when an audio frame meeting the foregoing condition is encoded by using the first
encoding method or the second encoding method. Optionally, in an embodiment, the P1 spectral
envelopes may be P1 spectral envelopes having maximum energy in the P spectral envelopes.
[00134]     For example, an audio signal obtained by the processor 301 is a wideband signal sampled
at 16 kHz, and the obtained audio signal is obtained in a frame of 30 ms. Each frame of signal is 330
time domain sampling points. The processor 301 may perform time-frequency transform on a time
domain signal, for example, perform time-frequency transform by means of fast Fourier transform,
to obtain 130 spectral envelopes S(k), where k=0, 1, 2, ... , 159. The processor 301 may select Pi
spectral envelopes from the 130 spectral envelopes, and calculate a proportion that an energy sum of
the P1 spectral envelopes accounts for in total energy of the audio frame. The processor 301 may
execute the foregoing process for each of the N audio frames, that is, calculate a proportion that an
energy sum of the P1 spectral envelopes of each of the N audio frames accounts for in respective total
energy. The processor 301 may calculate an average value of the proportions. The average value of
the proportions is the first energy proportion. When the first energy proportion is greater than the
second preset value, the processor 301 may determine to use the first encoding method to encode the
current audio frame. When the first energy proportion is less than the second preset value, the
processor 301 may determine to use the second encoding method to encode the current audio frame.
The Pi spectral envelopes may be Pi spectral envelopes having maximum energy in the P spectral
envelopes. That is, the processor 301 is specifically configured to determine, from the P spectral
envelopes of each of the N audio frames, P1 spectral envelopes having maximum energy. Optionally,
in an embodiment, the value of Pi may be 30.
[00135]     Optionally, in another embodiment, the general sparseness parameter may include a
second minimum bandwidth and a third minimum bandwidth. In this case, the processor 301 is
specifically configured to determine an average value of minimum bandwidths, distributed on the
spectrums, of second-preset-proportion energy of the N audio frames and determine an average value
of minimum bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N
audio frames according to the energy of the P spectral envelopes of each of the N audio frames, where
the average value of the minimum bandwidths, distributed on the spectrums, of the second-preset
proportion energy of the N audio frames is used as the second minimum bandwidth, the average value
of the minimum bandwidths, distributed on the spectrums, of the third-preset-proportion energy of
the N audio frames is used as the third minimum bandwidth, and the second preset proportion is less
than the third preset proportion. The processor 301 is specifically configured to: when the second
                                                   45

minimum bandwidth is less than a third preset value and the third minimum bandwidth is less than a
fourth preset value, determine to use the first encoding method to encode the current audio frame;
when the third minimum bandwidth is less than a fifth preset value, determine to use the first encoding
method to encode the current audio frame; and when the third minimum bandwidth is greater than a
sixth preset value, determine to use the second encoding method to encode the current audio frame.
Optionally, in an embodiment, when N is 1, the N audio frames are the current audio frame. The
processor 301 may determine a minimum bandwidth, distributed on the spectrum, of second -preset
proportion energy of the current audio frame as the second minimum bandwidth. The processor 301
may determine a minimum bandwidth, distributed on the spectrum, of third-preset-proportion energy
of the current audio frame as the third minimum bandwidth.
[00136]     A person skilled in the art may understand that, the third preset value, the fourth preset
value, the fifth preset value, the sixth preset value, the second preset proportion, and the third preset
proportion may be determined according to a simulation experiment. Appropriate preset values and
preset proportions may be determined by means of a simulation experiment, so that a good encoding
effect can be obtained when an audio frame meeting the foregoing condition is encoded by using the
first encoding method or the second encoding method.
[00137]     The processor 301 is specifically configured to: sort the energy of the P spectral envelopes
of each audio frame in descending order; determine, according to the energy, sorted in descending
order, of the P spectral envelopes of each of the N audio frames, a minimum bandwidth, distributed
on the spectrum, of energy that accounts for not less than the second preset proportion of each of the
N audio frames; determine, according to the minimum bandwidth, distributed on the spectrum, of the
energy that accounts for not less than the second preset proportion of each of the N audio frames, an
average value of minimum bandwidths, distributed on the spectrums, of energy that accounts for not
less than the second preset proportion of the N audio frames; determine, according to the energy,
sorted in descending order, of the P spectral envelopes of each of the N audio frames, a minimum
bandwidth, distributed on the spectrum, of energy that accounts for not less than the third preset
proportion of each of the N audio frames; and determine, according to the minimum bandwidth,
distributed on the spectrum, of the energy that accounts for not less than the third preset proportion
of each of the N audio frames, an average value of minimum bandwidths, distributed on the spectrums,
of energy that accounts for not less than the third preset proportion of the N audio frames. For example,
an audio signal obtained by the processor 301 is a wideband signal sampled at 16 kHz, and the
obtained audio signal is obtained in a frame of 30 ins. Each frame of signal is 330 time domain
sampling points. The processor 301 may perform time-frequency transform on a time domain signal,
for example, perform time-frequency transform by means of fast Fourier transform, to obtain 130
                                                     46

spectral envelopes S(k), where k=0, 1, 2, ... , 159. The processor 301 may find a minimum bandwidth
from the spectral envelopes S(k) in a manner that a proportion that energy on the bandwidth accounts
for in total energy of the frame is not less than the second preset proportion. The processor 301 may
continue to find a bandwidth from the spectral envelopes S(k) in a manner that a proportion that
energy on the bandwidth accounts for in the total energy is not less than the third preset proportion.
Specifically, the processor 301 may sequentially accumulate energy of frequency bins in the spectral
envelopes S(k) in descending order. Energy obtained after each time of accumulation is compared
with the total energy of the audio frame, and if a proportion is greater than the second preset
proportion, a quantity of times of accumulation is a minimum bandwidth that is not less than the
second preset proportion. The processor 301 may continue the accumulation. If a proportion of energy
obtained after accumulation to the total energy of the audio frame is greater than the third preset
proportion, the accumulation is ended, and a quantity of times of accumulation is a minimum
bandwidth that is not less than the third preset proportion. For example, the second preset proportion
is 85%, and the third preset proportion is 95%. If a proportion that an energy sum obtained after 30
times of accumulation accounts for in the total energy exceeds 85%, it may be considered that the
minimum bandwidth, distributed on the spectrum, of the energy that accounts for not less than the
second preset proportion of the audio frame is 30. The accumulation is continued, and if a proportion
that an energy sum obtained after 35 times of accumulation accounts for in the total energy is 95%, it
may be considered that the minimum bandwidth, distributed on the spectrum, of the energy that
accounts for not less than the third preset proportion of the audio frame is 35. The processor 301 may
execute the foregoing process for each of the N audio frames. The processor 301 may separately
determine the minimum bandwidths, distributed on the spectrums, of the energy that accounts for not
less than the second preset proportion of the N audio frames including the current audio frame and
the minimum bandwidths, distributed on the spectrums, of the energy that accounts for not less than
the third preset proportion of the N audio frames including the current audio frame. The average value
of the minimum bandwidths, distributed on the spectrums, of the energy that accounts for not less
than the second preset proportion of the N audio frames is the second minimum bandwidth. The
average value of the minimum bandwidths, distributed on the spectrums, of the energy that accounts
for not less than the third preset proportion of the N audio frames is the third minimum bandwidth.
When the second minimum bandwidth is less than the third preset value and the third minimum
bandwidth is less than the fourth preset value, the processor 301 may determine to use the first
encoding method to encode the current audio frame. When the third minimum bandwidth is less than
the fifth preset value, the processor 301 may determine to use the first encoding method to encode
the current audio frame. When the third minimum bandwidth is greater than the sixth preset value,
                                                    47

the processor 301 may determine to use the second encoding method to encode the current audio
frame.
[00138]     Optionally, in another embodiment, the general sparseness parameter includes a second
energy proportion and a third energy proportion. In this case, the processor 301 is specifically
configured to: select P2 spectral envelopes from the P spectral envelopes of each of the N audio frames,
determine the second energy proportion according to energy of the P2 spectral envelopes of each of
the N audio frames and total energy of the respective N audio frames, select P3 spectral envelopes
from the P spectral envelopes of each of the N audio frames, and determine the third energy proportion
according to energy of the P3 spectral envelopes of each of the N audio frames and the total energy
of the respective N audio frames, where P2 and P3 are positive integers less than P, and P2 is less than
P3 . The processor 301 is specifically configured to: when the second energy proportion is greater than
a seventh preset value and the third energy proportion is greater than an eighth preset value, determine
to use the first encoding method to encode the current audio frame; when the second energy
proportion is greater than a ninth preset value, determine to use the first encoding method to encode
the current audio frame; and when the third energy proportion is less than a tenth preset value,
determine to use the second encoding method to encode the current audio frame. Optionally, in an
embodiment, when N is 1, the N audio frames are the current audio frame. The processor 301 may
determine the second energy proportion according to energy of P2 spectral envelopes of the current
audio frame and total energy of the current audio frame. The processor 301 may determine the third
energy proportion according to energy of P3 spectral envelopes of the current audio frame and the
total energy of the current audio frame.
[00139]     A person skilled in the art may understand that, values of P2 and P3, the seventh preset
value, the eighth preset value, the ninth preset value, and the tenth preset value may be determined
according to a simulation experiment. Appropriate preset values may be determined by means of a
simulation experiment, so that a good encoding effect can be obtained when an audio frame meeting
the foregoing condition is encoded by using the first encoding method or the second encoding method.
Optionally, in an embodiment, the processor 301 is specifically configured to determine, from the P
spectral envelopes of each of the N audio frames, P2 spectral envelopes having maximum energy, and
determine, from the P spectral envelopes of each of the N audio frames, P3 spectral envelopes having
maximum energy.
[00140]     For example, an audio signal obtained by the processor 301 is a wideband signal sampled
at 16 kHz, and the obtained audio signal is obtained in a frame of 30 ms. Each frame of signal is 330
time domain sampling points. The processor 301 may perform time-frequency transform on a time
domain signal, for example, perform time-frequency transform by means of fast Fourier transform,
                                                    48

to obtain 130 spectral envelopes S(k), where k=0, 1, 2, ... , 159. The processor 301 may select P 2
spectral envelopes from the 130 spectral envelopes, and calculate a proportion that an energy sum of
the P 2 spectral envelopes accounts for in total energy of the audio frame. The processor 301 may
execute the foregoing process for each of the N audio frames, that is, calculate a proportion that an
energy sum of the P 2 spectral envelopes of each of the N audio frames accounts for in respective total
energy. The processor 301 may calculate an average value of the proportions. The average value of
the proportions is the second energy proportion. The processor 301 may select P 3 spectral envelopes
from the 130 spectral envelopes, and calculate a proportion that an energy sum of the P 3 spectral
envelopes accounts for in the total energy of the audio frame. The processor 301 may execute the
foregoing process for each of the N audio frames, that is, calculate a proportion that an energy sum
of the P3 spectral envelopes of each of the N audio frames accounts for in the respective total energy.
The processor 301 may calculate an average value of the proportions. The average value of the
proportions is the third energy proportion. When the second energy proportion is greater than the
seventh preset value and the third energy proportion is greater than the eighth preset value, the
processor 301 may determine to use the first encoding method to encode the current audio frame.
When the second energy proportion is greater than the ninth preset value, the processor 301 may
determine to use the first encoding method to encode the current audio frame. When the third energy
proportion is less than the tenth preset value, the processor 301 may determine to use the second
encoding method to encode the current audio frame. The P 2 spectral envelopes may be P 2 spectral
envelopes having maximum energy in the P spectral envelopes; and the P 3 spectral envelopes may be
P3 spectral envelopes having maximum energy in the P spectral envelopes. Optionally, in an
embodiment, the value of P2 may be 30, and the value of P 3 may be 30.
[00141]     Optionally, in another embodiment, an appropriate encoding method may be selected for
the current audio frame by using the burst sparseness. For the burst sparseness, global sparseness,
local sparseness, and short-time burstiness of distribution, on a spectrum, of energy of an audio frame
need to be considered. In this case, the sparseness of distribution of the energy on the spectrums may
include global sparseness, local sparseness, and short-time burstiness of distribution of the energy on
the spectrums. In this case, a value of N may be 1, and the N audio frames are the current audio frame.
The processor 301 is specifically configured to divide a spectrum of the current audio frame into     Q
sub bands, and determine a burst sparseness parameter according to peak energy of each of the     Q sub
bands of the spectrum of the current audio frame, where the burst sparseness parameter is used to
indicate global sparseness, local sparseness, and short-time burstiness of the current audio frame.
[00142]     Specifically, the processor 301 is specifically configured to determine a global peak-to
average proportion of each of the    Q sub bands, a local peak-to-average proportion of each of the   Q
                                                   49

sub bands, and a short-time energy fluctuation of each of the      Q sub bands, where the global peak-to
average proportion is determined by the processor 301 according to the peak energy in the sub band
and average energy of all the sub bands of the current audio frame, the local peak-to-average
proportion is determined by the processor 301 according to the peak energy in the sub band and
average energy in the sub band, and the short-time peak energy fluctuation is determined according
to the peak energy in the sub band and peak energy in a specific frequency band of an audio frame
before the audio frame. The global peak-to-average proportion of each of the        Q sub bands, the local
peak-to-average proportion of each of the      Q sub bands, and the short-time energy fluctuation  of each
of the  Q sub bands respectively represent the global sparseness, the local sparseness, and the short
time burstiness. The processor 301 is specifically configured to: determine whether there is a first sub
band in the Q sub bands,    where a local peak-to-average proportion of the first sub band is greater than
an eleventh preset value, a global peak-to-average proportion of the first sub band is greater than a
twelfth preset value, and a short-time peak energy fluctuation of the first sub band is greater than a
thirteenth preset value; and when there is the first sub band in the    Q sub bands, determine to use the
first encoding method to encode the current audio frame.
[00143]     Specifically, the processor 301 may calculate the global peak-to-average proportion by
using the following formula:
            p2s(i) = e(i) /    -* Zs(k)                                                      Formula 1.7
            where e(i) represents peak energy of an ith sub band in the     Q sub bands,  s(k) represents
energy of a kth spectral envelope in the P spectral envelopes, and p2s(i) represents a global peak-to
average proportion of the    ith sub band.
[00144]     The processor 301 may calculate the local peak-to-average proportion by using the
following formula:
                                       1       h(i)
            p2a(i) = e(i) /                   *I    s(k)                                     Formula 1.8
                              (h(i) -1I(i) +1   =ei
            where e(i) represents the peak energy of the i"' sub band in the          Q sub  bands, s(k)
represents the energy of the kth spectral envelope in the P spectral envelopes, h(i) represents an index
of a spectral envelope that is included in the        i*h sub band and that has a highest frequency,   l(i)
represents an index of a spectral envelope that is included in the i* sub band and that has a lowest
frequency, p2a(i) represents a local peak-to-average proportion of the ih sub band, and h(i) is less
than or equal to P-1.
                                                         50

[00145]      The processor 301 may calculate the short-time peak energy fluctuation by using the
following formula:
              dev(i) = (2* e(i)) / (e, + e2 )                                                   Formula 1.9
             where e(i) represents the peak energy of the ith sub band in the      Q sub bands of the current
audio frame, and el and    e2 represent peak energy of specific frequency bands of audio frames before
the current audio frame. Specifically, assuming that the current audio frame is an Mth audio frame, a
spectral envelope in which peak energy of the ih sub band of the current audio frame is located is
determined. It is assumed that the spectral envelope in which the peak energy is located is i1 . Peak
energy within a range from an       (ii-t)*h spectral envelope to an (ii+t)h spectral envelope in an (M-1),h
audio frame is determined, and the peak energy is ei. Similarly, peak energy within a range from an
(ii-t)*' spectral envelope to an (ii+t),' spectral envelope in an (M-2)t audio frame is determined, and
the peak energy is e2.
[00146]      A person skilled in the art may understand that, the eleventh preset value, the twelfth preset
value, and the thirteenth preset value may be determined according to a simulation experiment.
Appropriate preset values may be determined by means of a simulation experiment, so that a good
encoding effect can be obtained when an audio frame meeting the foregoing condition is encoded by
using the first encoding method.
[00147]      Optionally, in another embodiment, an appropriate encoding method may be selected for
the current audio frame by using the band-limited sparseness. In this case, the sparseness of
distribution of the energy on the spectrums includes band-limited sparseness of distribution of the
energy on the spectrums. In this case, the processor 301 is specifically configured to determine a
demarcation frequency of each of the N audio frames. The processor 301 is specifically configured
to determine a band-limited sparseness parameter according to the demarcation frequency of each of
the N audio frames.
[00148]      A person skilled in the art may understand that, the fourth preset proportion and the
fourteenth preset value may be determined according to a simulation experiment. An appropriate
preset value and preset proportion may be determined according to a simulation experiment, so that
a good encoding effect can be obtained when an audio frame meeting the foregoing condition is
encoded by using the first encoding method.
[00149]      For example, the processor 301 may determine energy of each of P spectral envelopes of
the current audio frame, and search for a demarcation frequency from a low frequency to a high
frequency in a manner that a proportion that energy that is less than the demarcation frequency
accounts for in total energy of the current audio frame is the fourth preset proportion. The band
limited sparseness parameter may be an average value of the demarcation frequencies of the N audio
                                                        51

frames. In this case, the processor 301 is specifically configured to: when it is determined that the
band-limited sparseness parameter of the audio frames is less than a fourteenth preset value,
determine to use the first encoding method to encode the current audio frame. Assuming that N is 1,
the demarcation frequency of the current audio frame is the band-limited sparseness parameter.
Assuming that N is an integer greater than 1, the processor 301 may determine that the average value
of the demarcation frequencies of the N audio frames is the band-limited sparseness parameter. A
person skilled in the art may understand that, the demarcation frequency determining mentioned
above is merely an example. Alternatively, the demarcation frequency determining method may be
searching for a demarcation frequency from a high frequency to a low frequency or may be another
method.
[00150]     Further, to avoid frequent switching between the first encoding method and the second
encoding method, the processor 301 may be further configured to set a hangover period. The
processor 301 may be configured to: for an audio frame in the hangover period, use an encoding
method used for an audio frame at a start position of the hangover period. In this way, a switching
quality decrease caused by frequent switching between different encoding methods can be avoided.
[00151]     If a hangover length of the hangover period is L, the processor 301 may be configured to
determine that L audio frames after the current audio frame all belong to a hangover period of the
current audio frame. If sparseness of distribution, on a spectrum, of energy of an audio frame
belonging the hangover period is different from sparseness of distribution, on a spectrum, of energy
of an audio frame at a start position of the hangover period, the processor 301 may be configured to
determine that the audio frame is still encoded by using an encoding method that is the same as that
used for the audio frame at the start position of the hangover period.
[00152]     The hangover period length may be updated according to sparseness of distribution, on a
spectrum, of energy of an audio frame in the hangover period, until the hangover period length is 0.
[00153]     For example, if the processor 301 determines to use the first encoding method for an     1 h
audio frame and a length of a preset hangover period is L, the processor 301 may determine that the
first encoding method is used for an (I+1)th audio frame to an (I+L)th audio frame. Then, the processor
301 may determine sparseness of distribution, on a spectrum, of energy of the (I+1      )h audio frame,
and re-calculate the hangover period according to the sparseness of distribution, on the spectrum, of
the energy of the (I+1)th audio frame. If the (1+1 )th audio frame still meets a condition of using the
first encoding method, the processor 301 may determine that a subsequent hangover period is still the
preset hangover period L. That is, the hangover period starts from an (L+ 2 )th audio frame to an
(I+1+L)th audio frame. If the (I+1)th audio frame does not meet the condition of using the first
encoding method, the processor 301 may re-determine the hangover period according to the
                                                    52

sparseness of distribution, on the spectrum, of the energy of the (i+1)th audio frame. For example, the
processor 301 may re-determine that the hangover period is L-L 1, where LI is a positive integer less
than or equal to L. If LI is equal to L, the hangover period length is updated to 0. In this case, the
processor 301 may re-determine the encoding method according to the sparseness of distribution, on
the spectrum, of the energy of the (I+1)h audio frame. If LI is an integer less than L, the processor
301 may re-determine the encoding method according to sparseness of distribution, on a spectrum,
of energy of an (I+1+L-L1)th audio frame. However, because the (I+1)lh audio frame is in a hangover
period of the  ph  audio frame, the (I+1)th audio frame is still encoded by using the first encoding
method. LI may be referred to as a hangover update parameter, and a value of the hangover update
parameter may be determined according to sparseness of distribution, on a spectrum, of energy of an
input audio frame. In this way, hangover period update is related to sparseness of distribution, on a
spectrum, of energy of an audio frame.
[00154]     For example, when a general sparseness parameter is determined and the general
sparseness parameter is a first minimum bandwidth, the processor 301 may re-determine the hangover
period according to a minimum bandwidth, distributed on a spectrum, of first-preset-proportion
energy of an audio frame. It is assumed that it is determined to use the first encoding method to encode
the I* audio frame, and a preset hangover period is L. The processor 301 may determine a minimum
bandwidth, distributed on a spectrum, of first-preset-proportion energy of each of H consecutive audio
frames including the (I+1)h audio frame, where H is a positive integer greater than 0. If the (I+1)th
audio frame does not meet the condition of using the first encoding method, the processor 301 may
determine a quantity of audio frames whose minimum bandwidths, distributed on spectrums, of first
preset-proportion energy are less than a fifteenth preset value (the quantity is briefly referred to as a
first hangover parameter). When a minimum bandwidth, distributed on a spectrum, of first-preset
proportion energy of an (L+1)*' audio frame is greater than a sixteenth preset value and is less than a
seventeenth preset value, and the first hangover parameter is less than an eighteenth preset value, the
processor 301 may subtract the hangover period length by 1, that is, the hangover update parameter
is 1. The sixteenth preset value is greater than the first preset value. When the minimum bandwidth,
distributed on the spectrum, of the first-preset-proportion energy of the (L+1)th audio frame is greater
than the seventeenth preset value and is less than a nineteenth preset value, and the first hangover
parameter is less than the eighteenth preset value, the processor 301 may subtract the hangover period
length by 2, that is, the hangover update parameter is 2. When the minimum bandwidth, distributed
on the spectrum, of the first-preset-proportion energy of the (L+ I )th audio frame is greater than the
nineteenth preset value, the processor 301 may set the hangover period to 0. When the first hangover
parameter and the minimum bandwidth, distributed on the spectrum, of the first-preset-proportion
                                                     53

energy of the (L+1)h audio frame do not meet one or more of the sixteenth preset value to the
nineteenth preset value, the processor 301 may determine that the hangover period remains
unchanged.
[00155]     A person skilled in the art may understand that, the preset hangover period may be set
according to an actual status, and the hangover update parameter also may be adjusted according to
an actual status. The fifteenth preset value to the nineteenth preset value may be adjusted according
to an actual status, so that different hangover periods may be set.
[00156]      Similarly, when the general sparseness parameter includes a second minimum bandwidth
and a third minimum bandwidth, or the general sparseness parameter includes a first energy
proportion, or the general sparseness parameter includes a second energy proportion and a third
energy proportion, the processor 301 may set a corresponding preset hangover period, a
corresponding hangover update parameter, and a related parameter used to determine the hangover
update parameter, so that a corresponding hangover period can be determined, and frequent switching
between encoding methods is avoided.
[00157]     When the encoding method is determined according to the burst sparseness (that is, the
encoding method is determined according to global sparseness, local sparseness, and short-time
burstiness of distribution, on a spectrum, of energy of an audio frame), the processor 301 may set a
corresponding hangover period, a corresponding hangover update parameter, and a related parameter
used to determine the hangover update parameter, to avoid frequent switching between encoding
methods. In this case, the hangover period may be less than the hangover period that is set in the case
of the general sparseness parameter.
[00158]     When the encoding method is determined according to a band-limited characteristic of
distribution of energy on a spectrum, the processor 301 may set a corresponding hangover period, a
corresponding hangover update parameter, and a related parameter used to determine the hangover
update parameter, to avoid frequent switching between encoding methods. For example, the processor
301 may calculate a proportion of energy of a low spectral envelope of an input audio frame to energy
of all spectral envelopes, and determine the hangover update parameter according to the proportion.
Specifically, the processor 301 may determine the proportion of the energy of the low spectral
envelope to the energy of all the spectral envelopes by using the following formula:
                      y
                     Ys(k)
             RIW  =                                                               Formula 1.10
                     Js(k)
                     k=0
            where ROW represents the proportion of the energy of the low spectral envelope to the
energy of all the spectral envelopes, s(k) represents energy of a k*h spectral envelope, y represents an
                                                    54

index of a highest spectral envelope of a low frequency band, and P indicates that the audio frame is
divided into P spectral envelopes in total. In this case, if RI0 w is greater than a twentieth preset value,
the hangover update parameter is 0. If RlOw is greater than a twenty-first preset value, the hangover
update parameter may have a relatively small value, where the twentieth preset value is greater than
the twenty-first preset value. If RlOw   is not greater than the twenty-first preset value, the hangover
parameter may have a relatively large value. A person skilled in the art may understand that, the
twentieth preset value and the twenty-first preset value may be determined according to a simulation
experiment, and the value of the hangover update parameter also may be determined according to an
experiment.
[00159]     In addition, when the encoding method is determined according to a band-limited
characteristic of distribution of energy on a spectrum, the processor 301 may further determine a
demarcation frequency of an input audio frame, and determine the hangover update parameter
according to the demarcation frequency, where the demarcation frequency may be different from a
demarcation frequency used to determine a band-limited sparseness parameter. If the demarcation
frequency is less than a twenty-second preset value, the processor 301 may determine that the
hangover update parameter is 0. If the demarcation frequency is less than a twenty-third preset value,
the processor 301 may determine that the hangover update parameter has a relatively small value. If
the demarcation frequency is greater than the twenty-third preset value, the processor 301 may
determine that the hangover update parameter may have a relatively large value. A person skilled in
the art may understand that, the twenty-second preset value and the twenty-third preset value may be
determined according to a simulation experiment, and the value of the hangover update parameter
also may be determined according to an experiment.
[00160]     A person of ordinary skill in the art may be aware that, in combination with the examples
described in the embodiments disclosed in this specification, units and algorithm steps may be
implemented by electronic hardware or a combination of computer software and electronic hardware.
Whether the functions are performed by hardware or software depends on particular applications and
design constraint conditions of the technical solutions. A person skilled in the art may use different
methods to implement the described functions for each particular application, but it should not be
considered that the implementation goes beyond the scope of the present invention.
[00161]     It may be clearly understood by a person skilled in the art that, for the purpose of
convenient and brief description, for a detailed working process of the foregoing system, apparatus,
and unit, reference may be made to a corresponding process in the foregoing method embodiments,
and details are not described herein.
                                                     55

[00162]     In the several embodiments provided in the present application, it should be understood
that the disclosed system, apparatus, and method may be implemented in other manners. For example,
the described apparatus embodiment is merely exemplary. For example, the unit division is merely
logical function division and may be other division in actual implementation. For example, a plurality
of units or components may be combined or integrated into another system, or some features may be
ignored or not performed. In addition, the displayed or discussed mutual couplings or direct couplings
or communication connections may be implemented through some interfaces. The indirect couplings
or communication connections between the apparatuses or units may be implemented in electronic,
mechanical, or other forms.
[00163]     The units described as separate parts may or may not be physically separate, and parts
displayed as units may or may not be physical units, may be located in one position, or may be
distributed on a plurality of network units. A part or all of the units may be selected according to
actual needs to achieve the objectives of the solutions of the embodiments.
[00164]     In addition, functional units in the embodiments of the present invention may be integrated
into one processing unit, or each of the units may exist alone physically, or two or more units are
integrated into one unit.
[00165]      When the functions are implemented in a form of a software functional unit and sold or
used as an independent product, the functions may be stored in a computer-readable storage medium.
Based on such an understanding, the technical solutions of the present invention essentially, or the
part contributing to the prior art, or a part of the technical solutions may be implemented in a form of
a software product. The software product is stored in a storage medium and includes several
instructions for instructing a computer device (which may be a personal computer, a server, or a
network device) or a processor to perform all or a part of the steps of the methods described in the
embodiments of the present invention. The foregoing storage medium includes: any medium that can
store program code, such as a USB flash drive, a removable hard disk, a read-only memory (ROM,
Read-Only Memory), a random access memory (RAM, Random Access Memory), a magnetic disk,
or an optical disc.
[00166]     The foregoing descriptions are merely specific embodiments of the present invention, but
are not intended to limit the protection scope of the present invention. Any variation or replacement
readily figured out by a person skilled in the art within the technical scope disclosed in the present
invention shall fall within the protection scope of the present invention. Therefore, the protection
scope of the present invention shall be subject to the protection scope of the claims.
                                                       56

                                                CLAIMS
      1. An audio encoding method, wherein the method includes:
      determining sparseness of distribution, on spectrums, of energy of N input audio frames, wherein
the N audio frames comprise a current audio frame, and N is a positive integer; and
      determining, according to the sparseness of distribution, on the spectrums, of the energy of the
N audio frames, whether to use a first encoding method or a second encoding method to encode the
current audio frame, wherein the first encoding method is an encoding method that is based on time
frequency transform and transform coefficient quantization and that is not based on linear prediction,
and the second encoding method is a linear-predication-based encoding method.
      2. The method according to claim 1, wherein the determining sparseness of distribution, on
spectrums, of energy of N input audio frames includes:
      dividing a spectrum of each of the N audio frames into P spectral envelopes, wherein P is a
positive integer; and
      determining a general sparseness parameter according to energy of the P spectral envelopes of
each of the N audio frames, wherein the general sparseness parameter indicates the sparseness of
distribution, on the spectrums, of the energy of the N audio frames.
      3. The method according to claim 2, wherein the general sparseness parameter includes a first
minimum bandwidth;
      the determining a general sparseness parameter according to energy of the P spectral envelopes
of each of the N audio frames includes:
      determining an average value of minimum bandwidths, distributed on the spectrums, of first
preset-proportion energy of the N audio frames according to the energy of the P spectral envelopes of
each of the N audio frames, wherein the average value of the minimum bandwidths, distributed on
the spectrums, of the first-preset-proportion energy of the N audio frames is the first minimum
bandwidth; and
      the determining, according to the sparseness of distribution, on the spectrums, of the energy of
the N audio frames, whether to use a first encoding method or a second encoding method to encode
the current audio frame includes:
      when the first minimum bandwidth is less than a first preset value, determining to use the first
encoding method to encode the current audio frame; or when the first minimum bandwidth is greater
than the first preset value, determining to use the second encoding method to encode the current audio
frame.
                                                     57

      4. The method according to claim 3, wherein the determining an average value of minimum
bandwidths, distributed on the spectrums, of first-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames includes:
      sorting the energy of the P spectral envelopes of each audio frame in descending order;
      determining, according to the energy, sorted in descending order, of the P spectral envelopes of
each of the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that
accounts for not less than the first preset proportion of each of the N audio frames; and
      determining, according to the minimum bandwidth, distributed on the spectrum, of the energy
that accounts for not less than the first preset proportion of each of the N audio frames, an average
value of minimum bandwidths, distributed on the spectrums, of energy that accounts for not less than
the first preset proportion of the N audio frames.
      5. The method according to claim 2, wherein the general sparseness parameter includes a first
energy proportion;
      the determining a general sparseness parameter according to energy of the P spectral envelopes
of each of the N audio frames includes:
      selecting Pi spectral envelopes from the P spectral envelopes of each of the N audio frames; and
      determining the first energy proportion according to energy of the P1 spectral envelopes of each
of the N audio frames and total energy of the respective N audio frames, wherein Pi is a positive
integer less than P; and
      the determining, according to the sparseness of distribution, on the spectrums, of the energy of
the N audio frames, whether to use a first encoding method or a second encoding method to encode
the current audio frame includes:
      when the first energy proportion is greater than a second preset value, determining to use the
first encoding method to encode the current audio frame; or when the first energy proportion is less
than the second preset value, determining to use the second encoding method to encode the current
audio frame.
      6. The method according to claim 5, wherein energy of any one of the P1 spectral envelopes is
greater than energy of any one of the other spectral envelopes in the P spectral envelopes except the
Pi spectral envelopes.
      7. The method according to claim 2, wherein the general sparseness parameter includes a second
minimum bandwidth and a third minimum bandwidth;
      the determining a general sparseness parameter according to energy of the P spectral envelopes
of each of the N audio frames includes:
                                                    58

      determining an average value of minimum bandwidths, distributed on the spectrums, of second
preset-proportion energy of the N audio frames and determining an average value of minimum
bandwidths, distributed on the spectrums, of third-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, wherein the average
value of the minimum bandwidths, distributed on the spectrums, of the second-preset-proportion
energy of the N audio frames is used as the second minimum bandwidth, the average value of the
minimum bandwidths, distributed on the spectrums, of the third-preset-proportion energy of the N
audio frames is used as the third minimum bandwidth, and the second preset proportion is less than
the third preset proportion; and
      the determining, according to the sparseness of distribution, on the spectrums, of the energy of
the N audio frames, whether to use a first encoding method or a second encoding method to encode
the current audio frame includes:
      when the second minimum bandwidth is less than a third preset value and the third minimum
bandwidth is less than a fourth preset value, determining to use the first encoding method to encode
the current audio frame;
      when the third minimum bandwidth is less than a fifth preset value, determining to use the first
encoding method to encode the current audio frame; or
      when the third minimum bandwidth is greater than a sixth preset value, determining to use the
second encoding method to encode the current audio frame, wherein
      the fourth preset value is greater than or equal to the third preset value, the fifth preset value is
less than the fourth preset value, and the sixth preset value is greater than the fourth preset value.
      8. The method according to claim 7, wherein the determining an average value of minimum
bandwidths, distributed on the spectrums, of second-preset-proportion energy of the N audio frames
and determining an average value of minimum bandwidths, distributed on the spectrums, of third
preset-proportion energy of the N audio frames according to the energy of the P spectral envelopes of
each of the N audio frames includes:
      sorting the energy of the P spectral envelopes of each audio frame in descending order;
      determining, according to the energy, sorted in descending order, of the P spectral envelopes of
each of the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that
accounts for not less than the second preset proportion of each of the N audio frames;
      determining, according to the minimum bandwidth, distributed on the spectrum, of the energy
that accounts for not less than the second preset proportion of each of the N audio frames, an average
value of minimum bandwidths, distributed on the spectrums, of energy that accounts for not less than
the second preset proportion of the N audio frames;
                                                    59

      determining, according to the energy, sorted in descending order, of the P spectral envelopes of
each of the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that
accounts for not less than the third preset proportion of each of the N audio frames; and
      determining, according to the minimum bandwidth, distributed on the spectrum, of the energy
that accounts for not less than the third preset proportion of each of the N audio frames, an average
value of minimum bandwidths, distributed on the spectrums, of energy that accounts for not less than
the third preset proportion of the N audio frames.
      9. The method according to claim 2, wherein the general sparseness parameter includes a second
energy proportion and a third energy proportion;
      the determining a general sparseness parameter according to energy of the P spectral envelopes
of each of the N audio frames includes:
      selecting P2 spectral envelopes from the P spectral envelopes of each of the N audio frames;
      determining the second energy proportion according to energy of the P2 spectral envelopes of
each of the N audio frames and total energy of the respective N audio frames;
      selecting P3 spectral envelopes from the P spectral envelopes of each of the N audio frames; and
      determining the third energy proportion according to energy of the P 3 spectral envelopes of each
of the N audio frames and the total energy of the respective N audio frames, wherein P 2 and P 3 are
positive integers less than P, and P2 is less than P 3 ; and
      the determining, according to the sparseness of distribution, on the spectrums, of the energy of
the N audio frames, whether to use a first encoding method or a second encoding method to encode
the current audio frame includes:
      when the second energy proportion is greater than a seventh preset value and the third energy
proportion is greater than an eighth preset value, determining to use the first encoding method to
encode the current audio frame;
      when the second energy proportion is greater than a ninth preset value, determining to use the
first encoding method to encode the current audio frame; or
      when the third energy proportion is less than a tenth preset value, determining to use the second
encoding method to encode the current audio frame.
      10. The method according to claim 9, wherein the P 2 spectral envelopes are P 2 spectral envelopes
having maximum energy in the P spectral envelopes; and
      the P3 spectral envelopes are P 3 spectral envelopes having maximum energy in the P spectral
envelopes.
                                                     60

      11. The method according to claim 1, wherein the sparseness of distribution of the energy on the
spectrums includes global sparseness, local sparseness, and short-time burstiness of distribution of
the energy on the spectrums.
      12. The method according to claim 11, wherein N is 1, and the N audio frames are the current
audio frame; and
     the determining sparseness of distribution, on spectrums, of energy of N input audio frames
includes:
     dividing a spectrum of the current audio frame into     Q sub   bands; and
     determining a burst sparseness parameter according to peak energy of each of the        Q sub  bands
of the spectrum of the current audio frame, wherein the burst sparseness parameter is used to indicate
global sparseness, local sparseness, and short-time burstiness of the current audio frame.
      13. The method according to claim 12, wherein the burst sparseness parameter includes: a global
peak-to-average proportion of each of the    Q sub bands,   a local peak-to-average proportion of each of
the Q sub   bands, and a short-time peak energy fluctuation of each of the      Q sub bands, wherein the
global peak-to-average proportion is determined according to the peak energy in the sub band and
average energy of all the sub bands of the current audio frame, the local peak-to-average proportion
is determined according to the peak energy in the sub band and average energy in the sub band, and
the short-time peak energy fluctuation is determined according to the peak energy in the sub band and
peak energy in a specific frequency band of an audio frame before the audio frame; and
     the determining, according to the sparseness of distribution, on the spectrums, of the energy of
the N audio frames, whether to use a first encoding method or a second encoding method to encode
the current audio frame includes:
     determining whether there is a first sub band in the  Q sub bands,   wherein a local peak-to-average
proportion of the first sub band is greater than an eleventh preset value, a global peak-to-average
proportion of the first sub band is greater than a twelfth preset value, and a short-time peak energy
fluctuation of the first sub band is greater than a thirteenth preset value; and
     when there is the first sub band in the Q sub bands, determining to use the first encoding method
to encode the current audio frame.
      14. The method according to claim 1, wherein the sparseness of distribution of the energy on the
spectrums includes band-limited characteristics of distribution of the energy on the spectrums.
      15. The method according to claim 14, wherein the determining sparseness of distribution, on
spectrums, of energy of N input audio frames includes:
     determining a demarcation frequency of each of the N audio frames; and
                                                     61

      determining a band-limited sparseness parameter according to the demarcation frequency of
each of the N audio frames.
      16. The method according to claim 15, wherein the band-limited sparseness parameter is an
average value of the demarcation frequencies of the N audio frames; and
      the determining, according to the sparseness of distribution, on the spectrums, of the energy of
the N audio frames, whether to use a first encoding method or a second encoding method to encode
the current audio frame includes:
      when it is determined that the band-limited sparseness parameter of the audio frames is less than
a fourteenth preset value, determining to use the first encoding method to encode the current audio
frame.
      17. An apparatus, wherein the apparatus includes:
      an obtaining unit, configured to obtain N audio frames, wherein the N audio frames comprise a
current audio frame, and N is a positive integer; and
      a determining unit, configured to determine sparseness of distribution, on the spectrums, of
energy of the N audio frames obtained by the obtaining unit; and
      the determining unit is further configured to determine, according to the sparseness of
distribution, on the spectrums, of the energy of the N audio frames, whether to use a first encoding
method or a second encoding method to encode the current audio frame, wherein the first encoding
method is an encoding method that is based on time-frequency transform and transform coefficient
quantization and that is not based on linear prediction, and the second encoding method is a linear
predication-based encoding method.
      18. The apparatus according to claim 17, wherein
      the determining unit is specifically configured to divide a spectrum of each of the N audio frames
into P spectral envelopes, and determine a general sparseness parameter according to energy of the P
spectral envelopes of each of the N audio frames, wherein P is a positive integer, and the general
sparseness parameter indicates the sparseness of distribution, on the spectrums, of the energy of the
N audio frames.
      19. The apparatus according to claim 18, wherein the general sparseness parameter includes a
first minimum bandwidth;
      the determining unit is specifically configured to determine an average value of minimum
bandwidths, distributed on the spectrums, of first-preset-proportion energy of the N audio frames
according to the energy of the P spectral envelopes of each of the N audio frames, wherein the average
value of the minimum bandwidths, distributed on the spectrums, of the first-preset-proportion energy
of the N audio frames is the first minimum bandwidth; and
                                                    62

      the determining unit is specifically configured to: when the first minimum bandwidth is less than
a first preset value, determine to use the first encoding method to encode the current audio frame; and
when the first minimum bandwidth is greater than the first preset value, determine to use the second
encoding method to encode the current audio frame.
      20. The apparatus according to claim 19, wherein the determining unit is specifically configured
to: sort the energy of the P spectral envelopes of each audio frame in descending order; determine,
according to the energy, sorted in descending order, of the P spectral envelopes of each of the N audio
frames, a minimum bandwidth, distributed on the spectrum, of energy that accounts for not less than
the first preset proportion of each of the N audio frames; and determine, according to the minimum
bandwidth, distributed on the spectrum, of the energy that accounts for not less than the first preset
proportion of each of the N audio frames, an average value of minimum bandwidths, distributed on
the spectrums, of energy that accounts for not less than the first preset proportion of the N audio
franies.
      21. The apparatus according to claim 18, wherein the general sparseness parameter includes a
first energy proportion;
      the determining unit is specifically configured to select P1 spectral envelopes from the P spectral
envelopes of each of the N audio frames, and determine the first energy proportion according to
energy of the P1 spectral envelopes of each of the N audio frames and total energy of the respective
N audio frames, wherein Pi is a positive integer less than P; and
      the determining unit is specifically configured to: when the first energy proportion is greater
than a second preset value, detennine to use the first encoding method to encode the current audio
frame; and when the first energy proportion is less than the second preset value, determine to use the
second encoding method to encode the current audio frame.
      22. The apparatus according to claim 21, wherein the determining unit is specifically configured
to determine the Pi spectral envelopes according to the energy of the P spectral envelopes, wherein
energy of any one of the Pi spectral envelopes is greater than energy of any one of the other spectral
envelopes in the P spectral envelopes except the P1 spectral envelopes.
      23. The apparatus according to claim 18, wherein the general sparseness parameter includes a
second minimum bandwidth and a third minimum bandwidth;
      the determining unit is specifically configured to determine an average value of minimum
bandwidths, distributed on the spectrums, of second-preset-proportion energy of the N audio frames
and determine an average value of minimum bandwidths, distributed on the spectrums, of third
preset-proportion energy of the N audio frames according to the energy of the P spectral envelopes of
each of the N audio frames, wherein the average value of the minimum bandwidths, distributed on
                                                     63

the spectrums, of the second-preset-proportion energy of the N audio frames is used as the second
minimum bandwidth, the average value of the minimum bandwidths, distributed on the spectrums,
of the third-preset-proportion energy of the N audio frames is used as the third minimum bandwidth,
and the second preset proportion is less than the third preset proportion; and
      the determining unit is specifically configured to: when the second minimum bandwidth is less
than a third preset value and the third minimum bandwidth is less than a fourth preset value, determine
to use the first encoding method to encode the current audio frame; when the third minimum
bandwidth is less than a fifth preset value, determine to use the first encoding method to encode the
current audio frame; and when the third minimum bandwidth is greater than a sixth preset value,
determine to use the second encoding method to encode the current audio frame, wherein
      the fourth preset value is greater than or equal to the third preset value, the fifth preset value is
less than the fourth preset value, and the sixth preset value is greater than the fourth preset value.
      24. The apparatus according to claim 23, wherein the determining unit is specifically configured
to: sort the energy of the P spectral envelopes of each audio frame in descending order; determine,
according to the energy, sorted in descending order, of the P spectral envelopes of each of the N audio
frames, a minimum bandwidth, distributed on the spectrum, of energy that accounts for not less than
the second preset proportion of each of the N audio frames; determine, according to the minimum
bandwidth, distributed on the spectrum, of the energy that accounts for not less than the second preset
proportion of each of the N audio frames, an average value of minimum bandwidths, distributed on
the spectrums, of energy that accounts for not less than the second preset proportion of the N audio
frames; determine, according to the energy, sorted in descending order, of the P spectral envelopes of
each of the N audio frames, a minimum bandwidth, distributed on the spectrum, of energy that
accounts for not less than the third preset proportion of each of the N audio frames; and determine,
according to the minimum bandwidth, distributed on the spectrum, of the energy that accounts for not
less than the third preset proportion of each of the N audio frames, an average value of minimum
bandwidths, distributed on the spectrums, of energy that accounts for not less than the third preset
proportion of the N audio frames.
      25. The apparatus according to claim 18, wherein the general sparseness parameter includes a
second energy proportion and a third energy proportion;
      the determining unit is specifically configured to: select P2 spectral envelopes from the P spectral
envelopes of each of the N audio frames, determine the second energy proportion according to energy
of the P2 spectral envelopes of each of the N audio frames and total energy of the respective N audio
frames, select P3 spectral envelopes from the P spectral envelopes of each of the N audio frames, and
determine the third energy proportion according to energy of the P3 spectral envelopes of each of the
                                                    64

N audio frames and the total energy of the respective N audio frames, wherein P2 and P 3 are positive
integers less than P, and P2 is less than P 3 ; and
      the determining unit is specifically configured to: when the second energy proportion is greater
than a seventh preset value and the third energy proportion is greater than an eighth preset value,
determine to use the first encoding method to encode the current audio frame; when the second energy
proportion is greater than a ninth preset value, determine to use the first encoding method to encode
the current audio frame; and when the third energy proportion is less than a tenth preset value,
determine to use the second encoding method to encode the current audio frame.
      26. The apparatus according to claim 25, wherein the determining unit is specifically configured
to determine, from the P spectral envelopes of each of the N audio frames, P 2 spectral envelopes
having maximum energy, and determine, from the P spectral envelopes of each of the N audio frames,
P 3 spectral envelopes having maximum energy.
      27. The apparatus according to claim 17, wherein N is 1, and the N audio frames are the current
audio frame; and
      the determining unit is specifically configured to divide a spectrum of the current audio frame
into  Q sub bands, and determine a burst sparseness parameter according to peak energy of each of the
Q   sub bands of the spectrum of the current audio frame, wherein the burst sparseness parameter is
used to indicate global sparseness, local sparseness, and short-time burstiness of the current audio
frame.
      28. The apparatus according to claim 27, wherein the determining unit is specifically configured
to determine a global peak-to-average proportion of each of the   Q sub bands,  a local peak-to-average
proportion of each of the   Q sub bands,  and a short-time peak energy fluctuation of each of the Q sub
bands, wherein the global peak-to-average proportion is determined by the determining unit according
to the peak energy in the sub band and average energy of all the sub bands of the current audio frame,
the local peak-to-average proportion is determined by the determining unit according to the peak
energy in the sub band and average energy in the sub band, and the short-time peak energy fluctuation
is determined according to the peak energy in the sub band and peak energy in a specific frequency
band of an audio frame before the audio frame; and
      the determining unit is specifically configured to: determine whether there is a first sub band in
the  Q sub bands,  wherein a local peak-to-average proportion of the first sub band is greater than an
eleventh preset value, a global peak-to-average proportion of the first sub band is greater than a
twelfth preset value, and a short-time peak energy fluctuation of the first sub band is greater than a
thirteenth preset value; and when there is the first sub band in the Q sub bands,   determine to use the
first encoding method to encode the current audio frame.
                                                    65

      29. The apparatus according to claim 17, wherein the determining unit is specifically configured
to determine a demarcation frequency of each of the N audio frames; and
      the determining unit is specifically configured to determine a band-limited sparseness parameter
according to the demarcation frequency of each of the N audio frames.
      30. The apparatus according to claim 29, wherein the band-limited sparseness parameter is an
average value of the demarcation frequencies of the N audio frames; and
      the determining unit is specifically configured to: when it is determined that the band-limited
sparseness parameter of the audio frames is less than a fourteenth preset value, determine to use the
first encoding method to encode the current audio frame.
                                                    66

<removed-date>
                                                 <U+2701>
              Determine sparseness of distribution, on spectrums, of energy of N   101
                                     input audio frames
                 Determine, according to the sparseness of distribution, on the    102
               spectrums, of the energy of the N audio frames, whether to use a
               first encoding method or a second encoding method to encode a
<removed-apn>
                                     current audio frame
                                             <U+2702><U+2704><U+260E><U+2706> <U+271D>
                                                                 200
                                       Apparatus
                                                                 201
                                     Obtaining unit
                                                                 202
                                   Determining unit
                                             <U+2702><U+2704><U+260E><U+2706> <U+271E>
                                                                 300
                                              Apparatus
                                                           301
                                           Processor         Bus system
                                                                303
                                              302
                               Memory
                                             <U+2702><U+2704><U+260E><U+2706> <U+271F>

