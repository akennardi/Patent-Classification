  Abstract
  A positioning device comprising a positioning calculation unit to perform positioning
  calculation by using a state quantity including at least either an ionospheric residual or a
5 tropospheric residual that remains after error correction processing is performed on
  observation data from a positioning satellite.
  9865705_1 (GHMatters) P104009.AU.1

                                                         1
                                           POSITIONING DEVICE
   Technical Field
   [0001]            The present invention relates to a positioning device that performs satellite
 5 positioning.
   Background Art
   [0002]            A positioning error in each positioning scheme will be described first.
                     In an independent positioning scheme in which a positioning device
10 independently determines a position by using code information of a GNSS (Global
   Navigation System) signal from a satellite positioning system (GNSS) such as a GPS
   (Global Positioning System), a positioning accuracy is on the order of meters due to an
   error included in the GNSS signal.
                     In comparison with the independent positioning scheme using the code
15 information, a positioning scheme using carrier-level correction data realizes highly
   accurate positioning on the order of centimeters.
                     In particular, a scheme is called a network type RTK (Realtime Kinematic)
   scheme in which a GNSS signal is received at a plurality of electronic reference points
   (distributed at intervals of ten or so kilometers in Japan), the accurate positions of which
20 are already known, to estimate an amount of error included in the GNSS signal
   invertedly from the known positions of the permanent GPS stations, distribute it to a
   user as correction data, and perform positioning on the order of centimeters together
   with a GNSS signal obtained by a positioning device on the user' s side.
                     Such positioning scheme includes a positioning reinforcement system called a
25 FKP (Flaechen Korrekktur Punkt) scheme.
   9865645_1 (GHMatters) P104009.AU.1

                                                        2
                     The positioning device realizes highly accurate positioning on the order of
   centimeters by acquiring the correction data valid in a local area around the electronic
   reference point closest to the device in one-to-one communication via a communication
   network using terrestrial waves with abundant communication capacity such as a
 5 wireless LAN (Local Area Network) or a mobile phone, and eliminating an error
   included in a GPS signal with the use of the correction data.
                     On the other hand, the highly accurate positioning on the order of centimeters
   is also realized in a positioning scheme that uses an artificial satellite such as a quasi
   zenith satellite to distribute correction data valid in a wide area nationwide.
10                   In this positioning scheme, the correction data is distributed from the quasi
   zenith satellite to allow a positioning device to acquire the correction data even in an
   environment where communication via the wireless LAN or mobile phone is not
   available, so that the error in the GNSS signal is eliminated by using the correction data
   to be able to realize the highly accurate positioning on the order of centimeters.
15                   JP Patent Application Publication No. 2002-323552 A discloses a scheme as
   the positioning scheme using the quasi-zenith satellite, for example.
   [0003]            The correction data valid in the nationwide wide area is generated by a ground
   station and transmitted to the quasi-zenith satellite in the scheme using the artificial
   satellite, particularly the quasi-zenith satellite.
20                   The same correction data is universally broadcast from the quasi-zenith
   satellite to service areas.
                     A user generates correction data of his own position by using the broadcasted
   correction data and corrects the GNSS signal to be able to perform positioning on the
   order of centimeters.
25                   Here, the correction data used in the network type RTK scheme such as the
   9865645_1 (GHMatters) P104009.AU.1

                                                          3
   conventional FKP scheme requires enormous communication capacity of approximately
   2 Mbps to cover all across Japan.
                     The artificial satellite such as the quasi-zenith satellite has a limited
   communication band so that the ground station compresses the correction data to
 5 transmit it to the quasi-zenith satellite.
                     Distribution information including the compressed correction data and
   reliability information of the correction data is called reinforcement information.
                     The quasi-zenith satellite then broadcasts the reinforcement information to the
   wide area.
10                   Therefore, in the scheme using the quasi-zenith satellite, the positioning
   device is required to perform error correction on the basis of the reinforcement
   information in which the information amount is compressed.
   Summary of the Invention
15 [0004]            According to an aspect of the present invention, there is provided a
   positioning device comprising a positioning calculation unit to perform positioning
   calculation by using a state quantity including at least either an ionospheric residual or a
   tropospheric residual that remains after error correction processing is performed on
   observation data from a positioning satellite.
20 [0005]            In an embodiment, the positioning calculation unit obtains a positioning result
   from which at least either the ionospheric residual or the tropospheric residual is
   eliminated. In another embodiment, the positioning calculation unit performs
   positioning calculation by using the state quantity including LI-wave ambiguity and
   wide-lane ambiguity. In a further embodiment, the positioning calculation unit includes:
25 a time extrapolation calculation unit to perform time extrapolation calculation on a state
   9865645_1 (GHMatters) P104009.AU.1

                                                        4
   quantity of a past epoch including at least either the ionospheric residual or the
   tropospheric residual to estimate a state quantity of a current epoch including at least
   either the ionospheric residual or the tropospheric residual; a residual calculation unit to
   calculate a double difference residual by using double difference data obtained by
 5 double difference calculation on the observation data, a geometric distance between the
   positioning satellite and the positioning device obtained from the observation data, and
   the state quantity of the current epoch estimated by the time extrapolation calculation
   unit; and an observation update calculation unit to perform observation update
   calculation using the double difference residual to update the state quantity of the
10 current epoch estimated by the time extrapolation calculation unit. In an example, the
   observation update calculation unit performs observation update calculation based on an
   assumption that a value of the ionospheric residual included in the double difference
   residual is zero to update the state quantity of the current epoch including at least the
   ionospheric residual and estimated by the time extrapolation calculation unit. In another
15 example, the observation update calculation unit performs observation update
   calculation based on an assumption that a value of the tropospheric residual included in
   the double difference residual is zero to update the state quantity of the current epoch
   including at least the tropospheric residual and estimated by the time extrapolation
   calculation unit.
20 [0006]            Also disclosed herein is a positioning device that includes: a receiving unit to
   receive a value of an error used in satellite positioning at a first time interval and receive
   a correction value of the error at a second time interval that is 1/n (n is an integer of two
   or larger) time interval of the first time interval; and an error correction unit to correct
   the value of the error at the second time interval by using the correction value, wherein
25 the receiving unit receives at the first time interval a value of a frequency-dependent
   9865645_1 (GHMatters) P104009.AU.1

                                                      5
   error that is an error dependent on a frequency of a carrier from a positioning satellite
   and a value of a frequency-independent error that is an error independent of the
   frequency of the carrier and receives, at the second time interval, a correction value of
   the frequency-independent error, and the error correction unit corrects the value of the
 5 frequency-independent error at the second time interval by using the correction value.
   [0006a]           In an embodiment, the positioning device further comprises a correction value
   calculation unit to calculate a correction value of the frequency-dependent error for the
   every second time interval, wherein the error correction unit corrects, at the second time
   interval, the value of the frequency-independent error by using the correction value
10 received by the receiving unit and the value of the frequency-dependent error by using
   the correction value calculated by the correction value calculation unit. In one example,
   the correction value calculation unit calculates a correction value of the frequency
   independent error for the every second time interval by linear interpolation employing
   time extrapolation. In another embodiment, the receiving unit receives, at the first time
15 interval, at least any one of a value of an inter-frequency bias of an LI wave, a value of
   an inter-frequency bias of an L2 wave and a value of an ionospheric delay error as the
   value of the frequency-dependent error and at least any one of a value of a satellite orbit
   error, a value of an inter-frequency bias of an LO wave and a value of a tropospheric
   delay error as the value of the frequency-independent error, and receives, at the second
20 time interval, at least any one of a correction value of the satellite orbit error, a
   correction value of the inter-frequency bias of the LO wave and a correction value of the
   tropospheric delay error as the correction value of the frequency-independent error. In
   an example, the positioning device further comprises a correction value calculation unit
   to calculate a correction value of the inter-frequency bias of the LI wave for the every
25 second time interval, a correction value of the inter-frequency bias of the L2 wave for
   9865645_1 (GHMatters) P104009.AU.1

                                                          6
   the every second time interval and a correction value of the ionospheric delay error for
   the every second time interval, wherein the error correction unit corrects, at the second
   time interval, the frequency-independent error by using the correction value received by
   the receiving unit and the frequency-dependent error by using the correction value
 5 calculated by the correction value calculation unit.
   Advantageous Effects of Invention
   [0007]            According to the present invention, fine error correction can be performed at
   the second time interval by using the reinforcement information distributed at the first
10 time interval to be able to realize positioning with high accuracy (on the order of
   centimeters).
   Brief Description of Drawings
   [0008]            In order that the invention may be more clearly ascertained, embodiments will
15 now be described, by way of example, with reference to the accompanying drawing, in
   which:
                     Fig. 1 is a diagram illustrating a configuration example of a positioning
   system according to a first embodiment.
                     Fig. 2 is a diagram illustrating input/output of a positioning device according
20 to the first embodiment.
                     Fig. 3 is a table illustrating input/output data of the positioning device
   according to the first embodiment.
                   Fig. 4 is a table illustrating observation data according to the first embodiment.
                     Fig. 5 is a diagram illustrating a source of error included in a GPS signal
25 according to the first embodiment.
   9865645_1 (GHMatters) P104009.AU.1

                                                          7
                     Fig. 6 is a diagram illustrating a relationship between an error in the GPS
   signal and reinforcement information according to the first embodiment.
                     Fig. 7 is a diagram illustrating a grid point according to the first embodiment.
                     Fig. 8 is a diagram illustrating a configuration example of the positioning
 5 device according to the first embodiment.
                     Fig. 9 is a table illustrating elements of the positioning device according to the
   first embodiment.
                     Fig. 10 is a table illustrating intermediate data of the positioning device
   according to the first embodiment.
10                   Fig. 11 is a diagram illustrating a configuration example of a correction data
   creation unit according to the first embodiment.
                     Fig. 12 is a diagram illustrating a breakdown of the observation data
   according to the first embodiment.
                     Fig. 13 is a diagram illustrating double difference calculation according to the
15 first embodiment.
                     Fig. 14 is a diagram illustrating a processing flow of a Kalman filter
   according to the first embodiment.
                     Fig. 15 is a table illustrating a vector and a matrix used in the Kalman filter
   according to the first embodiment.
20                   Fig. 16 is a diagram illustrating a delay amount in a grid according to a
   second embodiment.
                     Fig. 17 is a diagram illustrating a difference between an actual delay amount
   and a delay amount in correction data in normal times according to the second
   embodiment.
25                   Fig. 18 is a diagram illustrating a difference between an actual delay amount
   9865645_1 (GHMatters) P104009.AU.1

                                                          8
   and a delay amount in correction data at the time of a strong ionospheric disturbance or
   tropospheric disturbance according to the second embodiment.
                     Fig. 19 is a table illustrating ambiguity according to the second embodiment.
                     Fig. 20 is a diagram illustrating a state quantity according to the second
 5 embodiment and a state quantity according to a conventional technique.
                     Fig. 21 is a table illustrating a dynamic model and a transition matrix
   according to the second embodiment and a dynamic model and a transition matrix
   according to a conventional technique.
                     Fig. 22 is a diagram illustrating an observation model of a pseudorange and an
10 observation model of a carrier phase according to a conventional technique.
                     Fig. 23 is a diagram illustrating an observation model of a pseudorange and an
   observation model of a carrier phase according to the second embodiment.
                     Fig. 24 is a diagram illustrating an example of a hardware configuration of the
   positioning device according to the first and second embodiments.
15
   Description of Embodiments
   [0009]            First Embodiment
                     1. System configuration
                     Fig. 1 is a diagram illustrating a configuration example of a positioning
20 system according to the present embodiment.
                     There will be described below an example where a quasi-zenith satellite is
   used in distributing reinforcement information.
                     A geostationary satellite such as a broadcasting satellite may be used instead
   of the quasi-zenith satellite, or another satellite may be used as long as it has a function
25 of uniformly broadcasting the reinforcement information to a wide area.
   9865645_1 (GHMatters) P104009.AU.1

                                                          9
                     Moreover, the example described below uses a GPS satellite as a positioning
   satellite.
                     Instead of the GPS satellite, there may be used a GNSS such as GLONASS,
   Galileo, and BeiDou or an RNSS (Regional Navigation Satellite System) such as the
 5 quasi-zenith satellite.
   [0010]            As illustrated in Fig. 1, a positioning device 100 is mounted to a mobile body
   such as an automobile.
                     The positioning device 100 receives observation data 501 and a broadcast
   ephemeris 502 transmitted from a GNSS (GPS) satellite 300.
10                   The broadcast ephemeris 502 is also called an ephemeris.
                     The positioning device 100 also receives reinforcement information 400
   transmitted from a quasi-zenith satellite 200 (also denoted as QZS).
                     An operation of the positioning device 100 will be mainly described in the
   present embodiment and a second embodiment.
15 [0011]            The quasi-zenith satellite 200 receives reinforcement information from a
   ground station not shown in Fig. 1, and distributes the received reinforcement
   information as the reinforcement information 400.
   [0012]            The GPS satellite 300 transmits the observation data 501 and the broadcast
   ephemeris 502.
20                   The positioning device 100 needs to acquire four or more of the GPS satellite
   300 in order to perform positioning.
   [0013]            2. Overview of operation of positioning device 100
                     Here, there will be described an overview of the operation of the positioning
   device 100 described in the present embodiment and the second embodiment.
25                   As illustrated in Fig. 2, the positioning device 100 receives the observation
   9865645_1 (GHMatters) P104009.AU.1

                                                             10
   data 501 and the broadcast ephemeris 502 as a GPS signal and the reinforcement
   information 400 as a QZS signal.
                     The positioning device 100 then uses the reinforcement information 400 as
   well as the observation data 501 and the broadcast ephemeris 502 to calculate the
 5 position of a positioning point (the position of the positioning device 100).
                     Fig. 3 illustrates the observation data 501, the broadcast ephemeris 502, the
   reinforcement information 400 and the position in detail.
   [0014]            3.1. Observation data
                     A pseudorange between the positioning point and the GPS satellite 300 as
10 well as a carrier phase can be derived from the observation data 501.
                     Fig. 4 illustrates the pseudorange and the carrier phase in detail.
                     Each of the pseudorange and the carrier phase derived from the observation
   data 501 includes an error.
                     The positioning device 100 uses the reinforcement information 400 to
15 eliminate the error included in each of the pseudorange and the carrier phase.
                     Note that in the following description, a pseudorange for LI wave of a GPS
   satellite i will be denoted as P (i, 1), and a pseudorange for L2 wave of the GPS satellite
   i will be denoted as P (i, 2).
                     Moreover, a carrier phase for the LI wave of the GPS satellite i will be
20 denoted as               (i, 1), and a carrier phase for the L2 wave of the GPS satellite i will be
   denoted as               (i, 2).
   [0015]            3.2. Reinforcement information
                     Fig. 5 illustrates a bias error and a noise source included in the observation
   data 501.
25                   Errors resulting from the GPS satellite 300 include an orbit error, a satellite
   9865645_1 (GHMatters) P104009.AU.1

                                                         11
   clock error, and an inter-frequency bias, and errors resulting from a signal propagation
   path include an ionospheric propagation delay error (also called an ionospheric delay
   error or an ionospheric delay amount) and a tropospheric propagation delay error (also
   called a tropospheric delay error or a tropospheric delay amount).
 5                   Errors resulting from a receiver of the positioning device 100 include a
   receiver clock error, a receiver noise and an error associated with multipath that is
   caused by an interference between a GPS signal reflected off a building and a GPS
   signal directly received from the GPS satellite 300.
                     Among these errors, the errors resulting from the receiver vary depending on
10 the performance and a reception environment of the receiver of the positioning device
   100 used by a user, and are thus not included in correction data and the reinforcement
   information but eliminated by processing of the positioning device 100.
                     The errors resulting from the GPS satellite 300 and the signal propagation
   path are compressed and distributed as the reinforcement information from the quasi
15 zenith satellite 200.
                     In addition to the errors illustrated in Fig. 5, errors resulting from an earth tide
   effect and a phase wind up effect that vary depending on the position of the positioning
   point are included in the correction data but not included in the reinforcement
   information.
20                   Fig. 6 illustrates a breakdown of the reinforcement information taking the
   aforementioned points into consideration.
   [0016]            The correction data distributed from a reference point via a wireless LAN is
   distributed at an update cycle of one second, while the errors in the reinforcement
   information according to the present embodiment are classified into a high rate and a
25 low rate according to the degree of temporal fluctuations and subjected to time
   9865645_1 (GHMatters) P104009.AU.1

                                                        12
   compression.
                     More specifically, the error classified under the high rate is updated every five
   seconds, while the error classified under the low rate is updated every 30 seconds.
                     Moreover, while conventional correction data is generated at each reference
 5 point set at intervals of about 10 to 30 km and distributed, the ionospheric delay error
   and the tropospheric delay error (with a spatial fluctuation) resulting from the signal
   path and included in the reinforcement information of the present embodiment are
   distributed only at every grid point (Fig. 7) with a 60-km radius to be subjected to space
   compression.
10                   Furthermore, in the present embodiment, the errors included in the
   reinforcement information are classified into an error which is dependent on frequency
   (a frequency-dependent error) and an error which is independent of frequency (a
   frequency-independent error).
                     The frequency-independent error is classified as the high-rate error, and the
15 frequency-dependent error is classified as the low-rate error.
                     Among the frequency-independent errors, the satellite clock error alone is
   updated every five seconds and distributed.
                     The other frequency-independent errors, namely the satellite orbit error, the
   inter-frequency bias and the tropospheric delay error, are updated every 30 seconds and
20 distributed.
                     However, for each of the satellite orbit error, the inter-frequency bias and the
   tropospheric delay error, a variation from the error measured every 30 seconds is added
   as a correction value every five seconds to the satellite clock error (updated every five
   seconds and distributed).
25                   In other words, during 30 seconds, five correction values (30 seconds/5
   9865645_1 (GHMatters) P104009.AU.1

                                                        13
   seconds - 1 = 5) for each of the satellite orbit error, the inter-frequency bias and the
   tropospheric delay error are added to the satellite clock error updated every five seconds.
                     As a result, the positioning device 100 can receive an updated value of each of
   the satellite orbit error, the inter-frequency bias and the tropospheric delay error every
 5 30 seconds as well as receive the correction value of each of the satellite orbit error, the
   inter-frequency bias and the tropospheric delay error every five seconds.
                     The positioning device 100 then adds the correction value received every five
   seconds to the updated value received every 30 seconds to be able to perform correction
   on the satellite orbit error, the inter-frequency bias and the tropospheric delay error
10 every five seconds.
                     The correction value for each of the satellite orbit error, the inter-frequency
   bias and the tropospheric delay error obtained every five seconds and added to the
   satellite clock error is also called a consistency.
                     Thus, in the present embodiment, the data volume of the reinforcement
15 information is compressed by distributing the consistency every five seconds.
                     Note that the inter-frequency bias is based on an LI signal and represents a
   delay amount within a satellite payload of each signal, where an inter-frequency bias
   (LI bias) is ' 0' and an intefrequency bias (L2 bias) represents a delay amount of an L2
   carrier signal with respect to an Li carrier signal ' L2- Li' .
20                   Moreover, an inter-frequency bias (LO bias) represents a frequency
   independent term of the inter-frequency bias and is calculated from the inter-frequency
   bias (LI bias) and the inter-frequency bias (L2 bias) as expressed by expression 1 in Fig.
   6.
                     The inter-frequency bias based on the LI signal may also be based on another
25 signal without any problem, where the same effect can be expected when an L5 signal is
   9865645_1 (GHMatters) P104009.AU.1

                                                         14
   used.
   [0017]            4. Configuration example of positioning device
                     Fig. 8 is a diagram illustrating a configuration example of the positioning
   device 100 according to the present embodiment.
 5                   Moreover, Fig. 9 illustrates a brief description of each component illustrated
   in Fig. 8, and Fig. 10 illustrates a brief description of intermediate data.
   [0018]            An approximate position/satellite position calculation unit 101 receives the
   observation data 501 and the broadcast ephemeris 502 from the GPS satellite 300 and
   calculates an approximate position of the positioning point and a position of each GPS
10 satellite 300.
                     An approximate position 151 and a satellite position 152 are calculation
   results of the approximate position/satellite position calculation unit 101.
                     The approximate position 151 is a position of the positioning point that is
   calculated by independent positioning and accurate on the order of meters.
15                   The satellite position 152 is a position of each GPS satellite 300 from which
   the positioning device 100 receives the observation data.
   [0019]            A correction data creation unit 102 receives the reinforcement information
   400 from the quasi-zenith satellite 200 as well as acquires the approximate position 151
   and the satellite position 152 to calculate correction data 153 from the reinforcement
20 information 400, the approximate position 151 and the satellite position 152.
                     The correction data 153 indicates an error expected to be included in the
   observation data 501 that is received at the positioning point from each GPS satellite
   300.
                     Note that the correction data creation unit 102 corresponds to an example of a
25 receiving unit, an error correction unit and a correction value calculation unit.
   9865645_1 (GHMatters) P104009.AU.1

                                                        15
   [0020]            An observation data screening unit 103 eliminates the observation data 501
   that is expected to be degraded in quality.
   [0021]            An observation data error correction unit 104 performs double difference
   calculation to output double difference data 154 of the observation data.
 5                   The double difference data 154 indicates a value obtained by subtracting
   observation data of a master satellite (observation data already corrected by using the
   correction data 153) from observation data of a slave satellite (observation data already
   corrected by using the correction data 153).
                     The double difference calculation and the double difference data 154 will be
10 described later.
   [0022]            A time extrapolation calculation unit 105 performs time extrapolation
   calculation to estimate a state quantity X (t) of a current epoch from a state quantity X^
   (t - At) of a previous epoch.
                     Note that notation in which "A" lies directly above "X" in Fig. 8 is identical in
15 meaning to the notation in which "A" lies at the upper right of "X" ("X^").
                     Moreover, "A" indicates a state quantity after being updated by an observation
   update calculation unit 108 to be described.
   [0023]            A geometric distance calculation unit 106 calculates a geometric distance 155
   from the GPS satellite 300 to the positioning point on the basis of the satellite position
20 152.
   [0024]            A residual calculation unit 107 calculates a double difference residual 156
   from the double difference data 154 and the geometric distance 155.
   [0025]            The observation update calculation unit 108 updates the state quantity X (t)
   such that the state quantity X (t) has the smallest estimated error.
25                   The state quantity X (t) after being updated by the observation update
   9865645_1 (GHMatters) P104009.AU.1

                                                         16
   calculation unit 108 is denoted as the state quantity X^ (t).
   [0026]            An ambiguity calculation unit 109 calculates ambiguity being a bias amount
   of the carrier phase and updates the state quantity X^ (t) on the basis of the calculation
   result.
 5                   A value of the position included in the state quantity     XA (t) updated by the
   ambiguity calculation unit 109 is output as a positioning result.
                     Moreover, the state quantity   XA  (t) updated by the ambiguity calculation unit
   109 is subjected to the time extrapolation calculation by the time extrapolation
   calculation unit 105 as the state quantity         XA   (t - At) of the previous epoch.
10 [0027]            Note that a range enclosed with a dashed line in Fig. 8 is called a positioning
   calculation unit 110.
                     Details of the positioning calculation unit 110 will be mainly described in a
   second embodiment.
   [0028]            4.1. Correction data creation unit 102
15                   Fig. 11 illustrates a configuration example of the correction data creation unit
   102.
   [0029]            A first receiving unit 1021 receives data on the frequency-independent errors
   included in the reinforcement information 400.
                     More specifically, the first receiving unit 1021 receives a satellite clock error
20 401 at five second intervals.
                   The satellite clock error 401 obtained every 30 seconds such as at zero second,
   30 seconds, and 60 seconds does not include the consistency (denoted as "C" in Fig. 11),
   while the satellite clock error 401 obtained every five seconds such as at five seconds,
   10 seconds, 35 seconds, 40 seconds, 65 seconds and 70 seconds includes the consistency.
25                   The consistency included in the satellite clock error 401 is a correction value
   9865645_1 (GHMatters) P104009.AU.1

                                                       17
   for each of a satellite orbit error 402, a tropospheric delay error 403, and an inter
   frequency bias (LO bias) 406.
                     Moreover, the first receiving unit 1021 receives each of the satellite orbit error
   402, the tropospheric delay error 403 and the inter-frequency bias (LO bias) 406 at 30
 5 second intervals.
                     The inter-frequency bias (LO bias) 406 is generated from an inter-frequency
   bias (LI bias) 404 and an inter-frequency bias (L2 bias) 405 as described above.
                     The first receiving unit 1021 puts together the satellite clock error 401, the
   satellite orbit error 402, the tropospheric delay error 403 and the inter-frequency bias
10 (LO bias) 406 being received into frequency-independent error data 1022.
                     That is, at zero second and 30 seconds, the frequency-independent error data
   1022 is made up of the satellite clock error 401 (without consistency), the satellite orbit
   error 402, the tropospheric delay error 403 and the inter-frequency bias (LO bias) 406.
                     At five seconds and 10 seconds (35 seconds and 40 seconds), the frequency
15 independent error data 1022 is made up of the satellite clock error 401 (with
   consistency) at five seconds and 10 seconds (35 seconds and 40 seconds) as well as the
   satellite orbit error 402 at zero second (30 seconds), the tropospheric delay error 403 at
   zero second (30 seconds), and the inter-frequency bias (LO bias) 406 at zero second (30
   seconds).
20                   Note that at five seconds and 10 seconds (35 seconds and 40 seconds), the
   satellite clock error 401 obtained five seconds ago is updated by the latest satellite clock
   error 401 (that is, the consistency obtained five seconds ago is also updated by the latest
   consistency).
   [0030]            A second receiving unit 1023 receives data on the frequency-dependent errors
25 included in the reinforcement information 400.
   9865645_1 (GHMatters) P104009.AU.1

                                                       18
                     More specifically, the second receiving unit 1023 receives the inter-frequency
   bias (LI bias) 404, the inter-frequency bias (L2 bias) 405 and an ionospheric delay error
   407 at 30 second intervals.
                     The second receiving unit 1023 then puts together the inter-frequency bias
 5 (LI bias) 404, the inter-frequency bias (L2 bias) 405 and the ionospheric delay error
   407 being received into frequency-dependent error data 1024.
   [0031]            Note that for convenience of explanation, Fig. 11 illustrates the configuration
   in which the first receiving unit 1021 receives the data on the frequency-independent
   errors included in the reinforcement information 400 while the second receiving unit
10 1023 receives the data on the frequency-dependent errors included in the reinforcement
   information 400, but a single receiving unit may be adapted to receive the whole
   reinforcement information to classify the received reinforcement information into the
   data on the frequency-independent errors and the data on the frequency-dependent
   errors.
15 [0032]            A time extrapolation unit 1027 performs linear interpolation by time
   extrapolation using the latest frequency-dependent error data 1024 and frequency
   dependent error data 1026 obtained 30 seconds ago, and estimates frequency-dependent
   error data for the next 30 seconds.
                     The time extrapolation unit 1027 then divides the estimated frequency
20 dependent error data for the next 30 seconds by five seconds and calculates a variation
   for every five seconds for each of the inter-frequency bias (LI bias) 404, the inter
   frequency bias (L2 bias) 405 and the ionospheric delay error 407.
                     The calculated variation for every five seconds is called time extrapolation
   consistency (denoted as C' inFig. 11).
25                   The time extrapolation consistency is a correction amount for each of the
   9865645_1 (GHMatters) P104009.AU.1

                                                       19
   inter-frequency bias (LI bias) 404, the inter-frequency bias (L2 bias) 405 and the
   ionospheric delay error 407.
   [0033]            At zero second and 30 seconds, frequency-dependent error data 1028 is the
   latest frequency-dependent error data 1024 (the inter-frequency bias (LI bias) 404, the
 5 inter-frequency bias (L2 bias) 405, and the ionospheric delay error 407).
                     At five seconds and 10 seconds (35 seconds and 40 seconds), the frequency
   dependent error data 1028 is made up of the frequency-dependent error data 1024 (the
   inter-frequency bias (LI bias) 404, the inter-frequency bias (L2 bias) 405 and the
   ionospheric delay error 407) at zero second (30 seconds) and the time extrapolation
10 consistency at five seconds and 10 seconds (35 seconds and 40 seconds).
                     At five seconds and 10 seconds (35 seconds and 40 seconds), the time
   extrapolation consistency obtained five seconds ago is updated by the latest time
   extrapolation consistency.
   [0034]            A switch 1025 switches a path from the frequency-dependent error data 1024
15 to the frequency-dependent error data 1028 and a path from the time extrapolation unit
   1027 to the frequency-dependent error data 1028.
                     That is, the switch 1025 enables the path from the frequency-dependent error
   data 1024 to the frequency-dependent error data 1028 at zero second and 30 seconds,
   and enables the path from the time extrapolation unit 1027 to the frequency-dependent
20 error data 1028 at five seconds and 10 seconds (35 seconds and 40 seconds).
   [0035]            A data integration unit 1029 generates the correction data 153 from the
   frequency-independent error data 1022, the frequency-dependent error data 1028, the
   approximate position 151 and the satellite position 152.
                     The frequency-independent error data 1022 at zero second and 30 seconds is
25 made up of the satellite clock error 401 (without consistency), the satellite orbit error
   9865645_1 (GHMatters) P104009.AU.1

                                                        20
   402, the tropospheric delay error 403 and the inter-frequency bias (LO bias) 406.
                     The frequency-dependent error data 1028 at zero second and 30 seconds is
   made up of the inter-frequency bias (LI bias) 404, the inter-frequency bias (L2 bias)
   405, and the ionospheric delay error 407.
 5                   The frequency-independent error data 1022 at five seconds and 10 seconds
   (35 seconds and 40 seconds) is made up of the satellite clock error 401 (with
   consistency) at five seconds and 10 seconds (35 seconds and 40 seconds) as well as the
   satellite orbit error 402 at zero second (30 seconds), the tropospheric delay error 403 at
   zero second (30 seconds), and the inter-frequency bias (LO bias) 406 at zero second (30
10 seconds).
                     The frequency-dependent error data 1028 at five seconds and 10 seconds (35
   seconds and 40 seconds) is made up of the satellite orbit error 402, the tropospheric
   delay error 403 and the inter-frequency bias (LO bias) 406 at zero second (30 seconds)
   as well as the time extrapolation consistency at five seconds and 10 seconds (35 seconds
15 and 40 seconds).
                     At five seconds and 10 seconds (35 seconds and 40 seconds), the data
   integration unit 1029 corrects the satellite orbit error 402, the tropospheric delay error
   403 and the inter-frequency bias (LO bias) 406 on the basis of the consistency.
                     That is, the data integration unit 1029 calculates (estimates) the satellite orbit
20 error 402, the tropospheric delay error 403 and the inter-frequency bias (LO bias) 406 at
   five seconds and 10 seconds (35 seconds and 40 seconds) on the basis of the
   consistency in the satellite clock error 401 at five seconds and 10 seconds (35 seconds
   and 40 seconds) as well as the satellite orbit error 402, the tropospheric delay error 403
   and the inter-frequency bias (LO bias) 406 at zero second (30 seconds).
25                   Likewise, at five seconds and 10 seconds (35 seconds and 40 seconds), the
   9865645_1 (GHMatters) P104009.AU.1

                                                        21
   data integration unit 1029 corrects the inter-frequency bias (LI bias) 404, the inter
   frequency bias (L2 bias) 405 and the ionospheric delay error 407 on the basis of the
   time extrapolation consistency.
                     That is, the data integration unit 1029 calculates (estimates) the inter
 5 frequency bias (LI bias) 404, the inter-frequency bias (L2 bias) 405 and the ionospheric
   delay error 407 at five seconds and 10 seconds (35 seconds and 40 seconds) on the basis
   of the time extrapolation consistency at five seconds and 10 seconds (35 seconds and 40
   seconds) as well as the inter-frequency bias (LI bias) 404, the inter-frequency bias (L2
   bias) 405 and the ionospheric delay error 407 at zero second (30 seconds).
10 [0036]            As described above, the correction data creation unit 102 receives the value of
   the frequency-dependent error and the value of the frequency-independent error at 30
   second intervals (a first time interval) and receives the consistency of the frequency
   independent error at five second intervals (a second time interval).
                     Moreover, the correction data creation unit 102 calculates the time
15 extrapolation consistency of the frequency-dependent error at five second intervals.
                     The correction data creation unit 102 then corrects the value of the frequency
   independent error at five second intervals by using the received consistency, and
   corrects the value of the frequency-dependent error by using the calculated time
   extrapolation consistency.
20 [0037]            4.2.1. Double difference amount
                     Next, there will be described double difference calculation to realize error
   correction processing performed by the observation data error correction unit 104.
                     Figs. 12 and 13 illustrate the double difference calculation.
   [0038]            The observation data includes the pseudorange and the carrier phase as
25 illustrated in Fig. 4.
   9865645_1 (GHMatters) P104009.AU.1

                                                         22
                     Each of the pseudorange and the carrier phase includes the error illustrated in
   section 3.2 and Fig. 6, where the error includes an amount included in the correction
   data (reference numeral 1201 in Fig. 12) as well as the receiver clock error (reference
   numeral 1203 in Fig. 12) and the receiver noise (reference numeral 1204 in Fig. 12)
 5 resulting from the receiver and not included in the correction data (the multipath is
   ignored in this case).
                     A portion obtained by eliminating all the errors is a true range (geometric
   distance indicated with reference numeral 1202 in Fig. 12) between the positioning
   point and the GPS satellite 300.
10                   The error amount (reference numeral 1201 in Fig. 12) included in the
   correction data is eliminated by subtracting the correction data from the observation
   data (the pseudorange and the carrier phase) from each GPS satellite 300.
                     The error amount obtained after subtracting the correction data from the
   observation data (the pseudorange and the carrier phase) is called a single difference
15 amount.
                     When a certain GPS satellite is determined to be a master satellite (a GPS
   satellite near the zenith is usually selected) and a GPS satellite other than the master
   satellite is determined to be a slave satellite, a single difference of the master satellite is
   subtracted from a single difference of the slave satellite.
20                   As illustrated in Fig. 13, the single difference of the slave satellite and the
   single difference of the master satellite are a single difference of a common receiver, so
   that the receiver clock error (reference numeral 1203 in Fig. 12) included in the single
   difference of the slave satellite is equal to the receiver clock error included in the single
   difference of the master satellite.
25                   Therefore, the receiver clock error (reference numeral 1203 in Fig. 12) is
   9865645_1 (GHMatters) P104009.AU.1

                                                         23
   cancelled by subtracting the single difference of the master satellite from the single
   difference of the slave satellite.
                     An error amount obtained after eliminating the receiver clock error is called a
   double difference amount.
 5                   The main error is eliminated by calculating the double difference amount, and
   there remain the geometric distance (reference numeral 1202 in Fig. 12), the receiver
   noise (reference numeral 1204 in Fig. 12) and the ambiguity (reference numeral 1205 in
   Fig. 12, only the carrier phase).
                     The receiver noise equals zero when time-averaged and can thus be
10 eliminated by performing statistical processing (Kalman filter in section 4.2.2 to be
   described) in the process of continuing the observation.
                     The ambiguity can be estimated by using the pseudorange from which the
   error is eliminated (refer to section 4.2.3 to be described) and, as a result, the position
   can be estimated with high accuracy.
15 [0039]            4.2.2. Kalman filter
                     The Kalman filter realizing the time extrapolation calculation unit 105 and the
   observation update calculation unit 108 in Figs. 8 and 9 will be described.
                     Fig. 14 illustrates a processing flow of the Kalman filter.
                     Fig. 15 illustrates a description of a variable used in the processing of the
20 Kalman filter.
   [0040]            The time extrapolation calculation unit 105 in Fig. 8 performs time
   extrapolation calculation of the Kalman filter illustrated in Fig. 14.
                     Moreover, the observation update calculation unit 108 in Fig. 8 performs
   observation update calculation of the Kalman filter illustrated in Fig. 14.
25                   The time extrapolation calculation and the observation update calculation
   9865645_1 (GHMatters) P104009.AU.1

                                                          24
   form a loop, and the loop formed by the time extrapolation calculation and the
   observation update calculation is executed repeatedly.
                     The Kalman filter estimates the state quantity such that a diagonal component
   of an error covariance (error covariance matrix Pij = E<xixj>, where E<a> is a variance
 5 of "a") of the estimated state quantity (state quantity X) to be estimated is the smallest
   in each loop being repeated.
   [0041]            The processing of the Kalman filter will be described in due order.
                     In the time extrapolation calculation, from a state quantity     (xA  (-)) and an
   error covariance matrix            (PA (-)) of a previous time, a state quantity (x (+)) and an error
10 covariance matrix (P (+)) of a following time are estimated based on a transition matrix
       determined according to a dynamic model being adopted.
                     At this time, process noise Q that is an error expected between the dynamic
   model and an actual phenomenon is added to the error covariance matrix                   (PA  (-)).
                     The process noise Q is also determined according to the adopted dynamic
15 model and design.
                     From the estimated state quantity (x (+)), an amount y- equivalent to an
   observation amount(y- represents that "-" lies directly above "y"; the same applies
   hereinafter) is obtained, the amount y- being estimated by an observation model (y- = f
   (x)) expressing a relationship between the state quantity and the observation amount.
20                   In the observation update calculation, a residual (dz    =  y - y-) being a
   difference between an actual observation amount and the estimated observation amount
   is obtained to then convert it to a difference in the state quantity (dx = K-dz) by using
   Kalman gain K expressed in an expression in Fig. 14 and update the state quantity.
                     An observation matrix used in the observation update calculation expresses
25 the observation model and is obtained by the following expression.
   9865645_1 (GHMatters) P104009.AU.1

                                                        25
   [0042]            [Expression 1]
    dz=H-dx(dz=y-y=f                              (i)-f(x)=Vxf -dx=H-dx)
   [0043]            Moreover, R included in the denominator of the expression of the Kalman
   gain K represents observation noise expected to be included in the observation amount.
 5 [0044]            4.2.3. Ambiguity calculation
                     Next, ambiguity calculation performed by the ambiguity calculation unit 109
   in Figs. 8 and 9 will be described.
                     In order to realize highly accurate positioning, it is conventionally required to
   perform positioning by using a carrier phase with which the receiver noise is on the
10 order of millimeters (refer to Fig. 4).
                     The ambiguity being a bias amount is included in the carrier phase but cannot
   be eliminated by the double difference calculation (refer to section 4.2.1), so that the
   positioning device 100 needs to estimate the ambiguity by adding the ambiguity to the
   state quantity (position and velocity) and eliminate the ambiguity.
15                   A procedure of eliminating the ambiguity is described in a list below.
                     (1) Estimate a position by using the pseudorange (refer to sections 4.2.1 and
   4.2.2).
                     (2) With the geometric distance found from the position obtained in (1),
   estimate the ambiguity from the carrier phase (refer to section 4.2.1).
20                   (3) Repeat (1) and (2) for a while to make a variance of the state quantity
   (position, velocity, and ambiguity) statistically small.
                     (4) Use a method called a LAMBDA method to determine an integer value
   (called a Fix solution) of the ambiguity (the ambiguity has an integer value; refer to Fig.
   4) that has a decimal value (called a Float solution) at the time of step (3).
   9865645_1 (GHMatters) P104009.AU.1

                                                        26
                     (5) Verify whether the Fix solution is correct and, when correct, fix the
   ambiguity to update the position corresponding to the difference between the Float
   solution and the Fix solution and realize the accuracy on the order of centimeters.
   [0045]            The LAMBDA method is a method of using the Float solution of the
 5 ambiguity and an error covariance matrix with a component corresponding to the Float
   solution as inputs, and searching for the Fix solution that results in the smallest square
   sum average of the difference between the Float solution and the Fix solution from a
   hyperdimensional ellipsoid sphere determined by the magnitude of the error covariance
   with the Float solution as the center.
10                   It is hyperdimensional since the number of Float solutions corresponds to the
   number of double differences (= number of satellites - 1), and the ellipsoid sphere
   instead of a sphere is used since a non-diagonal component of the error covariance
   matrix is not zero.
                     The determination in the verification in (5) is made on the basis of
15 information such as the magnitude of the residual using the Fix solution.
   [0046]            Second Embodiment
                     The positioning calculation unit 110 illustrated in Fig. 8 will be described in
   detail in the present embodiment.
                     First, a problem to be solved by the positioning calculation unit 110 of the
20 present embodiment will be described.
   [0047]            5.1. Problem
                     The tropospheric delay error and the ionospheric delay error included in the
   reinforcement information are assigned to the grid point as illustrated in Fig. 16.
                     In normal times, as illustrated in Fig. 17, the ionospheric delay error and the
25 tropospheric delay error at the grid point in the vicinity of the positioning point are
   9865645_1 (GHMatters) P104009.AU.1

                                                      27
   interpolated to be able to calculate an estimated value of the ionospheric delay error and
   an estimated value of the tropospheric delay error at the positioning point.
                     The difference between the estimated value and an actual value is negligible
   with respect to the positioning accuracy when a spatial fluctuation of the ionospheric
 5 delay error and the tropospheric delay error is moderate.
                     However, at the time of a strong ionospheric disturbance or tropospheric
   disturbance (such as when a solar flare occurs, in summertime, or late at night), the
   difference between the estimated value and the actual value is large as illustrated in Fig.
   18, thereby causing degradation in the positioning accuracy.
10                   In the present embodiment, there will be described the positioning calculation
   unit 110 capable of maintaining highly accurate positioning performance even at the
   time of the strong ionospheric disturbance or tropospheric disturbance.
   [0048]            5.2. Wide-lane ambiguity
                     When the difference between the estimated value and the actual value is large
15 as illustrated in Fig. 18, an ionospheric error and a tropospheric error remain as they
   cannot be eliminated from the observation data even when the double difference
   calculation described in section 4.2.1 and Figs. 12 and 13 is performed.
                     The errors remaining after the double difference calculation are called an
   ionospheric residual and a tropospheric residual.
20                   Each of the ionospheric residual and the tropospheric residual is on the order
   of approximately one centimeter to 20 centimeters.
                     The ionospheric residual and tropospheric residual are approximately the
   same in magnitude as wavelengths of LI-wave ambiguity and L2-wave ambiguity
   illustrated in Fig. 19, when comparing them. Therefore, in the ambiguity calculation
25 described in section 4.2.3, it takes more time to fix the ambiguity, or the ambiguity is
   9865645_1 (GHMatters) P104009.AU.1

                                                        28
   fixed to a wrong integer value.
                     In the present embodiment, the Li -wave ambiguity and wide-lane (WL)
   ambiguity (in a far right column in Fig. 19) are adopted as the state quantity instead of
   the LI -wave ambiguity and the L2-wave ambiguity.
 5                   That is, in the positioning calculation unit 110, the time extrapolation
   calculation unit 105 follows the procedure described in section 4.2.2 to perform time
   extrapolation calculation on the state quantity XA (t - At) including the LI-wave
   ambiguity and the WL ambiguity and estimate the state quantity X (t) including the LI
   wave ambiguity and the WL ambiguity.
10                   Moreover, the observation update calculation unit 108 follows the procedure
   described in section 4.2.2 to update the state quantity X (t) including the LI-wave
   ambiguity and the WL ambiguity.
                     The ambiguity calculation unit 109 follows the procedure described in section
   4.2.3 to calculate the LI-wave ambiguity and the WL ambiguity.
15                   As illustrated in Fig. 19, the WL ambiguity has a wavelength of
   approximately 86 centimeters, which is sufficiently large compared to the ionospheric
   residual and the tropospheric residual so that the ambiguity can be fixed even at the time
   of the strong ionospheric disturbance or tropospheric disturbance.
                     The accuracy of position is increased after fixing the WL ambiguity, followed
20 by fixing of the LI ambiguity so that the time it takes to fix the ambiguity can be
   reduced.
   [0049]            5.3. Ionospheric residual and tropospheric residual
                     As described above, when the difference between the estimated value and the
   actual value is large as illustrated in Fig. 18, the ionospheric residual and the
25 tropospheric residual remain in the observation data even when the double difference
   9865645_1 (GHMatters) P104009.AU.1

                                                         29
   calculation described in section 4.2.1 and Figs. 12 and 13 is performed.
                     The ionospheric residual and the tropospheric residual are not noise but bias
   errors (do not equal zero when time-averaged), whereby the ionospheric residual and
   the tropospheric residual cannot be eliminated by the Kalman filter calculation
 5 described in section 4.3.2.
                     Therefore, the ionospheric residual and the tropospheric residual are reflected
   in the state quantity as errors, and the positioning accuracy on the order of centimeters
   cannot be realized.
                     In the present embodiment, the ionospheric residual and the tropospheric
10 residual are added as an amount to be estimated to the state quantity in the positioning
   device 100.
                     Further, in the present embodiment, a dynamic model in the time
   extrapolation calculation unit 105 and an observation model in the observation update
   calculation unit 108 are adapted to the ionospheric residual and the tropospheric residual
15 being added to the state quantity.
   [0050]            A conventional state quantity X (t) is made up of the position, velocity, LI
   wave ambiguity, and L2-wave ambiguity as illustrated in Fig. 20.
                     On the other hand, the state quantity X (t) of the present embodiment is made
   up of the position, velocity, LI-wave ambiguity, WL ambiguity, ionospheric residual
20 and tropospheric residual.
   [0051]            Fig. 21 illustrates details of a dynamic model, a transition matrix and a
   process noise of the Kalman filter adapted for the state quantity of the present
   embodiment.
                     As illustrated in Fig. 21, in the present embodiment, the transition matrix of a
25 Gauss-Markov process is used in the time extrapolation calculation of the ionospheric
   9865645_1 (GHMatters) P104009.AU.1

                                                        30
   residual.
                     The transition matrix of the Gauss-Markov process is also used in the time
   extrapolation calculation of the tropospheric residual.
   [0052]            Each expression in Fig. 23 represents the observation model adapted for the
 5 state quantity of the present embodiment.
                     Fig. 22 illustrates the observation model adapted for the conventional state
   quantity.
                     Expression 4 in Fig. 22 corresponds to expression 2 in Fig. 13, and expression
   5 in Fig. 22 corresponds to expression 3 in Fig. 13.
10                   The conventional observation model (Fig. 22) is described in section 8.3 of
   the following reference.
                     Moreover, the reference describes characteristics of the ionosphere in section
   6.3.2 as well as characteristics of the troposphere and a mapping coefficient in section
   6.3.3.
15                   Reference: "Global Positioning System: Theory and Practice", Hofmann
   Wellenhof, B., Lichtenegger, H., Collins, J., Translated by Nishi, S., Published by
   Springer-Verlag Tokyo
   [0053]            Compared to the observation model in Fig. 22, an ionospheric residual resl (i)
   is added in the observation model of the present embodiment as illustrated in Fig. 23.
20                   The ionospheric residual resl (i) represents the ionospheric residual of the
   GPS satellite i.
                     That is, the ionospheric residual has a difference value for each GPS satellite
   300.
                     A sign (+/-) of the ionospheric residual is different in the pseudorange and the
25 carrier phase due to the characteristics of the ionosphere that cause the ionospheric
   9865645_1 (GHMatters) P104009.AU.1

                                                       31
   delay error.
                     Moreover, the ionospheric residual of the L2 wave is inversely proportional to
   a square of the frequency, and thus has a value equal to the magnitude of the
   ionospheric residual of the LI wave (res (i)) multiplied by F (1) 2/F(2) 2
 5                   Note that F (1) represents a signal frequency of the LI wave, and F (2)
   represents a signal frequency of the L2 wave.
                     With regard to the tropospheric residual, two variables are prepared as the
   state quantity, the variables including resTd being a delay amount when a GPS signal
   passing in the zenith direction passes through dry air and resT, being a delay amount
10 when a GPS signal passing in the zenith direction passes through wet air.
                     Then, a multiplied value of a coefficient md  (i) and resTd as well as a
   multiplied value of a coefficient m, (i) and resT, are added as the tropospheric residual
   to all observation data.
   [0054]            In the present embodiment, the time extrapolation calculation unit 105 of the
15 positioning calculation unit 110 follows the procedure described in section 4.2.2 as well
   as uses the transition matrix of the Gauss-Markov process as illustrated in Fig. 21 to
   perform the time extrapolation calculation on the state quantity XA (t - At) including the
   ionospheric residual and the tropospheric residual and estimate the state quantity X (t)
   including the ionospheric residual and the tropospheric residual.
20                   Moreover, the observation update calculation unit 108 follows the procedure
   described in section 4.2.2 as well as uses the observation model illustrated in Fig. 23 to
   update the state quantity X (t) including the ionospheric residual and the tropospheric
   residual.
                     As a result, the observation update calculation unit 108 outputs a positioning
25 result (position) from which the ionospheric residual and the tropospheric residual are
   9865645_1 (GHMatters) P104009.AU.1

                                                          32
   eliminated.
   [0055]            5. 4. Pseudo-observation amount of ionospheric residual and tropospheric
   residual
                     Where n denotes the number of double differences (= the number of satellites
 5 - 1), n number of each expression in Fig. 23 are required (4 x n expressions are required
   on a whole).
                     The position and velocity being the estimated values include six components,
   the Li -wave ambiguity and WL ambiguity include 2 x n components, the ionospheric
   residual includes n components, and the tropospheric residual includes two components.
10                   In order to calculate the estimated value of an unknown quantity from the
   expression, 4 x n ;_:6 + 2 x n + n + 2 needs to be satisfied, thereby requiring n ;8.
                     The condition n ;_:8 is a rather stringent condition considering a n ormal
   satellite signal receiving environment, where an area and hours satisfying the condition
   are limited.
15                   In other words, the condition n ;8 has low observability.
                     Accordingly, in the present embodiment, the observability is increased by
   adding the following pseudo-observation model of the ionospheric residual and the
   tropospheric residual to the four expressions in Fig. 23.
                     0 = resl (i)
20                   0   =   resTd
                     0   =   resT,
                     In the three expressions above, "0" on the left side represents a pseudo
   observation amount indicating that each of resl (i), resTd, and resT, can roughly be
   approximate to zero in an actual phenomenon.
25                   That is, the observation update calculation unit 108 in Fig. 8 performs
   9865645_1 (GHMatters) P104009.AU.1

                                                         33
   observation update calculation on the state quantity X (t) while assuming the value of
   the ionospheric residual and the value of the tropospheric residual included in the
   double difference residual 156 to both be zero.
                     The number of "0 = resl (i)" corresponds to the number of GPS satellites (that
 5 is, n + 1 expressions), where n number of "0 = resl (i)" are used in the double difference
   calculation.
                     The total of n + 2 expressions (n number of "0 = resl (i)" as well as "0 =
   resTd" and "0 = resT,") are added to the aforementioned expression to be able to obtain
   4 x n + n + 2;_:6 + 2 x n + n + 2 and obtain a condition of n >3            as a result.
10                   The condition n >3 is equivalent to the value required in independent
   positioning and the conventional observation model (Fig. 22) so that sufficient
   observability can be maintained.
                     When the ambiguity calculation unit 109 determines the ambiguity by using
   the observation model of the present embodiment (Fig. 23), "2 x n" corresponding to
15 the ambiguity is erased from the right side of the inequality (4 x n + n + 2 ;_6 + 2 x n +
   n + 2).
                     The observation amount on the left side becomes excessive as a result.
                     Moreover, in order to increase the positioning accuracy by increasing the
   accuracy of the ionospheric residual and tropospheric residual, it is desired to eliminate
20 the pseudo-observation amount (0           =  resl (i), 0 = resTd, 0 = resT.) that is not zero in
   reality from the observation model.
                     Accordingly, the observation update calculation unit 108 maximizes a
   component of observation noise (section 4.3.2 and R in Fig. 14) equivalent to the
   pseudo-observation model in an epoch after the LI-wave ambiguity and the WL
25 ambiguity are determined by the ambiguity calculation unit 109.
   9865645_1 (GHMatters) P104009.AU.1

                                                       34
                     The pseudo-observation amount (0     = resl (i), 0 = resTd, 0 = resT,) can be
   nullified as a result.
   [0056]            6. Variation
                     In the first and second embodiments, there has been described the example in
 5 which the positioning device 100 receives the low-rate errors at 30 second intervals and
   the high-rate errors at five second intervals.
                     However, the low-rate errors need not be received as 30 second intervals, and
   the high-rate errors need not be received at five second intervals, either.
                     The time interval may be set to any interval as long as there holds a
10 relationship where the interval at which the high-rate errors are received is 1/n (n is an
   integer of two or larger) of the interval at which the low-rate errors are received.
   [0057]            Moreover, in the first and second embodiments, there has been described the
   example in which the positioning device 100 receives, as the value of the frequency
   dependent error, the inter-frequency bias (LI bias), the inter-frequency bias (L2 bias)
15 and the value of the ionospheric delay error.
                     It may be adapted not to receive the value of the ionospheric delay error,
   however.
                     Moreover, in the first and second embodiments, there has been described the
   example in which the positioning device 100 receives, as the value of the frequency
20 independent error, the value of the satellite orbit error, the inter-frequency bias (LO bias)
   and the value of the tropospheric delay error.
                     It may be adapted not to receive the value of the tropospheric delay error,
   however.
   [0058]            Moreover, while the second embodiment illustrates the example in which the
25 ionospheric residual and the tropospheric residual are included in the state quantity, it
   9865645_1 (GHMatters) P104009.AU.1

                                                       35
   may be adapted to include either one of the ionospheric residual and the tropospheric
   residual in the state quantity.
   [0059]            While the embodiments of the present invention have been described, two or
   more of those embodiments may be combined and implemented.
 5                   Alternatively, one of those embodiments may be partially implemented.
                     Yet alternatively, two or more of those embodiments may be partially
   combined and implemented.
                     Note that the present invention is not to be limited by those embodiments but
   can be modified in various manners as needed.
10 [0060]            7. Example of hardware configuration
                     Lastly, an example of a hardware configuration of the positioning device 100
   according to the first and second embodiments will be described with reference to Fig.
   24.
                     The positioning device 100 is a computer that can implement each element of
15 the positioning device 100 by a program.
                     The positioning device 100 has the hardware configuration in which an
   arithmetic device 901, an external storage 902, a main storage 903, a communication
   device 904 and an input/output device 905 are connected to a bus.
   [0061]            The arithmetic device 901 is a CPU (Central Processing Unit) executing the
20 program.
                     The external storage 902 is a ROM (Read Only Memory), a flash memory
   and/or a hard disk device, for example.
                     The main storage 903 is a RAM (Random Access Memory).
                     The communication device 904 receives the observation data and the
25 broadcast ephemeris from the GPS satellite and receives the reinforcement information
   9865645_1 (GHMatters) P104009.AU.1

                                                             36
   from the quasi-zenith satellite.
                     The communication device 904 includes an AD (analog-digital) conversion
   function.
                     The input/output device 905 is a touch panel display, for example.
 5 [0062]            The program usually stored in the external storage 902 is sequentially read
   into the arithmetic device 901 and executed while loaded to the main storage 903.
                     The program is a program implementing the function that is described as "...
   unit" in Fig. 8.
                     Moreover, the external storage 902 stores an operating system (OS), at least a
10 part of which is loaded to the main storage 903 so that the arithmetic device 901
   executes the program implementing the function of the "... unit" in Fig. 8 while
   executing the OS.
                     Furthermore, the main storage 903 stores as a file a piece of information, data,
   a signal value and a variable value representing the result of the processing described as
15 "correction of ...".,''generation of ...".,''creation of ..."..,''computation of ..."..,''calculation
   of ...",    ''determination        of ...", ''evaluation of ...".,''update   of ...", ''estimation of ...",
   "extraction of ..."., 'selection of ..."..,'reception of             ..." and the like in the first and second
   embodiments.
   [0063]            Note that the configuration in Fig. 24 merely illustrates an example of the
20 hardware configuration of the positioning device 100, which may thus have the
   hardware configuration that is not necessarily the configuration illustrated in Fig. 24 but
   another configuration.
   Reference Signs List
25 [0064]            100: positioning device, 101: approximate position/satellite position
   9865645_1 (GHMatters) P104009.AU.1

                                                        37
   calculation unit, 102: correction data creation unit, 103: observation data screening unit,
   104: observation data error correction unit, 105: time extrapolation calculation unit,
   106: geometric distance calculation unit, 107: residual calculation unit, 108: observation
   update calculation unit, 109: ambiguity calculation unit, 110: positioning calculation
 5 unit, 200: quasi-zenith satellite, 300: GPS satellite, 400: reinforcement information,
   401: satellite clock error, 402: satellite orbit error, 403: tropospheric delay error, 404:
   inter-frequency bias (LI bias), 405: inter-frequency bias (L2 bias), 406: inter-frequency
   bias (LO bias), 407: ionospheric delay error, 501: observation data, 502: broadcast
   ephemeris, 1021: first receiving unit, 1022: frequency-independent error data, 1023:
10 second receiving unit, 1024: frequency-dependent error data, 1025: switch, 1026:
   frequency-dependent error data, 1027: time extrapolation unit, 1028: frequency
   dependent error data, and 1029: data integration unit
   [0065]            Modifications within the scope of the invention may be readily effected by
   those skilled in the art. It is to be understood, therefore, that this invention is not limited
15 to the particular embodiments described by way of example hereinabove.
   [0066]            In the claims that follow and in the preceding description of the invention,
   except where the context requires otherwise owing to express language or necessary
   implication, the word "comprise" or variations such as "comprises" or "comprising" is
   used in an inclusive sense, that is, to specify the presence of the stated features but not
20 to preclude the presence or addition of further features in various embodiments of the
   invention.
   [0067]            Further, any reference herein to prior art is not intended to imply that such
   prior art forms or formed a part of the common general knowledge in any country.
   9865645_1 (GHMatters) P104009.AU.1

                                                              38
   The claims defining the invention are as follows:
   1.                A positioning device comprising a positioning calculation unit to perform
   positioning calculation by using a state quantity including at least either an ionospheric
 5 residual or a tropospheric residual that remains after error correction processing is
   performed on observation data from a positioning satellite.
   2.                The positioning device according to claim 1, wherein
                     the positioning calculation unit obtains a positioning result from which at least
10 either the ionospheric residual or the tropospheric residual is eliminated.
   3.                The positioning device according to claim 1, wherein
                     the positioning calculation unit performs positioning calculation by using the
   state quantity including LI-wave ambiguity and wide-lane ambiguity.
15
   4.                The positioning device according to claim 1, wherein
                     the positioning calculation unit includes:
                                      a time extrapolation calculation unit to perform time extrapolation
   calculation on a state quantity of a past epoch including at least either the ionospheric
20 residual or the tropospheric residual to estimate a state quantity of a current epoch
   including at least either the ionospheric residual or the tropospheric residual;
                                      a residual calculation unit to calculate a double difference residual
   by using double difference data obtained by double difference calculation on the
   observation data, a geometric distance between the positioning satellite and the
25 positioning device obtained from the observation data, and the state quantity of the
   9865645_1 (GHMatters) P104009.AU.1

                                                            39
   current epoch estimated by the time extrapolation calculation unit; and
                                      an observation update calculation unit to perform observation
   update calculation using the double difference residual to update the state quantity of
   the current epoch estimated by the time extrapolation calculation unit.
 5
   5.                The positioning device according to claim 4, wherein
                     the observation update calculation unit performs observation update
   calculation based on an assumption that a value of the ionospheric residual included in
   the double difference residual is zero to update the state quantity of the current epoch
10 including at least the ionospheric residual and estimated by the time extrapolation
   calculation unit.
   6.                The positioning device according to claim 4, wherein
                     the observation update calculation unit performs observation update
15 calculation based on an assumption that a value of the tropospheric residual included in
   the double difference residual is zero to update the state quantity of the current epoch
   including at least the tropospheric residual and estimated by the time extrapolation
   calculation unit.
20 7.                The positioning device according to claim 4, wherein
                     the observation update calculation unit performs observation update
   calculation by maximizing a value of observation noise after LI-wave ambiguity and
   wide-lane ambiguity are determined.
25 8.                The positioning device according to claim 4, wherein
   9865645_1 (GHMatters) P104009.AU.1

                                                    40
                  the time extrapolation calculation unit performs time extrapolation calculation
using a transition matrix of a Gauss-Markov process.
9865645_1 (GHMatters) P104009.AU.1

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
