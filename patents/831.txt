                                             Abstract
              An observation data screening unit (103) executes least squares method
   positioning using, as an observation amount, n (n is an integer of 3 or larger) number of
   single difference amounts of an LI-wave pseudorange obtained from n pieces of
 5 observation data from n number of positioning satellites and n pieces of correction data
   corresponding to the n pieces of the observation data. The observation data screening
   unit (103) calculates a sum of squares of n residuals obtained for each positioning
   satellite by executing the least squares method positioning and normalizes the n
   residuals. The observation data screening unit (103) then evaluates the sum of squares
10 of the residuals and the n normalized residuals.

                                                      1
                            POSITIONING DEVICE AND POSITIONING METHOD
   Related Application
                   This application is a divisional application of Australian application no.
   2014388688, the disclosure of which is incorporated herein by reference. Most of the
 5 disclosure of that application is also included herein, however, reference may be made
   to the specification of application no. 2014388688 as filed to gain further understanding
   of the invention claimed herein.
   Technical Field
10                 The present invention relates to a positioning device that performs satellite
   positioning.
   Background Art
                   Various errors are included in GNSS (Global Navigation Satellite System)
15 observation data transmitted from a satellite positioning system (GNSS) such as a GPS
   (Global Positioning System).
                   The errors included in the GNSS observation data need to be eliminated in
   order to realize highly accurate positioning.
                   JP Patent Application Publication No. 2009-257802 A discloses a technique of
20 eliminating an error by performing double difference calculation of the error associated
   with a pseudorange and a carrier phase, for example.
                   Multipath is one cause of degrading positioning accuracy.
                   The multipath is a phenomenon that occurs when a GNSS signal including the
   observation data reaches an antenna of a positioning device via a plurality of paths.
25                 The multipath occurs when, for example, a GNSS signal (multipath signal)
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     2
   reaching the antenna of the positioning device after reflected off a building or the like
   interferes with a GNSS signal directly reaching the antenna.
                   Urban areas with many buildings and mountainous areas with many forests
   are prone to the multipath, thus a multipath signal needs to be eliminated in order to
 5 realize highly accurate positioning in these areas.
                   The multipath signal is strongly dependent on a reception environment at a
   positioning point, and so correction data used to eliminate the multipath signal cannot
   be distributed.
                   Moreover, a degree to which the GNSS signal is influenced by the multipath
10 varies for each GNSS signal, so that the multipath signal cannot be eliminated by the
   double difference calculation described in Patent Literature 1.
   Summary of the Invention
                   According to an aspect of the present invention, there is provided a
15 positioning device comprising: a correction data creation unit; a least squares method
   positioning execution unit configured to execute least squares method positioning by
   using, as an observation amount in a positioning calculation, n (n is an integer of 3 or
   larger) number of single difference amounts of an LI-wave pseudorange obtained by
   subtracting n pieces of correction data created by the correction data creation unit from
20 n pieces of observation data of n number of positioning satellites, the n pieces of
   correction data corresponding to the n pieces of observation data, the n pieces of
   correction data being used for a correction depending on each of sources of error; a
   sum-of-squares calculation unit configured to calculate a sum of squares of n residuals
   obtained for each positioning satellite by executing the least squares method
25 positioning; a normalization unit configured to normalize the n residuals; and an
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                    3
   evaluation unit configured to control an amount of observation data to be used for the
   positioning calculation by the least squares method positioning execution unit based on
   an evaluation result obtained by evaluating the sum of squares calculated by the sum-of
   squares calculation unit and the n residuals normalized by the normalization unit.
 5                 In an embodiment, the evaluation unit compares the sum of squares with a
   first threshold, compares each of the n normalized residuals with a second threshold,
   and discards less than n pieces of observation data out of the n pieces of observation
   data when the sum of squares exceeds the first threshold and at least any of the n
   normalized residuals exceeds the second threshold. In an example, the evaluation unit
10 discards, from among the n pieces of observation data, a piece of observation data from
   a positioning satellite with the normalized residual having the largest absolute value.
                   According to another aspect of the present invention, there is provided a
   positioning device comprising: a correction data creation unit; a least squares method
   positioning execution unit configured to select a combination of n number of
15 positioning satellites (3 < n < m) from among m number of positioning satellites, the m
   pieces of correction data being used for a correction depending on each of sources of
   error, and execute least squares method positioning for each combination, using
   observation amount for positioning calculation obtained from m number of single
   difference amounts of an LI-wave pseudorange, which is obtained by subtracting m
20 pieces of correction data created by the correction data creation unit from m pieces of
   observation data of the m number of positioning satellites, the m pieces of correction
   data being for correction for each of sources of error and corresponding to the m pieces
   of observation data; a sum-of-squares calculation unit configured to calculate a sum of
   squares of n residuals obtained for each positioning satellite by executing the least
25 squares method positioning; a normalization unit configured to normalize the n
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                    4
   residuals; and an evaluation unit configured to control an amount of observation data to
   be used for the positioning calculation by the least squares method positioning
   execution unit based on an evaluation result obtained by evaluating the sum of squares
   calculated by the sum-of-squares calculation unit and the n residuals normalized by the
 5 normalization unit.
                   In an embodiment, the evaluation unit compares the sum of squares with a
   first threshold, compares each of the n normalized residuals with a second threshold,
   and discards less than n pieces of observation data out of the n pieces of observation
   data when the sum of squares exceeds the first threshold and at least any of the n
10 normalized residuals exceeds the second threshold. In an example, the evaluation unit
   discards, from among the n pieces of observation data, a piece of observation data from
   a positioning satellite with the normalized residual having the largest absolute value.
                   In another embodiment, the evaluation unit inputs, to a positioning calculation
   unit performing positioning calculation, n pieces of observation data of a combination
15 with the smallest sum of squares calculated by the sum-of-squares calculation unit, from
   among the combinations selected by the least squares method positioning execution unit.
                   According to another aspect of the present invention, there is provided a
   positioning method comprising: creating a correction data; performing least squares
   method positioning by using, as an observation amount, n (n is an integer of 3 or larger)
20 number of single difference amounts of an LI-wave pseudorange obtained by
   subtracting n pieces of correction data created by the creating from n pieces of
   observation data of n number of positioning satellites, the n pieces of correction data
   being used for a correction depending on each source of error; calculating a sum of
   squares of n residuals obtained for each positioning satellite by executing the least
25 squares method positioning; normalizing the n residuals; and controlling an amount of
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                        5
   observation data to be used for the positioning calculation by the least squares method
   positioning, based on an evaluation result obtained by evaluating the calculated sum of
   squares calculated by the sum-of-squares calculating and the normalized n residuals.
 5 Advantageous Effects of Invention
                   Residuals vary greatly between observation data influenced by the multipath,
   and an individual residual is large in the observation data influenced by the multipath.
                   In the present invention, the observation data influenced by the multipath can
   be eliminated by evaluating the variation of the residual on the basis of an evaluation on
10 a sum of squares of the residual and by evaluating the amount of individual residual on
   the basis of an evaluation on a normalized residual.
   Brief Description of Drawings
                   In order that the invention may be more clearly ascertained, embodiments will
15 now be described, by way of example, with reference to the accompanying drawing, in
   which:
                   Fig. 1 is a diagram illustrating a configuration example of a positioning
   system according to a first embodiment.
                   Fig. 2 is a diagram illustrating input/output of a positioning device according
20 to the first embodiment.
                   Fig. 3 is a table illustrating input/output data of the positioning device
   according to the first embodiment.
                  Fig. 4 is a table illustrating observation data according to the first embodiment.
                   Fig. 5 is a diagram illustrating a source of error included in a GPS signal
25 according to the first embodiment.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                        6
                   Fig. 6 is a diagram illustrating a relationship between an error in the GPS
   signal and reinforcement information according to the first embodiment.
                   Fig. 7 is a diagram illustrating a grid point according to the first embodiment.
                   Fig. 8 is a diagram illustrating a configuration example of the positioning
 5 device according to the first embodiment.
                   Fig. 9 is a table illustrating elements of the positioning device according to the
   first embodiment.
                   Fig. 10 is a table illustrating intermediate data of the positioning device
   according to the first embodiment.
10                 Fig. 11 is a flowchart illustrating an operational example of an observation
   data screening unit according to the first embodiment.
                   Fig. 12 is a diagram illustrating a breakdown of the observation data
   according to the first embodiment.
                   Fig. 13 is a diagram illustrating double difference calculation according to the
15 first embodiment.
                   Fig. 14 is a diagram illustrating a processing flow of a Kalman filter
   according to the first embodiment.
                   Fig. 15 is a table illustrating a vector and a matrix used in the Kalman filter
   according to the first embodiment.
20                 Fig. 16 is a flowchart illustrating a procedure of least squares method
   positioning according to the first embodiment.
                   Fig. 17 is a table illustrating a calculation expression of the least squares
   method positioning according to the first embodiment.
                   Fig. 18 is a table illustrating a calculation expression of the least squares
25 method positioning according to the first embodiment.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                       7
                   Fig. 19 is a diagram illustrating an example of a hardware configuration of the
   positioning device according to the first and second embodiments.
   Description of Embodiments
 5                 First Embodiment
                    1. System configuration
                   Fig. 1 is a diagram illustrating a configuration example of a positioning
   system according to the present embodiment.
                   An example described below uses a GPS satellite as a positioning satellite.
10                 Instead of the GPS satellite, there may be used a GNSS such as GLONASS,
   Galileo, and BeiDou or an RNSS (Regional Navigation Satellite System) such as a
   quasi-zenith satellite.
                   As illustrated in Fig. 1, a positioning device 100 is mounted to a mobile body
   such as an automobile.
15                 The positioning device 100 receives observation data 501 and a broadcast
   ephemeris 502 transmitted from a GPS satellite 300.
                   The broadcast ephemeris 502 is also called an ephemeris.
                   The positioning device 100 also receives reinforcement information 400
   transmitted from a reinforcement information distribution satellite 200.
20                 An operation of the positioning device 100 will be mainly described in the
   present embodiment and a second embodiment.
                   The reinforcement information distribution satellite 200 receives
   reinforcement information from a ground station not shown in Fig. 1, and distributes the
   received reinforcement information as the reinforcement information 400.
25                 The GPS satellite 300 being a positioning satellite transmits the observation
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                        8
   data 501 and the broadcast ephemeris 502.
                   The positioning device 100 needs to acquire four or more of the GPS satellite
   300 in order to perform positioning.
                   2. Overview of operation of positioning device 100
 5                 Here, there will be described an overview of the operation of the positioning
   device 100 described in the present embodiment and the second embodiment.
                   As illustrated in Fig. 2, the positioning device 100 receives the observation
   data 501 and the broadcast ephemeris 502 as a GPS signal and the reinforcement
   information 400.
10                 The positioning device 100 then uses the reinforcement information 400 as
   well as the observation data 501 and the broadcast ephemeris 502 to calculate the
   position of a positioning point (the position of the positioning device 100).
                   Fig. 3 illustrates the observation data 501, the broadcast ephemeris 502, the
   reinforcement information 400 and the position in detail.
15                 3.1. Observation data
                   A pseudorange between the positioning point and the GPS satellite 300 as
   well as a carrier phase can be derived from the observation data 501.
                   Fig. 4 illustrates the pseudorange and the carrier phase in detail.
                   Each of the pseudorange and the carrier phase derived from the observation
20 data 501 includes an error.
                   The positioning device 100 uses the reinforcement information 400 to
   eliminate the error included in each of the pseudorange and the carrier phase.
                   Note that in the following description, a pseudorange for LI wave of a GPS
   satellite i will be denoted as P (i, 1), and a pseudorange for L2 wave of the GPS satellite
25 i will be denoted as P (i, 2).
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                        9
                   Moreover, a carrier phase for the LI wave of the GPS satellite i will be
   denoted as * (i, 1), and a carrier phase for the L2 wave of the GPS satellite i will be
   denoted as * (i, 2).
                   3.2. Reinforcement information
 5                 Fig. 5 illustrates a bias error and a noise source included in the observation
   data 501.
                   Errors resulting from the GPS satellite 300 include an orbit error, a satellite
   clock error, and an inter-frequency bias, and errors resulting from a signal propagation
   path include an ionospheric propagation delay error (also called an ionospheric delay
10 error or an ionospheric delay amount) and a tropospheric propagation delay error (also
   called a tropospheric delay error or a tropospheric delay amount).
                   Errors resulting from a receiver of the positioning device 100 include a
   receiver clock error, a receiver noise and an error associated with multipath that is
   caused by an interference between a GPS signal reflected off a building and a GPS
15 signal directly received from the GPS satellite 300.
                   Among these errors, the errors resulting from the receiver vary depending on
   the performance and a reception environment of the receiver of the positioning device
   100 used by a user, and are thus not included in correction data and the reinforcement
   information but eliminated by processing of the positioning device 100.
20                 The errors resulting from the GPS satellite 300 and the signal propagation
   path are compressed and distributed as the reinforcement information from the
   reinforcement information distribution satellite 200.
                   In addition to the errors illustrated in Fig. 5, errors resulting from an earth tide
   effect and a phase wind up effect that vary depending on the position of the positioning
25 point are included in the correction data but not included in the reinforcement
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      10
   information.
                   Fig. 6 illustrates a breakdown of the reinforcement information taking the
   aforementioned points into consideration.
                   A ground station collects the observation data 501 from a reference point via a
 5 terrestrial channel and generates correction data.
                   The correction data is traditionally distributed as reinforcement information
   together with reliability information of the correction data at an update cycle of one
   second via a mobile phone or a wireless LAN (Local Area Network). However, the
   reinforcement information of the present embodiment is broadcast to users through a
10 communication line of an artificial satellite with limited transmission capacity, so that
   the errors in the reinforcement information of the present embodiment are classified into
   a high rate and a low rate according to the degree of temporal fluctuations and subjected
   to time compression.
                   More specifically, the error classified under the high rate is updated every five
15 seconds, while the error classified under the low rate is updated every 30 seconds.
                   While the conventional correction data is generated at each reference point set
   at intervals of about 10 to 30 km and distributed, the ionospheric delay error and the
   tropospheric delay error (with a spatial fluctuation) resulting from the signal path and
   included in the reinforcement information of the present embodiment are distributed
20 only at every grid point (Fig. 7) with a 60-km radius to be subjected to space
   compression.
                   Furthermore, in the present embodiment, the errors included in the
   reinforcement information are classified into an error which is dependent on frequency
   (a frequency-dependent error) and an error which is independent of frequency (a
25 frequency-independent error).
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      11
                   The frequency-independent error is classified as the high-rate error, and the
   frequency-dependent error is classified as the low-rate error.
                   Among the frequency-independent errors, the satellite clock error alone is
   updated every five seconds and distributed.
 5                 The other frequency-independent errors, namely the satellite orbit error, the
   inter-frequency bias and the tropospheric delay error, are updated every 30 seconds and
   distributed.
                   However, for each of the satellite orbit error, the inter-frequency bias and the
   tropospheric delay error, a variation from the error updated every 30 seconds is added
10 every five seconds as a correction value to the satellite clock error (updated every five
   seconds and distributed).
                   In other words, during 30 seconds, five correction values (30 seconds/5
   seconds - 1 = 5) for each of the satellite orbit error, the inter-frequency bias and the
   tropospheric delay error are added to the satellite clock error updated every five seconds.
15                 As a result, the positioning device 100 can receive an updated value of each of
   the satellite orbit error, the inter-frequency bias and the tropospheric delay error every
   30 seconds as well as receive the correction value of each of the satellite orbit error, the
   inter-frequency bias and the tropospheric delay error every five seconds.
                   The positioning device 100 then adds the correction value received every five
20 seconds to the updated value received every 30 seconds to be able to perform correction
   on the satellite orbit error, the inter-frequency bias and the tropospheric delay error
   every five seconds.
                   The correction value for each of the satellite orbit error, the inter-frequency
   bias and the tropospheric delay error obtained every five seconds and added to the
25 satellite clock error is also called a consistency.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                        12
                   In the present embodiment, the data volume of the reinforcement information
   is compressed by distributing the consistency every five seconds.
                   Note that the inter-frequency bias is based on an LI signal and represents a
   delay amount within a satellite payload of each signal, where an inter-frequency bias
 5 (LI bias) is '0' and an inter-frequency bias (L2 bias) represents a delay amount of an L2
   carrier signal with respect to an LI carrier signal 'L2 - Li'.
                   An inter-frequency bias (LO bias) represents a frequency-independent term of
   the inter-frequency bias and is calculated from the inter-frequency bias (LI bias) and the
   inter-frequency bias (L2 bias) as expressed by expression I in Fig. 6.
10                 The inter-frequency bias based on the LI signal may also be based on another
   signal without any problem, where the same effect can be expected when an L5 signal is
   used.
                   4. Configuration example of positioning device
                   Fig. 8 is a diagram illustrating a configuration example of the positioning
15 device 100 according to the present embodiment.
                   Fig. 9 illustrates a brief description of each component illustrated in Fig. 8,
   and Fig. 10 illustrates a brief description of intermediate data.
                   An approximate position/satellite position calculation unit 101 receives the
   observation data 501 and the broadcast ephemeris 502 from the GPS satellite 300 and
20 calculates an approximate position of the positioning point and a position of each GPS
   satellite 300.
                   An approximate position 151 and a satellite position 152 are calculation
   results of the approximate position/satellite position calculation unit 101.
                   The approximate position 151 is a position of the positioning point that is
25 calculated by independent positioning and accurate on the order of meters.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      13
                   The satellite position 152 is a position of each GPS satellite 300 from which
   the positioning device 100 receives the observation data.
                   A correction data creation unit 102 receives the reinforcement information
   400 from the reinforcement information distribution satellite 200 as well as acquires the
 5 approximate position 151 and the satellite position 152 to calculate correction data 153
   from the reinforcement information 400, the approximate position 151 and the satellite
   position 152.
                   The correction data 153 indicates an error expected to be included in the
   observation data 501 that is received at the positioning point from each GPS satellite
10 300.
                   An observation data screening unit 103 eliminates the observation data 501
   that is expected to be degraded in quality.
                   The observation data screening unit 103 corresponds to an example of a least
   squares method positioning execution unit, a sum-of-squares calculation unit, a
15 normalization unit and an evaluation unit.
                   An observation data error correction unit 104 performs double difference
   calculation to output double difference data 154 of the observation data.
                   The double difference data 154 indicates a value obtained by subtracting
   observation data of a master satellite (observation data already corrected by using the
20 correction data 153) from observation data of a slave satellite (observation data already
   corrected by using the correction data 153).
                   The double difference calculation and the double difference data 154 will be
   described later.
                   A time extrapolation calculation unit 105 performs time extrapolation
25 calculation to estimate a state quantity X (t) of a current epoch from a state quantity X^
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      14
   (t - At) of a previous epoch.
                   Note that notation in which "^" lies directly above "X" in Fig. 8 is identical in
   meaning to the notation in which "^" lies at the upper right of "X" ("X^").
                   Moreover, "^" indicates a state quantity after being updated by an observation
 5 update calculation unit 108 to be described.
                   A geometric distance calculation unit 106 calculates a geometric distance 155
   from the GPS satellite 300 to the positioning point on the basis of the satellite position
   152.
                   A residual calculation unit 107 calculates a double difference residual 156
10 from the double difference data 154 and the geometric distance 155.
                   The observation update calculation unit 108 updates the state quantity X (t)
   such that the state quantity X (t) has the smallest estimated error.
                   The state quantity X (t) after being updated by the observation update
   calculation unit 108 is denoted as the state quantity X^ (t).
15                 An ambiguity calculation unit 109 calculates ambiguity being a bias amount
   of the carrier phase and updates the state quantity X^ (t) on the basis of the calculation
   result.
                   A value of the position included in the state quantity X^ (t) updated by the
   ambiguity calculation unit 109 is output as a positioning result.
20                 Moreover, the state quantity X^ (t) updated by the ambiguity calculation unit
   109 is subjected to the time extrapolation calculation by the time extrapolation
   calculation unit 105 as the state quantity X^ (t - At) of the previous epoch.
                   A double difference residual analysis unit 110 identifies observation data
   suspected of being influenced by the multipath, and notifies the observation data
25 screening unit 103 of the observation data suspected of being influenced by the
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      15
   multipath.
                   Moreover, the double difference residual analysis unit 110 instructs the
   ambiguity calculation unit 109 to recalculate the ambiguity when a cycle slip is
   suspected.
 5                 The double difference residual analysis unit 110 together with the observation
   data screening unit 103 corresponds to an example of the evaluation unit.
                   4.1. Observation data screening unit 103
                   Here, an operation of the observation data screening unit 103 will be
   described in detail.
10                 The observation data screening unit 103 employs a residual detection and
   elimination scheme using a single difference to detect, from among a plurality of pieces
   of observation data, the observation data influenced by the multipath and eliminate the
   observation data being detected.
                   Fig. 11 illustrates an operational example of the observation data screening
15 unit 103.
                   The operational example of the observation data screening unit 103 will be
   described below with reference to Fig. 11.
                   When three or more of the GPS satellites 300 are acquired (YES in S1101),
   the observation data screening unit 103 executes least squares method positioning
20 (S 1102) in which a single difference amount (hereinafter simply referred to as a single
   difference as well) of an Li-wave pseudorange to be described in section 4.2.1 is used
   as an observation amount.
                   That is, the observation data screening unit 103 executes the least squares
   method positioning by using, as the observation amount, n (n is an integer of 3 or larger)
25 number of single difference amounts of the LI-wave pseudorange obtained from n
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     16
   pieces of the observation data 501 from n number of the GPS satellites 300 and n pieces
   of the correction data 153 corresponding to the n pieces of the observation data 501.
                   A procedure of the least squares method positioning is illustrated in Fig. 16,
   and a calculation expression of the least squares method positioning is illustrated in Figs.
 5 17 and 18.
                   The procedure of the least squares method positioning in Fig. 16 and the
   calculation expression of the least squares method positioning in Figs. 17 and 18 are
   already known and thus will not be described.
                   The least squares method positioning is executed to be able to obtain a
10 residual of the observation amount for each GPS satellite 300.
                   That is, n number of residuals are obtained for n number of the GPS satellites
   300.
                   A variation among the n number of residuals obtained by the least squares
   method positioning is larger when the observation data includes the multipath than
15 when the observation data does not include the multipath.
                   Moreover, each of the n number of residuals is larger in magnitude when the
   observation data includes the multipath than when the observation data does not include
   the multipath.
                   The observation data screening unit 103 calculates a sum of squares of the
20 residual of the observation amount of each satellite (calculates a sum of squares of the n
   number of residuals) to evaluate the variation in the magnitude among the n number of
   residuals (Si 103).
                   The observation data screening unit 103 further normalizes the n number of
   residuals (S 1103).
25                 A calculation expression of the sum of squares and a normalization
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                          17
   calculation expression are as follows.
                   Note that in the following expressions, R represents observation noise, H
   represents an observation matrix, n represents the number of satellites acquired, and
   indices i and j represent satellite numbers.
 5                 A matrix M is a matrix which represents an expected variance of the residual.
                   Where an expected value of A is denoted as E <A>, an element M (i, j) of M
   with i rows and j columns is represented as M (i, j) = E <dz (i)* dz (j)>.
                    [Expression 1]
    R     =    7                         = normalization parameter
                                  "En = nx n identity matrix
   M=H H1HHT +R
                     H R-'H
                                                   n   n
10 Sum of squares of residual:zz=E                       dZiMifdz
                                                  i=1 j=1
   Normalization of residual:Zn                = dzi
                   Next, the observation data screening unit 103 compares a sum of squares zz of
   the residual with a threshold (first threshold) (S 1104 and S 1105).
                   When the sum of squares zz of the residual does not exceed the threshold (NO
15 in S1105), the observation data screening unit 103 determines that the multipath is not
   included in any of the n pieces of the observation data and ends the processing.
                   On the other hand, when the sum of squares zz of the residual exceeds the
   threshold (YES in S1105), the observation data screening unit 103 compares each of n
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                       18
   number of normalized residuals zni with a threshold (second threshold) (S 1104 and
   S1106).
                   When none of the n number of normalized residuals zni exceeds the threshold
   (NO in S 1106), the observation data screening unit 103 determines that the multipath is
 5 not included in any of the n pieces of the observation data and ends the processing.
                   On the other hand, when at least one of the n number of normalized residuals
   zni exceeds the threshold (YES in S 1106), the observation data screening unit 103
   discards, as data including the multipath, a piece of observation data from the GPS
   satellite 300 corresponding to the residual zni having the largest absolute value among
10 the n number of normalized residuals zni (S 1107).
                   The observation data screening unit 103 also eliminates observation data
   satisfying any of the following conditions 1) to 3) as data suspected of including the
   multipath.
                    1) Signal intensity is lower than a threshold (third threshold) being set
15                 The observation data includes signal intensity of a GPS signal.
                   The observation data including the multipath tends to have lower signal
   intensity, whereby the observation data screening unit 103 eliminates the observation
   data with the signal intensity lower than the threshold.
                   2) Satellite elevation angle is smaller than a threshold (mask angle) (fourth
20 threshold) being set
                   The observation data from the GPS satellite with a low elevation angle passes
   through long distances of an ionosphere and a troposphere and is highly likely to be
   reflected off a building, whereby the observation data screening unit 103 eliminates the
   observation data from the GPS satellite with the low elevation angle.
25                 3) Pseudorange double difference residual (refer to section 4.2.2) exceeds an
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                    19
   estimated error (fifth error) estimated by Kalman filter
                   The double difference residual analysis unit 110 compares the estimated error
   (observation value error) estimated to be included in a double difference observation
   amount by the Kalman filter with the pseudorange double difference residual and, when
 5 the pseudorange double difference residual exceeds the estimated error, the observation
   data screening unit 103 eliminates the corresponding observation data.
                   The estimated error by the Kalman filter is calculated by a diagonal
   component aii of a matrix G expressed by the following expression.
                   G=HPH+R
10                 For H and R, an observation matrix (Fig. 14) and observation noise (Fig. 14)
   used by the observation update calculation unit 108 in performing an observation update,
   are used respectively, and for P, an error covariance matrix (Fig. 14) estimated by the
   time extrapolation calculation unit 105 is used.
                   The double difference residual analysis unit 110 compares an observation
15 value error of a pseudorange double difference of the GPS satellite having a satellite
   number i with a residual of the pseudorange double difference and, when the residual is
   larger, notifies the observation data screening unit 103 of the satellite number i so that
   the observation data screening unit 103 eliminates the observation data from the GPS
   satellite having the satellite number i.
20                 The observation data screening unit 103 eliminates the observation data
   including the multipath as described above, whereby only the observation data not
   including the multipath is input to the observation data error correction unit 104.
                   Moreover, the observation data screening unit 103 selects a plurality of
   satellites from among the observed satellites, switches a selected satellite, executes the
25 processing employing the residual detection and elimination scheme using the single
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      20
   difference as described above, executes multipath detection, and inputs the observation
   data from a combination of satellites having the smallest residual to the error correction
   unit 104.
                   In the satellite selection, the number of satellites being selected corresponds to
 5 the number of visible satellites at the maximum and, at the minimum, four satellites
   with which positioning calculation can be performed.
                   This selection is performed with all combinations of the visible satellites.
                   4.2.1. Double difference amount
                   The double difference calculation performed by the observation data error
10 correction unit 104 will now be described.
                   Figs. 12 and 13 illustrate the double difference calculation.
                   The observation data includes the pseudorange and the carrier phase as
   illustrated in Fig. 4.
                   Each of the pseudorange and the carrier phase includes the error illustrated in
15 section 3.2 and Fig. 6, where the error includes an amount included in the correction
   data (reference numeral 1201 in Fig. 12) as well as the receiver clock error (reference
   numeral 1203 in Fig. 12) and the receiver noise (reference numeral 1204 in Fig. 12)
   resulting from the receiver and not included in the correction data (the multipath is
   ignored in this case).
20                 A portion obtained by eliminating all the errors is a true range (geometric
   distance indicated with reference numeral 1202 in Fig. 12) between the positioning
   point and the GPS satellite 300.                 The error amount (reference numeral 1201 in
   Fig. 12) included in the correction data is eliminated by subtracting the correction data
   from the observation data (the pseudorange and the carrier phase) from each GPS
25 satellite 300.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      21
                   The error amount obtained after subtracting the correction data from the
   observation data (the pseudorange and the carrier phase) is called a single difference
   amount.
                   When a certain GPS satellite is determined to be a master satellite (a GPS
 5 satellite near the zenith is usually selected) and a GPS satellite other than the master
   satellite is determined to be a slave satellite, a single difference of the master satellite is
   subtracted from a single difference of the slave satellite.
                   As illustrated in Fig. 13, the single difference of the slave satellite and the
   single difference of the master satellite are single differences of a common receiver, so
10 that the receiver clock error (reference numeral 1203 in Fig. 12) included in the single
   difference of the slave satellite is equal to the receiver clock error included in the single
   difference of the master satellite.
                   Therefore, the receiver clock error (reference numeral 1203 in Fig. 12) is
   cancelled by subtracting the single difference of the master satellite from the single
15 difference of the slave satellite.
                   An error amount obtained after eliminating the receiver clock error is called a
   double difference amount (or simply called a double difference).
                   The main error is eliminated by calculating the double difference amount, and
   there remain the geometric distance (reference numeral 1202 in Fig. 12), the receiver
20 noise (reference numeral 1204 in Fig. 12) and the ambiguity (reference numeral 1205 in
   Fig. 12, only the carrier phase).
                   The receiver noise equals zero when time-averaged and can thus be
   eliminated by performing statistical processing (Kalman filter in section 4.2.2 to be
   described) in the process of continuing the observation.
25                 The ambiguity can be estimated by using the pseudorange from which the
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      22
   error is eliminated (refer to section 4.2.3 to be described) and, as a result, the position
   can be estimated with high accuracy.
                   4.2.2. Kalman filter
                   The Kalman filter realizing the time extrapolation calculation unit 105 and the
 5 observation update calculation unit 108 in Figs. 8 and 9 will be described.
                   Fig. 14 illustrates a processing flow of the Kalman filter.
                   Fig. 15 illustrates a description of a variable used in the processing of the
   Kalman filter.
                   The time extrapolation calculation unit 105 in Fig. 8 performs time
10 extrapolation calculation using the Kalman filter illustrated in Fig. 14.
                   The observation update calculation unit 108 in Fig. 8 performs observation
   update calculation of the Kalman filter illustrated in Fig. 14.
                   The time extrapolation calculation and the observation update calculation
   form a loop, and the loop formed by the time extrapolation calculation and the
15 observation update calculation is executed repeatedly.
                   The Kalman filter estimates the state quantity such that a diagonal component
   of an error covariance (error covariance matrix Pij = E<xixj>, where E<a> is a variance
   of "a") of the state quantity (state quantity X) to be estimated is the smallest in each
   loop being repeated.
20                 The processing of the Kalman filter will be described in due order.
                   In the time extrapolation calculation, from a state quantity (x^ (-)) and an
   error covariance matrix (P^ (-)) of a previous time, a state quantity (x (+)) and an error
   covariance matrix (P (+)) of a following time are estimated based on a transition matrix
   # determined            according to a dynamic model being adopted.
25                 At this time, process noise Q that is an error expected between the dynamic
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      23
   model and an actual phenomenon is added to the error covariance matrix (PA ()).
                   The process noise Q is also determined according to the adopted dynamic
   model and design.
                   From the estimated state quantity (x (+)),an amount y- equivalent to an
 5 observation amount(y- represents that "-" lies directly above "y"; the same applies
   hereinafter) is obtained, the amount y- being estimated by an observation model (y- = f
   (x)) expressing a relationship between the state quantity and the observation amount.
                   In the observation update calculation, a residual (dz = y - y-) being a
   difference between an actual observation amount and the estimated observation amount
10 is obtained to then be converted into a difference in the state quantity (dx = K-dz) by
   using Kalman gain K expressed in an expression in Fig. 14 and update the state quantity.
                   An observation matrix used in the observation update calculation expresses
   the observation model and is obtained by the following expression.
   [0041]           [Expression 2]
      dz=H-dx(dz=y-Y=f(i)-f(x)=Vf
                                                                           dx=H-dx)
15
                   R included in the denominator of the expression of the Kalman gain K
   represents observation noise expected to be included in the observation amount.
                   4.2.3. Ambiguity calculation
                   Next, ambiguity calculation performed by the ambiguity calculation unit 109
20 in Figs. 8 and 9 will be described.
                   In order to realize highly accurate positioning, it is conventionally required to
   perform positioning by using a carrier phase with which the receiver noise is on the
   order of millimeters (refer to Fig. 4).
                   The ambiguity being a bias amount is included in the carrier phase but cannot
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     24
   be eliminated by the double difference calculation (refer to section 4.2.1), so that the
   positioning device 100 needs to estimate the ambiguity by adding the ambiguity to the
   state quantity (position and velocity) and eliminate the ambiguity.
                   A procedure of eliminating the ambiguity is described in a list below.
 5                 (1) Estimate a position by using the pseudorange (refer to sections 4.2.1 and
   4.2.2).
                   (2) With the geometric distance found from the position obtained in (1),
   estimate the ambiguity from the carrier phase (refer to section 4.2.1).
                   (3) Repeat (1) and (2) for a while to make a variance of the state quantity
10 (position, velocity, and ambiguity) statistically small.
                   (4) Use a method called a LAMBDA method to determine an integer value
   (called a Fix solution) of the ambiguity (the ambiguity has an integer value; refer to Fig.
   4) that has a decimal value (called a Float solution) at the time of step (3).
                   (5) Verify whether the Fix solution is correct and, when correct, fix the
15 ambiguity to update the position corresponding to the difference between the Float
   solution and the Fix solution and realize the accuracy on the order of centimeters.
                   The LAMBDA method is a method of using the Float solution of the
   ambiguity and an error covariance matrix with a component corresponding to the Float
20 solution as inputs, and searching for the Fix solution that results in the smallest square
   sum average of the difference between the Float solution and the Fix solution from a
   hyperdimensional ellipsoid sphere determined by the magnitude of the error covariance
   with the Float solution as the center.
                   It is hyperdimensional since the number of Float solutions corresponds to the
25 number of double differences (= number of satellites - 1), and the ellipsoid sphere
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     25
   instead of a sphere is used since a non-diagonal component of the error covariance
   matrix is not zero.
                   The determination in the verification in (5) is made on the basis of
   information such as the magnitude of the residual using the Fix solution.
 5
                   Second Embodiment
                   5. Measures against cycle slip
                   In the present embodiment, measures taken by the double difference residual
   analysis unit 110 in Fig. 8 against a cycle slip will be described.
10                 Ambiguity of a carrier phase remains constant while the positioning device
   100 keeps receiving a GPS signal (while acquiring the GPS satellite).
                   When the positioning device 100 reacquires the GPS satellite 300 after the
   acquisition is once interrupted, however, the ambiguity is sometimes offset to another
   value (which is called the cycle slip).
15                 Once the cycle slip occurs, a discrepancy caused by the offset degrades
   positioning accuracy when using the ambiguity retained by the positioning device 100
   before reacquisition.
                   Thus, as with the multipath, areas such as urban and mountainous areas in
   which acquisition of the GPS satellite is frequently interrupted require measures against
20 the cycle slip in order to achieve highly accurate positioning.
                   The double difference residual analysis unit 110 compares, for each GPS
   satellite 300, the double difference residual of the carrier phase (refer to section 4.2.2)
   with a threshold (sixth threshold).
                  When the double difference residual of the carrier phase exceeds the threshold,
25 the double difference residual analysis unit 110 suspects that the cycle slip is generated
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     26
   and instructs the ambiguity calculation unit 109 to recalculate ambiguity of the GPS
   satellite 300, the double difference residual of the carrier phase of which exceeds the
   threshold.
                   The ambiguity calculation unit 109 recalculates the ambiguity of the GPS
 5 satellite for which the calculation of the ambiguity is instructed by the double difference
   residual analysis unit 110.
                   6. Variation
                   While the embodiments of the present invention have been described, two or
   more of those embodiments may be combined and implemented.
10                 Alternatively, one of those embodiments may be partially implemented.
                   Yet alternatively, two or more of those embodiments may be partially
   combined and implemented.
                   Note that the present invention is not to be limited by those embodiments but
   can be modified in various manners as needed.
15                 7. Example of hardware configuration
                   Lastly, an example of a hardware configuration of the positioning device 100
   according to the first and second embodiments will be described with reference to Fig.
   19.
                   The positioning device 100 is a computer that can implement each element of
20 the positioning device 100 by a program.
                   The positioning device 100 has the hardware configuration in which an
   arithmetic device 901, an external storage 902, a main storage 903, a communication
   device 904 and an input/output device 905 are connected to a bus.
                   The arithmetic device 901 is a CPU (Central Processing Unit) executing the
25 program.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     27
                   The external storage 902 is a ROM (Read Only Memory), a flash memory
   and/or a hard disk device, for example.
                   The main storage 903 is a RAM (Random Access Memory).
                   The communication device 904 receives the observation data and the
 5 broadcast ephemeris from the GPS satellite and receives the reinforcement information
   from the reinforcement information distribution satellite.
                   The communication device 904 includes an AD (analog-digital) conversion
   function.
                   The input/output device 905 is a touch panel display, for example.
10                 The program usually stored in the external storage 902 is sequentially read
   into the arithmetic device 901 and executed while loaded to the main storage 903.
                   The program is a program implementing the function that is described as             "...
   unit" in Fig. 8.
                   Moreover, the external storage 902 stores an operating system (OS), at least a
15 part of which is loaded to the main storage 903 so that the arithmetic device 901
   executes the program implementing the function of the "... unit" in Fig. 8 while
   executing the OS.
                   Furthermore, the main storage 903 stores as a file a piece of information, data,
   a signal value and a variable value representing the result of the processing described as
20 "correction of ...", "generation of ...", "creation of ...", "computation of ...", "calculation
   of ...'', ''determination of ...'', ''evaluation of ...'', ''update of ...'', ''estimation of ...",
   "extraction of ...", "selection of ...", "reception of..." and the like in the first and second
   embodiments.
                   Note that the configuration in Fig. 19 merely illustrates an example of the
25 hardware configuration of the positioning device 100, which may thus have the
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     28
   hardware configuration that is not necessarily the configuration illustrated in Fig. 19 but
   another configuration.
   Reference Signs List
 5                  100: positioning device, 101: approximate position/satellite position
   calculation unit, 102: correction data creation unit, 103: observation data screening unit,
   104: observation data error correction unit, 105: time extrapolation calculation unit,
   106: geometric distance calculation unit, 107: residual calculation unit, 108: observation
   update calculation unit, 109: ambiguity calculation unit, 110: double difference residual
10 analysis unit, 200: reinforcement information distribution satellite, 300: GPS satellite,
   400: reinforcement information, 501: observation data, and 502: broadcast ephemeris
                   Modifications within the scope of the invention may be readily effected by
   those skilled in the art. It is to be understood, therefore, that this invention is not limited
   to the particular embodiments described by way of example hereinabove.
15                 In the claims that follow and in the preceding description of the invention,
   except where the context requires otherwise owing to express language or necessary
   implication, the word "comprise" or variations such as "comprises" or "comprising" is
   used in an inclusive sense, that is, to specify the presence of the stated features but not
   to preclude the presence or addition of further features in various embodiments of the
20 invention.
                   Further, any reference herein to prior art is not intended to imply that such
   prior art forms or formed a part of the common general knowledge in any country.
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                    29
   The Claims Defining the Invention Are as Follows:
   1.              A positioning device comprising:
                   a correction data creation unit;
 5                 a least squares method positioning execution unit configured to execute least
   squares method positioning by using, as an observation amount in a positioning
   calculation, n (n is an integer of 3 or larger) number of single difference amounts of an
   L I-wave pseudorange obtained by subtracting n pieces of correction data created by the
   correction data creation unit from n pieces of observation data of n number of positioning
10 satellites, the n pieces of correction data corresponding to the n pieces of observation
   data, the n pieces of correction data being used for a correction depending on each of
   sources of error;
                   a sum-of-squares calculation unit configured to calculate a sum of squares of
   n residuals obtained for each positioning satellite by executing the least squares method
15 positioning;
                   a normalization unit configured to normalize the n residuals; and
                   an evaluation unit configured to control an amount of observation data to be
   used for the positioning calculation by the least squares method positioning execution
   unit based on an evaluation result obtained by evaluating the sum of squares calculated
20 by the sum-of-squares calculation unit and the n residuals normalized by the
   normalization unit.
   2.              The positioning device according to claim 1, wherein
                   the evaluation unit compares the sum of squares with a first threshold,
25 compares each of the n normalized residuals with a second threshold, and
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     30
                   discards less than n pieces of observation data out of the n pieces of
   observation data when the sum of squares exceeds the first threshold and at least any of
   the n normalized residuals exceeds the second threshold.
 5 3.              The positioning device according to claim 2, wherein
                   the evaluation unit discards, from among the n pieces of observation data, a
   piece of observation data from a positioning satellite with the normalized residual
   having the largest absolute value.
10 4.              A positioning device comprising:
                   a correction data creation unit;
                   a least squares method positioning execution unit configured to select a
   combination of n number of positioning satellites (3 < n < m) from among m number of
   positioning satellites, the m pieces of correction data being used for a correction
15 depending on each of sources of error, and execute least squares method positioning for
   each combination, using observation amount for positioning calculation obtained from
   m number of single difference amounts of an LI-wave pseudorange, which is obtained
   by subtracting m pieces of correction data created by the correction data creation unit
   from m pieces of observation data of the m number of positioning satellites, the m
20 pieces of correction data being for correction for each of sources of error and
   corresponding to the m pieces of observation data;
                   a sum-of-squares calculation unit configured to calculate a sum of squares of
   n residuals obtained for each positioning satellite by executing the least squares method
   positioning;
25                 a normalization unit configured to normalize the n residuals; and
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                      31
                   an evaluation unit configured to control an amount of observation data to be
   used for the positioning calculation by the least squares method positioning execution
   unit based on an evaluation result obtained by evaluating the sum of squares calculated
   by the sum-of-squares calculation unit and the n residuals normalized by the
 5 normalization unit.
   5.              The positioning device according to claim 4, wherein
                   the evaluation unit compares the sum of squares with a first threshold,
   compares each of the n normalized residuals with a second threshold, and
10                 discards less than n pieces of observation data out of the n pieces of
   observation data when the sum of squares exceeds the first threshold and at least any of
   the n normalized residuals exceeds the second threshold.
   6.              The positioning device according to claim 5, wherein
15                 the evaluation unit discards, from among the n pieces of observation data, a
   piece of observation data from a positioning satellite with the normalized residual
   having the largest absolute value.
   7.              The positioning device according to claim 4, wherein
20                 the evaluation unit inputs, to a positioning calculation unit performing
   positioning calculation, n pieces of observation data of a combination with the smallest
   sum of squares calculated by the sum-of-squares calculation unit, from among the
   combinations selected by the least squares method positioning execution unit.
25 8.              The positioning device according to claim 1, wherein
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                     32
                   the evaluation unit compares, for each positioning satellite, signal intensity of
   a positioning signal with a third threshold and discards observation data from a
   positioning satellite with the signal intensity of the positioning signal falling below the
   third threshold.
 5
   9.              The positioning device according to claim 1, wherein
                   the evaluation unit compares, for each positioning satellite, a satellite
   elevation angle with a fourth threshold and
                   discards observation data from a positioning satellite with the satellite
10 elevation angle falling below the fourth threshold.
   10.             The positioning device according to claim 1, wherein
                   the evaluation unit compares, for each positioning satellite, a pseudorange
   double difference residual with a fifth threshold and
15                 discards observation data from a positioning satellite with the pseudorange
   double difference residual exceeding the fifth threshold.
   11.             The positioning device according to claim 1, further comprising
                   an ambiguity calculation unit configured to calculate ambiguity for each
20 positioning satellite, wherein
                   the evaluation unit compares a carrier phase double difference residual with a
   sixth threshold for each positioning satellite and instructs the ambiguity calculation unit
   to recalculate ambiguity of a positioning satellite with the carrier phase double
   difference residual exceeding the sixth threshold, and
25                 the ambiguity calculation unit recalculates the ambiguity of the positioning
   10156305_1(GHMaters) P104011.AU 6/7/2018

                                                    33
   satellite for which the recalculation of the ambiguity is instructed by the evaluation unit.
   12.             A positioning method comprising:
                   creating correction data;
 5                 performing least squares method positioning by using, as an observation
   amount, n (n is an integer of 3 or larger) number of single difference amounts of an LI
   wave pseudorange obtained by subtracting n pieces of correction data created by the
   creating from n pieces of observation data of n number of positioning satellites, the n
   pieces of correction data being used for a correction depending on each source of error;
10                 calculating a sum of squares of n residuals obtained for each positioning
   satellite by executing the least squares method positioning;
                   normalizing the n residuals; and
                   controlling an amount of observation data to be used for the positioning
   calculation by the least squares method positioning, based on an evaluation result
15 obtained by evaluating the calculated sum of squares calculated by the sum-of-squares
   calculating and the normalized n residuals.
   10156305_1(GHMaters) P104011.AU 6/7/2018

<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
<removed-apn> <removed-date>
